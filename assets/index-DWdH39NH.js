(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))r(i);new MutationObserver(i=>{for(const s of i)if(s.type==="childList")for(const o of s.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&r(o)}).observe(document,{childList:!0,subtree:!0});function t(i){const s={};return i.integrity&&(s.integrity=i.integrity),i.referrerPolicy&&(s.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?s.credentials="include":i.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function r(i){if(i.ep)return;i.ep=!0;const s=t(i);fetch(i.href,s)}})();const xT=()=>{};var ky={};const m5=function(n){const e=[];let t=0;for(let r=0;r<n.length;r++){let i=n.charCodeAt(r);i<128?e[t++]=i:i<2048?(e[t++]=i>>6|192,e[t++]=i&63|128):(i&64512)===55296&&r+1<n.length&&(n.charCodeAt(r+1)&64512)===56320?(i=65536+((i&1023)<<10)+(n.charCodeAt(++r)&1023),e[t++]=i>>18|240,e[t++]=i>>12&63|128,e[t++]=i>>6&63|128,e[t++]=i&63|128):(e[t++]=i>>12|224,e[t++]=i>>6&63|128,e[t++]=i&63|128)}return e},RT=function(n){const e=[];let t=0,r=0;for(;t<n.length;){const i=n[t++];if(i<128)e[r++]=String.fromCharCode(i);else if(i>191&&i<224){const s=n[t++];e[r++]=String.fromCharCode((i&31)<<6|s&63)}else if(i>239&&i<365){const s=n[t++],o=n[t++],a=n[t++],c=((i&7)<<18|(s&63)<<12|(o&63)<<6|a&63)-65536;e[r++]=String.fromCharCode(55296+(c>>10)),e[r++]=String.fromCharCode(56320+(c&1023))}else{const s=n[t++],o=n[t++];e[r++]=String.fromCharCode((i&15)<<12|(s&63)<<6|o&63)}}return e.join("")},y5={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(n,e){if(!Array.isArray(n))throw Error("encodeByteArray takes an array as a parameter");this.init_();const t=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,r=[];for(let i=0;i<n.length;i+=3){const s=n[i],o=i+1<n.length,a=o?n[i+1]:0,c=i+2<n.length,u=c?n[i+2]:0,d=s>>2,g=(s&3)<<4|a>>4;let y=(a&15)<<2|u>>6,p=u&63;c||(p=64,o||(y=64)),r.push(t[d],t[g],t[y],t[p])}return r.join("")},encodeString(n,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(n):this.encodeByteArray(m5(n),e)},decodeString(n,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(n):RT(this.decodeStringToByteArray(n,e))},decodeStringToByteArray(n,e){this.init_();const t=e?this.charToByteMapWebSafe_:this.charToByteMap_,r=[];for(let i=0;i<n.length;){const s=t[n.charAt(i++)],a=i<n.length?t[n.charAt(i)]:0;++i;const u=i<n.length?t[n.charAt(i)]:64;++i;const g=i<n.length?t[n.charAt(i)]:64;if(++i,s==null||a==null||u==null||g==null)throw new NT;const y=s<<2|a>>4;if(r.push(y),u!==64){const p=a<<4&240|u>>2;if(r.push(p),g!==64){const S=u<<6&192|g;r.push(S)}}}return r},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let n=0;n<this.ENCODED_VALS.length;n++)this.byteToCharMap_[n]=this.ENCODED_VALS.charAt(n),this.charToByteMap_[this.byteToCharMap_[n]]=n,this.byteToCharMapWebSafe_[n]=this.ENCODED_VALS_WEBSAFE.charAt(n),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[n]]=n,n>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(n)]=n,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(n)]=n)}}};class NT extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const kT=function(n){const e=m5(n);return y5.encodeByteArray(e,!0)},yf=function(n){return kT(n).replace(/\./g,"")},Xm=function(n){try{return y5.decodeString(n,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};function _f(n,e){if(!(e instanceof Object))return e;switch(e.constructor){case Date:const t=e;return new Date(t.getTime());case Object:n===void 0&&(n={});break;case Array:n=[];break;default:return e}for(const t in e)!e.hasOwnProperty(t)||!CT(t)||(n[t]=_f(n[t],e[t]));return n}function CT(n){return n!=="__proto__"}function Zm(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}const LT=()=>Zm().__FIREBASE_DEFAULTS__,DT=()=>{if(typeof process>"u"||typeof ky>"u")return;const n=ky.__FIREBASE_DEFAULTS__;if(n)return JSON.parse(n)},OT=()=>{if(typeof document>"u")return;let n;try{n=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=n&&Xm(n[1]);return e&&JSON.parse(e)},e1=()=>{try{return xT()||LT()||DT()||OT()}catch(n){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${n}`);return}},t1=()=>e1()?.config,FT=n=>e1()?.[`_${n}`];class MT{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}wrapCallback(e){return(t,r)=>{t?this.reject(t):this.resolve(r),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(t):e(t,r))}}}function Xu(n){try{return(n.startsWith("http://")||n.startsWith("https://")?new URL(n).hostname:n).endsWith(".cloudworkstations.dev")}catch{return!1}}async function _5(n){return(await fetch(n,{credentials:"include"})).ok}function VT(n,e){if(n.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const t={alg:"none",type:"JWT"},r=e||"demo-project",i=n.iat||0,s=n.sub||n.user_id;if(!s)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const o={iss:`https://securetoken.google.com/${r}`,aud:r,iat:i,exp:i+3600,auth_time:i,sub:s,user_id:s,firebase:{sign_in_provider:"custom",identities:{}},...n};return[yf(JSON.stringify(t)),yf(JSON.stringify(o)),""].join(".")}const Zl={};function BT(){const n={prod:[],emulator:[]};for(const e of Object.keys(Zl))Zl[e]?n.emulator.push(e):n.prod.push(e);return n}function UT(n){let e=document.getElementById(n),t=!1;return e||(e=document.createElement("div"),e.setAttribute("id",n),t=!0),{created:t,element:e}}let Cy=!1;function v5(n,e){if(typeof window>"u"||typeof document>"u"||!Xu(window.location.host)||Zl[n]===e||Zl[n]||Cy)return;Zl[n]=e;function t(y){return`__firebase__banner__${y}`}const r="__firebase__banner",s=BT().prod.length>0;function o(){const y=document.getElementById(r);y&&y.remove()}function a(y){y.style.display="flex",y.style.background="#7faaf0",y.style.position="fixed",y.style.bottom="5px",y.style.left="5px",y.style.padding=".5em",y.style.borderRadius="5px",y.style.alignItems="center"}function c(y,p){y.setAttribute("width","24"),y.setAttribute("id",p),y.setAttribute("height","24"),y.setAttribute("viewBox","0 0 24 24"),y.setAttribute("fill","none"),y.style.marginLeft="-6px"}function u(){const y=document.createElement("span");return y.style.cursor="pointer",y.style.marginLeft="16px",y.style.fontSize="24px",y.innerHTML=" &times;",y.onclick=()=>{Cy=!0,o()},y}function d(y,p){y.setAttribute("id",p),y.innerText="Learn more",y.href="https://firebase.google.com/docs/studio/preview-apps#preview-backend",y.setAttribute("target","__blank"),y.style.paddingLeft="5px",y.style.textDecoration="underline"}function g(){const y=UT(r),p=t("text"),S=document.getElementById(p)||document.createElement("span"),N=t("learnmore"),C=document.getElementById(N)||document.createElement("a"),k=t("preprendIcon"),K=document.getElementById(k)||document.createElementNS("http://www.w3.org/2000/svg","svg");if(y.created){const G=y.element;a(G),d(C,N);const W=u();c(K,k),G.append(K,S,C,W),document.body.appendChild(G)}s?(S.innerText="Preview backend disconnected.",K.innerHTML=`<g clip-path="url(#clip0_6013_33858)">
<path d="M4.8 17.6L12 5.6L19.2 17.6H4.8ZM6.91667 16.4H17.0833L12 7.93333L6.91667 16.4ZM12 15.6C12.1667 15.6 12.3056 15.5444 12.4167 15.4333C12.5389 15.3111 12.6 15.1667 12.6 15C12.6 14.8333 12.5389 14.6944 12.4167 14.5833C12.3056 14.4611 12.1667 14.4 12 14.4C11.8333 14.4 11.6889 14.4611 11.5667 14.5833C11.4556 14.6944 11.4 14.8333 11.4 15C11.4 15.1667 11.4556 15.3111 11.5667 15.4333C11.6889 15.5444 11.8333 15.6 12 15.6ZM11.4 13.6H12.6V10.4H11.4V13.6Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6013_33858">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`):(K.innerHTML=`<g clip-path="url(#clip0_6083_34804)">
<path d="M11.4 15.2H12.6V11.2H11.4V15.2ZM12 10C12.1667 10 12.3056 9.94444 12.4167 9.83333C12.5389 9.71111 12.6 9.56667 12.6 9.4C12.6 9.23333 12.5389 9.09444 12.4167 8.98333C12.3056 8.86111 12.1667 8.8 12 8.8C11.8333 8.8 11.6889 8.86111 11.5667 8.98333C11.4556 9.09444 11.4 9.23333 11.4 9.4C11.4 9.56667 11.4556 9.71111 11.5667 9.83333C11.6889 9.94444 11.8333 10 12 10ZM12 18.4C11.1222 18.4 10.2944 18.2333 9.51667 17.9C8.73889 17.5667 8.05556 17.1111 7.46667 16.5333C6.88889 15.9444 6.43333 15.2611 6.1 14.4833C5.76667 13.7056 5.6 12.8778 5.6 12C5.6 11.1111 5.76667 10.2833 6.1 9.51667C6.43333 8.73889 6.88889 8.06111 7.46667 7.48333C8.05556 6.89444 8.73889 6.43333 9.51667 6.1C10.2944 5.76667 11.1222 5.6 12 5.6C12.8889 5.6 13.7167 5.76667 14.4833 6.1C15.2611 6.43333 15.9389 6.89444 16.5167 7.48333C17.1056 8.06111 17.5667 8.73889 17.9 9.51667C18.2333 10.2833 18.4 11.1111 18.4 12C18.4 12.8778 18.2333 13.7056 17.9 14.4833C17.5667 15.2611 17.1056 15.9444 16.5167 16.5333C15.9389 17.1111 15.2611 17.5667 14.4833 17.9C13.7167 18.2333 12.8889 18.4 12 18.4ZM12 17.2C13.4444 17.2 14.6722 16.6944 15.6833 15.6833C16.6944 14.6722 17.2 13.4444 17.2 12C17.2 10.5556 16.6944 9.32778 15.6833 8.31667C14.6722 7.30555 13.4444 6.8 12 6.8C10.5556 6.8 9.32778 7.30555 8.31667 8.31667C7.30556 9.32778 6.8 10.5556 6.8 12C6.8 13.4444 7.30556 14.6722 8.31667 15.6833C9.32778 16.6944 10.5556 17.2 12 17.2Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6083_34804">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`,S.innerText="Preview backend running in this workspace."),S.setAttribute("id",p)}document.readyState==="loading"?window.addEventListener("DOMContentLoaded",g):g()}function Nn(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function jT(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(Nn())}function Jf(){const n=e1()?.forceEnvironment;if(n==="node")return!0;if(n==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function qT(){return typeof window<"u"||w5()}function w5(){return typeof WorkerGlobalScope<"u"&&typeof self<"u"&&self instanceof WorkerGlobalScope}function zT(){return typeof navigator<"u"&&navigator.userAgent==="Cloudflare-Workers"}function b5(){const n=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof n=="object"&&n.id!==void 0}function n1(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function I5(){const n=Nn();return n.indexOf("MSIE ")>=0||n.indexOf("Trident/")>=0}function A5(){return!Jf()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function E5(){return!Jf()&&!!navigator.userAgent&&(navigator.userAgent.includes("Safari")||navigator.userAgent.includes("WebKit"))&&!navigator.userAgent.includes("Chrome")}function yh(){try{return typeof indexedDB=="object"}catch{return!1}}function $T(){return new Promise((n,e)=>{try{let t=!0;const r="validate-browser-context-for-indexeddb-analytics-module",i=self.indexedDB.open(r);i.onsuccess=()=>{i.result.close(),t||self.indexedDB.deleteDatabase(r),n(!0)},i.onupgradeneeded=()=>{t=!1},i.onerror=()=>{e(i.error?.message||"")}}catch(t){e(t)}})}const WT="FirebaseError";class Gr extends Error{constructor(e,t,r){super(t),this.code=e,this.customData=r,this.name=WT,Object.setPrototypeOf(this,Gr.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,Nc.prototype.create)}}class Nc{constructor(e,t,r){this.service=e,this.serviceName=t,this.errors=r}create(e,...t){const r=t[0]||{},i=`${this.service}/${e}`,s=this.errors[e],o=s?HT(s,r):"Error",a=`${this.serviceName}: ${o} (${i}).`;return new Gr(i,a,r)}}function HT(n,e){return n.replace(GT,(t,r)=>{const i=e[r];return i!=null?String(i):`<${r}?>`})}const GT=/\{\$([^}]+)}/g;function Ly(n,e){return Object.prototype.hasOwnProperty.call(n,e)}function KT(n){for(const e in n)if(Object.prototype.hasOwnProperty.call(n,e))return!1;return!0}function ga(n,e){if(n===e)return!0;const t=Object.keys(n),r=Object.keys(e);for(const i of t){if(!r.includes(i))return!1;const s=n[i],o=e[i];if(Dy(s)&&Dy(o)){if(!ga(s,o))return!1}else if(s!==o)return!1}for(const i of r)if(!t.includes(i))return!1;return!0}function Dy(n){return n!==null&&typeof n=="object"}function Zu(n){const e=[];for(const[t,r]of Object.entries(n))Array.isArray(r)?r.forEach(i=>{e.push(encodeURIComponent(t)+"="+encodeURIComponent(i))}):e.push(encodeURIComponent(t)+"="+encodeURIComponent(r));return e.length?"&"+e.join("&"):""}function gu(n){const e={};return n.replace(/^\?/,"").split("&").forEach(r=>{if(r){const[i,s]=r.split("=");e[decodeURIComponent(i)]=decodeURIComponent(s)}}),e}function Wl(n){const e=n.indexOf("?");if(!e)return"";const t=n.indexOf("#",e);return n.substring(e,t>0?t:void 0)}function T5(n,e){const t=new YT(n,e);return t.subscribe.bind(t)}class YT{constructor(e,t){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=t,this.task.then(()=>{e(this)}).catch(r=>{this.error(r)})}next(e){this.forEachObserver(t=>{t.next(e)})}error(e){this.forEachObserver(t=>{t.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,t,r){let i;if(e===void 0&&t===void 0&&r===void 0)throw new Error("Missing Observer.");JT(e,["next","error","complete"])?i=e:i={next:e,error:t,complete:r},i.next===void 0&&(i.next=rg),i.error===void 0&&(i.error=rg),i.complete===void 0&&(i.complete=rg);const s=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?i.error(this.finalError):i.complete()}catch{}}),this.observers.push(i),s}unsubscribeOne(e){this.observers===void 0||this.observers[e]===void 0||(delete this.observers[e],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let t=0;t<this.observers.length;t++)this.sendOne(t,e)}sendOne(e,t){this.task.then(()=>{if(this.observers!==void 0&&this.observers[e]!==void 0)try{t(this.observers[e])}catch(r){typeof console<"u"&&console.error&&console.error(r)}})}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function JT(n,e){if(typeof n!="object"||n===null)return!1;for(const t of e)if(t in n&&typeof n[t]=="function")return!0;return!1}function rg(){}function ft(n){return n&&n._delegate?n._delegate:n}class zs{constructor(e,t,r){this.name=e,this.instanceFactory=t,this.type=r,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}const Ya="[DEFAULT]";class QT{constructor(e,t){this.name=e,this.container=t,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const t=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(t)){const r=new MT;if(this.instancesDeferred.set(t,r),this.isInitialized(t)||this.shouldAutoInitialize())try{const i=this.getOrInitializeService({instanceIdentifier:t});i&&r.resolve(i)}catch{}}return this.instancesDeferred.get(t).promise}getImmediate(e){const t=this.normalizeInstanceIdentifier(e?.identifier),r=e?.optional??!1;if(this.isInitialized(t)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:t})}catch(i){if(r)return null;throw i}else{if(r)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(ZT(e))try{this.getOrInitializeService({instanceIdentifier:Ya})}catch{}for(const[t,r]of this.instancesDeferred.entries()){const i=this.normalizeInstanceIdentifier(t);try{const s=this.getOrInitializeService({instanceIdentifier:i});r.resolve(s)}catch{}}}}clearInstance(e=Ya){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(t=>"INTERNAL"in t).map(t=>t.INTERNAL.delete()),...e.filter(t=>"_delete"in t).map(t=>t._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=Ya){return this.instances.has(e)}getOptions(e=Ya){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:t={}}=e,r=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(r))throw Error(`${this.name}(${r}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const i=this.getOrInitializeService({instanceIdentifier:r,options:t});for(const[s,o]of this.instancesDeferred.entries()){const a=this.normalizeInstanceIdentifier(s);r===a&&o.resolve(i)}return i}onInit(e,t){const r=this.normalizeInstanceIdentifier(t),i=this.onInitCallbacks.get(r)??new Set;i.add(e),this.onInitCallbacks.set(r,i);const s=this.instances.get(r);return s&&e(s,r),()=>{i.delete(e)}}invokeOnInitCallbacks(e,t){const r=this.onInitCallbacks.get(t);if(r)for(const i of r)try{i(e,t)}catch{}}getOrInitializeService({instanceIdentifier:e,options:t={}}){let r=this.instances.get(e);if(!r&&this.component&&(r=this.component.instanceFactory(this.container,{instanceIdentifier:XT(e),options:t}),this.instances.set(e,r),this.instancesOptions.set(e,t),this.invokeOnInitCallbacks(r,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,r)}catch{}return r||null}normalizeInstanceIdentifier(e=Ya){return this.component?this.component.multipleInstances?e:Ya:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function XT(n){return n===Ya?void 0:n}function ZT(n){return n.instantiationMode==="EAGER"}class S5{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const t=this.getProvider(e.name);if(t.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);t.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const t=new QT(e,this);return this.providers.set(e,t),t}getProviders(){return Array.from(this.providers.values())}}const r1=[];var Dt;(function(n){n[n.DEBUG=0]="DEBUG",n[n.VERBOSE=1]="VERBOSE",n[n.INFO=2]="INFO",n[n.WARN=3]="WARN",n[n.ERROR=4]="ERROR",n[n.SILENT=5]="SILENT"})(Dt||(Dt={}));const P5={debug:Dt.DEBUG,verbose:Dt.VERBOSE,info:Dt.INFO,warn:Dt.WARN,error:Dt.ERROR,silent:Dt.SILENT},eS=Dt.INFO,tS={[Dt.DEBUG]:"log",[Dt.VERBOSE]:"log",[Dt.INFO]:"info",[Dt.WARN]:"warn",[Dt.ERROR]:"error"},nS=(n,e,...t)=>{if(e<n.logLevel)return;const r=new Date().toISOString(),i=tS[e];if(i)console[i](`[${r}]  ${n.name}:`,...t);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};class Qf{constructor(e){this.name=e,this._logLevel=eS,this._logHandler=nS,this._userLogHandler=null,r1.push(this)}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in Dt))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?P5[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,Dt.DEBUG,...e),this._logHandler(this,Dt.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,Dt.VERBOSE,...e),this._logHandler(this,Dt.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,Dt.INFO,...e),this._logHandler(this,Dt.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,Dt.WARN,...e),this._logHandler(this,Dt.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,Dt.ERROR,...e),this._logHandler(this,Dt.ERROR,...e)}}function rS(n){r1.forEach(e=>{e.setLogLevel(n)})}function iS(n,e){for(const t of r1){let r=null;e&&e.level&&(r=P5[e.level]),n===null?t.userLogHandler=null:t.userLogHandler=(i,s,...o)=>{const a=o.map(c=>{if(c==null)return null;if(typeof c=="string")return c;if(typeof c=="number"||typeof c=="boolean")return c.toString();if(c instanceof Error)return c.message;try{return JSON.stringify(c)}catch{return null}}).filter(c=>c).join(" ");s>=(r??i.logLevel)&&n({level:Dt[s].toLowerCase(),message:a,args:o,type:i.name})}}}const sS=(n,e)=>e.some(t=>n instanceof t);let Oy,Fy;function oS(){return Oy||(Oy=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function aS(){return Fy||(Fy=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const x5=new WeakMap,Yg=new WeakMap,R5=new WeakMap,ig=new WeakMap,i1=new WeakMap;function cS(n){const e=new Promise((t,r)=>{const i=()=>{n.removeEventListener("success",s),n.removeEventListener("error",o)},s=()=>{t(ua(n.result)),i()},o=()=>{r(n.error),i()};n.addEventListener("success",s),n.addEventListener("error",o)});return e.then(t=>{t instanceof IDBCursor&&x5.set(t,n)}).catch(()=>{}),i1.set(e,n),e}function uS(n){if(Yg.has(n))return;const e=new Promise((t,r)=>{const i=()=>{n.removeEventListener("complete",s),n.removeEventListener("error",o),n.removeEventListener("abort",o)},s=()=>{t(),i()},o=()=>{r(n.error||new DOMException("AbortError","AbortError")),i()};n.addEventListener("complete",s),n.addEventListener("error",o),n.addEventListener("abort",o)});Yg.set(n,e)}let Jg={get(n,e,t){if(n instanceof IDBTransaction){if(e==="done")return Yg.get(n);if(e==="objectStoreNames")return n.objectStoreNames||R5.get(n);if(e==="store")return t.objectStoreNames[1]?void 0:t.objectStore(t.objectStoreNames[0])}return ua(n[e])},set(n,e,t){return n[e]=t,!0},has(n,e){return n instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in n}};function lS(n){Jg=n(Jg)}function hS(n){return n===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...t){const r=n.call(sg(this),e,...t);return R5.set(r,e.sort?e.sort():[e]),ua(r)}:aS().includes(n)?function(...e){return n.apply(sg(this),e),ua(x5.get(this))}:function(...e){return ua(n.apply(sg(this),e))}}function dS(n){return typeof n=="function"?hS(n):(n instanceof IDBTransaction&&uS(n),sS(n,oS())?new Proxy(n,Jg):n)}function ua(n){if(n instanceof IDBRequest)return cS(n);if(ig.has(n))return ig.get(n);const e=dS(n);return e!==n&&(ig.set(n,e),i1.set(e,n)),e}const sg=n=>i1.get(n);function fS(n,e,{blocked:t,upgrade:r,blocking:i,terminated:s}={}){const o=indexedDB.open(n,e),a=ua(o);return r&&o.addEventListener("upgradeneeded",c=>{r(ua(o.result),c.oldVersion,c.newVersion,ua(o.transaction),c)}),t&&o.addEventListener("blocked",c=>t(c.oldVersion,c.newVersion,c)),a.then(c=>{s&&c.addEventListener("close",()=>s()),i&&c.addEventListener("versionchange",u=>i(u.oldVersion,u.newVersion,u))}).catch(()=>{}),a}const pS=["get","getKey","getAll","getAllKeys","count"],gS=["put","add","delete","clear"],og=new Map;function My(n,e){if(!(n instanceof IDBDatabase&&!(e in n)&&typeof e=="string"))return;if(og.get(e))return og.get(e);const t=e.replace(/FromIndex$/,""),r=e!==t,i=gS.includes(t);if(!(t in(r?IDBIndex:IDBObjectStore).prototype)||!(i||pS.includes(t)))return;const s=async function(o,...a){const c=this.transaction(o,i?"readwrite":"readonly");let u=c.store;return r&&(u=u.index(a.shift())),(await Promise.all([u[t](...a),i&&c.done]))[0]};return og.set(e,s),s}lS(n=>({...n,get:(e,t,r)=>My(e,t)||n.get(e,t,r),has:(e,t)=>!!My(e,t)||n.has(e,t)}));class mS{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(t=>{if(yS(t)){const r=t.getImmediate();return`${r.library}/${r.version}`}else return null}).filter(t=>t).join(" ")}}function yS(n){return n.getComponent()?.type==="VERSION"}const vf="@firebase/app",Qg="0.14.7";const _o=new Qf("@firebase/app"),_S="@firebase/app-compat",vS="@firebase/analytics-compat",wS="@firebase/analytics",bS="@firebase/app-check-compat",IS="@firebase/app-check",AS="@firebase/auth",ES="@firebase/auth-compat",TS="@firebase/database",SS="@firebase/data-connect",PS="@firebase/database-compat",xS="@firebase/functions",RS="@firebase/functions-compat",NS="@firebase/installations",kS="@firebase/installations-compat",CS="@firebase/messaging",LS="@firebase/messaging-compat",DS="@firebase/performance",OS="@firebase/performance-compat",FS="@firebase/remote-config",MS="@firebase/remote-config-compat",VS="@firebase/storage",BS="@firebase/storage-compat",US="@firebase/firestore",jS="@firebase/ai",qS="@firebase/firestore-compat",zS="firebase",$S="12.8.0";const ma="[DEFAULT]",WS={[vf]:"fire-core",[_S]:"fire-core-compat",[wS]:"fire-analytics",[vS]:"fire-analytics-compat",[IS]:"fire-app-check",[bS]:"fire-app-check-compat",[AS]:"fire-auth",[ES]:"fire-auth-compat",[TS]:"fire-rtdb",[SS]:"fire-data-connect",[PS]:"fire-rtdb-compat",[xS]:"fire-fn",[RS]:"fire-fn-compat",[NS]:"fire-iid",[kS]:"fire-iid-compat",[CS]:"fire-fcm",[LS]:"fire-fcm-compat",[DS]:"fire-perf",[OS]:"fire-perf-compat",[FS]:"fire-rc",[MS]:"fire-rc-compat",[VS]:"fire-gcs",[BS]:"fire-gcs-compat",[US]:"fire-fst",[qS]:"fire-fst-compat",[jS]:"fire-vertex","fire-js":"fire-js",[zS]:"fire-js-all"};const ya=new Map,Ru=new Map,Nu=new Map;function _h(n,e){try{n.container.addComponent(e)}catch(t){_o.debug(`Component ${e.name} failed to register with FirebaseApp ${n.name}`,t)}}function N5(n,e){n.container.addOrOverwriteComponent(e)}function _a(n){const e=n.name;if(Nu.has(e))return _o.debug(`There were multiple attempts to register component ${e}.`),!1;Nu.set(e,n);for(const t of ya.values())_h(t,n);for(const t of Ru.values())_h(t,n);return!0}function k5(n,e){const t=n.container.getProvider("heartbeat").getImmediate({optional:!0});return t&&t.triggerHeartbeat(),n.container.getProvider(e)}function HS(n,e,t=ma){k5(n,e).clearInstance(t)}function s1(n){return n.options!==void 0}function C5(n){return s1(n)?!1:"authIdToken"in n||"appCheckToken"in n||"releaseOnDeref"in n||"automaticDataCollectionEnabled"in n}function Pn(n){return n==null?!1:n.settings!==void 0}function GS(){Nu.clear()}const KS={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},xi=new Nc("app","Firebase",KS);let L5=class{constructor(e,t,r){this._isDeleted=!1,this._options={...e},this._config={...t},this._name=t.name,this._automaticDataCollectionEnabled=t.automaticDataCollectionEnabled,this._container=r,this.container.addComponent(new zs("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw xi.create("app-deleted",{appName:this._name})}};function Vy(n,e){const t=Xm(n.split(".")[1]);if(t===null){console.error(`FirebaseServerApp ${e} is invalid: second part could not be parsed.`);return}if(JSON.parse(t).exp===void 0){console.error(`FirebaseServerApp ${e} is invalid: expiration claim could not be parsed`);return}const i=JSON.parse(t).exp*1e3,s=new Date().getTime();i-s<=0&&console.error(`FirebaseServerApp ${e} is invalid: the token has expired.`)}class YS extends L5{constructor(e,t,r,i){const s=t.automaticDataCollectionEnabled!==void 0?t.automaticDataCollectionEnabled:!0,o={name:r,automaticDataCollectionEnabled:s};if(e.apiKey!==void 0)super(e,o,i);else{const a=e;super(a.options,o,i)}this._serverConfig={automaticDataCollectionEnabled:s,...t},this._serverConfig.authIdToken&&Vy(this._serverConfig.authIdToken,"authIdToken"),this._serverConfig.appCheckToken&&Vy(this._serverConfig.appCheckToken,"appCheckToken"),this._finalizationRegistry=null,typeof FinalizationRegistry<"u"&&(this._finalizationRegistry=new FinalizationRegistry(()=>{this.automaticCleanup()})),this._refCount=0,this.incRefCount(this._serverConfig.releaseOnDeref),this._serverConfig.releaseOnDeref=void 0,t.releaseOnDeref=void 0,as(vf,Qg,"serverapp")}toJSON(){}get refCount(){return this._refCount}incRefCount(e){this.isDeleted||(this._refCount++,e!==void 0&&this._finalizationRegistry!==null&&this._finalizationRegistry.register(e,this))}decRefCount(){return this.isDeleted?0:--this._refCount}automaticCleanup(){a1(this)}get settings(){return this.checkDestroyed(),this._serverConfig}checkDestroyed(){if(this.isDeleted)throw xi.create("server-app-deleted")}}const Pa=$S;function o1(n,e={}){let t=n;typeof e!="object"&&(e={name:e});const r={name:ma,automaticDataCollectionEnabled:!0,...e},i=r.name;if(typeof i!="string"||!i)throw xi.create("bad-app-name",{appName:String(i)});if(t||(t=t1()),!t)throw xi.create("no-options");const s=ya.get(i);if(s){if(ga(t,s.options)&&ga(r,s.config))return s;throw xi.create("duplicate-app",{appName:i})}const o=new S5(i);for(const c of Nu.values())o.addComponent(c);const a=new L5(t,r,o);return ya.set(i,a),a}function JS(n,e={}){if(qT()&&!w5())throw xi.create("invalid-server-app-environment");let t,r=e||{};if(n&&(s1(n)?t=n.options:C5(n)?r=n:t=n),r.automaticDataCollectionEnabled===void 0&&(r.automaticDataCollectionEnabled=!0),t||(t=t1()),!t)throw xi.create("no-options");const i={...r,...t};i.releaseOnDeref!==void 0&&delete i.releaseOnDeref;const s=d=>[...d].reduce((g,y)=>Math.imul(31,g)+y.charCodeAt(0)|0,0);if(r.releaseOnDeref!==void 0&&typeof FinalizationRegistry>"u")throw xi.create("finalization-registry-not-supported",{});const o=""+s(JSON.stringify(i)),a=Ru.get(o);if(a)return a.incRefCount(r.releaseOnDeref),a;const c=new S5(o);for(const d of Nu.values())c.addComponent(d);const u=new YS(t,r,o,c);return Ru.set(o,u),u}function QS(n=ma){const e=ya.get(n);if(!e&&n===ma&&t1())return o1();if(!e)throw xi.create("no-app",{appName:n});return e}function XS(){return Array.from(ya.values())}async function a1(n){let e=!1;const t=n.name;ya.has(t)?(e=!0,ya.delete(t)):Ru.has(t)&&n.decRefCount()<=0&&(Ru.delete(t),e=!0),e&&(await Promise.all(n.container.getProviders().map(r=>r.delete())),n.isDeleted=!0)}function as(n,e,t){let r=WS[n]??n;t&&(r+=`-${t}`);const i=r.match(/\s|\//),s=e.match(/\s|\//);if(i||s){const o=[`Unable to register library "${r}" with version "${e}":`];i&&o.push(`library name "${r}" contains illegal characters (whitespace or "/")`),i&&s&&o.push("and"),s&&o.push(`version name "${e}" contains illegal characters (whitespace or "/")`),_o.warn(o.join(" "));return}_a(new zs(`${r}-version`,()=>({library:r,version:e}),"VERSION"))}function D5(n,e){if(n!==null&&typeof n!="function")throw xi.create("invalid-log-argument");iS(n,e)}function O5(n){rS(n)}const ZS="firebase-heartbeat-database",e4=1,vh="firebase-heartbeat-store";let ag=null;function F5(){return ag||(ag=fS(ZS,e4,{upgrade:(n,e)=>{switch(e){case 0:try{n.createObjectStore(vh)}catch(t){console.warn(t)}}}}).catch(n=>{throw xi.create("idb-open",{originalErrorMessage:n.message})})),ag}async function t4(n){try{const t=(await F5()).transaction(vh),r=await t.objectStore(vh).get(M5(n));return await t.done,r}catch(e){if(e instanceof Gr)_o.warn(e.message);else{const t=xi.create("idb-get",{originalErrorMessage:e?.message});_o.warn(t.message)}}}async function By(n,e){try{const r=(await F5()).transaction(vh,"readwrite");await r.objectStore(vh).put(e,M5(n)),await r.done}catch(t){if(t instanceof Gr)_o.warn(t.message);else{const r=xi.create("idb-set",{originalErrorMessage:t?.message});_o.warn(r.message)}}}function M5(n){return`${n.name}!${n.options.appId}`}const n4=1024,r4=30;class i4{constructor(e){this.container=e,this._heartbeatsCache=null;const t=this.container.getProvider("app").getImmediate();this._storage=new o4(t),this._heartbeatsCachePromise=this._storage.read().then(r=>(this._heartbeatsCache=r,r))}async triggerHeartbeat(){try{const t=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),r=Uy();if(this._heartbeatsCache?.heartbeats==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,this._heartbeatsCache?.heartbeats==null)||this._heartbeatsCache.lastSentHeartbeatDate===r||this._heartbeatsCache.heartbeats.some(i=>i.date===r))return;if(this._heartbeatsCache.heartbeats.push({date:r,agent:t}),this._heartbeatsCache.heartbeats.length>r4){const i=a4(this._heartbeatsCache.heartbeats);this._heartbeatsCache.heartbeats.splice(i,1)}return this._storage.overwrite(this._heartbeatsCache)}catch(e){_o.warn(e)}}async getHeartbeatsHeader(){try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,this._heartbeatsCache?.heartbeats==null||this._heartbeatsCache.heartbeats.length===0)return"";const e=Uy(),{heartbeatsToSend:t,unsentEntries:r}=s4(this._heartbeatsCache.heartbeats),i=yf(JSON.stringify({version:2,heartbeats:t}));return this._heartbeatsCache.lastSentHeartbeatDate=e,r.length>0?(this._heartbeatsCache.heartbeats=r,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),i}catch(e){return _o.warn(e),""}}}function Uy(){return new Date().toISOString().substring(0,10)}function s4(n,e=n4){const t=[];let r=n.slice();for(const i of n){const s=t.find(o=>o.agent===i.agent);if(s){if(s.dates.push(i.date),jy(t)>e){s.dates.pop();break}}else if(t.push({agent:i.agent,dates:[i.date]}),jy(t)>e){t.pop();break}r=r.slice(1)}return{heartbeatsToSend:t,unsentEntries:r}}class o4{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return yh()?$T().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const t=await t4(this.app);return t?.heartbeats?t:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(e){if(await this._canUseIndexedDBPromise){const r=await this.read();return By(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??r.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){if(await this._canUseIndexedDBPromise){const r=await this.read();return By(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??r.lastSentHeartbeatDate,heartbeats:[...r.heartbeats,...e.heartbeats]})}else return}}function jy(n){return yf(JSON.stringify({version:2,heartbeats:n})).length}function a4(n){if(n.length===0)return-1;let e=0,t=n[0].date;for(let r=1;r<n.length;r++)n[r].date<t&&(t=n[r].date,e=r);return e}function c4(n){_a(new zs("platform-logger",e=>new mS(e),"PRIVATE")),_a(new zs("heartbeat",e=>new i4(e),"PRIVATE")),as(vf,Qg,n),as(vf,Qg,"esm2020"),as("fire-js","")}c4("");const u4=Object.freeze(Object.defineProperty({__proto__:null,FirebaseError:Gr,SDK_VERSION:Pa,_DEFAULT_ENTRY_NAME:ma,_addComponent:_h,_addOrOverwriteComponent:N5,_apps:ya,_clearComponents:GS,_components:Nu,_getProvider:k5,_isFirebaseApp:s1,_isFirebaseServerApp:Pn,_isFirebaseServerAppSettings:C5,_registerComponent:_a,_removeServiceInstance:HS,_serverApps:Ru,deleteApp:a1,getApp:QS,getApps:XS,initializeApp:o1,initializeServerApp:JS,onLog:D5,registerVersion:as,setLogLevel:O5},Symbol.toStringTag,{value:"Module"}));class l4{constructor(e,t){this._delegate=e,this.firebase=t,_h(e,new zs("app-compat",()=>this,"PUBLIC")),this.container=e.container}get automaticDataCollectionEnabled(){return this._delegate.automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this._delegate.automaticDataCollectionEnabled=e}get name(){return this._delegate.name}get options(){return this._delegate.options}delete(){return new Promise(e=>{this._delegate.checkDestroyed(),e()}).then(()=>(this.firebase.INTERNAL.removeApp(this.name),a1(this._delegate)))}_getService(e,t=ma){this._delegate.checkDestroyed();const r=this._delegate.container.getProvider(e);return!r.isInitialized()&&r.getComponent()?.instantiationMode==="EXPLICIT"&&r.initialize(),r.getImmediate({identifier:t})}_removeServiceInstance(e,t=ma){this._delegate.container.getProvider(e).clearInstance(t)}_addComponent(e){_h(this._delegate,e)}_addOrOverwriteComponent(e){N5(this._delegate,e)}toJSON(){return{name:this.name,automaticDataCollectionEnabled:this.automaticDataCollectionEnabled,options:this.options}}}const h4={"no-app":"No Firebase App '{$appName}' has been created - call Firebase App.initializeApp()","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance."},qy=new Nc("app-compat","Firebase",h4);function d4(n){const e={},t={__esModule:!0,initializeApp:s,app:i,registerVersion:as,setLogLevel:O5,onLog:D5,apps:null,SDK_VERSION:Pa,INTERNAL:{registerComponent:a,removeApp:r,useAsService:c,modularAPIs:u4}};t.default=t,Object.defineProperty(t,"apps",{get:o});function r(u){delete e[u]}function i(u){if(u=u||ma,!Ly(e,u))throw qy.create("no-app",{appName:u});return e[u]}i.App=n;function s(u,d={}){const g=o1(u,d);if(Ly(e,g.name))return e[g.name];const y=new n(g,t);return e[g.name]=y,y}function o(){return Object.keys(e).map(u=>e[u])}function a(u){const d=u.name,g=d.replace("-compat","");if(_a(u)&&u.type==="PUBLIC"){const y=(p=i())=>{if(typeof p[g]!="function")throw qy.create("invalid-app-argument",{appName:d});return p[g]()};u.serviceProps!==void 0&&_f(y,u.serviceProps),t[g]=y,n.prototype[g]=function(...p){return this._getService.bind(this,d).apply(this,u.multipleInstances?p:[])}}return u.type==="PUBLIC"?t[g]:null}function c(u,d){return d==="serverAuth"?null:d}return t}function V5(){const n=d4(l4);n.INTERNAL={...n.INTERNAL,createFirebaseNamespace:V5,extendNamespace:e,createSubscribe:T5,ErrorFactory:Nc,deepExtend:_f};function e(t){_f(n,t)}return n}const f4=V5();const zy=new Qf("@firebase/app-compat"),p4="@firebase/app-compat",g4="0.5.7";function m4(n){as(p4,g4,n)}try{const n=Zm();if(n.firebase!==void 0){zy.warn(`
      Warning: Firebase is already defined in the global scope. Please make sure
      Firebase library is only loaded once.
    `);const e=n.firebase.SDK_VERSION;e&&e.indexOf("LITE")>=0&&zy.warn(`
        Warning: You are trying to load Firebase while using Firebase Performance standalone script.
        You should load Firebase Performance with this instance of Firebase to avoid loading duplicate code.
        `)}}catch{}const $s=f4;m4();var y4="firebase",_4="12.8.0";$s.registerVersion(y4,_4,"app-compat");const Cl={FACEBOOK:"facebook.com",GITHUB:"github.com",GOOGLE:"google.com",PASSWORD:"password",TWITTER:"twitter.com"},Qc={EMAIL_SIGNIN:"EMAIL_SIGNIN",PASSWORD_RESET:"PASSWORD_RESET",RECOVER_EMAIL:"RECOVER_EMAIL",REVERT_SECOND_FACTOR_ADDITION:"REVERT_SECOND_FACTOR_ADDITION",VERIFY_AND_CHANGE_EMAIL:"VERIFY_AND_CHANGE_EMAIL",VERIFY_EMAIL:"VERIFY_EMAIL"};function v4(){return{"admin-restricted-operation":"This operation is restricted to administrators only.","argument-error":"","app-not-authorized":"This app, identified by the domain where it's hosted, is not authorized to use Firebase Authentication with the provided API key. Review your key configuration in the Google API console.","app-not-installed":"The requested mobile application corresponding to the identifier (Android package name or iOS bundle ID) provided is not installed on this device.","captcha-check-failed":"The reCAPTCHA response token provided is either invalid, expired, already used or the domain associated with it does not match the list of whitelisted domains.","code-expired":"The SMS code has expired. Please re-send the verification code to try again.","cordova-not-ready":"Cordova framework is not ready.","cors-unsupported":"This browser is not supported.","credential-already-in-use":"This credential is already associated with a different user account.","custom-token-mismatch":"The custom token corresponds to a different audience.","requires-recent-login":"This operation is sensitive and requires recent authentication. Log in again before retrying this request.","dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK.","dynamic-link-not-activated":"Please activate Dynamic Links in the Firebase Console and agree to the terms and conditions.","email-change-needs-verification":"Multi-factor users must always have a verified email.","email-already-in-use":"The email address is already in use by another account.","emulator-config-failed":'Auth instance has already been used to make a network call. Auth can no longer be configured to use the emulator. Try calling "connectAuthEmulator()" sooner.',"expired-action-code":"The action code has expired.","cancelled-popup-request":"This operation has been cancelled due to another conflicting popup being opened.","internal-error":"An internal AuthError has occurred.","invalid-app-credential":"The phone verification request contains an invalid application verifier. The reCAPTCHA token response is either invalid or expired.","invalid-app-id":"The mobile app identifier is not registered for the current project.","invalid-user-token":"This user's credential isn't valid for this project. This can happen if the user's token has been tampered with, or if the user isn't for the project associated with this API key.","invalid-auth-event":"An internal AuthError has occurred.","invalid-verification-code":"The SMS verification code used to create the phone auth credential is invalid. Please resend the verification code sms and be sure to use the verification code provided by the user.","invalid-continue-uri":"The continue URL provided in the request is invalid.","invalid-cordova-configuration":"The following Cordova plugins must be installed to enable OAuth sign-in: cordova-plugin-buildinfo, cordova-universal-links-plugin, cordova-plugin-browsertab, cordova-plugin-inappbrowser and cordova-plugin-customurlscheme.","invalid-custom-token":"The custom token format is incorrect. Please check the documentation.","invalid-dynamic-link-domain":"The provided dynamic link domain is not configured or authorized for the current project.","invalid-email":"The email address is badly formatted.","invalid-emulator-scheme":"Emulator URL must start with a valid scheme (http:// or https://).","invalid-api-key":"Your API key is invalid, please check you have copied it correctly.","invalid-cert-hash":"The SHA-1 certificate hash provided is invalid.","invalid-credential":"The supplied auth credential is incorrect, malformed or has expired.","invalid-message-payload":"The email template corresponding to this action contains invalid characters in its message. Please fix by going to the Auth email templates section in the Firebase Console.","invalid-multi-factor-session":"The request does not contain a valid proof of first factor successful sign-in.","invalid-oauth-provider":"EmailAuthProvider is not supported for this operation. This operation only supports OAuth providers.","invalid-oauth-client-id":"The OAuth client ID provided is either invalid or does not match the specified API key.","unauthorized-domain":"This domain is not authorized for OAuth operations for your Firebase project. Edit the list of authorized domains from the Firebase console.","invalid-action-code":"The action code is invalid. This can happen if the code is malformed, expired, or has already been used.","wrong-password":"The password is invalid or the user does not have a password.","invalid-persistence-type":"The specified persistence type is invalid. It can only be local, session or none.","invalid-phone-number":"The format of the phone number provided is incorrect. Please enter the phone number in a format that can be parsed into E.164 format. E.164 phone numbers are written in the format [+][country code][subscriber number including area code].","invalid-provider-id":"The specified provider ID is invalid.","invalid-recipient-email":"The email corresponding to this action failed to send as the provided recipient email address is invalid.","invalid-sender":"The email template corresponding to this action contains an invalid sender email or name. Please fix by going to the Auth email templates section in the Firebase Console.","invalid-verification-id":"The verification ID used to create the phone auth credential is invalid.","invalid-tenant-id":"The Auth instance's tenant ID is invalid.","login-blocked":"Login blocked by user-provided method: {$originalMessage}","missing-android-pkg-name":"An Android Package Name must be provided if the Android App is required to be installed.","auth-domain-config-required":"Be sure to include authDomain when calling firebase.initializeApp(), by following the instructions in the Firebase console.","missing-app-credential":"The phone verification request is missing an application verifier assertion. A reCAPTCHA response token needs to be provided.","missing-verification-code":"The phone auth credential was created with an empty SMS verification code.","missing-continue-uri":"A continue URL must be provided in the request.","missing-iframe-start":"An internal AuthError has occurred.","missing-ios-bundle-id":"An iOS Bundle ID must be provided if an App Store ID is provided.","missing-or-invalid-nonce":"The request does not contain a valid nonce. This can occur if the SHA-256 hash of the provided raw nonce does not match the hashed nonce in the ID token payload.","missing-password":"A non-empty password must be provided","missing-multi-factor-info":"No second factor identifier is provided.","missing-multi-factor-session":"The request is missing proof of first factor successful sign-in.","missing-phone-number":"To send verification codes, provide a phone number for the recipient.","missing-verification-id":"The phone auth credential was created with an empty verification ID.","app-deleted":"This instance of FirebaseApp has been deleted.","multi-factor-info-not-found":"The user does not have a second factor matching the identifier provided.","multi-factor-auth-required":"Proof of ownership of a second factor is required to complete sign-in.","account-exists-with-different-credential":"An account already exists with the same email address but different sign-in credentials. Sign in using a provider associated with this email address.","network-request-failed":"A network AuthError (such as timeout, interrupted connection or unreachable host) has occurred.","no-auth-event":"An internal AuthError has occurred.","no-such-provider":"User was not linked to an account with the given provider.","null-user":"A null user object was provided as the argument for an operation which requires a non-null user object.","operation-not-allowed":"The given sign-in provider is disabled for this Firebase project. Enable it in the Firebase console, under the sign-in method tab of the Auth section.","operation-not-supported-in-this-environment":'This operation is not supported in the environment this application is running on. "location.protocol" must be http, https or chrome-extension and web storage must be enabled.',"popup-blocked":"Unable to establish a connection with the popup. It may have been blocked by the browser.","popup-closed-by-user":"The popup has been closed by the user before finalizing the operation.","provider-already-linked":"User can only be linked to one identity for the given provider.","quota-exceeded":"The project's quota for this operation has been exceeded.","redirect-cancelled-by-user":"The redirect operation has been cancelled by the user before finalizing.","redirect-operation-pending":"A redirect sign-in operation is already pending.","rejected-credential":"The request contains malformed or mismatching credentials.","second-factor-already-in-use":"The second factor is already enrolled on this account.","maximum-second-factor-count-exceeded":"The maximum allowed number of second factors on a user has been exceeded.","tenant-id-mismatch":"The provided tenant ID does not match the Auth instance's tenant ID",timeout:"The operation has timed out.","user-token-expired":"The user's credential is no longer valid. The user must sign in again.","too-many-requests":"We have blocked all requests from this device due to unusual activity. Try again later.","unauthorized-continue-uri":"The domain of the continue URL is not whitelisted.  Please whitelist the domain in the Firebase console.","unsupported-first-factor":"Enrolling a second factor or signing in with a multi-factor account requires sign-in with a supported first factor.","unsupported-persistence-type":"The current environment does not support the specified persistence type.","unsupported-tenant-operation":"This operation is not supported in a multi-tenant context.","unverified-email":"The operation requires a verified email.","user-cancelled":"The user did not grant your application the permissions it requested.","user-not-found":"There is no user record corresponding to this identifier. The user may have been deleted.","user-disabled":"The user account has been disabled by an administrator.","user-mismatch":"The supplied credentials do not correspond to the previously signed in user.","user-signed-out":"","weak-password":"The password must be 6 characters long or more.","web-storage-unsupported":"This browser is not supported or 3rd party cookies and data may be disabled.","already-initialized":"initializeAuth() has already been called with different options. To avoid this error, call initializeAuth() with the same options as when it was originally called, or call getAuth() to return the already initialized instance.","missing-recaptcha-token":"The reCAPTCHA token is missing when sending request to the backend.","invalid-recaptcha-token":"The reCAPTCHA token is invalid when sending request to the backend.","invalid-recaptcha-action":"The reCAPTCHA action is invalid when sending request to the backend.","recaptcha-not-enabled":"reCAPTCHA Enterprise integration is not enabled for this project.","missing-client-type":"The reCAPTCHA client type is missing when sending request to the backend.","missing-recaptcha-version":"The reCAPTCHA version is missing when sending request to the backend.","invalid-req-type":"Invalid request parameters.","invalid-recaptcha-version":"The reCAPTCHA version is invalid when sending request to the backend.","unsupported-password-policy-schema-version":"The password policy received from the backend uses a schema version that is not supported by this version of the Firebase SDK.","password-does-not-meet-requirements":"The password does not meet the requirements.","invalid-hosting-link-domain":"The provided Hosting link domain is not configured in Firebase Hosting or is not owned by the current project. This cannot be a default Hosting domain (`web.app` or `firebaseapp.com`)."}}function B5(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}const w4=v4,b4=B5,U5=new Nc("auth","Firebase",B5());const wf=new Qf("@firebase/auth");function I4(n,...e){wf.logLevel<=Dt.WARN&&wf.warn(`Auth (${Pa}): ${n}`,...e)}function Gd(n,...e){wf.logLevel<=Dt.ERROR&&wf.error(`Auth (${Pa}): ${n}`,...e)}function vr(n,...e){throw u1(n,...e)}function nr(n,...e){return u1(n,...e)}function c1(n,e,t){const r={...b4(),[e]:t};return new Nc("auth","Firebase",r).create(e,{appName:n.name})}function hr(n){return c1(n,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function el(n,e,t){const r=t;if(!(e instanceof r))throw r.name!==e.constructor.name&&vr(n,"argument-error"),c1(n,"argument-error",`Type of ${e.constructor.name} does not match expected instance.Did you pass a reference from a different Auth SDK?`)}function u1(n,...e){if(typeof n!="string"){const t=e[0],r=[...e.slice(1)];return r[0]&&(r[0].appName=n.name),n._errorFactory.create(t,...r)}return U5.create(n,...e)}function Ce(n,e,...t){if(!n)throw u1(e,...t)}function Fs(n){const e="INTERNAL ASSERTION FAILED: "+n;throw Gd(e),new Error(e)}function hs(n,e){n||Fs(e)}function wh(){return typeof self<"u"&&self.location?.href||""}function l1(){return $y()==="http:"||$y()==="https:"}function $y(){return typeof self<"u"&&self.location?.protocol||null}function A4(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(l1()||b5()||"connection"in navigator)?navigator.onLine:!0}function E4(){if(typeof navigator>"u")return null;const n=navigator;return n.languages&&n.languages[0]||n.language||null}class qh{constructor(e,t){this.shortDelay=e,this.longDelay=t,hs(t>e,"Short delay should be less than long delay!"),this.isMobile=jT()||n1()}get(){return A4()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}function h1(n,e){hs(n.emulator,"Emulator should always be set here");const{url:t}=n.emulator;return e?`${t}${e.startsWith("/")?e.slice(1):e}`:t}class j5{static initialize(e,t,r){this.fetchImpl=e,t&&(this.headersImpl=t),r&&(this.responseImpl=r)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;if(typeof globalThis<"u"&&globalThis.fetch)return globalThis.fetch;if(typeof fetch<"u")return fetch;Fs("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;if(typeof globalThis<"u"&&globalThis.Headers)return globalThis.Headers;if(typeof Headers<"u")return Headers;Fs("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;if(typeof globalThis<"u"&&globalThis.Response)return globalThis.Response;if(typeof Response<"u")return Response;Fs("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}const T4={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};const S4=["/v1/accounts:signInWithCustomToken","/v1/accounts:signInWithEmailLink","/v1/accounts:signInWithIdp","/v1/accounts:signInWithPassword","/v1/accounts:signInWithPhoneNumber","/v1/token"],P4=new qh(3e4,6e4);function Fn(n,e){return n.tenantId&&!e.tenantId?{...e,tenantId:n.tenantId}:e}async function Mn(n,e,t,r,i={}){return q5(n,i,async()=>{let s={},o={};r&&(e==="GET"?o=r:s={body:JSON.stringify(r)});const a=Zu({key:n.config.apiKey,...o}).slice(1),c=await n._getAdditionalHeaders();c["Content-Type"]="application/json",n.languageCode&&(c["X-Firebase-Locale"]=n.languageCode);const u={method:e,headers:c,...s};return zT()||(u.referrerPolicy="no-referrer"),n.emulatorConfig&&Xu(n.emulatorConfig.host)&&(u.credentials="include"),j5.fetch()(await z5(n,n.config.apiHost,t,a),u)})}async function q5(n,e,t){n._canInitEmulator=!1;const r={...T4,...e};try{const i=new R4(n),s=await Promise.race([t(),i.promise]);i.clearNetworkTimeout();const o=await s.json();if("needConfirmation"in o)throw Hl(n,"account-exists-with-different-credential",o);if(s.ok&&!("errorMessage"in o))return o;{const a=s.ok?o.errorMessage:o.error.message,[c,u]=a.split(" : ");if(c==="FEDERATED_USER_ID_ALREADY_LINKED")throw Hl(n,"credential-already-in-use",o);if(c==="EMAIL_EXISTS")throw Hl(n,"email-already-in-use",o);if(c==="USER_DISABLED")throw Hl(n,"user-disabled",o);const d=r[c]||c.toLowerCase().replace(/[_\s]+/g,"-");if(u)throw c1(n,d,u);vr(n,d)}}catch(i){if(i instanceof Gr)throw i;vr(n,"network-request-failed",{message:String(i)})}}async function Ao(n,e,t,r,i={}){const s=await Mn(n,e,t,r,i);return"mfaPendingCredential"in s&&vr(n,"multi-factor-auth-required",{_serverResponse:s}),s}async function z5(n,e,t,r){const i=`${e}${t}?${r}`,s=n,o=s.config.emulator?h1(n.config,i):`${n.config.apiScheme}://${i}`;return S4.includes(t)&&(await s._persistenceManagerAvailable,s._getPersistenceType()==="COOKIE")?s._getPersistence()._getFinalTarget(o).toString():o}function x4(n){switch(n){case"ENFORCE":return"ENFORCE";case"AUDIT":return"AUDIT";case"OFF":return"OFF";default:return"ENFORCEMENT_STATE_UNSPECIFIED"}}class R4{clearNetworkTimeout(){clearTimeout(this.timer)}constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((t,r)=>{this.timer=setTimeout(()=>r(nr(this.auth,"network-request-failed")),P4.get())})}}function Hl(n,e,t){const r={appName:n.name};t.email&&(r.email=t.email),t.phoneNumber&&(r.phoneNumber=t.phoneNumber);const i=nr(n,e,r);return i.customData._tokenResponse=t,i}function Wy(n){return n!==void 0&&n.getResponse!==void 0}function Hy(n){return n!==void 0&&n.enterprise!==void 0}class $5{constructor(e){if(this.siteKey="",this.recaptchaEnforcementState=[],e.recaptchaKey===void 0)throw new Error("recaptchaKey undefined");this.siteKey=e.recaptchaKey.split("/")[3],this.recaptchaEnforcementState=e.recaptchaEnforcementState}getProviderEnforcementState(e){if(!this.recaptchaEnforcementState||this.recaptchaEnforcementState.length===0)return null;for(const t of this.recaptchaEnforcementState)if(t.provider&&t.provider===e)return x4(t.enforcementState);return null}isProviderEnabled(e){return this.getProviderEnforcementState(e)==="ENFORCE"||this.getProviderEnforcementState(e)==="AUDIT"}isAnyProviderEnabled(){return this.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")||this.isProviderEnabled("PHONE_PROVIDER")}}async function N4(n){return(await Mn(n,"GET","/v1/recaptchaParams")).recaptchaSiteKey||""}async function W5(n,e){return Mn(n,"GET","/v2/recaptchaConfig",Fn(n,e))}async function k4(n,e){return Mn(n,"POST","/v1/accounts:delete",e)}async function C4(n,e){return Mn(n,"POST","/v1/accounts:update",e)}async function bf(n,e){return Mn(n,"POST","/v1/accounts:lookup",e)}function eh(n){if(n)try{const e=new Date(Number(n));if(!isNaN(e.getTime()))return e.toUTCString()}catch{}}async function L4(n,e=!1){const t=ft(n),r=await t.getIdToken(e),i=Xf(r);Ce(i&&i.exp&&i.auth_time&&i.iat,t.auth,"internal-error");const s=typeof i.firebase=="object"?i.firebase:void 0,o=s?.sign_in_provider;return{claims:i,token:r,authTime:eh(cg(i.auth_time)),issuedAtTime:eh(cg(i.iat)),expirationTime:eh(cg(i.exp)),signInProvider:o||null,signInSecondFactor:s?.sign_in_second_factor||null}}function cg(n){return Number(n)*1e3}function Xf(n){const[e,t,r]=n.split(".");if(e===void 0||t===void 0||r===void 0)return Gd("JWT malformed, contained fewer than 3 sections"),null;try{const i=Xm(t);return i?JSON.parse(i):(Gd("Failed to decode base64 JWT payload"),null)}catch(i){return Gd("Caught error parsing JWT payload as JSON",i?.toString()),null}}function Gy(n){const e=Xf(n);return Ce(e,"internal-error"),Ce(typeof e.exp<"u","internal-error"),Ce(typeof e.iat<"u","internal-error"),Number(e.exp)-Number(e.iat)}async function vo(n,e,t=!1){if(t)return e;try{return await e}catch(r){throw r instanceof Gr&&D4(r)&&n.auth.currentUser===n&&await n.auth.signOut(),r}}function D4({code:n}){return n==="auth/user-disabled"||n==="auth/user-token-expired"}class O4{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(e){if(e){const t=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),t}else{this.errorBackoff=3e4;const r=(this.user.stsTokenManager.expirationTime??0)-Date.now()-3e5;return Math.max(0,r)}}schedule(e=!1){if(!this.isRunning)return;const t=this.getInterval(e);this.timerId=setTimeout(async()=>{await this.iteration()},t)}async iteration(){try{await this.user.getIdToken(!0)}catch(e){e?.code==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()}}class Xg{constructor(e,t){this.createdAt=e,this.lastLoginAt=t,this._initializeTime()}_initializeTime(){this.lastSignInTime=eh(this.lastLoginAt),this.creationTime=eh(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}async function bh(n){const e=n.auth,t=await n.getIdToken(),r=await vo(n,bf(e,{idToken:t}));Ce(r?.users.length,e,"internal-error");const i=r.users[0];n._notifyReloadListener(i);const s=i.providerUserInfo?.length?H5(i.providerUserInfo):[],o=M4(n.providerData,s),a=n.isAnonymous,c=!(n.email&&i.passwordHash)&&!o?.length,u=a?c:!1,d={uid:i.localId,displayName:i.displayName||null,photoURL:i.photoUrl||null,email:i.email||null,emailVerified:i.emailVerified||!1,phoneNumber:i.phoneNumber||null,tenantId:i.tenantId||null,providerData:o,metadata:new Xg(i.createdAt,i.lastLoginAt),isAnonymous:u};Object.assign(n,d)}async function F4(n){const e=ft(n);await bh(e),await e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)}function M4(n,e){return[...n.filter(r=>!e.some(i=>i.providerId===r.providerId)),...e]}function H5(n){return n.map(({providerId:e,...t})=>({providerId:e,uid:t.rawId||"",displayName:t.displayName||null,email:t.email||null,phoneNumber:t.phoneNumber||null,photoURL:t.photoUrl||null}))}async function V4(n,e){const t=await q5(n,{},async()=>{const r=Zu({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:i,apiKey:s}=n.config,o=await z5(n,i,"/v1/token",`key=${s}`),a=await n._getAdditionalHeaders();a["Content-Type"]="application/x-www-form-urlencoded";const c={method:"POST",headers:a,body:r};return n.emulatorConfig&&Xu(n.emulatorConfig.host)&&(c.credentials="include"),j5.fetch()(o,c)});return{accessToken:t.access_token,expiresIn:t.expires_in,refreshToken:t.refresh_token}}async function B4(n,e){return Mn(n,"POST","/v2/accounts:revokeToken",Fn(n,e))}class yu{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){Ce(e.idToken,"internal-error"),Ce(typeof e.idToken<"u","internal-error"),Ce(typeof e.refreshToken<"u","internal-error");const t="expiresIn"in e&&typeof e.expiresIn<"u"?Number(e.expiresIn):Gy(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,t)}updateFromIdToken(e){Ce(e.length!==0,"internal-error");const t=Gy(e);this.updateTokensAndExpiration(e,null,t)}async getToken(e,t=!1){return!t&&this.accessToken&&!this.isExpired?this.accessToken:(Ce(this.refreshToken,e,"user-token-expired"),this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null)}clearRefreshToken(){this.refreshToken=null}async refresh(e,t){const{accessToken:r,refreshToken:i,expiresIn:s}=await V4(e,t);this.updateTokensAndExpiration(r,i,Number(s))}updateTokensAndExpiration(e,t,r){this.refreshToken=t||null,this.accessToken=e||null,this.expirationTime=Date.now()+r*1e3}static fromJSON(e,t){const{refreshToken:r,accessToken:i,expirationTime:s}=t,o=new yu;return r&&(Ce(typeof r=="string","internal-error",{appName:e}),o.refreshToken=r),i&&(Ce(typeof i=="string","internal-error",{appName:e}),o.accessToken=i),s&&(Ce(typeof s=="number","internal-error",{appName:e}),o.expirationTime=s),o}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new yu,this.toJSON())}_performRefresh(){return Fs("not implemented")}}function Qo(n,e){Ce(typeof n=="string"||typeof n>"u","internal-error",{appName:e})}class ss{constructor({uid:e,auth:t,stsTokenManager:r,...i}){this.providerId="firebase",this.proactiveRefresh=new O4(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=e,this.auth=t,this.stsTokenManager=r,this.accessToken=r.accessToken,this.displayName=i.displayName||null,this.email=i.email||null,this.emailVerified=i.emailVerified||!1,this.phoneNumber=i.phoneNumber||null,this.photoURL=i.photoURL||null,this.isAnonymous=i.isAnonymous||!1,this.tenantId=i.tenantId||null,this.providerData=i.providerData?[...i.providerData]:[],this.metadata=new Xg(i.createdAt||void 0,i.lastLoginAt||void 0)}async getIdToken(e){const t=await vo(this,this.stsTokenManager.getToken(this.auth,e));return Ce(t,this.auth,"internal-error"),this.accessToken!==t&&(this.accessToken=t,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),t}getIdTokenResult(e){return L4(this,e)}reload(){return F4(this)}_assign(e){this!==e&&(Ce(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(t=>({...t})),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){const t=new ss({...this,auth:e,stsTokenManager:this.stsTokenManager._clone()});return t.metadata._copy(this.metadata),t}_onReload(e){Ce(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e,t=!1){let r=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),r=!0),t&&await bh(this),await this.auth._persistUserIfCurrent(this),r&&this.auth._notifyListenersIfCurrent(this)}async delete(){if(Pn(this.auth.app))return Promise.reject(hr(this.auth));const e=await this.getIdToken();return await vo(this,k4(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return{uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>({...e})),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId,...this.metadata.toJSON(),apiKey:this.auth.config.apiKey,appName:this.auth.name}}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,t){const r=t.displayName??void 0,i=t.email??void 0,s=t.phoneNumber??void 0,o=t.photoURL??void 0,a=t.tenantId??void 0,c=t._redirectEventId??void 0,u=t.createdAt??void 0,d=t.lastLoginAt??void 0,{uid:g,emailVerified:y,isAnonymous:p,providerData:S,stsTokenManager:N}=t;Ce(g&&N,e,"internal-error");const C=yu.fromJSON(this.name,N);Ce(typeof g=="string",e,"internal-error"),Qo(r,e.name),Qo(i,e.name),Ce(typeof y=="boolean",e,"internal-error"),Ce(typeof p=="boolean",e,"internal-error"),Qo(s,e.name),Qo(o,e.name),Qo(a,e.name),Qo(c,e.name),Qo(u,e.name),Qo(d,e.name);const k=new ss({uid:g,auth:e,email:i,emailVerified:y,displayName:r,isAnonymous:p,photoURL:o,phoneNumber:s,tenantId:a,stsTokenManager:C,createdAt:u,lastLoginAt:d});return S&&Array.isArray(S)&&(k.providerData=S.map(K=>({...K}))),c&&(k._redirectEventId=c),k}static async _fromIdTokenResponse(e,t,r=!1){const i=new yu;i.updateFromServerResponse(t);const s=new ss({uid:t.localId,auth:e,stsTokenManager:i,isAnonymous:r});return await bh(s),s}static async _fromGetAccountInfoResponse(e,t,r){const i=t.users[0];Ce(i.localId!==void 0,"internal-error");const s=i.providerUserInfo!==void 0?H5(i.providerUserInfo):[],o=!(i.email&&i.passwordHash)&&!s?.length,a=new yu;a.updateFromIdToken(r);const c=new ss({uid:i.localId,auth:e,stsTokenManager:a,isAnonymous:o}),u={uid:i.localId,displayName:i.displayName||null,photoURL:i.photoUrl||null,email:i.email||null,emailVerified:i.emailVerified||!1,phoneNumber:i.phoneNumber||null,tenantId:i.tenantId||null,providerData:s,metadata:new Xg(i.createdAt,i.lastLoginAt),isAnonymous:!(i.email&&i.passwordHash)&&!s?.length};return Object.assign(c,u),c}}const Ky=new Map;function Si(n){hs(n instanceof Function,"Expected a class definition");let e=Ky.get(n);return e?(hs(e instanceof n,"Instance stored in cache mismatched with class"),e):(e=new n,Ky.set(n,e),e)}class G5{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,t){this.storage[e]=t}async _get(e){const t=this.storage[e];return t===void 0?null:t}async _remove(e){delete this.storage[e]}_addListener(e,t){}_removeListener(e,t){}}G5.type="NONE";const ku=G5;function uc(n,e,t){return`firebase:${n}:${e}:${t}`}class _u{constructor(e,t,r){this.persistence=e,this.auth=t,this.userKey=r;const{config:i,name:s}=this.auth;this.fullUserKey=uc(this.userKey,i.apiKey,s),this.fullPersistenceKey=uc("persistence",i.apiKey,s),this.boundEventHandler=t._onStorageEvent.bind(t),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){const e=await this.persistence._get(this.fullUserKey);if(!e)return null;if(typeof e=="string"){const t=await bf(this.auth,{idToken:e}).catch(()=>{});return t?ss._fromGetAccountInfoResponse(this.auth,t,e):null}return ss._fromJSON(this.auth,e)}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;const t=await this.getCurrentUser();if(await this.removeCurrentUser(),this.persistence=e,t)return this.setCurrentUser(t)}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,t,r="authUser"){if(!t.length)return new _u(Si(ku),e,r);const i=(await Promise.all(t.map(async u=>{if(await u._isAvailable())return u}))).filter(u=>u);let s=i[0]||Si(ku);const o=uc(r,e.config.apiKey,e.name);let a=null;for(const u of t)try{const d=await u._get(o);if(d){let g;if(typeof d=="string"){const y=await bf(e,{idToken:d}).catch(()=>{});if(!y)break;g=await ss._fromGetAccountInfoResponse(e,y,d)}else g=ss._fromJSON(e,d);u!==s&&(a=g),s=u;break}}catch{}const c=i.filter(u=>u._shouldAllowMigration);return!s._shouldAllowMigration||!c.length?new _u(s,e,r):(s=c[0],a&&await s._set(o,a.toJSON()),await Promise.all(t.map(async u=>{if(u!==s)try{await u._remove(o)}catch{}})),new _u(s,e,r))}}function Yy(n){const e=n.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(Q5(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(K5(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(X5(e))return"Blackberry";if(Z5(e))return"Webos";if(Y5(e))return"Safari";if((e.includes("chrome/")||J5(e))&&!e.includes("edge/"))return"Chrome";if(zh(e))return"Android";{const t=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,r=n.match(t);if(r?.length===2)return r[1]}return"Other"}function K5(n=Nn()){return/firefox\//i.test(n)}function Y5(n=Nn()){const e=n.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function J5(n=Nn()){return/crios\//i.test(n)}function Q5(n=Nn()){return/iemobile/i.test(n)}function zh(n=Nn()){return/android/i.test(n)}function X5(n=Nn()){return/blackberry/i.test(n)}function Z5(n=Nn()){return/webos/i.test(n)}function $h(n=Nn()){return/iphone|ipad|ipod/i.test(n)||/macintosh/i.test(n)&&/mobile/i.test(n)}function U4(n=Nn()){return/(iPad|iPhone|iPod).*OS 7_\d/i.test(n)||/(iPad|iPhone|iPod).*OS 8_\d/i.test(n)}function j4(n=Nn()){return $h(n)&&!!window.navigator?.standalone}function q4(){return I5()&&document.documentMode===10}function ew(n=Nn()){return $h(n)||zh(n)||Z5(n)||X5(n)||/windows phone/i.test(n)||Q5(n)}function tw(n,e=[]){let t;switch(n){case"Browser":t=Yy(Nn());break;case"Worker":t=`${Yy(Nn())}-${n}`;break;default:t=n}const r=e.length?e.join(","):"FirebaseCore-web";return`${t}/JsCore/${Pa}/${r}`}class z4{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,t){const r=s=>new Promise((o,a)=>{try{const c=e(s);o(c)}catch(c){a(c)}});r.onAbort=t,this.queue.push(r);const i=this.queue.length-1;return()=>{this.queue[i]=()=>Promise.resolve()}}async runMiddleware(e){if(this.auth.currentUser===e)return;const t=[];try{for(const r of this.queue)await r(e),r.onAbort&&t.push(r.onAbort)}catch(r){t.reverse();for(const i of t)try{i()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:r?.message})}}}async function $4(n,e={}){return Mn(n,"GET","/v2/passwordPolicy",Fn(n,e))}const W4=6;class H4{constructor(e){const t=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=t.minPasswordLength??W4,t.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=t.maxPasswordLength),t.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=t.containsLowercaseCharacter),t.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=t.containsUppercaseCharacter),t.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=t.containsNumericCharacter),t.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=t.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=e.allowedNonAlphanumericCharacters?.join("")??"",this.forceUpgradeOnSignin=e.forceUpgradeOnSignin??!1,this.schemaVersion=e.schemaVersion}validatePassword(e){const t={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,t),this.validatePasswordCharacterOptions(e,t),t.isValid&&(t.isValid=t.meetsMinPasswordLength??!0),t.isValid&&(t.isValid=t.meetsMaxPasswordLength??!0),t.isValid&&(t.isValid=t.containsLowercaseLetter??!0),t.isValid&&(t.isValid=t.containsUppercaseLetter??!0),t.isValid&&(t.isValid=t.containsNumericCharacter??!0),t.isValid&&(t.isValid=t.containsNonAlphanumericCharacter??!0),t}validatePasswordLengthOptions(e,t){const r=this.customStrengthOptions.minPasswordLength,i=this.customStrengthOptions.maxPasswordLength;r&&(t.meetsMinPasswordLength=e.length>=r),i&&(t.meetsMaxPasswordLength=e.length<=i)}validatePasswordCharacterOptions(e,t){this.updatePasswordCharacterOptionsStatuses(t,!1,!1,!1,!1);let r;for(let i=0;i<e.length;i++)r=e.charAt(i),this.updatePasswordCharacterOptionsStatuses(t,r>="a"&&r<="z",r>="A"&&r<="Z",r>="0"&&r<="9",this.allowedNonAlphanumericCharacters.includes(r))}updatePasswordCharacterOptionsStatuses(e,t,r,i,s){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=t)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=r)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=i)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=s))}}class G4{constructor(e,t,r,i){this.app=e,this.heartbeatServiceProvider=t,this.appCheckServiceProvider=r,this.config=i,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new Jy(this),this.idTokenSubscription=new Jy(this),this.beforeStateQueue=new z4(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=U5,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this._resolvePersistenceManagerAvailable=void 0,this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=i.sdkClientVersion,this._persistenceManagerAvailable=new Promise(s=>this._resolvePersistenceManagerAvailable=s)}_initializeWithPersistence(e,t){return t&&(this._popupRedirectResolver=Si(t)),this._initializationPromise=this.queue(async()=>{if(!this._deleted&&(this.persistenceManager=await _u.create(this,e),this._resolvePersistenceManagerAvailable?.(),!this._deleted)){if(this._popupRedirectResolver?._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch{}await this.initializeCurrentUser(t),this.lastNotifiedUid=this.currentUser?.uid||null,!this._deleted&&(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const e=await this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!e)){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),await this.currentUser.getIdToken();return}await this._updateCurrentUser(e,!0)}}async initializeCurrentUserFromIdToken(e){try{const t=await bf(this,{idToken:e}),r=await ss._fromGetAccountInfoResponse(this,t,e);await this.directlySetCurrentUser(r)}catch(t){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",t),await this.directlySetCurrentUser(null)}}async initializeCurrentUser(e){if(Pn(this.app)){const s=this.app.settings.authIdToken;return s?new Promise(o=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(s).then(o,o))}):this.directlySetCurrentUser(null)}const t=await this.assertedPersistence.getCurrentUser();let r=t,i=!1;if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const s=this.redirectUser?._redirectEventId,o=r?._redirectEventId,a=await this.tryRedirectSignIn(e);(!s||s===o)&&a?.user&&(r=a.user,i=!0)}if(!r)return this.directlySetCurrentUser(null);if(!r._redirectEventId){if(i)try{await this.beforeStateQueue.runMiddleware(r)}catch(s){r=t,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(s))}return r?this.reloadAndSetCurrentUserOrClear(r):this.directlySetCurrentUser(null)}return Ce(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===r._redirectEventId?this.directlySetCurrentUser(r):this.reloadAndSetCurrentUserOrClear(r)}async tryRedirectSignIn(e){let t=null;try{t=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch{await this._setRedirectUser(null)}return t}async reloadAndSetCurrentUserOrClear(e){try{await bh(e)}catch(t){if(t?.code!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=E4()}async _delete(){this._deleted=!0}async updateCurrentUser(e){if(Pn(this.app))return Promise.reject(hr(this));const t=e?ft(e):null;return t&&Ce(t.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(t&&t._clone(this))}async _updateCurrentUser(e,t=!1){if(!this._deleted)return e&&Ce(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),t||await this.beforeStateQueue.runMiddleware(e),this.queue(async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()})}async signOut(){return Pn(this.app)?Promise.reject(hr(this)):(await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0))}setPersistence(e){return Pn(this.app)?Promise.reject(hr(this)):this.queue(async()=>{await this.assertedPersistence.setPersistence(Si(e))})}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(e){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();const t=this._getPasswordPolicyInternal();return t.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):t.validatePassword(e)}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){const e=await $4(this),t=new H4(e);this.tenantId===null?this._projectPasswordPolicy=t:this._tenantPasswordPolicies[this.tenantId]=t}_getPersistenceType(){return this.assertedPersistence.persistence.type}_getPersistence(){return this.assertedPersistence.persistence}_updateErrorMap(e){this._errorFactory=new Nc("auth","Firebase",e())}onAuthStateChanged(e,t,r){return this.registerStateListener(this.authStateSubscription,e,t,r)}beforeAuthStateChanged(e,t){return this.beforeStateQueue.pushCallback(e,t)}onIdTokenChanged(e,t,r){return this.registerStateListener(this.idTokenSubscription,e,t,r)}authStateReady(){return new Promise((e,t)=>{if(this.currentUser)e();else{const r=this.onAuthStateChanged(()=>{r(),e()},t)}})}async revokeAccessToken(e){if(this.currentUser){const t=await this.currentUser.getIdToken(),r={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:t};this.tenantId!=null&&(r.tenantId=this.tenantId),await B4(this,r)}}toJSON(){return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:this._currentUser?.toJSON()}}async _setRedirectUser(e,t){const r=await this.getOrInitRedirectPersistenceManager(t);return e===null?r.removeCurrentUser():r.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){const t=e&&Si(e)||this._popupRedirectResolver;Ce(t,this,"argument-error"),this.redirectPersistenceManager=await _u.create(this,[Si(t._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){return this._isInitialized&&await this.queue(async()=>{}),this._currentUser?._redirectEventId===e?this._currentUser:this.redirectUser?._redirectEventId===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(e))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const e=this.currentUser?.uid??null;this.lastNotifiedUid!==e&&(this.lastNotifiedUid=e,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,t,r,i){if(this._deleted)return()=>{};const s=typeof t=="function"?t:t.next.bind(t);let o=!1;const a=this._isInitialized?Promise.resolve():this._initializationPromise;if(Ce(a,this,"internal-error"),a.then(()=>{o||s(this.currentUser)}),typeof t=="function"){const c=e.addObserver(t,r,i);return()=>{o=!0,c()}}else{const c=e.addObserver(t);return()=>{o=!0,c()}}}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return Ce(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=tw(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){const e={"X-Client-Version":this.clientVersion};this.app.options.appId&&(e["X-Firebase-gmpid"]=this.app.options.appId);const t=await this.heartbeatServiceProvider.getImmediate({optional:!0})?.getHeartbeatsHeader();t&&(e["X-Firebase-Client"]=t);const r=await this._getAppCheckToken();return r&&(e["X-Firebase-AppCheck"]=r),e}async _getAppCheckToken(){if(Pn(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const e=await this.appCheckServiceProvider.getImmediate({optional:!0})?.getToken();return e?.error&&I4(`Error while retrieving App Check token: ${e.error}`),e?.token}}function kn(n){return ft(n)}class Jy{constructor(e){this.auth=e,this.observer=null,this.addObserver=T5(t=>this.observer=t)}get next(){return Ce(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}let Wh={async loadJS(){throw new Error("Unable to load external scripts")},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function K4(n){Wh=n}function d1(n){return Wh.loadJS(n)}function Y4(){return Wh.recaptchaV2Script}function J4(){return Wh.recaptchaEnterpriseScript}function Q4(){return Wh.gapiScript}function nw(n){return`__${n}${Math.floor(Math.random()*1e6)}`}const X4=500,Z4=6e4,Nd=1e12;class eP{constructor(e){this.auth=e,this.counter=Nd,this._widgets=new Map}render(e,t){const r=this.counter;return this._widgets.set(r,new rP(e,this.auth.name,t||{})),this.counter++,r}reset(e){const t=e||Nd;this._widgets.get(t)?.delete(),this._widgets.delete(t)}getResponse(e){const t=e||Nd;return this._widgets.get(t)?.getResponse()||""}async execute(e){const t=e||Nd;return this._widgets.get(t)?.execute(),""}}class tP{constructor(){this.enterprise=new nP}ready(e){e()}execute(e,t){return Promise.resolve("token")}render(e,t){return""}}class nP{ready(e){e()}execute(e,t){return Promise.resolve("token")}render(e,t){return""}}class rP{constructor(e,t,r){this.params=r,this.timerId=null,this.deleted=!1,this.responseToken=null,this.clickHandler=()=>{this.execute()};const i=typeof e=="string"?document.getElementById(e):e;Ce(i,"argument-error",{appName:t}),this.container=i,this.isVisible=this.params.size!=="invisible",this.isVisible?this.execute():this.container.addEventListener("click",this.clickHandler)}getResponse(){return this.checkIfDeleted(),this.responseToken}delete(){this.checkIfDeleted(),this.deleted=!0,this.timerId&&(clearTimeout(this.timerId),this.timerId=null),this.container.removeEventListener("click",this.clickHandler)}execute(){this.checkIfDeleted(),!this.timerId&&(this.timerId=window.setTimeout(()=>{this.responseToken=iP(50);const{callback:e,"expired-callback":t}=this.params;if(e)try{e(this.responseToken)}catch{}this.timerId=window.setTimeout(()=>{if(this.timerId=null,this.responseToken=null,t)try{t()}catch{}this.isVisible&&this.execute()},Z4)},X4))}checkIfDeleted(){if(this.deleted)throw new Error("reCAPTCHA mock was already deleted!")}}function iP(n){const e=[],t="1234567890abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ";for(let r=0;r<n;r++)e.push(t.charAt(Math.floor(Math.random()*t.length)));return e.join("")}const sP="recaptcha-enterprise",th="NO_RECAPTCHA";class rw{constructor(e){this.type=sP,this.auth=kn(e)}async verify(e="verify",t=!1){async function r(s){if(!t){if(s.tenantId==null&&s._agentRecaptchaConfig!=null)return s._agentRecaptchaConfig.siteKey;if(s.tenantId!=null&&s._tenantRecaptchaConfigs[s.tenantId]!==void 0)return s._tenantRecaptchaConfigs[s.tenantId].siteKey}return new Promise(async(o,a)=>{W5(s,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}).then(c=>{if(c.recaptchaKey===void 0)a(new Error("recaptcha Enterprise site key undefined"));else{const u=new $5(c);return s.tenantId==null?s._agentRecaptchaConfig=u:s._tenantRecaptchaConfigs[s.tenantId]=u,o(u.siteKey)}}).catch(c=>{a(c)})})}function i(s,o,a){const c=window.grecaptcha;Hy(c)?c.enterprise.ready(()=>{c.enterprise.execute(s,{action:e}).then(u=>{o(u)}).catch(()=>{o(th)})}):a(Error("No reCAPTCHA enterprise script loaded."))}return this.auth.settings.appVerificationDisabledForTesting?new tP().execute("siteKey",{action:"verify"}):new Promise((s,o)=>{r(this.auth).then(a=>{if(!t&&Hy(window.grecaptcha))i(a,s,o);else{if(typeof window>"u"){o(new Error("RecaptchaVerifier is only supported in browser"));return}let c=J4();c.length!==0&&(c+=a),d1(c).then(()=>{i(a,s,o)}).catch(u=>{o(u)})}}).catch(a=>{o(a)})})}}async function Ll(n,e,t,r=!1,i=!1){const s=new rw(n);let o;if(i)o=th;else try{o=await s.verify(t)}catch{o=await s.verify(t,!0)}const a={...e};if(t==="mfaSmsEnrollment"||t==="mfaSmsSignIn"){if("phoneEnrollmentInfo"in a){const c=a.phoneEnrollmentInfo.phoneNumber,u=a.phoneEnrollmentInfo.recaptchaToken;Object.assign(a,{phoneEnrollmentInfo:{phoneNumber:c,recaptchaToken:u,captchaResponse:o,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}else if("phoneSignInInfo"in a){const c=a.phoneSignInInfo.recaptchaToken;Object.assign(a,{phoneSignInInfo:{recaptchaToken:c,captchaResponse:o,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}return a}return r?Object.assign(a,{captchaResp:o}):Object.assign(a,{captchaResponse:o}),Object.assign(a,{clientType:"CLIENT_TYPE_WEB"}),Object.assign(a,{recaptchaVersion:"RECAPTCHA_ENTERPRISE"}),a}async function la(n,e,t,r,i){if(i==="EMAIL_PASSWORD_PROVIDER")if(n._getRecaptchaConfig()?.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")){const s=await Ll(n,e,t,t==="getOobCode");return r(n,s)}else return r(n,e).catch(async s=>{if(s.code==="auth/missing-recaptcha-token"){console.log(`${t} is protected by reCAPTCHA Enterprise for this project. Automatically triggering the reCAPTCHA flow and restarting the flow.`);const o=await Ll(n,e,t,t==="getOobCode");return r(n,o)}else return Promise.reject(s)});else if(i==="PHONE_PROVIDER")if(n._getRecaptchaConfig()?.isProviderEnabled("PHONE_PROVIDER")){const s=await Ll(n,e,t);return r(n,s).catch(async o=>{if(n._getRecaptchaConfig()?.getProviderEnforcementState("PHONE_PROVIDER")==="AUDIT"&&(o.code==="auth/missing-recaptcha-token"||o.code==="auth/invalid-app-credential")){console.log(`Failed to verify with reCAPTCHA Enterprise. Automatically triggering the reCAPTCHA v2 flow to complete the ${t} flow.`);const a=await Ll(n,e,t,!1,!0);return r(n,a)}return Promise.reject(o)})}else{const s=await Ll(n,e,t,!1,!0);return r(n,s)}else return Promise.reject(i+" provider is not supported.")}async function oP(n){const e=kn(n),t=await W5(e,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}),r=new $5(t);e.tenantId==null?e._agentRecaptchaConfig=r:e._tenantRecaptchaConfigs[e.tenantId]=r,r.isAnyProviderEnabled()&&new rw(e).verify()}function aP(n,e){const t=e?.persistence||[],r=(Array.isArray(t)?t:[t]).map(Si);e?.errorMap&&n._updateErrorMap(e.errorMap),n._initializeWithPersistence(r,e?.popupRedirectResolver)}function cP(n,e,t){const r=kn(n);Ce(/^https?:\/\//.test(e),r,"invalid-emulator-scheme");const i=!!t?.disableWarnings,s=iw(e),{host:o,port:a}=uP(e),c=a===null?"":`:${a}`,u={url:`${s}//${o}${c}/`},d=Object.freeze({host:o,port:a,protocol:s.replace(":",""),options:Object.freeze({disableWarnings:i})});if(!r._canInitEmulator){Ce(r.config.emulator&&r.emulatorConfig,r,"emulator-config-failed"),Ce(ga(u,r.config.emulator)&&ga(d,r.emulatorConfig),r,"emulator-config-failed");return}r.config.emulator=u,r.emulatorConfig=d,r.settings.appVerificationDisabledForTesting=!0,Xu(o)?(_5(`${s}//${o}${c}`),v5("Auth",!0)):i||lP()}function iw(n){const e=n.indexOf(":");return e<0?"":n.substr(0,e+1)}function uP(n){const e=iw(n),t=/(\/\/)?([^?#/]+)/.exec(n.substr(e.length));if(!t)return{host:"",port:null};const r=t[2].split("@").pop()||"",i=/^(\[[^\]]+\])(:|$)/.exec(r);if(i){const s=i[1];return{host:s,port:Qy(r.substr(s.length+1))}}else{const[s,o]=r.split(":");return{host:s,port:Qy(o)}}}function Qy(n){if(!n)return null;const e=Number(n);return isNaN(e)?null:e}function lP(){function n(){const e=document.createElement("p"),t=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",t.position="fixed",t.width="100%",t.backgroundColor="#ffffff",t.border=".1em solid #000000",t.color="#b50000",t.bottom="0px",t.left="0px",t.margin="0px",t.zIndex="10000",t.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}typeof console<"u"&&typeof console.info=="function"&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&(document.readyState==="loading"?window.addEventListener("DOMContentLoaded",n):n())}class tl{constructor(e,t){this.providerId=e,this.signInMethod=t}toJSON(){return Fs("not implemented")}_getIdTokenResponse(e){return Fs("not implemented")}_linkToIdToken(e,t){return Fs("not implemented")}_getReauthenticationResolver(e){return Fs("not implemented")}}async function sw(n,e){return Mn(n,"POST","/v1/accounts:resetPassword",Fn(n,e))}async function hP(n,e){return Mn(n,"POST","/v1/accounts:update",e)}async function dP(n,e){return Mn(n,"POST","/v1/accounts:signUp",e)}async function fP(n,e){return Mn(n,"POST","/v1/accounts:update",Fn(n,e))}async function pP(n,e){return Ao(n,"POST","/v1/accounts:signInWithPassword",Fn(n,e))}async function Zf(n,e){return Mn(n,"POST","/v1/accounts:sendOobCode",Fn(n,e))}async function gP(n,e){return Zf(n,e)}async function mP(n,e){return Zf(n,e)}async function yP(n,e){return Zf(n,e)}async function _P(n,e){return Zf(n,e)}async function vP(n,e){return Ao(n,"POST","/v1/accounts:signInWithEmailLink",Fn(n,e))}async function wP(n,e){return Ao(n,"POST","/v1/accounts:signInWithEmailLink",Fn(n,e))}class Ih extends tl{constructor(e,t,r,i=null){super("password",r),this._email=e,this._password=t,this._tenantId=i}static _fromEmailAndPassword(e,t){return new Ih(e,t,"password")}static _fromEmailAndCode(e,t,r=null){return new Ih(e,t,"emailLink",r)}toJSON(){return{email:this._email,password:this._password,signInMethod:this.signInMethod,tenantId:this._tenantId}}static fromJSON(e){const t=typeof e=="string"?JSON.parse(e):e;if(t?.email&&t?.password){if(t.signInMethod==="password")return this._fromEmailAndPassword(t.email,t.password);if(t.signInMethod==="emailLink")return this._fromEmailAndCode(t.email,t.password,t.tenantId)}return null}async _getIdTokenResponse(e){switch(this.signInMethod){case"password":const t={returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return la(e,t,"signInWithPassword",pP,"EMAIL_PASSWORD_PROVIDER");case"emailLink":return vP(e,{email:this._email,oobCode:this._password});default:vr(e,"internal-error")}}async _linkToIdToken(e,t){switch(this.signInMethod){case"password":const r={idToken:t,returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return la(e,r,"signUpPassword",dP,"EMAIL_PASSWORD_PROVIDER");case"emailLink":return wP(e,{idToken:t,email:this._email,oobCode:this._password});default:vr(e,"internal-error")}}_getReauthenticationResolver(e){return this._getIdTokenResponse(e)}}async function mo(n,e){return Ao(n,"POST","/v1/accounts:signInWithIdp",Fn(n,e))}const bP="http://localhost";class Ws extends tl{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){const t=new Ws(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(t.idToken=e.idToken),e.accessToken&&(t.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(t.nonce=e.nonce),e.pendingToken&&(t.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(t.accessToken=e.oauthToken,t.secret=e.oauthTokenSecret):vr("argument-error"),t}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){const t=typeof e=="string"?JSON.parse(e):e,{providerId:r,signInMethod:i,...s}=t;if(!r||!i)return null;const o=new Ws(r,i);return o.idToken=s.idToken||void 0,o.accessToken=s.accessToken||void 0,o.secret=s.secret,o.nonce=s.nonce,o.pendingToken=s.pendingToken||null,o}_getIdTokenResponse(e){const t=this.buildRequest();return mo(e,t)}_linkToIdToken(e,t){const r=this.buildRequest();return r.idToken=t,mo(e,r)}_getReauthenticationResolver(e){const t=this.buildRequest();return t.autoCreate=!1,mo(e,t)}buildRequest(){const e={requestUri:bP,returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{const t={};this.idToken&&(t.id_token=this.idToken),this.accessToken&&(t.access_token=this.accessToken),this.secret&&(t.oauth_token_secret=this.secret),t.providerId=this.providerId,this.nonce&&!this.pendingToken&&(t.nonce=this.nonce),e.postBody=Zu(t)}return e}}async function Xy(n,e){return Mn(n,"POST","/v1/accounts:sendVerificationCode",Fn(n,e))}async function IP(n,e){return Ao(n,"POST","/v1/accounts:signInWithPhoneNumber",Fn(n,e))}async function AP(n,e){const t=await Ao(n,"POST","/v1/accounts:signInWithPhoneNumber",Fn(n,e));if(t.temporaryProof)throw Hl(n,"account-exists-with-different-credential",t);return t}const EP={USER_NOT_FOUND:"user-not-found"};async function TP(n,e){const t={...e,operation:"REAUTH"};return Ao(n,"POST","/v1/accounts:signInWithPhoneNumber",Fn(n,t),EP)}class lc extends tl{constructor(e){super("phone","phone"),this.params=e}static _fromVerification(e,t){return new lc({verificationId:e,verificationCode:t})}static _fromTokenResponse(e,t){return new lc({phoneNumber:e,temporaryProof:t})}_getIdTokenResponse(e){return IP(e,this._makeVerificationRequest())}_linkToIdToken(e,t){return AP(e,{idToken:t,...this._makeVerificationRequest()})}_getReauthenticationResolver(e){return TP(e,this._makeVerificationRequest())}_makeVerificationRequest(){const{temporaryProof:e,phoneNumber:t,verificationId:r,verificationCode:i}=this.params;return e&&t?{temporaryProof:e,phoneNumber:t}:{sessionInfo:r,code:i}}toJSON(){const e={providerId:this.providerId};return this.params.phoneNumber&&(e.phoneNumber=this.params.phoneNumber),this.params.temporaryProof&&(e.temporaryProof=this.params.temporaryProof),this.params.verificationCode&&(e.verificationCode=this.params.verificationCode),this.params.verificationId&&(e.verificationId=this.params.verificationId),e}static fromJSON(e){typeof e=="string"&&(e=JSON.parse(e));const{verificationId:t,verificationCode:r,phoneNumber:i,temporaryProof:s}=e;return!r&&!t&&!i&&!s?null:new lc({verificationId:t,verificationCode:r,phoneNumber:i,temporaryProof:s})}}function SP(n){switch(n){case"recoverEmail":return"RECOVER_EMAIL";case"resetPassword":return"PASSWORD_RESET";case"signIn":return"EMAIL_SIGNIN";case"verifyEmail":return"VERIFY_EMAIL";case"verifyAndChangeEmail":return"VERIFY_AND_CHANGE_EMAIL";case"revertSecondFactorAddition":return"REVERT_SECOND_FACTOR_ADDITION";default:return null}}function PP(n){const e=gu(Wl(n)).link,t=e?gu(Wl(e)).deep_link_id:null,r=gu(Wl(n)).deep_link_id;return(r?gu(Wl(r)).link:null)||r||t||e||n}class ep{constructor(e){const t=gu(Wl(e)),r=t.apiKey??null,i=t.oobCode??null,s=SP(t.mode??null);Ce(r&&i&&s,"argument-error"),this.apiKey=r,this.operation=s,this.code=i,this.continueUrl=t.continueUrl??null,this.languageCode=t.lang??null,this.tenantId=t.tenantId??null}static parseLink(e){const t=PP(e);try{return new ep(t)}catch{return null}}}class xa{constructor(){this.providerId=xa.PROVIDER_ID}static credential(e,t){return Ih._fromEmailAndPassword(e,t)}static credentialWithLink(e,t){const r=ep.parseLink(t);return Ce(r,"argument-error"),Ih._fromEmailAndCode(e,r.code,r.tenantId)}}xa.PROVIDER_ID="password";xa.EMAIL_PASSWORD_SIGN_IN_METHOD="password";xa.EMAIL_LINK_SIGN_IN_METHOD="emailLink";class Eo{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}class nl extends Eo{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}class vu extends nl{static credentialFromJSON(e){const t=typeof e=="string"?JSON.parse(e):e;return Ce("providerId"in t&&"signInMethod"in t,"argument-error"),Ws._fromParams(t)}credential(e){return this._credential({...e,nonce:e.rawNonce})}_credential(e){return Ce(e.idToken||e.accessToken,"argument-error"),Ws._fromParams({...e,providerId:this.providerId,signInMethod:this.providerId})}static credentialFromResult(e){return vu.oauthCredentialFromTaggedObject(e)}static credentialFromError(e){return vu.oauthCredentialFromTaggedObject(e.customData||{})}static oauthCredentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:t,oauthAccessToken:r,oauthTokenSecret:i,pendingToken:s,nonce:o,providerId:a}=e;if(!r&&!i&&!t&&!s||!a)return null;try{return new vu(a)._credential({idToken:t,accessToken:r,nonce:o,pendingToken:s})}catch{return null}}}class Cs extends nl{constructor(){super("facebook.com")}static credential(e){return Ws._fromParams({providerId:Cs.PROVIDER_ID,signInMethod:Cs.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return Cs.credentialFromTaggedObject(e)}static credentialFromError(e){return Cs.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return Cs.credential(e.oauthAccessToken)}catch{return null}}}Cs.FACEBOOK_SIGN_IN_METHOD="facebook.com";Cs.PROVIDER_ID="facebook.com";class Ls extends nl{constructor(){super("google.com"),this.addScope("profile")}static credential(e,t){return Ws._fromParams({providerId:Ls.PROVIDER_ID,signInMethod:Ls.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:t})}static credentialFromResult(e){return Ls.credentialFromTaggedObject(e)}static credentialFromError(e){return Ls.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:t,oauthAccessToken:r}=e;if(!t&&!r)return null;try{return Ls.credential(t,r)}catch{return null}}}Ls.GOOGLE_SIGN_IN_METHOD="google.com";Ls.PROVIDER_ID="google.com";class Ds extends nl{constructor(){super("github.com")}static credential(e){return Ws._fromParams({providerId:Ds.PROVIDER_ID,signInMethod:Ds.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return Ds.credentialFromTaggedObject(e)}static credentialFromError(e){return Ds.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return Ds.credential(e.oauthAccessToken)}catch{return null}}}Ds.GITHUB_SIGN_IN_METHOD="github.com";Ds.PROVIDER_ID="github.com";const xP="http://localhost";class Cu extends tl{constructor(e,t){super(e,e),this.pendingToken=t}_getIdTokenResponse(e){const t=this.buildRequest();return mo(e,t)}_linkToIdToken(e,t){const r=this.buildRequest();return r.idToken=t,mo(e,r)}_getReauthenticationResolver(e){const t=this.buildRequest();return t.autoCreate=!1,mo(e,t)}toJSON(){return{signInMethod:this.signInMethod,providerId:this.providerId,pendingToken:this.pendingToken}}static fromJSON(e){const t=typeof e=="string"?JSON.parse(e):e,{providerId:r,signInMethod:i,pendingToken:s}=t;return!r||!i||!s||r!==i?null:new Cu(r,s)}static _create(e,t){return new Cu(e,t)}buildRequest(){return{requestUri:xP,returnSecureToken:!0,pendingToken:this.pendingToken}}}const RP="saml.";class If extends Eo{constructor(e){Ce(e.startsWith(RP),"argument-error"),super(e)}static credentialFromResult(e){return If.samlCredentialFromTaggedObject(e)}static credentialFromError(e){return If.samlCredentialFromTaggedObject(e.customData||{})}static credentialFromJSON(e){const t=Cu.fromJSON(e);return Ce(t,"argument-error"),t}static samlCredentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{pendingToken:t,providerId:r}=e;if(!t||!r)return null;try{return Cu._create(r,t)}catch{return null}}}class Os extends nl{constructor(){super("twitter.com")}static credential(e,t){return Ws._fromParams({providerId:Os.PROVIDER_ID,signInMethod:Os.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:t})}static credentialFromResult(e){return Os.credentialFromTaggedObject(e)}static credentialFromError(e){return Os.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthAccessToken:t,oauthTokenSecret:r}=e;if(!t||!r)return null;try{return Os.credential(t,r)}catch{return null}}}Os.TWITTER_SIGN_IN_METHOD="twitter.com";Os.PROVIDER_ID="twitter.com";async function ow(n,e){return Ao(n,"POST","/v1/accounts:signUp",Fn(n,e))}class Wi{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,t,r,i=!1){const s=await ss._fromIdTokenResponse(e,r,i),o=Zy(r);return new Wi({user:s,providerId:o,_tokenResponse:r,operationType:t})}static async _forOperation(e,t,r){await e._updateTokensIfNecessary(r,!0);const i=Zy(r);return new Wi({user:e,providerId:i,_tokenResponse:r,operationType:t})}}function Zy(n){return n.providerId?n.providerId:"phoneNumber"in n?"phone":null}async function NP(n){if(Pn(n.app))return Promise.reject(hr(n));const e=kn(n);if(await e._initializationPromise,e.currentUser?.isAnonymous)return new Wi({user:e.currentUser,providerId:null,operationType:"signIn"});const t=await ow(e,{returnSecureToken:!0}),r=await Wi._fromIdTokenResponse(e,"signIn",t,!0);return await e._updateCurrentUser(r.user),r}class Af extends Gr{constructor(e,t,r,i){super(t.code,t.message),this.operationType=r,this.user=i,Object.setPrototypeOf(this,Af.prototype),this.customData={appName:e.name,tenantId:e.tenantId??void 0,_serverResponse:t.customData._serverResponse,operationType:r}}static _fromErrorAndOperation(e,t,r,i){return new Af(e,t,r,i)}}function aw(n,e,t,r){return(e==="reauthenticate"?t._getReauthenticationResolver(n):t._getIdTokenResponse(n)).catch(s=>{throw s.code==="auth/multi-factor-auth-required"?Af._fromErrorAndOperation(n,s,e,r):s})}function cw(n){return new Set(n.map(({providerId:e})=>e).filter(e=>!!e))}async function kP(n,e){const t=ft(n);await tp(!0,t,e);const{providerUserInfo:r}=await C4(t.auth,{idToken:await t.getIdToken(),deleteProvider:[e]}),i=cw(r||[]);return t.providerData=t.providerData.filter(s=>i.has(s.providerId)),i.has("phone")||(t.phoneNumber=null),await t.auth._persistUserIfCurrent(t),t}async function f1(n,e,t=!1){const r=await vo(n,e._linkToIdToken(n.auth,await n.getIdToken()),t);return Wi._forOperation(n,"link",r)}async function tp(n,e,t){await bh(e);const r=cw(e.providerData),i=n===!1?"provider-already-linked":"no-such-provider";Ce(r.has(t)===n,e.auth,i)}async function uw(n,e,t=!1){const{auth:r}=n;if(Pn(r.app))return Promise.reject(hr(r));const i="reauthenticate";try{const s=await vo(n,aw(r,i,e,n),t);Ce(s.idToken,r,"internal-error");const o=Xf(s.idToken);Ce(o,r,"internal-error");const{sub:a}=o;return Ce(n.uid===a,r,"user-mismatch"),Wi._forOperation(n,i,s)}catch(s){throw s?.code==="auth/user-not-found"&&vr(r,"user-mismatch"),s}}async function lw(n,e,t=!1){if(Pn(n.app))return Promise.reject(hr(n));const r="signIn",i=await aw(n,r,e),s=await Wi._fromIdTokenResponse(n,r,i);return t||await n._updateCurrentUser(s.user),s}async function np(n,e){return lw(kn(n),e)}async function hw(n,e){const t=ft(n);return await tp(!1,t,e.providerId),f1(t,e)}async function dw(n,e){return uw(ft(n),e)}async function CP(n,e){return Ao(n,"POST","/v1/accounts:signInWithCustomToken",Fn(n,e))}async function LP(n,e){if(Pn(n.app))return Promise.reject(hr(n));const t=kn(n),r=await CP(t,{token:e,returnSecureToken:!0}),i=await Wi._fromIdTokenResponse(t,"signIn",r);return await t._updateCurrentUser(i.user),i}class Hh{constructor(e,t){this.factorId=e,this.uid=t.mfaEnrollmentId,this.enrollmentTime=new Date(t.enrolledAt).toUTCString(),this.displayName=t.displayName}static _fromServerResponse(e,t){return"phoneInfo"in t?p1._fromServerResponse(e,t):"totpInfo"in t?g1._fromServerResponse(e,t):vr(e,"internal-error")}}class p1 extends Hh{constructor(e){super("phone",e),this.phoneNumber=e.phoneInfo}static _fromServerResponse(e,t){return new p1(t)}}class g1 extends Hh{constructor(e){super("totp",e)}static _fromServerResponse(e,t){return new g1(t)}}function rp(n,e,t){Ce(t.url?.length>0,n,"invalid-continue-uri"),Ce(typeof t.dynamicLinkDomain>"u"||t.dynamicLinkDomain.length>0,n,"invalid-dynamic-link-domain"),Ce(typeof t.linkDomain>"u"||t.linkDomain.length>0,n,"invalid-hosting-link-domain"),e.continueUrl=t.url,e.dynamicLinkDomain=t.dynamicLinkDomain,e.linkDomain=t.linkDomain,e.canHandleCodeInApp=t.handleCodeInApp,t.iOS&&(Ce(t.iOS.bundleId.length>0,n,"missing-ios-bundle-id"),e.iOSBundleId=t.iOS.bundleId),t.android&&(Ce(t.android.packageName.length>0,n,"missing-android-pkg-name"),e.androidInstallApp=t.android.installApp,e.androidMinimumVersionCode=t.android.minimumVersion,e.androidPackageName=t.android.packageName)}async function m1(n){const e=kn(n);e._getPasswordPolicyInternal()&&await e._updatePasswordPolicy()}async function DP(n,e,t){const r=kn(n),i={requestType:"PASSWORD_RESET",email:e,clientType:"CLIENT_TYPE_WEB"};t&&rp(r,i,t),await la(r,i,"getOobCode",mP,"EMAIL_PASSWORD_PROVIDER")}async function OP(n,e,t){await sw(ft(n),{oobCode:e,newPassword:t}).catch(async r=>{throw r.code==="auth/password-does-not-meet-requirements"&&m1(n),r})}async function FP(n,e){await fP(ft(n),{oobCode:e})}async function fw(n,e){const t=ft(n),r=await sw(t,{oobCode:e}),i=r.requestType;switch(Ce(i,t,"internal-error"),i){case"EMAIL_SIGNIN":break;case"VERIFY_AND_CHANGE_EMAIL":Ce(r.newEmail,t,"internal-error");break;case"REVERT_SECOND_FACTOR_ADDITION":Ce(r.mfaInfo,t,"internal-error");default:Ce(r.email,t,"internal-error")}let s=null;return r.mfaInfo&&(s=Hh._fromServerResponse(kn(t),r.mfaInfo)),{data:{email:(r.requestType==="VERIFY_AND_CHANGE_EMAIL"?r.newEmail:r.email)||null,previousEmail:(r.requestType==="VERIFY_AND_CHANGE_EMAIL"?r.email:r.newEmail)||null,multiFactorInfo:s},operation:i}}async function MP(n,e){const{data:t}=await fw(ft(n),e);return t.email}async function VP(n,e,t){if(Pn(n.app))return Promise.reject(hr(n));const r=kn(n),o=await la(r,{returnSecureToken:!0,email:e,password:t,clientType:"CLIENT_TYPE_WEB"},"signUpPassword",ow,"EMAIL_PASSWORD_PROVIDER").catch(c=>{throw c.code==="auth/password-does-not-meet-requirements"&&m1(n),c}),a=await Wi._fromIdTokenResponse(r,"signIn",o);return await r._updateCurrentUser(a.user),a}function BP(n,e,t){return Pn(n.app)?Promise.reject(hr(n)):np(ft(n),xa.credential(e,t)).catch(async r=>{throw r.code==="auth/password-does-not-meet-requirements"&&m1(n),r})}async function UP(n,e,t){const r=kn(n),i={requestType:"EMAIL_SIGNIN",email:e,clientType:"CLIENT_TYPE_WEB"};function s(o,a){Ce(a.handleCodeInApp,r,"argument-error"),a&&rp(r,o,a)}s(i,t),await la(r,i,"getOobCode",yP,"EMAIL_PASSWORD_PROVIDER")}function jP(n,e){return ep.parseLink(e)?.operation==="EMAIL_SIGNIN"}async function qP(n,e,t){if(Pn(n.app))return Promise.reject(hr(n));const r=ft(n),i=xa.credentialWithLink(e,t||wh());return Ce(i._tenantId===(r.tenantId||null),r,"tenant-id-mismatch"),np(r,i)}async function zP(n,e){return Mn(n,"POST","/v1/accounts:createAuthUri",Fn(n,e))}async function $P(n,e){const t=l1()?wh():"http://localhost",r={identifier:e,continueUri:t},{signinMethods:i}=await zP(ft(n),r);return i||[]}async function WP(n,e){const t=ft(n),i={requestType:"VERIFY_EMAIL",idToken:await n.getIdToken()};e&&rp(t.auth,i,e);const{email:s}=await gP(t.auth,i);s!==n.email&&await n.reload()}async function HP(n,e,t){const r=ft(n),s={requestType:"VERIFY_AND_CHANGE_EMAIL",idToken:await n.getIdToken(),newEmail:e};t&&rp(r.auth,s,t);const{email:o}=await _P(r.auth,s);o!==n.email&&await n.reload()}async function GP(n,e){return Mn(n,"POST","/v1/accounts:update",e)}async function KP(n,{displayName:e,photoURL:t}){if(e===void 0&&t===void 0)return;const r=ft(n),s={idToken:await r.getIdToken(),displayName:e,photoUrl:t,returnSecureToken:!0},o=await vo(r,GP(r.auth,s));r.displayName=o.displayName||null,r.photoURL=o.photoUrl||null;const a=r.providerData.find(({providerId:c})=>c==="password");a&&(a.displayName=r.displayName,a.photoURL=r.photoURL),await r._updateTokensIfNecessary(o)}function YP(n,e){const t=ft(n);return Pn(t.auth.app)?Promise.reject(hr(t.auth)):pw(t,e,null)}function JP(n,e){return pw(ft(n),null,e)}async function pw(n,e,t){const{auth:r}=n,s={idToken:await n.getIdToken(),returnSecureToken:!0};e&&(s.email=e),t&&(s.password=t);const o=await vo(n,hP(r,s));await n._updateTokensIfNecessary(o,!0)}function QP(n){if(!n)return null;const{providerId:e}=n,t=n.rawUserInfo?JSON.parse(n.rawUserInfo):{},r=n.isNewUser||n.kind==="identitytoolkit#SignupNewUserResponse";if(!e&&n?.idToken){const i=Xf(n.idToken)?.firebase?.sign_in_provider;if(i){const s=i!=="anonymous"&&i!=="custom"?i:null;return new wu(r,s)}}if(!e)return null;switch(e){case"facebook.com":return new XP(r,t);case"github.com":return new ZP(r,t);case"google.com":return new e3(r,t);case"twitter.com":return new t3(r,t,n.screenName||null);case"custom":case"anonymous":return new wu(r,null);default:return new wu(r,e,t)}}class wu{constructor(e,t,r={}){this.isNewUser=e,this.providerId=t,this.profile=r}}class gw extends wu{constructor(e,t,r,i){super(e,t,r),this.username=i}}class XP extends wu{constructor(e,t){super(e,"facebook.com",t)}}class ZP extends gw{constructor(e,t){super(e,"github.com",t,typeof t?.login=="string"?t?.login:null)}}class e3 extends wu{constructor(e,t){super(e,"google.com",t)}}class t3 extends gw{constructor(e,t,r){super(e,"twitter.com",t,r)}}function n3(n){const{user:e,_tokenResponse:t}=n;return e.isAnonymous&&!t?{providerId:null,isNewUser:!1,profile:null}:QP(t)}class sc{constructor(e,t,r){this.type=e,this.credential=t,this.user=r}static _fromIdtoken(e,t){return new sc("enroll",e,t)}static _fromMfaPendingCredential(e){return new sc("signin",e)}toJSON(){return{multiFactorSession:{[this.type==="enroll"?"idToken":"pendingCredential"]:this.credential}}}static fromJSON(e){if(e?.multiFactorSession){if(e.multiFactorSession?.pendingCredential)return sc._fromMfaPendingCredential(e.multiFactorSession.pendingCredential);if(e.multiFactorSession?.idToken)return sc._fromIdtoken(e.multiFactorSession.idToken)}return null}}class y1{constructor(e,t,r){this.session=e,this.hints=t,this.signInResolver=r}static _fromError(e,t){const r=kn(e),i=t.customData._serverResponse,s=(i.mfaInfo||[]).map(a=>Hh._fromServerResponse(r,a));Ce(i.mfaPendingCredential,r,"internal-error");const o=sc._fromMfaPendingCredential(i.mfaPendingCredential);return new y1(o,s,async a=>{const c=await a._process(r,o);delete i.mfaInfo,delete i.mfaPendingCredential;const u={...i,idToken:c.idToken,refreshToken:c.refreshToken};switch(t.operationType){case"signIn":const d=await Wi._fromIdTokenResponse(r,t.operationType,u);return await r._updateCurrentUser(d.user),d;case"reauthenticate":return Ce(t.user,r,"internal-error"),Wi._forOperation(t.user,t.operationType,u);default:vr(r,"internal-error")}})}async resolveSignIn(e){const t=e;return this.signInResolver(t)}}function r3(n,e){const t=ft(n),r=e;return Ce(e.customData.operationType,t,"argument-error"),Ce(r.customData._serverResponse?.mfaPendingCredential,t,"argument-error"),y1._fromError(t,r)}function e2(n,e){return Mn(n,"POST","/v2/accounts/mfaEnrollment:start",Fn(n,e))}function i3(n,e){return Mn(n,"POST","/v2/accounts/mfaEnrollment:finalize",Fn(n,e))}function s3(n,e){return Mn(n,"POST","/v2/accounts/mfaEnrollment:withdraw",Fn(n,e))}class _1{constructor(e){this.user=e,this.enrolledFactors=[],e._onReload(t=>{t.mfaInfo&&(this.enrolledFactors=t.mfaInfo.map(r=>Hh._fromServerResponse(e.auth,r)))})}static _fromUser(e){return new _1(e)}async getSession(){return sc._fromIdtoken(await this.user.getIdToken(),this.user)}async enroll(e,t){const r=e,i=await this.getSession(),s=await vo(this.user,r._process(this.user.auth,i,t));return await this.user._updateTokensIfNecessary(s),this.user.reload()}async unenroll(e){const t=typeof e=="string"?e:e.uid,r=await this.user.getIdToken();try{const i=await vo(this.user,s3(this.user.auth,{idToken:r,mfaEnrollmentId:t}));this.enrolledFactors=this.enrolledFactors.filter(({uid:s})=>s!==t),await this.user._updateTokensIfNecessary(i),await this.user.reload()}catch(i){throw i}}}const ug=new WeakMap;function o3(n){const e=ft(n);return ug.has(e)||ug.set(e,_1._fromUser(e)),ug.get(e)}const Ef="__sak";class mw{constructor(e,t){this.storageRetriever=e,this.type=t}_isAvailable(){try{return this.storage?(this.storage.setItem(Ef,"1"),this.storage.removeItem(Ef),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(e,t){return this.storage.setItem(e,JSON.stringify(t)),Promise.resolve()}_get(e){const t=this.storage.getItem(e);return Promise.resolve(t?JSON.parse(t):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}}const a3=1e3,c3=10;class yw extends mw{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(e,t)=>this.onStorageEvent(e,t),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=ew(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(const t of Object.keys(this.listeners)){const r=this.storage.getItem(t),i=this.localCache[t];r!==i&&e(t,i,r)}}onStorageEvent(e,t=!1){if(!e.key){this.forAllChangedKeys((o,a,c)=>{this.notifyListeners(o,c)});return}const r=e.key;t?this.detachListener():this.stopPolling();const i=()=>{const o=this.storage.getItem(r);!t&&this.localCache[r]===o||this.notifyListeners(r,o)},s=this.storage.getItem(r);q4()&&s!==e.newValue&&e.newValue!==e.oldValue?setTimeout(i,c3):i()}notifyListeners(e,t){this.localCache[e]=t;const r=this.listeners[e];if(r)for(const i of Array.from(r))i(t&&JSON.parse(t))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((e,t,r)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:t,newValue:r}),!0)})},a3)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,t){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}async _set(e,t){await super._set(e,t),this.localCache[e]=JSON.stringify(t)}async _get(e){const t=await super._get(e);return this.localCache[e]=JSON.stringify(t),t}async _remove(e){await super._remove(e),delete this.localCache[e]}}yw.type="LOCAL";const v1=yw;class _w extends mw{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(e,t){}_removeListener(e,t){}}_w.type="SESSION";const pc=_w;function u3(n){return Promise.all(n.map(async e=>{try{return{fulfilled:!0,value:await e}}catch(t){return{fulfilled:!1,reason:t}}}))}class ip{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){const t=this.receivers.find(i=>i.isListeningto(e));if(t)return t;const r=new ip(e);return this.receivers.push(r),r}isListeningto(e){return this.eventTarget===e}async handleEvent(e){const t=e,{eventId:r,eventType:i,data:s}=t.data,o=this.handlersMap[i];if(!o?.size)return;t.ports[0].postMessage({status:"ack",eventId:r,eventType:i});const a=Array.from(o).map(async u=>u(t.origin,s)),c=await u3(a);t.ports[0].postMessage({status:"done",eventId:r,eventType:i,response:c})}_subscribe(e,t){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(t)}_unsubscribe(e,t){this.handlersMap[e]&&t&&this.handlersMap[e].delete(t),(!t||this.handlersMap[e].size===0)&&delete this.handlersMap[e],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}ip.receivers=[];function Gh(n="",e=10){let t="";for(let r=0;r<e;r++)t+=Math.floor(Math.random()*10);return n+t}class l3{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,t,r=50){const i=typeof MessageChannel<"u"?new MessageChannel:null;if(!i)throw new Error("connection_unavailable");let s,o;return new Promise((a,c)=>{const u=Gh("",20);i.port1.start();const d=setTimeout(()=>{c(new Error("unsupported_event"))},r);o={messageChannel:i,onMessage(g){const y=g;if(y.data.eventId===u)switch(y.data.status){case"ack":clearTimeout(d),s=setTimeout(()=>{c(new Error("timeout"))},3e3);break;case"done":clearTimeout(s),a(y.data.response);break;default:clearTimeout(d),clearTimeout(s),c(new Error("invalid_response"));break}}},this.handlers.add(o),i.port1.addEventListener("message",o.onMessage),this.target.postMessage({eventType:e,eventId:u,data:t},[i.port2])}).finally(()=>{o&&this.removeMessageHandler(o)})}}function Yn(){return window}function h3(n){Yn().location.href=n}function w1(){return typeof Yn().WorkerGlobalScope<"u"&&typeof Yn().importScripts=="function"}async function d3(){if(!navigator?.serviceWorker)return null;try{return(await navigator.serviceWorker.ready).active}catch{return null}}function f3(){return navigator?.serviceWorker?.controller||null}function p3(){return w1()?self:null}const vw="firebaseLocalStorageDb",g3=1,Tf="firebaseLocalStorage",ww="fbase_key";class Kh{constructor(e){this.request=e}toPromise(){return new Promise((e,t)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{t(this.request.error)})})}}function sp(n,e){return n.transaction([Tf],e?"readwrite":"readonly").objectStore(Tf)}function m3(){const n=indexedDB.deleteDatabase(vw);return new Kh(n).toPromise()}function Zg(){const n=indexedDB.open(vw,g3);return new Promise((e,t)=>{n.addEventListener("error",()=>{t(n.error)}),n.addEventListener("upgradeneeded",()=>{const r=n.result;try{r.createObjectStore(Tf,{keyPath:ww})}catch(i){t(i)}}),n.addEventListener("success",async()=>{const r=n.result;r.objectStoreNames.contains(Tf)?e(r):(r.close(),await m3(),e(await Zg()))})})}async function t2(n,e,t){const r=sp(n,!0).put({[ww]:e,value:t});return new Kh(r).toPromise()}async function y3(n,e){const t=sp(n,!1).get(e),r=await new Kh(t).toPromise();return r===void 0?null:r.value}function n2(n,e){const t=sp(n,!0).delete(e);return new Kh(t).toPromise()}const _3=800,v3=3;class bw{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db?this.db:(this.db=await Zg(),this.db)}async _withRetries(e){let t=0;for(;;)try{const r=await this._openDb();return await e(r)}catch(r){if(t++>v3)throw r;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return w1()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=ip._getInstance(p3()),this.receiver._subscribe("keyChanged",async(e,t)=>({keyProcessed:(await this._poll()).includes(t.key)})),this.receiver._subscribe("ping",async(e,t)=>["keyChanged"])}async initializeSender(){if(this.activeServiceWorker=await d3(),!this.activeServiceWorker)return;this.sender=new l3(this.activeServiceWorker);const e=await this.sender._send("ping",{},800);e&&e[0]?.fulfilled&&e[0]?.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(e){if(!(!this.sender||!this.activeServiceWorker||f3()!==this.activeServiceWorker))try{await this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch{}}async _isAvailable(){try{if(!indexedDB)return!1;const e=await Zg();return await t2(e,Ef,"1"),await n2(e,Ef),!0}catch{}return!1}async _withPendingWrite(e){this.pendingWrites++;try{await e()}finally{this.pendingWrites--}}async _set(e,t){return this._withPendingWrite(async()=>(await this._withRetries(r=>t2(r,e,t)),this.localCache[e]=t,this.notifyServiceWorker(e)))}async _get(e){const t=await this._withRetries(r=>y3(r,e));return this.localCache[e]=t,t}async _remove(e){return this._withPendingWrite(async()=>(await this._withRetries(t=>n2(t,e)),delete this.localCache[e],this.notifyServiceWorker(e)))}async _poll(){const e=await this._withRetries(i=>{const s=sp(i,!1).getAll();return new Kh(s).toPromise()});if(!e)return[];if(this.pendingWrites!==0)return[];const t=[],r=new Set;if(e.length!==0)for(const{fbase_key:i,value:s}of e)r.add(i),JSON.stringify(this.localCache[i])!==JSON.stringify(s)&&(this.notifyListeners(i,s),t.push(i));for(const i of Object.keys(this.localCache))this.localCache[i]&&!r.has(i)&&(this.notifyListeners(i,null),t.push(i));return t}notifyListeners(e,t){this.localCache[e]=t;const r=this.listeners[e];if(r)for(const i of Array.from(r))i(t)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),_3)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,t){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&this.stopPolling()}}bw.type="LOCAL";const Ah=bw;function r2(n,e){return Mn(n,"POST","/v2/accounts/mfaSignIn:start",Fn(n,e))}function w3(n,e){return Mn(n,"POST","/v2/accounts/mfaSignIn:finalize",Fn(n,e))}const lg=nw("rcb"),b3=new qh(3e4,6e4);class I3{constructor(){this.hostLanguage="",this.counter=0,this.librarySeparatelyLoaded=!!Yn().grecaptcha?.render}load(e,t=""){return Ce(A3(t),e,"argument-error"),this.shouldResolveImmediately(t)&&Wy(Yn().grecaptcha)?Promise.resolve(Yn().grecaptcha):new Promise((r,i)=>{const s=Yn().setTimeout(()=>{i(nr(e,"network-request-failed"))},b3.get());Yn()[lg]=()=>{Yn().clearTimeout(s),delete Yn()[lg];const a=Yn().grecaptcha;if(!a||!Wy(a)){i(nr(e,"internal-error"));return}const c=a.render;a.render=(u,d)=>{const g=c(u,d);return this.counter++,g},this.hostLanguage=t,r(a)};const o=`${Y4()}?${Zu({onload:lg,render:"explicit",hl:t})}`;d1(o).catch(()=>{clearTimeout(s),i(nr(e,"internal-error"))})})}clearedOneInstance(){this.counter--}shouldResolveImmediately(e){return!!Yn().grecaptcha?.render&&(e===this.hostLanguage||this.counter>0||this.librarySeparatelyLoaded)}}function A3(n){return n.length<=6&&/^\s*[a-zA-Z0-9\-]*\s*$/.test(n)}class E3{async load(e){return new eP(e)}clearedOneInstance(){}}const nh="recaptcha",T3={theme:"light",type:"image"};let S3=class{constructor(e,t,r={...T3}){this.parameters=r,this.type=nh,this.destroyed=!1,this.widgetId=null,this.tokenChangeListeners=new Set,this.renderPromise=null,this.recaptcha=null,this.auth=kn(e),this.isInvisible=this.parameters.size==="invisible",Ce(typeof document<"u",this.auth,"operation-not-supported-in-this-environment");const i=typeof t=="string"?document.getElementById(t):t;Ce(i,this.auth,"argument-error"),this.container=i,this.parameters.callback=this.makeTokenCallback(this.parameters.callback),this._recaptchaLoader=this.auth.settings.appVerificationDisabledForTesting?new E3:new I3,this.validateStartingState()}async verify(){this.assertNotDestroyed();const e=await this.render(),t=this.getAssertedRecaptcha(),r=t.getResponse(e);return r||new Promise(i=>{const s=o=>{o&&(this.tokenChangeListeners.delete(s),i(o))};this.tokenChangeListeners.add(s),this.isInvisible&&t.execute(e)})}render(){try{this.assertNotDestroyed()}catch(e){return Promise.reject(e)}return this.renderPromise?this.renderPromise:(this.renderPromise=this.makeRenderPromise().catch(e=>{throw this.renderPromise=null,e}),this.renderPromise)}_reset(){this.assertNotDestroyed(),this.widgetId!==null&&this.getAssertedRecaptcha().reset(this.widgetId)}clear(){this.assertNotDestroyed(),this.destroyed=!0,this._recaptchaLoader.clearedOneInstance(),this.isInvisible||this.container.childNodes.forEach(e=>{this.container.removeChild(e)})}validateStartingState(){Ce(!this.parameters.sitekey,this.auth,"argument-error"),Ce(this.isInvisible||!this.container.hasChildNodes(),this.auth,"argument-error"),Ce(typeof document<"u",this.auth,"operation-not-supported-in-this-environment")}makeTokenCallback(e){return t=>{if(this.tokenChangeListeners.forEach(r=>r(t)),typeof e=="function")e(t);else if(typeof e=="string"){const r=Yn()[e];typeof r=="function"&&r(t)}}}assertNotDestroyed(){Ce(!this.destroyed,this.auth,"internal-error")}async makeRenderPromise(){if(await this.init(),!this.widgetId){let e=this.container;if(!this.isInvisible){const t=document.createElement("div");e.appendChild(t),e=t}this.widgetId=this.getAssertedRecaptcha().render(e,this.parameters)}return this.widgetId}async init(){Ce(l1()&&!w1(),this.auth,"internal-error"),await P3(),this.recaptcha=await this._recaptchaLoader.load(this.auth,this.auth.languageCode||void 0);const e=await N4(this.auth);Ce(e,this.auth,"internal-error"),this.parameters.sitekey=e}getAssertedRecaptcha(){return Ce(this.recaptcha,this.auth,"internal-error"),this.recaptcha}};function P3(){let n=null;return new Promise(e=>{if(document.readyState==="complete"){e();return}n=()=>e(),window.addEventListener("load",n)}).catch(e=>{throw n&&window.removeEventListener("load",n),e})}class b1{constructor(e,t){this.verificationId=e,this.onConfirmation=t}confirm(e){const t=lc._fromVerification(this.verificationId,e);return this.onConfirmation(t)}}async function x3(n,e,t){if(Pn(n.app))return Promise.reject(hr(n));const r=kn(n),i=await op(r,e,ft(t));return new b1(i,s=>np(r,s))}async function R3(n,e,t){const r=ft(n);await tp(!1,r,"phone");const i=await op(r.auth,e,ft(t));return new b1(i,s=>hw(r,s))}async function N3(n,e,t){const r=ft(n);if(Pn(r.auth.app))return Promise.reject(hr(r.auth));const i=await op(r.auth,e,ft(t));return new b1(i,s=>dw(r,s))}async function op(n,e,t){if(!n._getRecaptchaConfig())try{await oP(n)}catch{console.log("Failed to initialize reCAPTCHA Enterprise config. Triggering the reCAPTCHA v2 verification.")}try{let r;if(typeof e=="string"?r={phoneNumber:e}:r=e,"session"in r){const i=r.session;if("phoneNumber"in r){Ce(i.type==="enroll",n,"internal-error");const s={idToken:i.credential,phoneEnrollmentInfo:{phoneNumber:r.phoneNumber,clientType:"CLIENT_TYPE_WEB"}};return(await la(n,s,"mfaSmsEnrollment",async(u,d)=>{if(d.phoneEnrollmentInfo.captchaResponse===th){Ce(t?.type===nh,u,"argument-error");const g=await hg(u,d,t);return e2(u,g)}return e2(u,d)},"PHONE_PROVIDER").catch(u=>Promise.reject(u))).phoneSessionInfo.sessionInfo}else{Ce(i.type==="signin",n,"internal-error");const s=r.multiFactorHint?.uid||r.multiFactorUid;Ce(s,n,"missing-multi-factor-info");const o={mfaPendingCredential:i.credential,mfaEnrollmentId:s,phoneSignInInfo:{clientType:"CLIENT_TYPE_WEB"}};return(await la(n,o,"mfaSmsSignIn",async(d,g)=>{if(g.phoneSignInInfo.captchaResponse===th){Ce(t?.type===nh,d,"argument-error");const y=await hg(d,g,t);return r2(d,y)}return r2(d,g)},"PHONE_PROVIDER").catch(d=>Promise.reject(d))).phoneResponseInfo.sessionInfo}}else{const i={phoneNumber:r.phoneNumber,clientType:"CLIENT_TYPE_WEB"};return(await la(n,i,"sendVerificationCode",async(c,u)=>{if(u.captchaResponse===th){Ce(t?.type===nh,c,"argument-error");const d=await hg(c,u,t);return Xy(c,d)}return Xy(c,u)},"PHONE_PROVIDER").catch(c=>Promise.reject(c))).sessionInfo}}finally{t?._reset()}}async function k3(n,e){const t=ft(n);if(Pn(t.auth.app))return Promise.reject(hr(t.auth));await f1(t,e)}async function hg(n,e,t){Ce(t.type===nh,n,"argument-error");const r=await t.verify();Ce(typeof r=="string",n,"argument-error");const i={...e};if("phoneEnrollmentInfo"in i){const s=i.phoneEnrollmentInfo.phoneNumber,o=i.phoneEnrollmentInfo.captchaResponse,a=i.phoneEnrollmentInfo.clientType,c=i.phoneEnrollmentInfo.recaptchaVersion;return Object.assign(i,{phoneEnrollmentInfo:{phoneNumber:s,recaptchaToken:r,captchaResponse:o,clientType:a,recaptchaVersion:c}}),i}else if("phoneSignInInfo"in i){const s=i.phoneSignInInfo.captchaResponse,o=i.phoneSignInInfo.clientType,a=i.phoneSignInInfo.recaptchaVersion;return Object.assign(i,{phoneSignInInfo:{recaptchaToken:r,captchaResponse:s,clientType:o,recaptchaVersion:a}}),i}else return Object.assign(i,{recaptchaToken:r}),i}let gc=class Kd{constructor(e){this.providerId=Kd.PROVIDER_ID,this.auth=kn(e)}verifyPhoneNumber(e,t){return op(this.auth,e,ft(t))}static credential(e,t){return lc._fromVerification(e,t)}static credentialFromResult(e){const t=e;return Kd.credentialFromTaggedObject(t)}static credentialFromError(e){return Kd.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{phoneNumber:t,temporaryProof:r}=e;return t&&r?lc._fromTokenResponse(t,r):null}};gc.PROVIDER_ID="phone";gc.PHONE_SIGN_IN_METHOD="phone";function kc(n,e){return e?Si(e):(Ce(n._popupRedirectResolver,n,"argument-error"),n._popupRedirectResolver)}class I1 extends tl{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return mo(e,this._buildIdpRequest())}_linkToIdToken(e,t){return mo(e,this._buildIdpRequest(t))}_getReauthenticationResolver(e){return mo(e,this._buildIdpRequest())}_buildIdpRequest(e){const t={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(t.idToken=e),t}}function C3(n){return lw(n.auth,new I1(n),n.bypassAuthState)}function L3(n){const{auth:e,user:t}=n;return Ce(t,e,"internal-error"),uw(t,new I1(n),n.bypassAuthState)}async function D3(n){const{auth:e,user:t}=n;return Ce(t,e,"internal-error"),f1(t,new I1(n),n.bypassAuthState)}class Iw{constructor(e,t,r,i,s=!1){this.auth=e,this.resolver=r,this.user=i,this.bypassAuthState=s,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(t)?t:[t]}execute(){return new Promise(async(e,t)=>{this.pendingPromise={resolve:e,reject:t};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(r){this.reject(r)}})}async onAuthEvent(e){const{urlResponse:t,sessionId:r,postBody:i,tenantId:s,error:o,type:a}=e;if(o){this.reject(o);return}const c={auth:this.auth,requestUri:t,sessionId:r,tenantId:s||void 0,postBody:i||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(a)(c))}catch(u){this.reject(u)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return C3;case"linkViaPopup":case"linkViaRedirect":return D3;case"reauthViaPopup":case"reauthViaRedirect":return L3;default:vr(this.auth,"internal-error")}}resolve(e){hs(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){hs(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}const O3=new qh(2e3,1e4);async function F3(n,e,t){if(Pn(n.app))return Promise.reject(nr(n,"operation-not-supported-in-this-environment"));const r=kn(n);el(n,e,Eo);const i=kc(r,t);return new ho(r,"signInViaPopup",e,i).executeNotNull()}async function M3(n,e,t){const r=ft(n);if(Pn(r.auth.app))return Promise.reject(nr(r.auth,"operation-not-supported-in-this-environment"));el(r.auth,e,Eo);const i=kc(r.auth,t);return new ho(r.auth,"reauthViaPopup",e,i,r).executeNotNull()}async function V3(n,e,t){const r=ft(n);el(r.auth,e,Eo);const i=kc(r.auth,t);return new ho(r.auth,"linkViaPopup",e,i,r).executeNotNull()}class ho extends Iw{constructor(e,t,r,i,s){super(e,t,i,s),this.provider=r,this.authWindow=null,this.pollId=null,ho.currentPopupAction&&ho.currentPopupAction.cancel(),ho.currentPopupAction=this}async executeNotNull(){const e=await this.execute();return Ce(e,this.auth,"internal-error"),e}async onExecution(){hs(this.filter.length===1,"Popup operations only handle one event");const e=Gh();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],e),this.authWindow.associatedEvent=e,this.resolver._originValidation(this.auth).catch(t=>{this.reject(t)}),this.resolver._isIframeWebStorageSupported(this.auth,t=>{t||this.reject(nr(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()}get eventId(){return this.authWindow?.associatedEvent||null}cancel(){this.reject(nr(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,ho.currentPopupAction=null}pollUserCancellation(){const e=()=>{if(this.authWindow?.window?.closed){this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(nr(this.auth,"popup-closed-by-user"))},8e3);return}this.pollId=window.setTimeout(e,O3.get())};e()}}ho.currentPopupAction=null;const B3="pendingRedirect",rh=new Map;class U3 extends Iw{constructor(e,t,r=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],t,void 0,r),this.eventId=null}async execute(){let e=rh.get(this.auth._key());if(!e){try{const r=await j3(this.resolver,this.auth)?await super.execute():null;e=()=>Promise.resolve(r)}catch(t){e=()=>Promise.reject(t)}rh.set(this.auth._key(),e)}return this.bypassAuthState||rh.set(this.auth._key(),()=>Promise.resolve(null)),e()}async onAuthEvent(e){if(e.type==="signInViaRedirect")return super.onAuthEvent(e);if(e.type==="unknown"){this.resolve(null);return}if(e.eventId){const t=await this.auth._redirectUserForId(e.eventId);if(t)return this.user=t,super.onAuthEvent(e);this.resolve(null)}}async onExecution(){}cleanUp(){}}async function j3(n,e){const t=Ew(e),r=Aw(n);if(!await r._isAvailable())return!1;const i=await r._get(t)==="true";return await r._remove(t),i}async function A1(n,e){return Aw(n)._set(Ew(e),"true")}function q3(){rh.clear()}function E1(n,e){rh.set(n._key(),e)}function Aw(n){return Si(n._redirectPersistence)}function Ew(n){return uc(B3,n.config.apiKey,n.name)}function z3(n,e,t){return $3(n,e,t)}async function $3(n,e,t){if(Pn(n.app))return Promise.reject(hr(n));const r=kn(n);el(n,e,Eo),await r._initializationPromise;const i=kc(r,t);return await A1(i,r),i._openRedirect(r,e,"signInViaRedirect")}function W3(n,e,t){return H3(n,e,t)}async function H3(n,e,t){const r=ft(n);if(el(r.auth,e,Eo),Pn(r.auth.app))return Promise.reject(hr(r.auth));await r.auth._initializationPromise;const i=kc(r.auth,t);await A1(i,r.auth);const s=await Tw(r);return i._openRedirect(r.auth,e,"reauthViaRedirect",s)}function G3(n,e,t){return K3(n,e,t)}async function K3(n,e,t){const r=ft(n);el(r.auth,e,Eo),await r.auth._initializationPromise;const i=kc(r.auth,t);await tp(!1,r,e.providerId),await A1(i,r.auth);const s=await Tw(r);return i._openRedirect(r.auth,e,"linkViaRedirect",s)}async function Y3(n,e){return await kn(n)._initializationPromise,ap(n,e,!1)}async function ap(n,e,t=!1){if(Pn(n.app))return Promise.reject(hr(n));const r=kn(n),i=kc(r,e),o=await new U3(r,i,t).execute();return o&&!t&&(delete o.user._redirectEventId,await r._persistUserIfCurrent(o.user),await r._setRedirectUser(null,e)),o}async function Tw(n){const e=Gh(`${n.uid}:::`);return n._redirectEventId=e,await n.auth._setRedirectUser(n),await n.auth._persistUserIfCurrent(n),e}const J3=600*1e3;class Sw{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let t=!1;return this.consumers.forEach(r=>{this.isEventForConsumer(e,r)&&(t=!0,this.sendToConsumer(e,r),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!Q3(e)||(this.hasHandledPotentialRedirect=!0,t||(this.queuedRedirectEvent=e,t=!0)),t}sendToConsumer(e,t){if(e.error&&!Pw(e)){const r=e.error.code?.split("auth/")[1]||"internal-error";t.onError(nr(this.auth,r))}else t.onAuthEvent(e)}isEventForConsumer(e,t){const r=t.eventId===null||!!e.eventId&&e.eventId===t.eventId;return t.filter.includes(e.type)&&r}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=J3&&this.cachedEventUids.clear(),this.cachedEventUids.has(i2(e))}saveEventToCache(e){this.cachedEventUids.add(i2(e)),this.lastProcessedEventTime=Date.now()}}function i2(n){return[n.type,n.eventId,n.sessionId,n.tenantId].filter(e=>e).join("-")}function Pw({type:n,error:e}){return n==="unknown"&&e?.code==="auth/no-auth-event"}function Q3(n){switch(n.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return Pw(n);default:return!1}}async function xw(n,e={}){return Mn(n,"GET","/v1/projects",e)}const X3=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,Z3=/^https?/;async function ex(n){if(n.config.emulator)return;const{authorizedDomains:e}=await xw(n);for(const t of e)try{if(tx(t))return}catch{}vr(n,"unauthorized-domain")}function tx(n){const e=wh(),{protocol:t,hostname:r}=new URL(e);if(n.startsWith("chrome-extension://")){const o=new URL(n);return o.hostname===""&&r===""?t==="chrome-extension:"&&n.replace("chrome-extension://","")===e.replace("chrome-extension://",""):t==="chrome-extension:"&&o.hostname===r}if(!Z3.test(t))return!1;if(X3.test(n))return r===n;const i=n.replace(/\./g,"\\.");return new RegExp("^(.+\\."+i+"|"+i+")$","i").test(r)}const nx=new qh(3e4,6e4);function s2(){const n=Yn().___jsl;if(n?.H){for(const e of Object.keys(n.H))if(n.H[e].r=n.H[e].r||[],n.H[e].L=n.H[e].L||[],n.H[e].r=[...n.H[e].L],n.CP)for(let t=0;t<n.CP.length;t++)n.CP[t]=null}}function rx(n){return new Promise((e,t)=>{function r(){s2(),gapi.load("gapi.iframes",{callback:()=>{e(gapi.iframes.getContext())},ontimeout:()=>{s2(),t(nr(n,"network-request-failed"))},timeout:nx.get()})}if(Yn().gapi?.iframes?.Iframe)e(gapi.iframes.getContext());else if(Yn().gapi?.load)r();else{const i=nw("iframefcb");return Yn()[i]=()=>{gapi.load?r():t(nr(n,"network-request-failed"))},d1(`${Q4()}?onload=${i}`).catch(s=>t(s))}}).catch(e=>{throw Yd=null,e})}let Yd=null;function ix(n){return Yd=Yd||rx(n),Yd}const sx=new qh(5e3,15e3),ox="__/auth/iframe",ax="emulator/auth/iframe",cx={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},ux=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function lx(n){const e=n.config;Ce(e.authDomain,n,"auth-domain-config-required");const t=e.emulator?h1(e,ax):`https://${n.config.authDomain}/${ox}`,r={apiKey:e.apiKey,appName:n.name,v:Pa},i=ux.get(n.config.apiHost);i&&(r.eid=i);const s=n._getFrameworks();return s.length&&(r.fw=s.join(",")),`${t}?${Zu(r).slice(1)}`}async function hx(n){const e=await ix(n),t=Yn().gapi;return Ce(t,n,"internal-error"),e.open({where:document.body,url:lx(n),messageHandlersFilter:t.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:cx,dontclear:!0},r=>new Promise(async(i,s)=>{await r.restyle({setHideOnLeave:!1});const o=nr(n,"network-request-failed"),a=Yn().setTimeout(()=>{s(o)},sx.get());function c(){Yn().clearTimeout(a),i(r)}r.ping(c).then(c,()=>{s(o)})}))}const dx={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},fx=500,px=600,gx="_blank",mx="http://localhost";class o2{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}}function yx(n,e,t,r=fx,i=px){const s=Math.max((window.screen.availHeight-i)/2,0).toString(),o=Math.max((window.screen.availWidth-r)/2,0).toString();let a="";const c={...dx,width:r.toString(),height:i.toString(),top:s,left:o},u=Nn().toLowerCase();t&&(a=J5(u)?gx:t),K5(u)&&(e=e||mx,c.scrollbars="yes");const d=Object.entries(c).reduce((y,[p,S])=>`${y}${p}=${S},`,"");if(j4(u)&&a!=="_self")return _x(e||"",a),new o2(null);const g=window.open(e||"",a,d);Ce(g,n,"popup-blocked");try{g.focus()}catch{}return new o2(g)}function _x(n,e){const t=document.createElement("a");t.href=n,t.target=e;const r=document.createEvent("MouseEvent");r.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),t.dispatchEvent(r)}const vx="__/auth/handler",wx="emulator/auth/handler",bx=encodeURIComponent("fac");async function em(n,e,t,r,i,s){Ce(n.config.authDomain,n,"auth-domain-config-required"),Ce(n.config.apiKey,n,"invalid-api-key");const o={apiKey:n.config.apiKey,appName:n.name,authType:t,redirectUrl:r,v:Pa,eventId:i};if(e instanceof Eo){e.setDefaultLanguage(n.languageCode),o.providerId=e.providerId||"",KT(e.getCustomParameters())||(o.customParameters=JSON.stringify(e.getCustomParameters()));for(const[d,g]of Object.entries(s||{}))o[d]=g}if(e instanceof nl){const d=e.getScopes().filter(g=>g!=="");d.length>0&&(o.scopes=d.join(","))}n.tenantId&&(o.tid=n.tenantId);const a=o;for(const d of Object.keys(a))a[d]===void 0&&delete a[d];const c=await n._getAppCheckToken(),u=c?`#${bx}=${encodeURIComponent(c)}`:"";return`${Ix(n)}?${Zu(a).slice(1)}${u}`}function Ix({config:n}){return n.emulator?h1(n,wx):`https://${n.authDomain}/${vx}`}const dg="webStorageSupport";class Ax{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=pc,this._completeRedirectFn=ap,this._overrideRedirectResult=E1}async _openPopup(e,t,r,i){hs(this.eventManagers[e._key()]?.manager,"_initialize() not called before _openPopup()");const s=await em(e,t,r,wh(),i);return yx(e,s,Gh())}async _openRedirect(e,t,r,i){await this._originValidation(e);const s=await em(e,t,r,wh(),i);return h3(s),new Promise(()=>{})}_initialize(e){const t=e._key();if(this.eventManagers[t]){const{manager:i,promise:s}=this.eventManagers[t];return i?Promise.resolve(i):(hs(s,"If manager is not set, promise should be"),s)}const r=this.initAndGetManager(e);return this.eventManagers[t]={promise:r},r.catch(()=>{delete this.eventManagers[t]}),r}async initAndGetManager(e){const t=await hx(e),r=new Sw(e);return t.register("authEvent",i=>(Ce(i?.authEvent,e,"invalid-auth-event"),{status:r.onEvent(i.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:r},this.iframes[e._key()]=t,r}_isIframeWebStorageSupported(e,t){this.iframes[e._key()].send(dg,{type:dg},i=>{const s=i?.[0]?.[dg];s!==void 0&&t(!!s),vr(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){const t=e._key();return this.originValidationPromises[t]||(this.originValidationPromises[t]=ex(e)),this.originValidationPromises[t]}get _shouldInitProactively(){return ew()||Y5()||$h()}}const Ex=Ax;class Tx{constructor(e){this.factorId=e}_process(e,t,r){switch(t.type){case"enroll":return this._finalizeEnroll(e,t.credential,r);case"signin":return this._finalizeSignIn(e,t.credential);default:return Fs("unexpected MultiFactorSessionType")}}}class T1 extends Tx{constructor(e){super("phone"),this.credential=e}static _fromCredential(e){return new T1(e)}_finalizeEnroll(e,t,r){return i3(e,{idToken:t,displayName:r,phoneVerificationInfo:this.credential._makeVerificationRequest()})}_finalizeSignIn(e,t){return w3(e,{mfaPendingCredential:t,phoneVerificationInfo:this.credential._makeVerificationRequest()})}}class Rw{constructor(){}static assertion(e){return T1._fromCredential(e)}}Rw.FACTOR_ID="phone";var a2="@firebase/auth",c2="1.12.0";class Sx{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){return this.assertAuthConfigured(),this.auth.currentUser?.uid||null}async getToken(e){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(e)}:null}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const t=this.auth.onIdTokenChanged(r=>{e(r?.stsTokenManager.accessToken||null)});this.internalListeners.set(e,t),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const t=this.internalListeners.get(e);t&&(this.internalListeners.delete(e),t(),this.updateProactiveRefresh())}assertAuthConfigured(){Ce(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}function Px(n){switch(n){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}function xx(n){_a(new zs("auth",(e,{options:t})=>{const r=e.getProvider("app").getImmediate(),i=e.getProvider("heartbeat"),s=e.getProvider("app-check-internal"),{apiKey:o,authDomain:a}=r.options;Ce(o&&!o.includes(":"),"invalid-api-key",{appName:r.name});const c={apiKey:o,authDomain:a,clientPlatform:n,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:tw(n)},u=new G4(r,i,s,c);return aP(u,t),u},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,t,r)=>{e.getProvider("auth-internal").initialize()})),_a(new zs("auth-internal",e=>{const t=kn(e.getProvider("auth").getImmediate());return(r=>new Sx(r))(t)},"PRIVATE").setInstantiationMode("EXPLICIT")),as(a2,c2,Px(n)),as(a2,c2,"esm2020")}const Rx=300;FT("authIdTokenMaxAge");function Nx(){return document.getElementsByTagName("head")?.[0]??document}K4({loadJS(n){return new Promise((e,t)=>{const r=document.createElement("script");r.setAttribute("src",n),r.onload=e,r.onerror=i=>{const s=nr("internal-error");s.customData=i,t(s)},r.type="text/javascript",r.charset="UTF-8",Nx().appendChild(r)})},gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="});xx("Browser");function mc(){return window}const kx=2e3;async function Cx(n,e,t){const{BuildInfo:r}=mc();hs(e.sessionId,"AuthEvent did not contain a session ID");const i=await Mx(e.sessionId),s={};return $h()?s.ibi=r.packageName:zh()?s.apn=r.packageName:vr(n,"operation-not-supported-in-this-environment"),r.displayName&&(s.appDisplayName=r.displayName),s.sessionId=i,em(n,t,e.type,void 0,e.eventId??void 0,s)}async function Lx(n){const{BuildInfo:e}=mc(),t={};$h()?t.iosBundleId=e.packageName:zh()?t.androidPackageName=e.packageName:vr(n,"operation-not-supported-in-this-environment"),await xw(n,t)}function Dx(n){const{cordova:e}=mc();return new Promise(t=>{e.plugins.browsertab.isAvailable(r=>{let i=null;r?e.plugins.browsertab.openUrl(n):i=e.InAppBrowser.open(n,U4()?"_blank":"_system","location=yes"),t(i)})})}async function Ox(n,e,t){const{cordova:r}=mc();let i=()=>{};try{await new Promise((s,o)=>{let a=null;function c(){s();const g=r.plugins.browsertab?.close;typeof g=="function"&&g(),typeof t?.close=="function"&&t.close()}function u(){a||(a=window.setTimeout(()=>{o(nr(n,"redirect-cancelled-by-user"))},kx))}function d(){document?.visibilityState==="visible"&&u()}e.addPassiveListener(c),document.addEventListener("resume",u,!1),zh()&&document.addEventListener("visibilitychange",d,!1),i=()=>{e.removePassiveListener(c),document.removeEventListener("resume",u,!1),document.removeEventListener("visibilitychange",d,!1),a&&window.clearTimeout(a)}})}finally{i()}}function Fx(n){const e=mc();Ce(typeof e?.universalLinks?.subscribe=="function",n,"invalid-cordova-configuration",{missingPlugin:"cordova-universal-links-plugin-fix"}),Ce(typeof e?.BuildInfo?.packageName<"u",n,"invalid-cordova-configuration",{missingPlugin:"cordova-plugin-buildInfo"}),Ce(typeof e?.cordova?.plugins?.browsertab?.openUrl=="function",n,"invalid-cordova-configuration",{missingPlugin:"cordova-plugin-browsertab"}),Ce(typeof e?.cordova?.plugins?.browsertab?.isAvailable=="function",n,"invalid-cordova-configuration",{missingPlugin:"cordova-plugin-browsertab"}),Ce(typeof e?.cordova?.InAppBrowser?.open=="function",n,"invalid-cordova-configuration",{missingPlugin:"cordova-plugin-inappbrowser"})}async function Mx(n){const e=Vx(n),t=await crypto.subtle.digest("SHA-256",e);return Array.from(new Uint8Array(t)).map(i=>i.toString(16).padStart(2,"0")).join("")}function Vx(n){if(hs(/[0-9a-zA-Z]+/.test(n),"Can only convert alpha-numeric strings"),typeof TextEncoder<"u")return new TextEncoder().encode(n);const e=new ArrayBuffer(n.length),t=new Uint8Array(e);for(let r=0;r<n.length;r++)t[r]=n.charCodeAt(r);return t}const Bx=20;class Ux extends Sw{constructor(){super(...arguments),this.passiveListeners=new Set,this.initPromise=new Promise(e=>{this.resolveInitialized=e})}addPassiveListener(e){this.passiveListeners.add(e)}removePassiveListener(e){this.passiveListeners.delete(e)}resetRedirect(){this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1}onEvent(e){return this.resolveInitialized(),this.passiveListeners.forEach(t=>t(e)),super.onEvent(e)}async initialized(){await this.initPromise}}function jx(n,e,t=null){return{type:e,eventId:t,urlResponse:null,sessionId:$x(),postBody:null,tenantId:n.tenantId,error:nr(n,"no-auth-event")}}function qx(n,e){return tm()._set(nm(n),e)}async function u2(n){const e=await tm()._get(nm(n));return e&&await tm()._remove(nm(n)),e}function zx(n,e){const t=Hx(e);if(t.includes("/__/auth/callback")){const r=Jd(t),s=(r.firebaseError?Wx(decodeURIComponent(r.firebaseError)):null)?.code?.split("auth/")?.[1],o=s?nr(s):null;return o?{type:n.type,eventId:n.eventId,tenantId:n.tenantId,error:o,urlResponse:null,sessionId:null,postBody:null}:{type:n.type,eventId:n.eventId,tenantId:n.tenantId,sessionId:n.sessionId,urlResponse:t,postBody:null}}return null}function $x(){const n=[],e="1234567890abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ";for(let t=0;t<Bx;t++){const r=Math.floor(Math.random()*e.length);n.push(e.charAt(r))}return n.join("")}function tm(){return Si(v1)}function nm(n){return uc("authEvent",n.config.apiKey,n.name)}function Wx(n){try{return JSON.parse(n)}catch{return null}}function Hx(n){const e=Jd(n),t=e.link?decodeURIComponent(e.link):void 0,r=Jd(t).link,i=e.deep_link_id?decodeURIComponent(e.deep_link_id):void 0;return Jd(i).link||i||r||t||n}function Jd(n){if(!n?.includes("?"))return{};const[e,...t]=n.split("?");return gu(t.join("?"))}const Gx=500;class Kx{constructor(){this._redirectPersistence=pc,this._shouldInitProactively=!0,this.eventManagers=new Map,this.originValidationPromises={},this._completeRedirectFn=ap,this._overrideRedirectResult=E1}async _initialize(e){const t=e._key();let r=this.eventManagers.get(t);return r||(r=new Ux(e),this.eventManagers.set(t,r),this.attachCallbackListeners(e,r)),r}_openPopup(e){vr(e,"operation-not-supported-in-this-environment")}async _openRedirect(e,t,r,i){Fx(e);const s=await this._initialize(e);await s.initialized(),s.resetRedirect(),q3(),await this._originValidation(e);const o=jx(e,r,i);await qx(e,o);const a=await Cx(e,o,t),c=await Dx(a);return Ox(e,s,c)}_isIframeWebStorageSupported(e,t){throw new Error("Method not implemented.")}_originValidation(e){const t=e._key();return this.originValidationPromises[t]||(this.originValidationPromises[t]=Lx(e)),this.originValidationPromises[t]}attachCallbackListeners(e,t){const{universalLinks:r,handleOpenURL:i,BuildInfo:s}=mc(),o=setTimeout(async()=>{await u2(e),t.onEvent(l2())},Gx),a=async d=>{clearTimeout(o);const g=await u2(e);let y=null;g&&d?.url&&(y=zx(g,d.url)),t.onEvent(y||l2())};typeof r<"u"&&typeof r.subscribe=="function"&&r.subscribe(null,a);const c=i,u=`${s.packageName.toLowerCase()}://`;mc().handleOpenURL=async d=>{if(d.toLowerCase().startsWith(u)&&a({url:d}),typeof c=="function")try{c(d)}catch(g){console.error(g)}}}}const Yx=Kx;function l2(){return{type:"unknown",eventId:null,sessionId:null,urlResponse:null,postBody:null,tenantId:null,error:nr("no-auth-event")}}function Jx(n,e){kn(n)._logFramework(e)}var Qx="@firebase/auth-compat",Xx="0.6.2";const Zx=1e3;function ih(){return self?.location?.protocol||null}function eR(){return ih()==="http:"||ih()==="https:"}function Nw(n=Nn()){return!!((ih()==="file:"||ih()==="ionic:"||ih()==="capacitor:")&&n.toLowerCase().match(/iphone|ipad|ipod|android/))}function tR(){return n1()||Jf()}function nR(){return I5()&&document?.documentMode===11}function rR(n=Nn()){return/Edge\/\d+/.test(n)}function iR(n=Nn()){return nR()||rR(n)}function kw(){try{const n=self.localStorage,e=Gh();if(n)return n.setItem(e,"1"),n.removeItem(e),iR()?yh():!0}catch{return S1()&&yh()}return!1}function S1(){return typeof global<"u"&&"WorkerGlobalScope"in global&&"importScripts"in global}function fg(){return(eR()||b5()||Nw())&&!tR()&&kw()&&!S1()}function Cw(){return Nw()&&typeof document<"u"}async function sR(){return Cw()?new Promise(n=>{const e=setTimeout(()=>{n(!1)},Zx);document.addEventListener("deviceready",()=>{clearTimeout(e),n(!0)})}):!1}function oR(){return typeof window<"u"?window:null}const Ti={LOCAL:"local",NONE:"none",SESSION:"session"},Dl=Ce,Lw="persistence";function aR(n,e){if(Dl(Object.values(Ti).includes(e),n,"invalid-persistence-type"),n1()){Dl(e!==Ti.SESSION,n,"unsupported-persistence-type");return}if(Jf()){Dl(e===Ti.NONE,n,"unsupported-persistence-type");return}if(S1()){Dl(e===Ti.NONE||e===Ti.LOCAL&&yh(),n,"unsupported-persistence-type");return}Dl(e===Ti.NONE||kw(),n,"unsupported-persistence-type")}async function rm(n){await n._initializationPromise;const e=Dw(),t=uc(Lw,n.config.apiKey,n.name);e&&e.setItem(t,n._getPersistenceType())}function cR(n,e){const t=Dw();if(!t)return[];const r=uc(Lw,n,e);switch(t.getItem(r)){case Ti.NONE:return[ku];case Ti.LOCAL:return[Ah,pc];case Ti.SESSION:return[pc];default:return[]}}function Dw(){try{return oR()?.sessionStorage||null}catch{return null}}const uR=Ce;class sa{constructor(){this.browserResolver=Si(Ex),this.cordovaResolver=Si(Yx),this.underlyingResolver=null,this._redirectPersistence=pc,this._completeRedirectFn=ap,this._overrideRedirectResult=E1}async _initialize(e){return await this.selectUnderlyingResolver(),this.assertedUnderlyingResolver._initialize(e)}async _openPopup(e,t,r,i){return await this.selectUnderlyingResolver(),this.assertedUnderlyingResolver._openPopup(e,t,r,i)}async _openRedirect(e,t,r,i){return await this.selectUnderlyingResolver(),this.assertedUnderlyingResolver._openRedirect(e,t,r,i)}_isIframeWebStorageSupported(e,t){this.assertedUnderlyingResolver._isIframeWebStorageSupported(e,t)}_originValidation(e){return this.assertedUnderlyingResolver._originValidation(e)}get _shouldInitProactively(){return Cw()||this.browserResolver._shouldInitProactively}get assertedUnderlyingResolver(){return uR(this.underlyingResolver,"internal-error"),this.underlyingResolver}async selectUnderlyingResolver(){if(this.underlyingResolver)return;const e=await sR();this.underlyingResolver=e?this.cordovaResolver:this.browserResolver}}function Ow(n){return n.unwrap()}function lR(n){return n.wrapped()}function hR(n){return Fw(n)}function dR(n,e){const t=e.customData?._tokenResponse;if(e?.code==="auth/multi-factor-auth-required"){const r=e;r.resolver=new fR(n,r3(n,e))}else if(t){const r=Fw(e),i=e;r&&(i.credential=r,i.tenantId=t.tenantId||void 0,i.email=t.email||void 0,i.phoneNumber=t.phoneNumber||void 0)}}function Fw(n){const{_tokenResponse:e}=n instanceof Gr?n.customData:n;if(!e)return null;if(!(n instanceof Gr)&&"temporaryProof"in e&&"phoneNumber"in e)return gc.credentialFromResult(n);const t=e.providerId;if(!t||t===Cl.PASSWORD)return null;let r;switch(t){case Cl.GOOGLE:r=Ls;break;case Cl.FACEBOOK:r=Cs;break;case Cl.GITHUB:r=Ds;break;case Cl.TWITTER:r=Os;break;default:const{oauthIdToken:i,oauthAccessToken:s,oauthTokenSecret:o,pendingToken:a,nonce:c}=e;return!s&&!o&&!i&&!a?null:a?t.startsWith("saml.")?Cu._create(t,a):Ws._fromParams({providerId:t,signInMethod:t,pendingToken:a,idToken:i,accessToken:s}):new vu(t).credential({idToken:i,accessToken:s,rawNonce:c})}return n instanceof Gr?r.credentialFromError(n):r.credentialFromResult(n)}function ci(n,e){return e.catch(t=>{throw t instanceof Gr&&dR(n,t),t}).then(t=>{const r=t.operationType,i=t.user;return{operationType:r,credential:hR(t),additionalUserInfo:n3(t),user:cp.getOrCreate(i)}})}async function im(n,e){const t=await e;return{verificationId:t.verificationId,confirm:r=>ci(n,t.confirm(r))}}class fR{constructor(e,t){this.resolver=t,this.auth=lR(e)}get session(){return this.resolver.session}get hints(){return this.resolver.hints}resolveSignIn(e){return ci(Ow(this.auth),this.resolver.resolveSignIn(e))}}let cp=class Gl{constructor(e){this._delegate=e,this.multiFactor=o3(e)}static getOrCreate(e){return Gl.USER_MAP.has(e)||Gl.USER_MAP.set(e,new Gl(e)),Gl.USER_MAP.get(e)}delete(){return this._delegate.delete()}reload(){return this._delegate.reload()}toJSON(){return this._delegate.toJSON()}getIdTokenResult(e){return this._delegate.getIdTokenResult(e)}getIdToken(e){return this._delegate.getIdToken(e)}linkAndRetrieveDataWithCredential(e){return this.linkWithCredential(e)}async linkWithCredential(e){return ci(this.auth,hw(this._delegate,e))}async linkWithPhoneNumber(e,t){return im(this.auth,R3(this._delegate,e,t))}async linkWithPopup(e){return ci(this.auth,V3(this._delegate,e,sa))}async linkWithRedirect(e){return await rm(kn(this.auth)),G3(this._delegate,e,sa)}reauthenticateAndRetrieveDataWithCredential(e){return this.reauthenticateWithCredential(e)}async reauthenticateWithCredential(e){return ci(this.auth,dw(this._delegate,e))}reauthenticateWithPhoneNumber(e,t){return im(this.auth,N3(this._delegate,e,t))}reauthenticateWithPopup(e){return ci(this.auth,M3(this._delegate,e,sa))}async reauthenticateWithRedirect(e){return await rm(kn(this.auth)),W3(this._delegate,e,sa)}sendEmailVerification(e){return WP(this._delegate,e)}async unlink(e){return await kP(this._delegate,e),this}updateEmail(e){return YP(this._delegate,e)}updatePassword(e){return JP(this._delegate,e)}updatePhoneNumber(e){return k3(this._delegate,e)}updateProfile(e){return KP(this._delegate,e)}verifyBeforeUpdateEmail(e,t){return HP(this._delegate,e,t)}get emailVerified(){return this._delegate.emailVerified}get isAnonymous(){return this._delegate.isAnonymous}get metadata(){return this._delegate.metadata}get phoneNumber(){return this._delegate.phoneNumber}get providerData(){return this._delegate.providerData}get refreshToken(){return this._delegate.refreshToken}get tenantId(){return this._delegate.tenantId}get displayName(){return this._delegate.displayName}get email(){return this._delegate.email}get photoURL(){return this._delegate.photoURL}get providerId(){return this._delegate.providerId}get uid(){return this._delegate.uid}get auth(){return this._delegate.auth}};cp.USER_MAP=new WeakMap;const Ol=Ce;class sm{constructor(e,t){if(this.app=e,t.isInitialized()){this._delegate=t.getImmediate(),this.linkUnderlyingAuth();return}const{apiKey:r}=e.options;Ol(r,"invalid-api-key",{appName:e.name}),Ol(r,"invalid-api-key",{appName:e.name});const i=typeof window<"u"?sa:void 0;this._delegate=t.initialize({options:{persistence:pR(r,e.name),popupRedirectResolver:i}}),this._delegate._updateErrorMap(w4),this.linkUnderlyingAuth()}get emulatorConfig(){return this._delegate.emulatorConfig}get currentUser(){return this._delegate.currentUser?cp.getOrCreate(this._delegate.currentUser):null}get languageCode(){return this._delegate.languageCode}set languageCode(e){this._delegate.languageCode=e}get settings(){return this._delegate.settings}get tenantId(){return this._delegate.tenantId}set tenantId(e){this._delegate.tenantId=e}useDeviceLanguage(){this._delegate.useDeviceLanguage()}signOut(){return this._delegate.signOut()}useEmulator(e,t){cP(this._delegate,e,t)}applyActionCode(e){return FP(this._delegate,e)}checkActionCode(e){return fw(this._delegate,e)}confirmPasswordReset(e,t){return OP(this._delegate,e,t)}async createUserWithEmailAndPassword(e,t){return ci(this._delegate,VP(this._delegate,e,t))}fetchProvidersForEmail(e){return this.fetchSignInMethodsForEmail(e)}fetchSignInMethodsForEmail(e){return $P(this._delegate,e)}isSignInWithEmailLink(e){return jP(this._delegate,e)}async getRedirectResult(){Ol(fg(),this._delegate,"operation-not-supported-in-this-environment");const e=await Y3(this._delegate,sa);return e?ci(this._delegate,Promise.resolve(e)):{credential:null,user:null}}addFrameworkForLogging(e){Jx(this._delegate,e)}onAuthStateChanged(e,t,r){const{next:i,error:s,complete:o}=h2(e,t,r);return this._delegate.onAuthStateChanged(i,s,o)}onIdTokenChanged(e,t,r){const{next:i,error:s,complete:o}=h2(e,t,r);return this._delegate.onIdTokenChanged(i,s,o)}sendSignInLinkToEmail(e,t){return UP(this._delegate,e,t)}sendPasswordResetEmail(e,t){return DP(this._delegate,e,t||void 0)}async setPersistence(e){aR(this._delegate,e);let t;switch(e){case Ti.SESSION:t=pc;break;case Ti.LOCAL:t=await Si(Ah)._isAvailable()?Ah:v1;break;case Ti.NONE:t=ku;break;default:return vr("argument-error",{appName:this._delegate.name})}return this._delegate.setPersistence(t)}signInAndRetrieveDataWithCredential(e){return this.signInWithCredential(e)}signInAnonymously(){return ci(this._delegate,NP(this._delegate))}signInWithCredential(e){return ci(this._delegate,np(this._delegate,e))}signInWithCustomToken(e){return ci(this._delegate,LP(this._delegate,e))}signInWithEmailAndPassword(e,t){return ci(this._delegate,BP(this._delegate,e,t))}signInWithEmailLink(e,t){return ci(this._delegate,qP(this._delegate,e,t))}signInWithPhoneNumber(e,t){return im(this._delegate,x3(this._delegate,e,t))}async signInWithPopup(e){return Ol(fg(),this._delegate,"operation-not-supported-in-this-environment"),ci(this._delegate,F3(this._delegate,e,sa))}async signInWithRedirect(e){return Ol(fg(),this._delegate,"operation-not-supported-in-this-environment"),await rm(this._delegate),z3(this._delegate,e,sa)}updateCurrentUser(e){return this._delegate.updateCurrentUser(e)}verifyPasswordResetCode(e){return MP(this._delegate,e)}unwrap(){return this._delegate}_delete(){return this._delegate._delete()}linkUnderlyingAuth(){this._delegate.wrapped=()=>this}}sm.Persistence=Ti;function h2(n,e,t){let r=n;typeof n!="function"&&({next:r,error:e,complete:t}=n);const i=r;return{next:o=>i(o&&cp.getOrCreate(o)),error:e,complete:t}}function pR(n,e){const t=cR(n,e);if(typeof self<"u"&&!t.includes(Ah)&&t.push(Ah),typeof window<"u")for(const r of[v1,pc])t.includes(r)||t.push(r);return t.includes(ku)||t.push(ku),t}class P1{static credential(e,t){return gc.credential(e,t)}constructor(){this.providerId="phone",this._delegate=new gc(Ow($s.auth()))}verifyPhoneNumber(e,t){return this._delegate.verifyPhoneNumber(e,t)}unwrap(){return this._delegate}}P1.PHONE_SIGN_IN_METHOD=gc.PHONE_SIGN_IN_METHOD;P1.PROVIDER_ID=gc.PROVIDER_ID;const gR=Ce;class mR{constructor(e,t,r=$s.app()){gR(r.options?.apiKey,"invalid-api-key",{appName:r.name}),this._delegate=new S3(r.auth(),e,t),this.type=this._delegate.type}clear(){this._delegate.clear()}render(){return this._delegate.render()}verify(){return this._delegate.verify()}}const yR="auth-compat";function _R(n){n.INTERNAL.registerComponent(new zs(yR,e=>{const t=e.getProvider("app-compat").getImmediate(),r=e.getProvider("auth");return new sm(t,r)},"PUBLIC").setServiceProps({ActionCodeInfo:{Operation:{EMAIL_SIGNIN:Qc.EMAIL_SIGNIN,PASSWORD_RESET:Qc.PASSWORD_RESET,RECOVER_EMAIL:Qc.RECOVER_EMAIL,REVERT_SECOND_FACTOR_ADDITION:Qc.REVERT_SECOND_FACTOR_ADDITION,VERIFY_AND_CHANGE_EMAIL:Qc.VERIFY_AND_CHANGE_EMAIL,VERIFY_EMAIL:Qc.VERIFY_EMAIL}},EmailAuthProvider:xa,FacebookAuthProvider:Cs,GithubAuthProvider:Ds,GoogleAuthProvider:Ls,OAuthProvider:vu,SAMLAuthProvider:If,PhoneAuthProvider:P1,PhoneMultiFactorGenerator:Rw,RecaptchaVerifier:mR,TwitterAuthProvider:Os,Auth:sm,AuthCredential:tl,Error:Gr}).setInstantiationMode("LAZY").setMultipleInstances(!1)),n.registerVersion(Qx,Xx)}_R($s);var d2=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};var ha,Mw;(function(){var n;function e(B,x){function A(){}A.prototype=x.prototype,B.F=x.prototype,B.prototype=new A,B.prototype.constructor=B,B.D=function(F,b,E){for(var T=Array(arguments.length-2),J=2;J<arguments.length;J++)T[J-2]=arguments[J];return x.prototype[b].apply(F,T)}}function t(){this.blockSize=-1}function r(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.C=Array(this.blockSize),this.o=this.h=0,this.u()}e(r,t),r.prototype.u=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function i(B,x,A){A||(A=0);const F=Array(16);if(typeof x=="string")for(var b=0;b<16;++b)F[b]=x.charCodeAt(A++)|x.charCodeAt(A++)<<8|x.charCodeAt(A++)<<16|x.charCodeAt(A++)<<24;else for(b=0;b<16;++b)F[b]=x[A++]|x[A++]<<8|x[A++]<<16|x[A++]<<24;x=B.g[0],A=B.g[1],b=B.g[2];let E=B.g[3],T;T=x+(E^A&(b^E))+F[0]+3614090360&4294967295,x=A+(T<<7&4294967295|T>>>25),T=E+(b^x&(A^b))+F[1]+3905402710&4294967295,E=x+(T<<12&4294967295|T>>>20),T=b+(A^E&(x^A))+F[2]+606105819&4294967295,b=E+(T<<17&4294967295|T>>>15),T=A+(x^b&(E^x))+F[3]+3250441966&4294967295,A=b+(T<<22&4294967295|T>>>10),T=x+(E^A&(b^E))+F[4]+4118548399&4294967295,x=A+(T<<7&4294967295|T>>>25),T=E+(b^x&(A^b))+F[5]+1200080426&4294967295,E=x+(T<<12&4294967295|T>>>20),T=b+(A^E&(x^A))+F[6]+2821735955&4294967295,b=E+(T<<17&4294967295|T>>>15),T=A+(x^b&(E^x))+F[7]+4249261313&4294967295,A=b+(T<<22&4294967295|T>>>10),T=x+(E^A&(b^E))+F[8]+1770035416&4294967295,x=A+(T<<7&4294967295|T>>>25),T=E+(b^x&(A^b))+F[9]+2336552879&4294967295,E=x+(T<<12&4294967295|T>>>20),T=b+(A^E&(x^A))+F[10]+4294925233&4294967295,b=E+(T<<17&4294967295|T>>>15),T=A+(x^b&(E^x))+F[11]+2304563134&4294967295,A=b+(T<<22&4294967295|T>>>10),T=x+(E^A&(b^E))+F[12]+1804603682&4294967295,x=A+(T<<7&4294967295|T>>>25),T=E+(b^x&(A^b))+F[13]+4254626195&4294967295,E=x+(T<<12&4294967295|T>>>20),T=b+(A^E&(x^A))+F[14]+2792965006&4294967295,b=E+(T<<17&4294967295|T>>>15),T=A+(x^b&(E^x))+F[15]+1236535329&4294967295,A=b+(T<<22&4294967295|T>>>10),T=x+(b^E&(A^b))+F[1]+4129170786&4294967295,x=A+(T<<5&4294967295|T>>>27),T=E+(A^b&(x^A))+F[6]+3225465664&4294967295,E=x+(T<<9&4294967295|T>>>23),T=b+(x^A&(E^x))+F[11]+643717713&4294967295,b=E+(T<<14&4294967295|T>>>18),T=A+(E^x&(b^E))+F[0]+3921069994&4294967295,A=b+(T<<20&4294967295|T>>>12),T=x+(b^E&(A^b))+F[5]+3593408605&4294967295,x=A+(T<<5&4294967295|T>>>27),T=E+(A^b&(x^A))+F[10]+38016083&4294967295,E=x+(T<<9&4294967295|T>>>23),T=b+(x^A&(E^x))+F[15]+3634488961&4294967295,b=E+(T<<14&4294967295|T>>>18),T=A+(E^x&(b^E))+F[4]+3889429448&4294967295,A=b+(T<<20&4294967295|T>>>12),T=x+(b^E&(A^b))+F[9]+568446438&4294967295,x=A+(T<<5&4294967295|T>>>27),T=E+(A^b&(x^A))+F[14]+3275163606&4294967295,E=x+(T<<9&4294967295|T>>>23),T=b+(x^A&(E^x))+F[3]+4107603335&4294967295,b=E+(T<<14&4294967295|T>>>18),T=A+(E^x&(b^E))+F[8]+1163531501&4294967295,A=b+(T<<20&4294967295|T>>>12),T=x+(b^E&(A^b))+F[13]+2850285829&4294967295,x=A+(T<<5&4294967295|T>>>27),T=E+(A^b&(x^A))+F[2]+4243563512&4294967295,E=x+(T<<9&4294967295|T>>>23),T=b+(x^A&(E^x))+F[7]+1735328473&4294967295,b=E+(T<<14&4294967295|T>>>18),T=A+(E^x&(b^E))+F[12]+2368359562&4294967295,A=b+(T<<20&4294967295|T>>>12),T=x+(A^b^E)+F[5]+4294588738&4294967295,x=A+(T<<4&4294967295|T>>>28),T=E+(x^A^b)+F[8]+2272392833&4294967295,E=x+(T<<11&4294967295|T>>>21),T=b+(E^x^A)+F[11]+1839030562&4294967295,b=E+(T<<16&4294967295|T>>>16),T=A+(b^E^x)+F[14]+4259657740&4294967295,A=b+(T<<23&4294967295|T>>>9),T=x+(A^b^E)+F[1]+2763975236&4294967295,x=A+(T<<4&4294967295|T>>>28),T=E+(x^A^b)+F[4]+1272893353&4294967295,E=x+(T<<11&4294967295|T>>>21),T=b+(E^x^A)+F[7]+4139469664&4294967295,b=E+(T<<16&4294967295|T>>>16),T=A+(b^E^x)+F[10]+3200236656&4294967295,A=b+(T<<23&4294967295|T>>>9),T=x+(A^b^E)+F[13]+681279174&4294967295,x=A+(T<<4&4294967295|T>>>28),T=E+(x^A^b)+F[0]+3936430074&4294967295,E=x+(T<<11&4294967295|T>>>21),T=b+(E^x^A)+F[3]+3572445317&4294967295,b=E+(T<<16&4294967295|T>>>16),T=A+(b^E^x)+F[6]+76029189&4294967295,A=b+(T<<23&4294967295|T>>>9),T=x+(A^b^E)+F[9]+3654602809&4294967295,x=A+(T<<4&4294967295|T>>>28),T=E+(x^A^b)+F[12]+3873151461&4294967295,E=x+(T<<11&4294967295|T>>>21),T=b+(E^x^A)+F[15]+530742520&4294967295,b=E+(T<<16&4294967295|T>>>16),T=A+(b^E^x)+F[2]+3299628645&4294967295,A=b+(T<<23&4294967295|T>>>9),T=x+(b^(A|~E))+F[0]+4096336452&4294967295,x=A+(T<<6&4294967295|T>>>26),T=E+(A^(x|~b))+F[7]+1126891415&4294967295,E=x+(T<<10&4294967295|T>>>22),T=b+(x^(E|~A))+F[14]+2878612391&4294967295,b=E+(T<<15&4294967295|T>>>17),T=A+(E^(b|~x))+F[5]+4237533241&4294967295,A=b+(T<<21&4294967295|T>>>11),T=x+(b^(A|~E))+F[12]+1700485571&4294967295,x=A+(T<<6&4294967295|T>>>26),T=E+(A^(x|~b))+F[3]+2399980690&4294967295,E=x+(T<<10&4294967295|T>>>22),T=b+(x^(E|~A))+F[10]+4293915773&4294967295,b=E+(T<<15&4294967295|T>>>17),T=A+(E^(b|~x))+F[1]+2240044497&4294967295,A=b+(T<<21&4294967295|T>>>11),T=x+(b^(A|~E))+F[8]+1873313359&4294967295,x=A+(T<<6&4294967295|T>>>26),T=E+(A^(x|~b))+F[15]+4264355552&4294967295,E=x+(T<<10&4294967295|T>>>22),T=b+(x^(E|~A))+F[6]+2734768916&4294967295,b=E+(T<<15&4294967295|T>>>17),T=A+(E^(b|~x))+F[13]+1309151649&4294967295,A=b+(T<<21&4294967295|T>>>11),T=x+(b^(A|~E))+F[4]+4149444226&4294967295,x=A+(T<<6&4294967295|T>>>26),T=E+(A^(x|~b))+F[11]+3174756917&4294967295,E=x+(T<<10&4294967295|T>>>22),T=b+(x^(E|~A))+F[2]+718787259&4294967295,b=E+(T<<15&4294967295|T>>>17),T=A+(E^(b|~x))+F[9]+3951481745&4294967295,B.g[0]=B.g[0]+x&4294967295,B.g[1]=B.g[1]+(b+(T<<21&4294967295|T>>>11))&4294967295,B.g[2]=B.g[2]+b&4294967295,B.g[3]=B.g[3]+E&4294967295}r.prototype.v=function(B,x){x===void 0&&(x=B.length);const A=x-this.blockSize,F=this.C;let b=this.h,E=0;for(;E<x;){if(b==0)for(;E<=A;)i(this,B,E),E+=this.blockSize;if(typeof B=="string"){for(;E<x;)if(F[b++]=B.charCodeAt(E++),b==this.blockSize){i(this,F),b=0;break}}else for(;E<x;)if(F[b++]=B[E++],b==this.blockSize){i(this,F),b=0;break}}this.h=b,this.o+=x},r.prototype.A=function(){var B=Array((this.h<56?this.blockSize:this.blockSize*2)-this.h);B[0]=128;for(var x=1;x<B.length-8;++x)B[x]=0;x=this.o*8;for(var A=B.length-8;A<B.length;++A)B[A]=x&255,x/=256;for(this.v(B),B=Array(16),x=0,A=0;A<4;++A)for(let F=0;F<32;F+=8)B[x++]=this.g[A]>>>F&255;return B};function s(B,x){var A=a;return Object.prototype.hasOwnProperty.call(A,B)?A[B]:A[B]=x(B)}function o(B,x){this.h=x;const A=[];let F=!0;for(let b=B.length-1;b>=0;b--){const E=B[b]|0;F&&E==x||(A[b]=E,F=!1)}this.g=A}var a={};function c(B){return-128<=B&&B<128?s(B,function(x){return new o([x|0],x<0?-1:0)}):new o([B|0],B<0?-1:0)}function u(B){if(isNaN(B)||!isFinite(B))return g;if(B<0)return C(u(-B));const x=[];let A=1;for(let F=0;B>=A;F++)x[F]=B/A|0,A*=4294967296;return new o(x,0)}function d(B,x){if(B.length==0)throw Error("number format error: empty string");if(x=x||10,x<2||36<x)throw Error("radix out of range: "+x);if(B.charAt(0)=="-")return C(d(B.substring(1),x));if(B.indexOf("-")>=0)throw Error('number format error: interior "-" character');const A=u(Math.pow(x,8));let F=g;for(let E=0;E<B.length;E+=8){var b=Math.min(8,B.length-E);const T=parseInt(B.substring(E,E+b),x);b<8?(b=u(Math.pow(x,b)),F=F.j(b).add(u(T))):(F=F.j(A),F=F.add(u(T)))}return F}var g=c(0),y=c(1),p=c(16777216);n=o.prototype,n.m=function(){if(N(this))return-C(this).m();let B=0,x=1;for(let A=0;A<this.g.length;A++){const F=this.i(A);B+=(F>=0?F:4294967296+F)*x,x*=4294967296}return B},n.toString=function(B){if(B=B||10,B<2||36<B)throw Error("radix out of range: "+B);if(S(this))return"0";if(N(this))return"-"+C(this).toString(B);const x=u(Math.pow(B,6));var A=this;let F="";for(;;){const b=W(A,x).g;A=k(A,b.j(x));let E=((A.g.length>0?A.g[0]:A.h)>>>0).toString(B);if(A=b,S(A))return E+F;for(;E.length<6;)E="0"+E;F=E+F}},n.i=function(B){return B<0?0:B<this.g.length?this.g[B]:this.h};function S(B){if(B.h!=0)return!1;for(let x=0;x<B.g.length;x++)if(B.g[x]!=0)return!1;return!0}function N(B){return B.h==-1}n.l=function(B){return B=k(this,B),N(B)?-1:S(B)?0:1};function C(B){const x=B.g.length,A=[];for(let F=0;F<x;F++)A[F]=~B.g[F];return new o(A,~B.h).add(y)}n.abs=function(){return N(this)?C(this):this},n.add=function(B){const x=Math.max(this.g.length,B.g.length),A=[];let F=0;for(let b=0;b<=x;b++){let E=F+(this.i(b)&65535)+(B.i(b)&65535),T=(E>>>16)+(this.i(b)>>>16)+(B.i(b)>>>16);F=T>>>16,E&=65535,T&=65535,A[b]=T<<16|E}return new o(A,A[A.length-1]&-2147483648?-1:0)};function k(B,x){return B.add(C(x))}n.j=function(B){if(S(this)||S(B))return g;if(N(this))return N(B)?C(this).j(C(B)):C(C(this).j(B));if(N(B))return C(this.j(C(B)));if(this.l(p)<0&&B.l(p)<0)return u(this.m()*B.m());const x=this.g.length+B.g.length,A=[];for(var F=0;F<2*x;F++)A[F]=0;for(F=0;F<this.g.length;F++)for(let b=0;b<B.g.length;b++){const E=this.i(F)>>>16,T=this.i(F)&65535,J=B.i(b)>>>16,fe=B.i(b)&65535;A[2*F+2*b]+=T*fe,K(A,2*F+2*b),A[2*F+2*b+1]+=E*fe,K(A,2*F+2*b+1),A[2*F+2*b+1]+=T*J,K(A,2*F+2*b+1),A[2*F+2*b+2]+=E*J,K(A,2*F+2*b+2)}for(B=0;B<x;B++)A[B]=A[2*B+1]<<16|A[2*B];for(B=x;B<2*x;B++)A[B]=0;return new o(A,0)};function K(B,x){for(;(B[x]&65535)!=B[x];)B[x+1]+=B[x]>>>16,B[x]&=65535,x++}function G(B,x){this.g=B,this.h=x}function W(B,x){if(S(x))throw Error("division by zero");if(S(B))return new G(g,g);if(N(B))return x=W(C(B),x),new G(C(x.g),C(x.h));if(N(x))return x=W(B,C(x)),new G(C(x.g),x.h);if(B.g.length>30){if(N(B)||N(x))throw Error("slowDivide_ only works with positive integers.");for(var A=y,F=x;F.l(B)<=0;)A=ne(A),F=ne(F);var b=de(A,1),E=de(F,1);for(F=de(F,2),A=de(A,2);!S(F);){var T=E.add(F);T.l(B)<=0&&(b=b.add(A),E=T),F=de(F,1),A=de(A,1)}return x=k(B,b.j(x)),new G(b,x)}for(b=g;B.l(x)>=0;){for(A=Math.max(1,Math.floor(B.m()/x.m())),F=Math.ceil(Math.log(A)/Math.LN2),F=F<=48?1:Math.pow(2,F-48),E=u(A),T=E.j(x);N(T)||T.l(B)>0;)A-=F,E=u(A),T=E.j(x);S(E)&&(E=y),b=b.add(E),B=k(B,T)}return new G(b,B)}n.B=function(B){return W(this,B).h},n.and=function(B){const x=Math.max(this.g.length,B.g.length),A=[];for(let F=0;F<x;F++)A[F]=this.i(F)&B.i(F);return new o(A,this.h&B.h)},n.or=function(B){const x=Math.max(this.g.length,B.g.length),A=[];for(let F=0;F<x;F++)A[F]=this.i(F)|B.i(F);return new o(A,this.h|B.h)},n.xor=function(B){const x=Math.max(this.g.length,B.g.length),A=[];for(let F=0;F<x;F++)A[F]=this.i(F)^B.i(F);return new o(A,this.h^B.h)};function ne(B){const x=B.g.length+1,A=[];for(let F=0;F<x;F++)A[F]=B.i(F)<<1|B.i(F-1)>>>31;return new o(A,B.h)}function de(B,x){const A=x>>5;x%=32;const F=B.g.length-A,b=[];for(let E=0;E<F;E++)b[E]=x>0?B.i(E+A)>>>x|B.i(E+A+1)<<32-x:B.i(E+A);return new o(b,B.h)}r.prototype.digest=r.prototype.A,r.prototype.reset=r.prototype.u,r.prototype.update=r.prototype.v,Mw=r,o.prototype.add=o.prototype.add,o.prototype.multiply=o.prototype.j,o.prototype.modulo=o.prototype.B,o.prototype.compare=o.prototype.l,o.prototype.toNumber=o.prototype.m,o.prototype.toString=o.prototype.toString,o.prototype.getBits=o.prototype.i,o.fromNumber=u,o.fromString=d,ha=o}).apply(typeof d2<"u"?d2:typeof self<"u"?self:typeof window<"u"?window:{});var kd=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};var Vw,Kl,Bw,Qd,om,Uw,jw,qw;(function(){var n,e=Object.defineProperty;function t(h){h=[typeof globalThis=="object"&&globalThis,h,typeof window=="object"&&window,typeof self=="object"&&self,typeof kd=="object"&&kd];for(var v=0;v<h.length;++v){var I=h[v];if(I&&I.Math==Math)return I}throw Error("Cannot find global object")}var r=t(this);function i(h,v){if(v)e:{var I=r;h=h.split(".");for(var V=0;V<h.length-1;V++){var ie=h[V];if(!(ie in I))break e;I=I[ie]}h=h[h.length-1],V=I[h],v=v(V),v!=V&&v!=null&&e(I,h,{configurable:!0,writable:!0,value:v})}}i("Symbol.dispose",function(h){return h||Symbol("Symbol.dispose")}),i("Array.prototype.values",function(h){return h||function(){return this[Symbol.iterator]()}}),i("Object.entries",function(h){return h||function(v){var I=[],V;for(V in v)Object.prototype.hasOwnProperty.call(v,V)&&I.push([V,v[V]]);return I}});var s=s||{},o=this||self;function a(h){var v=typeof h;return v=="object"&&h!=null||v=="function"}function c(h,v,I){return h.call.apply(h.bind,arguments)}function u(h,v,I){return u=c,u.apply(null,arguments)}function d(h,v){var I=Array.prototype.slice.call(arguments,1);return function(){var V=I.slice();return V.push.apply(V,arguments),h.apply(this,V)}}function g(h,v){function I(){}I.prototype=v.prototype,h.Z=v.prototype,h.prototype=new I,h.prototype.constructor=h,h.Ob=function(V,ie,he){for(var De=Array(arguments.length-2),vt=2;vt<arguments.length;vt++)De[vt-2]=arguments[vt];return v.prototype[ie].apply(V,De)}}var y=typeof AsyncContext<"u"&&typeof AsyncContext.Snapshot=="function"?h=>h&&AsyncContext.Snapshot.wrap(h):h=>h;function p(h){const v=h.length;if(v>0){const I=Array(v);for(let V=0;V<v;V++)I[V]=h[V];return I}return[]}function S(h,v){for(let V=1;V<arguments.length;V++){const ie=arguments[V];var I=typeof ie;if(I=I!="object"?I:ie?Array.isArray(ie)?"array":I:"null",I=="array"||I=="object"&&typeof ie.length=="number"){I=h.length||0;const he=ie.length||0;h.length=I+he;for(let De=0;De<he;De++)h[I+De]=ie[De]}else h.push(ie)}}class N{constructor(v,I){this.i=v,this.j=I,this.h=0,this.g=null}get(){let v;return this.h>0?(this.h--,v=this.g,this.g=v.next,v.next=null):v=this.i(),v}}function C(h){o.setTimeout(()=>{throw h},0)}function k(){var h=B;let v=null;return h.g&&(v=h.g,h.g=h.g.next,h.g||(h.h=null),v.next=null),v}class K{constructor(){this.h=this.g=null}add(v,I){const V=G.get();V.set(v,I),this.h?this.h.next=V:this.g=V,this.h=V}}var G=new N(()=>new W,h=>h.reset());class W{constructor(){this.next=this.g=this.h=null}set(v,I){this.h=v,this.g=I,this.next=null}reset(){this.next=this.g=this.h=null}}let ne,de=!1,B=new K,x=()=>{const h=Promise.resolve(void 0);ne=()=>{h.then(A)}};function A(){for(var h;h=k();){try{h.h.call(h.g)}catch(I){C(I)}var v=G;v.j(h),v.h<100&&(v.h++,h.next=v.g,v.g=h)}de=!1}function F(){this.u=this.u,this.C=this.C}F.prototype.u=!1,F.prototype.dispose=function(){this.u||(this.u=!0,this.N())},F.prototype[Symbol.dispose]=function(){this.dispose()},F.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function b(h,v){this.type=h,this.g=this.target=v,this.defaultPrevented=!1}b.prototype.h=function(){this.defaultPrevented=!0};var E=(function(){if(!o.addEventListener||!Object.defineProperty)return!1;var h=!1,v=Object.defineProperty({},"passive",{get:function(){h=!0}});try{const I=()=>{};o.addEventListener("test",I,v),o.removeEventListener("test",I,v)}catch{}return h})();function T(h){return/^[\s\xa0]*$/.test(h)}function J(h,v){b.call(this,h?h.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,h&&this.init(h,v)}g(J,b),J.prototype.init=function(h,v){const I=this.type=h.type,V=h.changedTouches&&h.changedTouches.length?h.changedTouches[0]:null;this.target=h.target||h.srcElement,this.g=v,v=h.relatedTarget,v||(I=="mouseover"?v=h.fromElement:I=="mouseout"&&(v=h.toElement)),this.relatedTarget=v,V?(this.clientX=V.clientX!==void 0?V.clientX:V.pageX,this.clientY=V.clientY!==void 0?V.clientY:V.pageY,this.screenX=V.screenX||0,this.screenY=V.screenY||0):(this.clientX=h.clientX!==void 0?h.clientX:h.pageX,this.clientY=h.clientY!==void 0?h.clientY:h.pageY,this.screenX=h.screenX||0,this.screenY=h.screenY||0),this.button=h.button,this.key=h.key||"",this.ctrlKey=h.ctrlKey,this.altKey=h.altKey,this.shiftKey=h.shiftKey,this.metaKey=h.metaKey,this.pointerId=h.pointerId||0,this.pointerType=h.pointerType,this.state=h.state,this.i=h,h.defaultPrevented&&J.Z.h.call(this)},J.prototype.h=function(){J.Z.h.call(this);const h=this.i;h.preventDefault?h.preventDefault():h.returnValue=!1};var fe="closure_listenable_"+(Math.random()*1e6|0),ye=0;function _e(h,v,I,V,ie){this.listener=h,this.proxy=null,this.src=v,this.type=I,this.capture=!!V,this.ha=ie,this.key=++ye,this.da=this.fa=!1}function ce(h){h.da=!0,h.listener=null,h.proxy=null,h.src=null,h.ha=null}function ve(h,v,I){for(const V in h)v.call(I,h[V],V,h)}function Oe(h,v){for(const I in h)v.call(void 0,h[I],I,h)}function xe(h){const v={};for(const I in h)v[I]=h[I];return v}const O="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function H(h,v){let I,V;for(let ie=1;ie<arguments.length;ie++){V=arguments[ie];for(I in V)h[I]=V[I];for(let he=0;he<O.length;he++)I=O[he],Object.prototype.hasOwnProperty.call(V,I)&&(h[I]=V[I])}}function Y(h){this.src=h,this.g={},this.h=0}Y.prototype.add=function(h,v,I,V,ie){const he=h.toString();h=this.g[he],h||(h=this.g[he]=[],this.h++);const De=te(h,v,V,ie);return De>-1?(v=h[De],I||(v.fa=!1)):(v=new _e(v,this.src,he,!!V,ie),v.fa=I,h.push(v)),v};function X(h,v){const I=v.type;if(I in h.g){var V=h.g[I],ie=Array.prototype.indexOf.call(V,v,void 0),he;(he=ie>=0)&&Array.prototype.splice.call(V,ie,1),he&&(ce(v),h.g[I].length==0&&(delete h.g[I],h.h--))}}function te(h,v,I,V){for(let ie=0;ie<h.length;++ie){const he=h[ie];if(!he.da&&he.listener==v&&he.capture==!!I&&he.ha==V)return ie}return-1}var ae="closure_lm_"+(Math.random()*1e6|0),ge={};function me(h,v,I,V,ie){if(Array.isArray(v)){for(let he=0;he<v.length;he++)me(h,v[he],I,V,ie);return null}return I=at(I),h&&h[fe]?h.J(v,I,a(V)?!!V.capture:!1,ie):Ee(h,v,I,!1,V,ie)}function Ee(h,v,I,V,ie,he){if(!v)throw Error("Invalid event type");const De=a(ie)?!!ie.capture:!!ie;let vt=Ve(h);if(vt||(h[ae]=vt=new Y(h)),I=vt.add(v,I,V,De,he),I.proxy)return I;if(V=Le(),I.proxy=V,V.src=h,V.listener=I,h.addEventListener)E||(ie=De),ie===void 0&&(ie=!1),h.addEventListener(v.toString(),V,ie);else if(h.attachEvent)h.attachEvent(tt(v.toString()),V);else if(h.addListener&&h.removeListener)h.addListener(V);else throw Error("addEventListener and attachEvent are unavailable.");return I}function Le(){function h(I){return v.call(h.src,h.listener,I)}const v=j;return h}function je(h,v,I,V,ie){if(Array.isArray(v))for(var he=0;he<v.length;he++)je(h,v[he],I,V,ie);else V=a(V)?!!V.capture:!!V,I=at(I),h&&h[fe]?(h=h.i,he=String(v).toString(),he in h.g&&(v=h.g[he],I=te(v,I,V,ie),I>-1&&(ce(v[I]),Array.prototype.splice.call(v,I,1),v.length==0&&(delete h.g[he],h.h--)))):h&&(h=Ve(h))&&(v=h.g[v.toString()],h=-1,v&&(h=te(v,I,V,ie)),(I=h>-1?v[h]:null)&&Ue(I))}function Ue(h){if(typeof h!="number"&&h&&!h.da){var v=h.src;if(v&&v[fe])X(v.i,h);else{var I=h.type,V=h.proxy;v.removeEventListener?v.removeEventListener(I,V,h.capture):v.detachEvent?v.detachEvent(tt(I),V):v.addListener&&v.removeListener&&v.removeListener(V),(I=Ve(v))?(X(I,h),I.h==0&&(I.src=null,v[ae]=null)):ce(h)}}}function tt(h){return h in ge?ge[h]:ge[h]="on"+h}function j(h,v){if(h.da)h=!0;else{v=new J(v,this);const I=h.listener,V=h.ha||h.src;h.fa&&Ue(h),h=I.call(V,v)}return h}function Ve(h){return h=h[ae],h instanceof Y?h:null}var bt="__closure_events_fn_"+(Math.random()*1e9>>>0);function at(h){return typeof h=="function"?h:(h[bt]||(h[bt]=function(v){return h.handleEvent(v)}),h[bt])}function Te(){F.call(this),this.i=new Y(this),this.M=this,this.G=null}g(Te,F),Te.prototype[fe]=!0,Te.prototype.removeEventListener=function(h,v,I,V){je(this,h,v,I,V)};function $e(h,v){var I,V=h.G;if(V)for(I=[];V;V=V.G)I.push(V);if(h=h.M,V=v.type||v,typeof v=="string")v=new b(v,h);else if(v instanceof b)v.target=v.target||h;else{var ie=v;v=new b(V,h),H(v,ie)}ie=!0;let he,De;if(I)for(De=I.length-1;De>=0;De--)he=v.g=I[De],ie=ze(he,V,!0,v)&&ie;if(he=v.g=h,ie=ze(he,V,!0,v)&&ie,ie=ze(he,V,!1,v)&&ie,I)for(De=0;De<I.length;De++)he=v.g=I[De],ie=ze(he,V,!1,v)&&ie}Te.prototype.N=function(){if(Te.Z.N.call(this),this.i){var h=this.i;for(const v in h.g){const I=h.g[v];for(let V=0;V<I.length;V++)ce(I[V]);delete h.g[v],h.h--}}this.G=null},Te.prototype.J=function(h,v,I,V){return this.i.add(String(h),v,!1,I,V)},Te.prototype.K=function(h,v,I,V){return this.i.add(String(h),v,!0,I,V)};function ze(h,v,I,V){if(v=h.i.g[String(v)],!v)return!0;v=v.concat();let ie=!0;for(let he=0;he<v.length;++he){const De=v[he];if(De&&!De.da&&De.capture==I){const vt=De.listener,fn=De.ha||De.src;De.fa&&X(h.i,De),ie=vt.call(fn,V)!==!1&&ie}}return ie&&!V.defaultPrevented}function ct(h,v){if(typeof h!="function")if(h&&typeof h.handleEvent=="function")h=u(h.handleEvent,h);else throw Error("Invalid listener argument");return Number(v)>2147483647?-1:o.setTimeout(h,v||0)}function it(h){h.g=ct(()=>{h.g=null,h.i&&(h.i=!1,it(h))},h.l);const v=h.h;h.h=null,h.m.apply(null,v)}class $t extends F{constructor(v,I){super(),this.m=v,this.l=I,this.h=null,this.i=!1,this.g=null}j(v){this.h=arguments,this.g?this.i=!0:it(this)}N(){super.N(),this.g&&(o.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function Pt(h){F.call(this),this.h=h,this.g={}}g(Pt,F);var _t=[];function Lt(h){ve(h.g,function(v,I){this.g.hasOwnProperty(I)&&Ue(v)},h),h.g={}}Pt.prototype.N=function(){Pt.Z.N.call(this),Lt(this)},Pt.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var kt=o.JSON.stringify,Je=o.JSON.parse,It=class{stringify(h){return o.JSON.stringify(h,void 0)}parse(h){return o.JSON.parse(h,void 0)}};function Ze(){}function An(){}var Ct={OPEN:"a",hb:"b",ERROR:"c",tb:"d"};function Et(){b.call(this,"d")}g(Et,b);function Tt(){b.call(this,"c")}g(Tt,b);var Wt={},st=null;function Kt(){return st=st||new Te}Wt.Ia="serverreachability";function ht(h){b.call(this,Wt.Ia,h)}g(ht,b);function gt(h){const v=Kt();$e(v,new ht(v))}Wt.STAT_EVENT="statevent";function rn(h,v){b.call(this,Wt.STAT_EVENT,h),this.stat=v}g(rn,b);function ut(h){const v=Kt();$e(v,new rn(v,h))}Wt.Ja="timingevent";function lt(h,v){b.call(this,Wt.Ja,h),this.size=v}g(lt,b);function Ft(h,v){if(typeof h!="function")throw Error("Fn must not be null and must be a function");return o.setTimeout(function(){h()},v)}function fi(){this.g=!0}fi.prototype.ua=function(){this.g=!1};function ir(h,v,I,V,ie,he){h.info(function(){if(h.g)if(he){var De="",vt=he.split("&");for(let Vt=0;Vt<vt.length;Vt++){var fn=vt[Vt].split("=");if(fn.length>1){const pn=fn[0];fn=fn[1];const or=pn.split("_");De=or.length>=2&&or[1]=="type"?De+(pn+"="+fn+"&"):De+(pn+"=redacted&")}}}else De=null;else De=he;return"XMLHTTP REQ ("+V+") [attempt "+ie+"]: "+v+`
`+I+`
`+De})}function Gi(h,v,I,V,ie,he,De){h.info(function(){return"XMLHTTP RESP ("+V+") [ attempt "+ie+"]: "+v+`
`+I+`
`+he+" "+De})}function dr(h,v,I,V){h.info(function(){return"XMLHTTP TEXT ("+v+"): "+Ki(h,I)+(V?" "+V:"")})}function dt(h,v){h.info(function(){return"TIMEOUT: "+v})}fi.prototype.info=function(){};function Ki(h,v){if(!h.g)return v;if(!v)return null;try{const he=JSON.parse(v);if(he){for(h=0;h<he.length;h++)if(Array.isArray(he[h])){var I=he[h];if(!(I.length<2)){var V=I[1];if(Array.isArray(V)&&!(V.length<1)){var ie=V[0];if(ie!="noop"&&ie!="stop"&&ie!="close")for(let De=1;De<V.length;De++)V[De]=""}}}}return kt(he)}catch{return v}}var Jr={NO_ERROR:0,cb:1,qb:2,pb:3,kb:4,ob:5,rb:6,Ga:7,TIMEOUT:8,ub:9},Lr={ib:"complete",Fb:"success",ERROR:"error",Ga:"abort",xb:"ready",yb:"readystatechange",TIMEOUT:"timeout",sb:"incrementaldata",wb:"progress",lb:"downloadprogress",Nb:"uploadprogress"},Dr;function un(){}g(un,Ze),un.prototype.g=function(){return new XMLHttpRequest},Dr=new un;function En(h){return encodeURIComponent(String(h))}function Qn(h){var v=1;h=h.split(":");const I=[];for(;v>0&&h.length;)I.push(h.shift()),v--;return h.length&&I.push(h.join(":")),I}function wr(h,v,I,V){this.j=h,this.i=v,this.l=I,this.S=V||1,this.V=new Pt(this),this.H=45e3,this.J=null,this.o=!1,this.u=this.B=this.A=this.M=this.F=this.T=this.D=null,this.G=[],this.g=null,this.C=0,this.m=this.v=null,this.X=-1,this.K=!1,this.P=0,this.O=null,this.W=this.L=this.U=this.R=!1,this.h=new Yi}function Yi(){this.i=null,this.g="",this.h=!1}var Qr={},Xr={};function Or(h,v,I){h.M=1,h.A=Xs(ti(v)),h.u=I,h.R=!0,Zr(h,null)}function Zr(h,v){h.F=Date.now(),ki(h),h.B=ti(h.A);var I=h.B,V=h.S;Array.isArray(V)||(V=[String(V)]),qc(I.i,"t",V),h.C=0,I=h.j.L,h.h=new Yi,h.g=We(h.j,I?v:null,!h.u),h.P>0&&(h.O=new $t(u(h.Y,h,h.g),h.P)),v=h.V,I=h.g,V=h.ba;var ie="readystatechange";Array.isArray(ie)||(ie&&(_t[0]=ie.toString()),ie=_t);for(let he=0;he<ie.length;he++){const De=me(I,ie[he],V||v.handleEvent,!1,v.h||v);if(!De)break;v.g[De.key]=De}v=h.J?xe(h.J):{},h.u?(h.v||(h.v="POST"),v["Content-Type"]="application/x-www-form-urlencoded",h.g.ea(h.B,h.v,h.u,v)):(h.v="GET",h.g.ea(h.B,h.v,null,v)),gt(),ir(h.i,h.v,h.B,h.l,h.S,h.u)}wr.prototype.ba=function(h){h=h.target;const v=this.O;v&&si(h)==3?v.j():this.Y(h)},wr.prototype.Y=function(h){try{if(h==this.g)e:{const vt=si(this.g),fn=this.g.ya(),Vt=this.g.ca();if(!(vt<3)&&(vt!=3||this.g&&(this.h.h||this.g.la()||Oo(this.g)))){this.K||vt!=4||fn==7||(fn==8||Vt<=0?gt(3):gt(2)),ms(this);var v=this.g.ca();this.X=v;var I=ei(this);if(this.o=v==200,Gi(this.i,this.v,this.B,this.l,this.S,vt,v),this.o){if(this.U&&!this.L){t:{if(this.g){var V,ie=this.g;if((V=ie.g?ie.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!T(V)){var he=V;break t}}he=null}if(h=he)dr(this.i,this.l,h,"Initial handshake response via X-HTTP-Initial-Response"),this.L=!0,Js(this,h);else{this.o=!1,this.m=3,ut(12),Ji(this),Ci(this);break e}}if(this.R){h=!0;let pn;for(;!this.K&&this.C<I.length;)if(pn=Ni(this,I),pn==Xr){vt==4&&(this.m=4,ut(14),h=!1),dr(this.i,this.l,null,"[Incomplete Response]");break}else if(pn==Qr){this.m=4,ut(15),dr(this.i,this.l,I,"[Invalid Chunk]"),h=!1;break}else dr(this.i,this.l,pn,null),Js(this,pn);if(gs(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),vt!=4||I.length!=0||this.h.h||(this.m=1,ut(16),h=!1),this.o=this.o&&h,!h)dr(this.i,this.l,I,"[Invalid Chunked Response]"),Ji(this),Ci(this);else if(I.length>0&&!this.W){this.W=!0;var De=this.j;De.g==this&&De.aa&&!De.P&&(De.j.info("Great, no buffering proxy detected. Bytes received: "+I.length),Mo(De),De.P=!0,ut(11))}}else dr(this.i,this.l,I,null),Js(this,I);vt==4&&Ji(this),this.o&&!this.K&&(vt==4?q(this.j,this):(this.o=!1,ki(this)))}else Wc(this.g),v==400&&I.indexOf("Unknown SID")>0?(this.m=3,ut(12)):(this.m=0,ut(13)),Ji(this),Ci(this)}}}catch{}};function ei(h){if(!gs(h))return h.g.la();const v=Oo(h.g);if(v==="")return"";let I="";const V=v.length,ie=si(h.g)==4;if(!h.h.i){if(typeof TextDecoder>"u")return Ji(h),Ci(h),"";h.h.i=new o.TextDecoder}for(let he=0;he<V;he++)h.h.h=!0,I+=h.h.i.decode(v[he],{stream:!(ie&&he==V-1)});return v.length=0,h.h.g+=I,h.C=0,h.h.g}function gs(h){return h.g?h.v=="GET"&&h.M!=2&&h.j.Aa:!1}function Ni(h,v){var I=h.C,V=v.indexOf(`
`,I);return V==-1?Xr:(I=Number(v.substring(I,V)),isNaN(I)?Qr:(V+=1,V+I>v.length?Xr:(v=v.slice(V,V+I),h.C=V+I,v)))}wr.prototype.cancel=function(){this.K=!0,Ji(this)};function ki(h){h.T=Date.now()+h.H,Ys(h,h.H)}function Ys(h,v){if(h.D!=null)throw Error("WatchDog timer not null");h.D=Ft(u(h.aa,h),v)}function ms(h){h.D&&(o.clearTimeout(h.D),h.D=null)}wr.prototype.aa=function(){this.D=null;const h=Date.now();h-this.T>=0?(dt(this.i,this.B),this.M!=2&&(gt(),ut(17)),Ji(this),this.m=2,Ci(this)):Ys(this,this.T-h)};function Ci(h){h.j.I==0||h.K||q(h.j,h)}function Ji(h){ms(h);var v=h.O;v&&typeof v.dispose=="function"&&v.dispose(),h.O=null,Lt(h.V),h.g&&(v=h.g,h.g=null,v.abort(),v.dispose())}function Js(h,v){try{var I=h.j;if(I.I!=0&&(I.g==h||No(I.h,h))){if(!h.L&&No(I.h,h)&&I.I==3){try{var V=I.Ba.g.parse(v)}catch{V=null}if(Array.isArray(V)&&V.length==3){var ie=V;if(ie[0]==0){e:if(!I.v){if(I.g)if(I.g.F+3e3<h.F)P(I),Is(I);else break e;Zi(I),ut(18)}}else I.xa=ie[1],0<I.xa-I.K&&ie[2]<37500&&I.F&&I.A==0&&!I.C&&(I.C=Ft(u(I.Va,I),6e3));Ro(I.h)<=1&&I.ta&&(I.ta=void 0)}else re(I,11)}else if((h.L||I.g==h)&&P(I),!T(v))for(ie=I.Ba.g.parse(v),v=0;v<ie.length;v++){let Vt=ie[v];const pn=Vt[0];if(!(pn<=I.K))if(I.K=pn,Vt=Vt[1],I.I==2)if(Vt[0]=="c"){I.M=Vt[1],I.ba=Vt[2];const or=Vt[3];or!=null&&(I.ka=or,I.j.info("VER="+I.ka));const br=Vt[4];br!=null&&(I.za=br,I.j.info("SVER="+I.za));const gn=Vt[5];gn!=null&&typeof gn=="number"&&gn>0&&(V=1.5*gn,I.O=V,I.j.info("backChannelRequestTimeoutMs_="+V)),V=I;const Ir=h.g;if(Ir){const Vi=Ir.g?Ir.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(Vi){var he=V.h;he.g||Vi.indexOf("spdy")==-1&&Vi.indexOf("quic")==-1&&Vi.indexOf("h2")==-1||(he.j=he.l,he.g=new Set,he.h&&(Qs(he,he.h),he.h=null))}if(V.G){const to=Ir.g?Ir.g.getResponseHeader("X-HTTP-Session-Id"):null;to&&(V.wa=to,Ht(V.J,V.G,to))}}I.I=3,I.l&&I.l.ra(),I.aa&&(I.T=Date.now()-h.F,I.j.info("Handshake RTT: "+I.T+"ms")),V=I;var De=h;if(V.na=Se(V,V.L?V.ba:null,V.W),De.L){Oa(V.h,De);var vt=De,fn=V.O;fn&&(vt.H=fn),vt.D&&(ms(vt),ki(vt)),V.g=De}else qa(V);I.i.length>0&&Es(I)}else Vt[0]!="stop"&&Vt[0]!="close"||re(I,7);else I.I==3&&(Vt[0]=="stop"||Vt[0]=="close"?Vt[0]=="stop"?re(I,7):bs(I):Vt[0]!="noop"&&I.l&&I.l.qa(Vt),I.A=0)}}gt(4)}catch{}}var Vc=class{constructor(h,v){this.g=h,this.map=v}};function Da(h){this.l=h||10,o.PerformanceNavigationTiming?(h=o.performance.getEntriesByType("navigation"),h=h.length>0&&(h[0].nextHopProtocol=="hq"||h[0].nextHopProtocol=="h2")):h=!!(o.chrome&&o.chrome.loadTimes&&o.chrome.loadTimes()&&o.chrome.loadTimes().wasFetchedViaSpdy),this.j=h?this.l:1,this.g=null,this.j>1&&(this.g=new Set),this.h=null,this.i=[]}function Fr(h){return h.h?!0:h.g?h.g.size>=h.j:!1}function Ro(h){return h.h?1:h.g?h.g.size:0}function No(h,v){return h.h?h.h==v:h.g?h.g.has(v):!1}function Qs(h,v){h.g?h.g.add(v):h.h=v}function Oa(h,v){h.h&&h.h==v?h.h=null:h.g&&h.g.has(v)&&h.g.delete(v)}Da.prototype.cancel=function(){if(this.i=Fa(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const h of this.g.values())h.cancel();this.g.clear()}};function Fa(h){if(h.h!=null)return h.i.concat(h.h.G);if(h.g!=null&&h.g.size!==0){let v=h.i;for(const I of h.g.values())v=v.concat(I.G);return v}return p(h.i)}var Ma=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function Li(h,v){if(h){h=h.split("&");for(let I=0;I<h.length;I++){const V=h[I].indexOf("=");let ie,he=null;V>=0?(ie=h[I].substring(0,V),he=h[I].substring(V+1)):ie=h[I],v(ie,he?decodeURIComponent(he.replace(/\+/g," ")):"")}}}function Mr(h){this.g=this.o=this.j="",this.u=null,this.m=this.h="",this.l=!1;let v;h instanceof Mr?(this.l=h.l,ln(this,h.j),this.o=h.o,this.g=h.g,ys(this,h.u),this.h=h.h,ni(this,ko(h.i)),this.m=h.m):h&&(v=String(h).match(Ma))?(this.l=!1,ln(this,v[1]||"",!0),this.o=sr(v[2]||""),this.g=sr(v[3]||"",!0),ys(this,v[4]),this.h=sr(v[5]||"",!0),ni(this,v[6]||"",!0),this.m=sr(v[7]||"")):(this.l=!1,this.i=new _s(null,this.l))}Mr.prototype.toString=function(){const h=[];var v=this.j;v&&h.push(vn(v,Va,!0),":");var I=this.g;return(I||v=="file")&&(h.push("//"),(v=this.o)&&h.push(vn(v,Va,!0),"@"),h.push(En(I).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),I=this.u,I!=null&&h.push(":",String(I))),(I=this.h)&&(this.g&&I.charAt(0)!="/"&&h.push("/"),h.push(vn(I,I.charAt(0)=="/"?pl:fl,!0))),(I=this.i.toString())&&h.push("?",I),(I=this.m)&&h.push("#",vn(I,Bc)),h.join("")},Mr.prototype.resolve=function(h){const v=ti(this);let I=!!h.j;I?ln(v,h.j):I=!!h.o,I?v.o=h.o:I=!!h.g,I?v.g=h.g:I=h.u!=null;var V=h.h;if(I)ys(v,h.u);else if(I=!!h.h){if(V.charAt(0)!="/")if(this.g&&!this.h)V="/"+V;else{var ie=v.h.lastIndexOf("/");ie!=-1&&(V=v.h.slice(0,ie+1)+V)}if(ie=V,ie==".."||ie==".")V="";else if(ie.indexOf("./")!=-1||ie.indexOf("/.")!=-1){V=ie.lastIndexOf("/",0)==0,ie=ie.split("/");const he=[];for(let De=0;De<ie.length;){const vt=ie[De++];vt=="."?V&&De==ie.length&&he.push(""):vt==".."?((he.length>1||he.length==1&&he[0]!="")&&he.pop(),V&&De==ie.length&&he.push("")):(he.push(vt),V=!0)}V=he.join("/")}else V=ie}return I?v.h=V:I=h.i.toString()!=="",I?ni(v,ko(h.i)):I=!!h.m,I&&(v.m=h.m),v};function ti(h){return new Mr(h)}function ln(h,v,I){h.j=I?sr(v,!0):v,h.j&&(h.j=h.j.replace(/:$/,""))}function ys(h,v){if(v){if(v=Number(v),isNaN(v)||v<0)throw Error("Bad port number "+v);h.u=v}else h.u=null}function ni(h,v,I){v instanceof _s?(h.i=v,pi(h.i,h.l)):(I||(v=vn(v,Di)),h.i=new _s(v,h.l))}function Ht(h,v,I){h.i.set(v,I)}function Xs(h){return Ht(h,"zx",Math.floor(Math.random()*2147483648).toString(36)+Math.abs(Math.floor(Math.random()*2147483648)^Date.now()).toString(36)),h}function sr(h,v){return h?v?decodeURI(h.replace(/%25/g,"%2525")):decodeURIComponent(h):""}function vn(h,v,I){return typeof h=="string"?(h=encodeURI(h).replace(v,Qi),I&&(h=h.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),h):null}function Qi(h){return h=h.charCodeAt(0),"%"+(h>>4&15).toString(16)+(h&15).toString(16)}var Va=/[#\/\?@]/g,fl=/[#\?:]/g,pl=/[#\?]/g,Di=/[#\?@]/g,Bc=/#/g;function _s(h,v){this.h=this.g=null,this.i=h||null,this.j=!!v}function ri(h){h.g||(h.g=new Map,h.h=0,h.i&&Li(h.i,function(v,I){h.add(decodeURIComponent(v.replace(/\+/g," ")),I)}))}n=_s.prototype,n.add=function(h,v){ri(this),this.i=null,h=Xi(this,h);let I=this.g.get(h);return I||this.g.set(h,I=[]),I.push(v),this.h+=1,this};function vs(h,v){ri(h),v=Xi(h,v),h.g.has(v)&&(h.i=null,h.h-=h.g.get(v).length,h.g.delete(v))}function Uc(h,v){return ri(h),v=Xi(h,v),h.g.has(v)}n.forEach=function(h,v){ri(this),this.g.forEach(function(I,V){I.forEach(function(ie){h.call(v,ie,V,this)},this)},this)};function jc(h,v){ri(h);let I=[];if(typeof v=="string")Uc(h,v)&&(I=I.concat(h.g.get(Xi(h,v))));else for(h=Array.from(h.g.values()),v=0;v<h.length;v++)I=I.concat(h[v]);return I}n.set=function(h,v){return ri(this),this.i=null,h=Xi(this,h),Uc(this,h)&&(this.h-=this.g.get(h).length),this.g.set(h,[v]),this.h+=1,this},n.get=function(h,v){return h?(h=jc(this,h),h.length>0?String(h[0]):v):v};function qc(h,v,I){vs(h,v),I.length>0&&(h.i=null,h.g.set(Xi(h,v),p(I)),h.h+=I.length)}n.toString=function(){if(this.i)return this.i;if(!this.g)return"";const h=[],v=Array.from(this.g.keys());for(let V=0;V<v.length;V++){var I=v[V];const ie=En(I);I=jc(this,I);for(let he=0;he<I.length;he++){let De=ie;I[he]!==""&&(De+="="+En(I[he])),h.push(De)}}return this.i=h.join("&")};function ko(h){const v=new _s;return v.i=h.i,h.g&&(v.g=new Map(h.g),v.h=h.h),v}function Xi(h,v){return v=String(v),h.j&&(v=v.toLowerCase()),v}function pi(h,v){v&&!h.j&&(ri(h),h.i=null,h.g.forEach(function(I,V){const ie=V.toLowerCase();V!=ie&&(vs(this,V),qc(this,ie,I))},h)),h.j=v}function gl(h,v){const I=new fi;if(o.Image){const V=new Image;V.onload=d(ii,I,"TestLoadImage: loaded",!0,v,V),V.onerror=d(ii,I,"TestLoadImage: error",!1,v,V),V.onabort=d(ii,I,"TestLoadImage: abort",!1,v,V),V.ontimeout=d(ii,I,"TestLoadImage: timeout",!1,v,V),o.setTimeout(function(){V.ontimeout&&V.ontimeout()},1e4),V.src=h}else v(!1)}function Zs(h,v){const I=new fi,V=new AbortController,ie=setTimeout(()=>{V.abort(),ii(I,"TestPingServer: timeout",!1,v)},1e4);fetch(h,{signal:V.signal}).then(he=>{clearTimeout(ie),he.ok?ii(I,"TestPingServer: ok",!0,v):ii(I,"TestPingServer: server error",!1,v)}).catch(()=>{clearTimeout(ie),ii(I,"TestPingServer: error",!1,v)})}function ii(h,v,I,V,ie){try{ie&&(ie.onload=null,ie.onerror=null,ie.onabort=null,ie.ontimeout=null),V(I)}catch{}}function ml(){this.g=new It}function mt(h){this.i=h.Sb||null,this.h=h.ab||!1}g(mt,Ze),mt.prototype.g=function(){return new Co(this.i,this.h)};function Co(h,v){Te.call(this),this.H=h,this.o=v,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.A=new Headers,this.h=null,this.F="GET",this.D="",this.g=!1,this.B=this.j=this.l=null,this.v=new AbortController}g(Co,Te),n=Co.prototype,n.open=function(h,v){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.F=h,this.D=v,this.readyState=1,Vr(this)},n.send=function(h){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");if(this.v.signal.aborted)throw this.abort(),Error("Request was aborted.");this.g=!0;const v={headers:this.A,method:this.F,credentials:this.m,cache:void 0,signal:this.v.signal};h&&(v.body=h),(this.H||o).fetch(new Request(this.D,v)).then(this.Pa.bind(this),this.ga.bind(this))},n.abort=function(){this.response=this.responseText="",this.A=new Headers,this.status=0,this.v.abort(),this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),this.readyState>=1&&this.g&&this.readyState!=4&&(this.g=!1,eo(this)),this.readyState=0},n.Pa=function(h){if(this.g&&(this.l=h,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=h.headers,this.readyState=2,Vr(this)),this.g&&(this.readyState=3,Vr(this),this.g)))if(this.responseType==="arraybuffer")h.arrayBuffer().then(this.Na.bind(this),this.ga.bind(this));else if(typeof o.ReadableStream<"u"&&"body"in h){if(this.j=h.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.B=new TextDecoder;zc(this)}else h.text().then(this.Oa.bind(this),this.ga.bind(this))};function zc(h){h.j.read().then(h.Ma.bind(h)).catch(h.ga.bind(h))}n.Ma=function(h){if(this.g){if(this.o&&h.value)this.response.push(h.value);else if(!this.o){var v=h.value?h.value:new Uint8Array(0);(v=this.B.decode(v,{stream:!h.done}))&&(this.response=this.responseText+=v)}h.done?eo(this):Vr(this),this.readyState==3&&zc(this)}},n.Oa=function(h){this.g&&(this.response=this.responseText=h,eo(this))},n.Na=function(h){this.g&&(this.response=h,eo(this))},n.ga=function(){this.g&&eo(this)};function eo(h){h.readyState=4,h.l=null,h.j=null,h.B=null,Vr(h)}n.setRequestHeader=function(h,v){this.A.append(h,v)},n.getResponseHeader=function(h){return this.h&&this.h.get(h.toLowerCase())||""},n.getAllResponseHeaders=function(){if(!this.h)return"";const h=[],v=this.h.entries();for(var I=v.next();!I.done;)I=I.value,h.push(I[0]+": "+I[1]),I=v.next();return h.join(`\r
`)};function Vr(h){h.onreadystatechange&&h.onreadystatechange.call(h)}Object.defineProperty(Co.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(h){this.m=h?"include":"same-origin"}});function Oi(h){let v="";return ve(h,function(I,V){v+=V,v+=":",v+=I,v+=`\r
`}),v}function Ba(h,v,I){e:{for(V in I){var V=!1;break e}V=!0}V||(I=Oi(I),typeof h=="string"?I!=null&&En(I):Ht(h,v,I))}function hn(h){Te.call(this),this.headers=new Map,this.L=h||null,this.h=!1,this.g=null,this.D="",this.o=0,this.l="",this.j=this.B=this.v=this.A=!1,this.m=null,this.F="",this.H=!1}g(hn,Te);var Lo=/^https?$/i,Ua=["POST","PUT"];n=hn.prototype,n.Fa=function(h){this.H=h},n.ea=function(h,v,I,V){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+h);v=v?v.toUpperCase():"GET",this.D=h,this.l="",this.o=0,this.A=!1,this.h=!0,this.g=this.L?this.L.g():Dr.g(),this.g.onreadystatechange=y(u(this.Ca,this));try{this.B=!0,this.g.open(v,String(h),!0),this.B=!1}catch(he){ws(this,he);return}if(h=I||"",I=new Map(this.headers),V)if(Object.getPrototypeOf(V)===Object.prototype)for(var ie in V)I.set(ie,V[ie]);else if(typeof V.keys=="function"&&typeof V.get=="function")for(const he of V.keys())I.set(he,V.get(he));else throw Error("Unknown input type for opt_headers: "+String(V));V=Array.from(I.keys()).find(he=>he.toLowerCase()=="content-type"),ie=o.FormData&&h instanceof o.FormData,!(Array.prototype.indexOf.call(Ua,v,void 0)>=0)||V||ie||I.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[he,De]of I)this.g.setRequestHeader(he,De);this.F&&(this.g.responseType=this.F),"withCredentials"in this.g&&this.g.withCredentials!==this.H&&(this.g.withCredentials=this.H);try{this.m&&(clearTimeout(this.m),this.m=null),this.v=!0,this.g.send(h),this.v=!1}catch(he){ws(this,he)}};function ws(h,v){h.h=!1,h.g&&(h.j=!0,h.g.abort(),h.j=!1),h.l=v,h.o=5,$c(h),Do(h)}function $c(h){h.A||(h.A=!0,$e(h,"complete"),$e(h,"error"))}n.abort=function(h){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.o=h||7,$e(this,"complete"),$e(this,"abort"),Do(this))},n.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),Do(this,!0)),hn.Z.N.call(this)},n.Ca=function(){this.u||(this.B||this.v||this.j?Fi(this):this.Xa())},n.Xa=function(){Fi(this)};function Fi(h){if(h.h&&typeof s<"u"){if(h.v&&si(h)==4)setTimeout(h.Ca.bind(h),0);else if($e(h,"readystatechange"),si(h)==4){h.h=!1;try{const he=h.ca();e:switch(he){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var v=!0;break e;default:v=!1}var I;if(!(I=v)){var V;if(V=he===0){let De=String(h.D).match(Ma)[1]||null;!De&&o.self&&o.self.location&&(De=o.self.location.protocol.slice(0,-1)),V=!Lo.test(De?De.toLowerCase():"")}I=V}if(I)$e(h,"complete"),$e(h,"success");else{h.o=6;try{var ie=si(h)>2?h.g.statusText:""}catch{ie=""}h.l=ie+" ["+h.ca()+"]",$c(h)}}finally{Do(h)}}}}function Do(h,v){if(h.g){h.m&&(clearTimeout(h.m),h.m=null);const I=h.g;h.g=null,v||$e(h,"ready");try{I.onreadystatechange=null}catch{}}}n.isActive=function(){return!!this.g};function si(h){return h.g?h.g.readyState:0}n.ca=function(){try{return si(this)>2?this.g.status:-1}catch{return-1}},n.la=function(){try{return this.g?this.g.responseText:""}catch{return""}},n.La=function(h){if(this.g){var v=this.g.responseText;return h&&v.indexOf(h)==0&&(v=v.substring(h.length)),Je(v)}};function Oo(h){try{if(!h.g)return null;if("response"in h.g)return h.g.response;switch(h.F){case"":case"text":return h.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in h.g)return h.g.mozResponseArrayBuffer}return null}catch{return null}}function Wc(h){const v={};h=(h.g&&si(h)>=2&&h.g.getAllResponseHeaders()||"").split(`\r
`);for(let V=0;V<h.length;V++){if(T(h[V]))continue;var I=Qn(h[V]);const ie=I[0];if(I=I[1],typeof I!="string")continue;I=I.trim();const he=v[ie]||[];v[ie]=he,he.push(I)}Oe(v,function(V){return V.join(", ")})}n.ya=function(){return this.o},n.Ha=function(){return typeof this.l=="string"?this.l:String(this.l)};function Br(h,v,I){return I&&I.internalChannelParams&&I.internalChannelParams[h]||v}function Fo(h){this.za=0,this.i=[],this.j=new fi,this.ba=this.na=this.J=this.W=this.g=this.wa=this.G=this.H=this.u=this.U=this.o=null,this.Ya=this.V=0,this.Sa=Br("failFast",!1,h),this.F=this.C=this.v=this.m=this.l=null,this.X=!0,this.xa=this.K=-1,this.Y=this.A=this.D=0,this.Qa=Br("baseRetryDelayMs",5e3,h),this.Za=Br("retryDelaySeedMs",1e4,h),this.Ta=Br("forwardChannelMaxRetries",2,h),this.va=Br("forwardChannelRequestTimeoutMs",2e4,h),this.ma=h&&h.xmlHttpFactory||void 0,this.Ua=h&&h.Rb||void 0,this.Aa=h&&h.useFetchStreams||!1,this.O=void 0,this.L=h&&h.supportsCrossDomainXhr||!1,this.M="",this.h=new Da(h&&h.concurrentRequestLimit),this.Ba=new ml,this.S=h&&h.fastHandshake||!1,this.R=h&&h.encodeInitMessageHeaders||!1,this.S&&this.R&&(this.R=!1),this.Ra=h&&h.Pb||!1,h&&h.ua&&this.j.ua(),h&&h.forceLongPolling&&(this.X=!1),this.aa=!this.S&&this.X&&h&&h.detectBufferingProxy||!1,this.ia=void 0,h&&h.longPollingTimeout&&h.longPollingTimeout>0&&(this.ia=h.longPollingTimeout),this.ta=void 0,this.T=0,this.P=!1,this.ja=this.B=null}n=Fo.prototype,n.ka=8,n.I=1,n.connect=function(h,v,I,V){ut(0),this.W=h,this.H=v||{},I&&V!==void 0&&(this.H.OSID=I,this.H.OAID=V),this.F=this.X,this.J=Se(this,null,this.W),Es(this)};function bs(h){if(As(h),h.I==3){var v=h.V++,I=ti(h.J);if(Ht(I,"SID",h.M),Ht(I,"RID",v),Ht(I,"TYPE","terminate"),Ur(h,I),v=new wr(h,h.j,v),v.M=2,v.A=Xs(ti(I)),I=!1,o.navigator&&o.navigator.sendBeacon)try{I=o.navigator.sendBeacon(v.A.toString(),"")}catch{}!I&&o.Image&&(new Image().src=v.A,I=!0),I||(v.g=We(v.j,null),v.g.ea(v.A)),v.F=Date.now(),ki(v)}be(h)}function Is(h){h.g&&(Mo(h),h.g.cancel(),h.g=null)}function As(h){Is(h),h.v&&(o.clearTimeout(h.v),h.v=null),P(h),h.h.cancel(),h.m&&(typeof h.m=="number"&&o.clearTimeout(h.m),h.m=null)}function Es(h){if(!Fr(h.h)&&!h.m){h.m=!0;var v=h.Ea;ne||x(),de||(ne(),de=!0),B.add(v,h),h.D=0}}function Hc(h,v){return Ro(h.h)>=h.h.j-(h.m?1:0)?!1:h.m?(h.i=v.G.concat(h.i),!0):h.I==1||h.I==2||h.D>=(h.Sa?0:h.Ta)?!1:(h.m=Ft(u(h.Ea,h,v),Q(h,h.D)),h.D++,!0)}n.Ea=function(h){if(this.m)if(this.m=null,this.I==1){if(!h){this.V=Math.floor(Math.random()*1e5),h=this.V++;const ie=new wr(this,this.j,h);let he=this.o;if(this.U&&(he?(he=xe(he),H(he,this.U)):he=this.U),this.u!==null||this.R||(ie.J=he,he=null),this.S)e:{for(var v=0,I=0;I<this.i.length;I++){t:{var V=this.i[I];if("__data__"in V.map&&(V=V.map.__data__,typeof V=="string")){V=V.length;break t}V=void 0}if(V===void 0)break;if(v+=V,v>4096){v=I;break e}if(v===4096||I===this.i.length-1){v=I+1;break e}}v=1e3}else v=1e3;v=Mi(this,ie,v),I=ti(this.J),Ht(I,"RID",h),Ht(I,"CVER",22),this.G&&Ht(I,"X-HTTP-Session-Id",this.G),Ur(this,I),he&&(this.R?v="headers="+En(Oi(he))+"&"+v:this.u&&Ba(I,this.u,he)),Qs(this.h,ie),this.Ra&&Ht(I,"TYPE","init"),this.S?(Ht(I,"$req",v),Ht(I,"SID","null"),ie.U=!0,Or(ie,I,null)):Or(ie,I,v),this.I=2}}else this.I==3&&(h?ja(this,h):this.i.length==0||Fr(this.h)||ja(this))};function ja(h,v){var I;v?I=v.l:I=h.V++;const V=ti(h.J);Ht(V,"SID",h.M),Ht(V,"RID",I),Ht(V,"AID",h.K),Ur(h,V),h.u&&h.o&&Ba(V,h.u,h.o),I=new wr(h,h.j,I,h.D+1),h.u===null&&(I.J=h.o),v&&(h.i=v.G.concat(h.i)),v=Mi(h,I,1e3),I.H=Math.round(h.va*.5)+Math.round(h.va*.5*Math.random()),Qs(h.h,I),Or(I,V,v)}function Ur(h,v){h.H&&ve(h.H,function(I,V){Ht(v,V,I)}),h.l&&ve({},function(I,V){Ht(v,V,I)})}function Mi(h,v,I){I=Math.min(h.i.length,I);const V=h.l?u(h.l.Ka,h.l,h):null;e:{var ie=h.i;let vt=-1;for(;;){const fn=["count="+I];vt==-1?I>0?(vt=ie[0].g,fn.push("ofs="+vt)):vt=0:fn.push("ofs="+vt);let Vt=!0;for(let pn=0;pn<I;pn++){var he=ie[pn].g;const or=ie[pn].map;if(he-=vt,he<0)vt=Math.max(0,ie[pn].g-100),Vt=!1;else try{he="req"+he+"_"||"";try{var De=or instanceof Map?or:Object.entries(or);for(const[br,gn]of De){let Ir=gn;a(gn)&&(Ir=kt(gn)),fn.push(he+br+"="+encodeURIComponent(Ir))}}catch(br){throw fn.push(he+"type="+encodeURIComponent("_badmap")),br}}catch{V&&V(or)}}if(Vt){De=fn.join("&");break e}}De=void 0}return h=h.i.splice(0,I),v.G=h,De}function qa(h){if(!h.g&&!h.v){h.Y=1;var v=h.Da;ne||x(),de||(ne(),de=!0),B.add(v,h),h.A=0}}function Zi(h){return h.g||h.v||h.A>=3?!1:(h.Y++,h.v=Ft(u(h.Da,h),Q(h,h.A)),h.A++,!0)}n.Da=function(){if(this.v=null,m(this),this.aa&&!(this.P||this.g==null||this.T<=0)){var h=4*this.T;this.j.info("BP detection timer enabled: "+h),this.B=Ft(u(this.Wa,this),h)}},n.Wa=function(){this.B&&(this.B=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.P=!0,ut(10),Is(this),m(this))};function Mo(h){h.B!=null&&(o.clearTimeout(h.B),h.B=null)}function m(h){h.g=new wr(h,h.j,"rpc",h.Y),h.u===null&&(h.g.J=h.o),h.g.P=0;var v=ti(h.na);Ht(v,"RID","rpc"),Ht(v,"SID",h.M),Ht(v,"AID",h.K),Ht(v,"CI",h.F?"0":"1"),!h.F&&h.ia&&Ht(v,"TO",h.ia),Ht(v,"TYPE","xmlhttp"),Ur(h,v),h.u&&h.o&&Ba(v,h.u,h.o),h.O&&(h.g.H=h.O);var I=h.g;h=h.ba,I.M=1,I.A=Xs(ti(v)),I.u=null,I.R=!0,Zr(I,h)}n.Va=function(){this.C!=null&&(this.C=null,Is(this),Zi(this),ut(19))};function P(h){h.C!=null&&(o.clearTimeout(h.C),h.C=null)}function q(h,v){var I=null;if(h.g==v){P(h),Mo(h),h.g=null;var V=2}else if(No(h.h,v))I=v.G,Oa(h.h,v),V=1;else return;if(h.I!=0){if(v.o)if(V==1){I=v.u?v.u.length:0,v=Date.now()-v.F;var ie=h.D;V=Kt(),$e(V,new lt(V,I)),Es(h)}else qa(h);else if(ie=v.m,ie==3||ie==0&&v.X>0||!(V==1&&Hc(h,v)||V==2&&Zi(h)))switch(I&&I.length>0&&(v=h.h,v.i=v.i.concat(I)),ie){case 1:re(h,5);break;case 4:re(h,10);break;case 3:re(h,6);break;default:re(h,2)}}}function Q(h,v){let I=h.Qa+Math.floor(Math.random()*h.Za);return h.isActive()||(I*=2),I*v}function re(h,v){if(h.j.info("Error code "+v),v==2){var I=u(h.bb,h),V=h.Ua;const ie=!V;V=new Mr(V||"//www.google.com/images/cleardot.gif"),o.location&&o.location.protocol=="http"||ln(V,"https"),Xs(V),ie?gl(V.toString(),I):Zs(V.toString(),I)}else ut(2);h.I=0,h.l&&h.l.pa(v),be(h),As(h)}n.bb=function(h){h?(this.j.info("Successfully pinged google.com"),ut(2)):(this.j.info("Failed to ping google.com"),ut(1))};function be(h){if(h.I=0,h.ja=[],h.l){const v=Fa(h.h);(v.length!=0||h.i.length!=0)&&(S(h.ja,v),S(h.ja,h.i),h.h.i.length=0,p(h.i),h.i.length=0),h.l.oa()}}function Se(h,v,I){var V=I instanceof Mr?ti(I):new Mr(I);if(V.g!="")v&&(V.g=v+"."+V.g),ys(V,V.u);else{var ie=o.location;V=ie.protocol,v=v?v+"."+ie.hostname:ie.hostname,ie=+ie.port;const he=new Mr(null);V&&ln(he,V),v&&(he.g=v),ie&&ys(he,ie),I&&(he.h=I),V=he}return I=h.G,v=h.wa,I&&v&&Ht(V,I,v),Ht(V,"VER",h.ka),Ur(h,V),V}function We(h,v,I){if(v&&!h.L)throw Error("Can't create secondary domain capable XhrIo object.");return v=h.Aa&&!h.ma?new hn(new mt({ab:I})):new hn(h.ma),v.Fa(h.L),v}n.isActive=function(){return!!this.l&&this.l.isActive(this)};function Ye(){}n=Ye.prototype,n.ra=function(){},n.qa=function(){},n.pa=function(){},n.oa=function(){},n.isActive=function(){return!0},n.Ka=function(){};function pt(){}pt.prototype.g=function(h,v){return new ot(h,v)};function ot(h,v){Te.call(this),this.g=new Fo(v),this.l=h,this.h=v&&v.messageUrlParams||null,h=v&&v.messageHeaders||null,v&&v.clientProtocolHeaderRequired&&(h?h["X-Client-Protocol"]="webchannel":h={"X-Client-Protocol":"webchannel"}),this.g.o=h,h=v&&v.initMessageHeaders||null,v&&v.messageContentType&&(h?h["X-WebChannel-Content-Type"]=v.messageContentType:h={"X-WebChannel-Content-Type":v.messageContentType}),v&&v.sa&&(h?h["X-WebChannel-Client-Profile"]=v.sa:h={"X-WebChannel-Client-Profile":v.sa}),this.g.U=h,(h=v&&v.Qb)&&!T(h)&&(this.g.u=h),this.A=v&&v.supportsCrossDomainXhr||!1,this.v=v&&v.sendRawJson||!1,(v=v&&v.httpSessionIdParam)&&!T(v)&&(this.g.G=v,h=this.h,h!==null&&v in h&&(h=this.h,v in h&&delete h[v])),this.j=new sn(this)}g(ot,Te),ot.prototype.m=function(){this.g.l=this.j,this.A&&(this.g.L=!0),this.g.connect(this.l,this.h||void 0)},ot.prototype.close=function(){bs(this.g)},ot.prototype.o=function(h){var v=this.g;if(typeof h=="string"){var I={};I.__data__=h,h=I}else this.v&&(I={},I.__data__=kt(h),h=I);v.i.push(new Vc(v.Ya++,h)),v.I==3&&Es(v)},ot.prototype.N=function(){this.g.l=null,delete this.j,bs(this.g),delete this.g,ot.Z.N.call(this)};function Mt(h){Et.call(this),h.__headers__&&(this.headers=h.__headers__,this.statusCode=h.__status__,delete h.__headers__,delete h.__status__);var v=h.__sm__;if(v){e:{for(const I in v){h=I;break e}h=void 0}(this.i=h)&&(h=this.i,v=v!==null&&h in v?v[h]:void 0),this.data=v}else this.data=h}g(Mt,Et);function dn(){Tt.call(this),this.status=1}g(dn,Tt);function sn(h){this.g=h}g(sn,Ye),sn.prototype.ra=function(){$e(this.g,"a")},sn.prototype.qa=function(h){$e(this.g,new Mt(h))},sn.prototype.pa=function(h){$e(this.g,new dn)},sn.prototype.oa=function(){$e(this.g,"b")},pt.prototype.createWebChannel=pt.prototype.g,ot.prototype.send=ot.prototype.o,ot.prototype.open=ot.prototype.m,ot.prototype.close=ot.prototype.close,qw=function(){return new pt},jw=function(){return Kt()},Uw=Wt,om={jb:0,mb:1,nb:2,Hb:3,Mb:4,Jb:5,Kb:6,Ib:7,Gb:8,Lb:9,PROXY:10,NOPROXY:11,Eb:12,Ab:13,Bb:14,zb:15,Cb:16,Db:17,fb:18,eb:19,gb:20},Jr.NO_ERROR=0,Jr.TIMEOUT=8,Jr.HTTP_ERROR=6,Qd=Jr,Lr.COMPLETE="complete",Bw=Lr,An.EventType=Ct,Ct.OPEN="a",Ct.CLOSE="b",Ct.ERROR="c",Ct.MESSAGE="d",Te.prototype.listen=Te.prototype.J,Kl=An,hn.prototype.listenOnce=hn.prototype.K,hn.prototype.getLastError=hn.prototype.Ha,hn.prototype.getLastErrorCode=hn.prototype.ya,hn.prototype.getStatus=hn.prototype.ca,hn.prototype.getResponseJson=hn.prototype.La,hn.prototype.getResponseText=hn.prototype.la,hn.prototype.send=hn.prototype.ea,hn.prototype.setWithCredentials=hn.prototype.Fa,Vw=hn}).apply(typeof kd<"u"?kd:typeof self<"u"?self:typeof window<"u"?window:{});class cr{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}cr.UNAUTHENTICATED=new cr(null),cr.GOOGLE_CREDENTIALS=new cr("google-credentials-uid"),cr.FIRST_PARTY=new cr("first-party-uid"),cr.MOCK_USER=new cr("mock-user");let rl="12.8.0";function vR(n){rl=n}const va=new Qf("@firebase/firestore");function au(){return va.logLevel}function wR(n){va.setLogLevel(n)}function Ne(n,...e){if(va.logLevel<=Dt.DEBUG){const t=e.map(x1);va.debug(`Firestore (${rl}): ${n}`,...t)}}function Wn(n,...e){if(va.logLevel<=Dt.ERROR){const t=e.map(x1);va.error(`Firestore (${rl}): ${n}`,...t)}}function Hs(n,...e){if(va.logLevel<=Dt.WARN){const t=e.map(x1);va.warn(`Firestore (${rl}): ${n}`,...t)}}function x1(n){if(typeof n=="string")return n;try{return(function(t){return JSON.stringify(t)})(n)}catch{return n}}function qe(n,e,t){let r="Unexpected state";typeof e=="string"?r=e:t=e,zw(n,r,t)}function zw(n,e,t){let r=`FIRESTORE (${rl}) INTERNAL ASSERTION FAILED: ${e} (ID: ${n.toString(16)})`;if(t!==void 0)try{r+=" CONTEXT: "+JSON.stringify(t)}catch{r+=" CONTEXT: "+t}throw Wn(r),new Error(r)}function Ke(n,e,t,r){let i="Unexpected state";typeof t=="string"?i=t:r=t,n||zw(e,i,r)}function bR(n,e){n||qe(57014,e)}function Be(n,e){return n}const pe={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class Pe extends Gr{constructor(e,t){super(e,t),this.code=e,this.message=t,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}class _r{constructor(){this.promise=new Promise(((e,t)=>{this.resolve=e,this.reject=t}))}}class $w{constructor(e,t){this.user=t,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class IR{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,t){e.enqueueRetryable((()=>t(cr.UNAUTHENTICATED)))}shutdown(){}}class AR{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,t){this.changeListener=t,e.enqueueRetryable((()=>t(this.token.user)))}shutdown(){this.changeListener=null}}class ER{constructor(e){this.t=e,this.currentUser=cr.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,t){Ke(this.o===void 0,42304);let r=this.i;const i=c=>this.i!==r?(r=this.i,t(c)):Promise.resolve();let s=new _r;this.o=()=>{this.i++,this.currentUser=this.u(),s.resolve(),s=new _r,e.enqueueRetryable((()=>i(this.currentUser)))};const o=()=>{const c=s;e.enqueueRetryable((async()=>{await c.promise,await i(this.currentUser)}))},a=c=>{Ne("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=c,this.o&&(this.auth.addAuthTokenListener(this.o),o())};this.t.onInit((c=>a(c))),setTimeout((()=>{if(!this.auth){const c=this.t.getImmediate({optional:!0});c?a(c):(Ne("FirebaseAuthCredentialsProvider","Auth not yet detected"),s.resolve(),s=new _r)}}),0),o()}getToken(){const e=this.i,t=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(t).then((r=>this.i!==e?(Ne("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):r?(Ke(typeof r.accessToken=="string",31837,{l:r}),new $w(r.accessToken,this.currentUser)):null)):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const e=this.auth&&this.auth.getUid();return Ke(e===null||typeof e=="string",2055,{h:e}),new cr(e)}}class TR{constructor(e,t,r){this.P=e,this.T=t,this.I=r,this.type="FirstParty",this.user=cr.FIRST_PARTY,this.R=new Map}A(){return this.I?this.I():null}get headers(){this.R.set("X-Goog-AuthUser",this.P);const e=this.A();return e&&this.R.set("Authorization",e),this.T&&this.R.set("X-Goog-Iam-Authorization-Token",this.T),this.R}}class SR{constructor(e,t,r){this.P=e,this.T=t,this.I=r}getToken(){return Promise.resolve(new TR(this.P,this.T,this.I))}start(e,t){e.enqueueRetryable((()=>t(cr.FIRST_PARTY)))}shutdown(){}invalidateToken(){}}class f2{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class PR{constructor(e,t){this.V=t,this.forceRefresh=!1,this.appCheck=null,this.m=null,this.p=null,Pn(e)&&e.settings.appCheckToken&&(this.p=e.settings.appCheckToken)}start(e,t){Ke(this.o===void 0,3512);const r=s=>{s.error!=null&&Ne("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${s.error.message}`);const o=s.token!==this.m;return this.m=s.token,Ne("FirebaseAppCheckTokenProvider",`Received ${o?"new":"existing"} token.`),o?t(s.token):Promise.resolve()};this.o=s=>{e.enqueueRetryable((()=>r(s)))};const i=s=>{Ne("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=s,this.o&&this.appCheck.addTokenListener(this.o)};this.V.onInit((s=>i(s))),setTimeout((()=>{if(!this.appCheck){const s=this.V.getImmediate({optional:!0});s?i(s):Ne("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}}),0)}getToken(){if(this.p)return Promise.resolve(new f2(this.p));const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then((t=>t?(Ke(typeof t.token=="string",44558,{tokenResult:t}),this.m=t.token,new f2(t.token)):null)):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}function xR(n){const e=typeof self<"u"&&(self.crypto||self.msCrypto),t=new Uint8Array(n);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(t);else for(let r=0;r<n;r++)t[r]=Math.floor(256*Math.random());return t}class R1{static newId(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",t=62*Math.floor(4.129032258064516);let r="";for(;r.length<20;){const i=xR(40);for(let s=0;s<i.length;++s)r.length<20&&i[s]<t&&(r+=e.charAt(i[s]%62))}return r}}function wt(n,e){return n<e?-1:n>e?1:0}function am(n,e){const t=Math.min(n.length,e.length);for(let r=0;r<t;r++){const i=n.charAt(r),s=e.charAt(r);if(i!==s)return pg(i)===pg(s)?wt(i,s):pg(i)?1:-1}return wt(n.length,e.length)}const RR=55296,NR=57343;function pg(n){const e=n.charCodeAt(0);return e>=RR&&e<=NR}function Lu(n,e,t){return n.length===e.length&&n.every(((r,i)=>t(r,e[i])))}function Ww(n){return n+"\0"}const p2="__name__";class Ns{constructor(e,t,r){t===void 0?t=0:t>e.length&&qe(637,{offset:t,range:e.length}),r===void 0?r=e.length-t:r>e.length-t&&qe(1746,{length:r,range:e.length-t}),this.segments=e,this.offset=t,this.len=r}get length(){return this.len}isEqual(e){return Ns.comparator(this,e)===0}child(e){const t=this.segments.slice(this.offset,this.limit());return e instanceof Ns?e.forEach((r=>{t.push(r)})):t.push(e),this.construct(t)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}forEach(e){for(let t=this.offset,r=this.limit();t<r;t++)e(this.segments[t])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,t){const r=Math.min(e.length,t.length);for(let i=0;i<r;i++){const s=Ns.compareSegments(e.get(i),t.get(i));if(s!==0)return s}return wt(e.length,t.length)}static compareSegments(e,t){const r=Ns.isNumericId(e),i=Ns.isNumericId(t);return r&&!i?-1:!r&&i?1:r&&i?Ns.extractNumericId(e).compare(Ns.extractNumericId(t)):am(e,t)}static isNumericId(e){return e.startsWith("__id")&&e.endsWith("__")}static extractNumericId(e){return ha.fromString(e.substring(4,e.length-2))}}class Ot extends Ns{construct(e,t,r){return new Ot(e,t,r)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){const t=[];for(const r of e){if(r.indexOf("//")>=0)throw new Pe(pe.INVALID_ARGUMENT,`Invalid segment (${r}). Paths must not contain // in them.`);t.push(...r.split("/").filter((i=>i.length>0)))}return new Ot(t)}static emptyPath(){return new Ot([])}}const kR=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class xn extends Ns{construct(e,t,r){return new xn(e,t,r)}static isValidIdentifier(e){return kR.test(e)}canonicalString(){return this.toArray().map((e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),xn.isValidIdentifier(e)||(e="`"+e+"`"),e))).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)===p2}static keyField(){return new xn([p2])}static fromServerFormat(e){const t=[];let r="",i=0;const s=()=>{if(r.length===0)throw new Pe(pe.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);t.push(r),r=""};let o=!1;for(;i<e.length;){const a=e[i];if(a==="\\"){if(i+1===e.length)throw new Pe(pe.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const c=e[i+1];if(c!=="\\"&&c!=="."&&c!=="`")throw new Pe(pe.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);r+=c,i+=2}else a==="`"?(o=!o,i++):a!=="."||o?(r+=a,i++):(s(),i++)}if(s(),o)throw new Pe(pe.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new xn(t)}static emptyPath(){return new xn([])}}class Fe{constructor(e){this.path=e}static fromPath(e){return new Fe(Ot.fromString(e))}static fromName(e){return new Fe(Ot.fromString(e).popFirst(5))}static empty(){return new Fe(Ot.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&Ot.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,t){return Ot.comparator(e.path,t.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new Fe(new Ot(e.slice()))}}function N1(n,e,t){if(!t)throw new Pe(pe.INVALID_ARGUMENT,`Function ${n}() cannot be called with an empty ${e}.`)}function Hw(n,e,t,r){if(e===!0&&r===!0)throw new Pe(pe.INVALID_ARGUMENT,`${n} and ${t} cannot be used together.`)}function g2(n){if(!Fe.isDocumentKey(n))throw new Pe(pe.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${n} has ${n.length}.`)}function m2(n){if(Fe.isDocumentKey(n))throw new Pe(pe.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${n} has ${n.length}.`)}function Gw(n){return typeof n=="object"&&n!==null&&(Object.getPrototypeOf(n)===Object.prototype||Object.getPrototypeOf(n)===null)}function up(n){if(n===void 0)return"undefined";if(n===null)return"null";if(typeof n=="string")return n.length>20&&(n=`${n.substring(0,20)}...`),JSON.stringify(n);if(typeof n=="number"||typeof n=="boolean")return""+n;if(typeof n=="object"){if(n instanceof Array)return"an array";{const e=(function(r){return r.constructor?r.constructor.name:null})(n);return e?`a custom ${e} object`:"an object"}}return typeof n=="function"?"a function":qe(12329,{type:typeof n})}function Gt(n,e){if("_delegate"in n&&(n=n._delegate),!(n instanceof e)){if(e.name===n.constructor.name)throw new Pe(pe.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const t=up(n);throw new Pe(pe.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${t}`)}}return n}function Kw(n,e){if(e<=0)throw new Pe(pe.INVALID_ARGUMENT,`Function ${n}() requires a positive number, but it was: ${e}.`)}function Jn(n,e){const t={typeString:n};return e&&(t.value=e),t}function Yh(n,e){if(!Gw(n))throw new Pe(pe.INVALID_ARGUMENT,"JSON must be an object");let t;for(const r in e)if(e[r]){const i=e[r].typeString,s="value"in e[r]?{value:e[r].value}:void 0;if(!(r in n)){t=`JSON missing required field: '${r}'`;break}const o=n[r];if(i&&typeof o!==i){t=`JSON field '${r}' must be a ${i}.`;break}if(s!==void 0&&o!==s.value){t=`Expected '${r}' field to equal '${s.value}'`;break}}if(t)throw new Pe(pe.INVALID_ARGUMENT,t);return!0}const y2=-62135596800,_2=1e6;class Jt{static now(){return Jt.fromMillis(Date.now())}static fromDate(e){return Jt.fromMillis(e.getTime())}static fromMillis(e){const t=Math.floor(e/1e3),r=Math.floor((e-1e3*t)*_2);return new Jt(t,r)}constructor(e,t){if(this.seconds=e,this.nanoseconds=t,t<0)throw new Pe(pe.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(t>=1e9)throw new Pe(pe.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(e<y2)throw new Pe(pe.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new Pe(pe.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/_2}_compareTo(e){return this.seconds===e.seconds?wt(this.nanoseconds,e.nanoseconds):wt(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{type:Jt._jsonSchemaVersion,seconds:this.seconds,nanoseconds:this.nanoseconds}}static fromJSON(e){if(Yh(e,Jt._jsonSchema))return new Jt(e.seconds,e.nanoseconds)}valueOf(){const e=this.seconds-y2;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}Jt._jsonSchemaVersion="firestore/timestamp/1.0",Jt._jsonSchema={type:Jn("string",Jt._jsonSchemaVersion),seconds:Jn("number"),nanoseconds:Jn("number")};class et{static fromTimestamp(e){return new et(e)}static min(){return new et(new Jt(0,0))}static max(){return new et(new Jt(253402300799,999999999))}constructor(e){this.timestamp=e}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}const Du=-1;class Sf{constructor(e,t,r,i){this.indexId=e,this.collectionGroup=t,this.fields=r,this.indexState=i}}function cm(n){return n.fields.find((e=>e.kind===2))}function Ja(n){return n.fields.filter((e=>e.kind!==2))}Sf.UNKNOWN_ID=-1;class Xd{constructor(e,t){this.fieldPath=e,this.kind=t}}class Eh{constructor(e,t){this.sequenceNumber=e,this.offset=t}static empty(){return new Eh(0,Ri.min())}}function Yw(n,e){const t=n.toTimestamp().seconds,r=n.toTimestamp().nanoseconds+1,i=et.fromTimestamp(r===1e9?new Jt(t+1,0):new Jt(t,r));return new Ri(i,Fe.empty(),e)}function Jw(n){return new Ri(n.readTime,n.key,Du)}class Ri{constructor(e,t,r){this.readTime=e,this.documentKey=t,this.largestBatchId=r}static min(){return new Ri(et.min(),Fe.empty(),Du)}static max(){return new Ri(et.max(),Fe.empty(),Du)}}function k1(n,e){let t=n.readTime.compareTo(e.readTime);return t!==0?t:(t=Fe.comparator(n.documentKey,e.documentKey),t!==0?t:wt(n.largestBatchId,e.largestBatchId))}const Qw="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class Xw{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach((e=>e()))}}async function Ra(n){if(n.code!==pe.FAILED_PRECONDITION||n.message!==Qw)throw n;Ne("LocalStore","Unexpectedly lost primary lease")}class oe{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e((t=>{this.isDone=!0,this.result=t,this.nextCallback&&this.nextCallback(t)}),(t=>{this.isDone=!0,this.error=t,this.catchCallback&&this.catchCallback(t)}))}catch(e){return this.next(void 0,e)}next(e,t){return this.callbackAttached&&qe(59440),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(t,this.error):this.wrapSuccess(e,this.result):new oe(((r,i)=>{this.nextCallback=s=>{this.wrapSuccess(e,s).next(r,i)},this.catchCallback=s=>{this.wrapFailure(t,s).next(r,i)}}))}toPromise(){return new Promise(((e,t)=>{this.next(e,t)}))}wrapUserFunction(e){try{const t=e();return t instanceof oe?t:oe.resolve(t)}catch(t){return oe.reject(t)}}wrapSuccess(e,t){return e?this.wrapUserFunction((()=>e(t))):oe.resolve(t)}wrapFailure(e,t){return e?this.wrapUserFunction((()=>e(t))):oe.reject(t)}static resolve(e){return new oe(((t,r)=>{t(e)}))}static reject(e){return new oe(((t,r)=>{r(e)}))}static waitFor(e){return new oe(((t,r)=>{let i=0,s=0,o=!1;e.forEach((a=>{++i,a.next((()=>{++s,o&&s===i&&t()}),(c=>r(c)))})),o=!0,s===i&&t()}))}static or(e){let t=oe.resolve(!1);for(const r of e)t=t.next((i=>i?oe.resolve(i):r()));return t}static forEach(e,t){const r=[];return e.forEach(((i,s)=>{r.push(t.call(this,i,s))})),this.waitFor(r)}static mapArray(e,t){return new oe(((r,i)=>{const s=e.length,o=new Array(s);let a=0;for(let c=0;c<s;c++){const u=c;t(e[u]).next((d=>{o[u]=d,++a,a===s&&r(o)}),(d=>i(d)))}}))}static doWhile(e,t){return new oe(((r,i)=>{const s=()=>{e()===!0?t().next((()=>{s()}),i):r()};s()}))}}const Ei="SimpleDb";class lp{static open(e,t,r,i){try{return new lp(t,e.transaction(i,r))}catch(s){throw new sh(t,s)}}constructor(e,t){this.action=e,this.transaction=t,this.aborted=!1,this.S=new _r,this.transaction.oncomplete=()=>{this.S.resolve()},this.transaction.onabort=()=>{t.error?this.S.reject(new sh(e,t.error)):this.S.resolve()},this.transaction.onerror=r=>{const i=C1(r.target.error);this.S.reject(new sh(e,i))}}get D(){return this.S.promise}abort(e){e&&this.S.reject(e),this.aborted||(Ne(Ei,"Aborting transaction:",e?e.message:"Client-initiated abort"),this.aborted=!0,this.transaction.abort())}C(){const e=this.transaction;this.aborted||typeof e.commit!="function"||e.commit()}store(e){const t=this.transaction.objectStore(e);return new LR(t)}}class Us{static delete(e){return Ne(Ei,"Removing database:",e),Za(Zm().indexedDB.deleteDatabase(e)).toPromise()}static v(){if(!yh())return!1;if(Us.F())return!0;const e=Nn(),t=Us.M(e),r=0<t&&t<10,i=Zw(e),s=0<i&&i<4.5;return!(e.indexOf("MSIE ")>0||e.indexOf("Trident/")>0||e.indexOf("Edge/")>0||r||s)}static F(){return typeof process<"u"&&process.__PRIVATE_env?.__PRIVATE_USE_MOCK_PERSISTENCE==="YES"}static O(e,t){return e.store(t)}static M(e){const t=e.match(/i(?:phone|pad|pod) os ([\d_]+)/i),r=t?t[1].split("_").slice(0,2).join("."):"-1";return Number(r)}constructor(e,t,r){this.name=e,this.version=t,this.N=r,this.B=null,Us.M(Nn())===12.2&&Wn("Firestore persistence suffers from a bug in iOS 12.2 Safari that may cause your app to stop working. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.")}async L(e){return this.db||(Ne(Ei,"Opening database:",this.name),this.db=await new Promise(((t,r)=>{const i=indexedDB.open(this.name,this.version);i.onsuccess=s=>{const o=s.target.result;t(o)},i.onblocked=()=>{r(new sh(e,"Cannot upgrade IndexedDB schema while another tab is open. Close all tabs that access Firestore and reload this page to proceed."))},i.onerror=s=>{const o=s.target.error;o.name==="VersionError"?r(new Pe(pe.FAILED_PRECONDITION,"A newer version of the Firestore SDK was previously used and so the persisted data is not compatible with the version of the SDK you are now using. The SDK will operate with persistence disabled. If you need persistence, please re-upgrade to a newer version of the SDK or else clear the persisted IndexedDB data for your app to start fresh.")):o.name==="InvalidStateError"?r(new Pe(pe.FAILED_PRECONDITION,"Unable to open an IndexedDB connection. This could be due to running in a private browsing session on a browser whose private browsing sessions do not support IndexedDB: "+o)):r(new sh(e,o))},i.onupgradeneeded=s=>{Ne(Ei,'Database "'+this.name+'" requires upgrade from version:',s.oldVersion);const o=s.target.result;this.N.k(o,i.transaction,s.oldVersion,this.version).next((()=>{Ne(Ei,"Database upgrade to version "+this.version+" complete")}))}}))),this.K&&(this.db.onversionchange=t=>this.K(t)),this.db}q(e){this.K=e,this.db&&(this.db.onversionchange=t=>e(t))}async runTransaction(e,t,r,i){const s=t==="readonly";let o=0;for(;;){++o;try{this.db=await this.L(e);const a=lp.open(this.db,e,s?"readonly":"readwrite",r),c=i(a).next((u=>(a.C(),u))).catch((u=>(a.abort(u),oe.reject(u)))).toPromise();return c.catch((()=>{})),await a.D,c}catch(a){const c=a,u=c.name!=="FirebaseError"&&o<3;if(Ne(Ei,"Transaction failed with error:",c.message,"Retrying:",u),this.close(),!u)return Promise.reject(c)}}}close(){this.db&&this.db.close(),this.db=void 0}}function Zw(n){const e=n.match(/Android ([\d.]+)/i),t=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(t)}class CR{constructor(e){this.U=e,this.$=!1,this.W=null}get isDone(){return this.$}get G(){return this.W}set cursor(e){this.U=e}done(){this.$=!0}j(e){this.W=e}delete(){return Za(this.U.delete())}}class sh extends Pe{constructor(e,t){super(pe.UNAVAILABLE,`IndexedDB transaction '${e}' failed: ${t}`),this.name="IndexedDbTransactionError"}}function Na(n){return n.name==="IndexedDbTransactionError"}class LR{constructor(e){this.store=e}put(e,t){let r;return t!==void 0?(Ne(Ei,"PUT",this.store.name,e,t),r=this.store.put(t,e)):(Ne(Ei,"PUT",this.store.name,"<auto-key>",e),r=this.store.put(e)),Za(r)}add(e){return Ne(Ei,"ADD",this.store.name,e,e),Za(this.store.add(e))}get(e){return Za(this.store.get(e)).next((t=>(t===void 0&&(t=null),Ne(Ei,"GET",this.store.name,e,t),t)))}delete(e){return Ne(Ei,"DELETE",this.store.name,e),Za(this.store.delete(e))}count(){return Ne(Ei,"COUNT",this.store.name),Za(this.store.count())}H(e,t){const r=this.options(e,t),i=r.index?this.store.index(r.index):this.store;if(typeof i.getAll=="function"){const s=i.getAll(r.range);return new oe(((o,a)=>{s.onerror=c=>{a(c.target.error)},s.onsuccess=c=>{o(c.target.result)}}))}{const s=this.cursor(r),o=[];return this.J(s,((a,c)=>{o.push(c)})).next((()=>o))}}Z(e,t){const r=this.store.getAll(e,t===null?void 0:t);return new oe(((i,s)=>{r.onerror=o=>{s(o.target.error)},r.onsuccess=o=>{i(o.target.result)}}))}X(e,t){Ne(Ei,"DELETE ALL",this.store.name);const r=this.options(e,t);r.Y=!1;const i=this.cursor(r);return this.J(i,((s,o,a)=>a.delete()))}ee(e,t){let r;t?r=e:(r={},t=e);const i=this.cursor(r);return this.J(i,t)}te(e){const t=this.cursor({});return new oe(((r,i)=>{t.onerror=s=>{const o=C1(s.target.error);i(o)},t.onsuccess=s=>{const o=s.target.result;o?e(o.primaryKey,o.value).next((a=>{a?o.continue():r()})):r()}}))}J(e,t){const r=[];return new oe(((i,s)=>{e.onerror=o=>{s(o.target.error)},e.onsuccess=o=>{const a=o.target.result;if(!a)return void i();const c=new CR(a),u=t(a.primaryKey,a.value,c);if(u instanceof oe){const d=u.catch((g=>(c.done(),oe.reject(g))));r.push(d)}c.isDone?i():c.G===null?a.continue():a.continue(c.G)}})).next((()=>oe.waitFor(r)))}options(e,t){let r;return e!==void 0&&(typeof e=="string"?r=e:t=e),{index:r,range:t}}cursor(e){let t="next";if(e.reverse&&(t="prev"),e.index){const r=this.store.index(e.index);return e.Y?r.openKeyCursor(e.range,t):r.openCursor(e.range,t)}return this.store.openCursor(e.range,t)}}function Za(n){return new oe(((e,t)=>{n.onsuccess=r=>{const i=r.target.result;e(i)},n.onerror=r=>{const i=C1(r.target.error);t(i)}}))}let v2=!1;function C1(n){const e=Us.M(Nn());if(e>=12.2&&e<13){const t="An internal error was encountered in the Indexed Database server";if(n.message.indexOf(t)>=0){const r=new Pe("internal",`IOS_INDEXEDDB_BUG1: IndexedDb has thrown '${t}'. This is likely due to an unavoidable bug in iOS. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.`);return v2||(v2=!0,setTimeout((()=>{throw r}),0)),r}}return n}const oh="IndexBackfiller";class DR{constructor(e,t){this.asyncQueue=e,this.ne=t,this.task=null}start(){this.re(15e3)}stop(){this.task&&(this.task.cancel(),this.task=null)}get started(){return this.task!==null}re(e){Ne(oh,`Scheduled in ${e}ms`),this.task=this.asyncQueue.enqueueAfterDelay("index_backfill",e,(async()=>{this.task=null;try{const t=await this.ne.ie();Ne(oh,`Documents written: ${t}`)}catch(t){Na(t)?Ne(oh,"Ignoring IndexedDB error during index backfill: ",t):await Ra(t)}await this.re(6e4)}))}}class OR{constructor(e,t){this.localStore=e,this.persistence=t}async ie(e=50){return this.persistence.runTransaction("Backfill Indexes","readwrite-primary",(t=>this.se(t,e)))}se(e,t){const r=new Set;let i=t,s=!0;return oe.doWhile((()=>s===!0&&i>0),(()=>this.localStore.indexManager.getNextCollectionGroupToUpdate(e).next((o=>{if(o!==null&&!r.has(o))return Ne(oh,`Processing collection: ${o}`),this.oe(e,o,i).next((a=>{i-=a,r.add(o)}));s=!1})))).next((()=>t-i))}oe(e,t,r){return this.localStore.indexManager.getMinOffsetFromCollectionGroup(e,t).next((i=>this.localStore.localDocuments.getNextDocuments(e,t,i,r).next((s=>{const o=s.changes;return this.localStore.indexManager.updateIndexEntries(e,o).next((()=>this._e(i,s))).next((a=>(Ne(oh,`Updating offset: ${a}`),this.localStore.indexManager.updateCollectionGroup(e,t,a)))).next((()=>o.size))}))))}_e(e,t){let r=e;return t.changes.forEach(((i,s)=>{const o=Jw(s);k1(o,r)>0&&(r=o)})),new Ri(r.readTime,r.documentKey,Math.max(t.batchId,e.largestBatchId))}}class ui{constructor(e,t){this.previousValue=e,t&&(t.sequenceNumberHandler=r=>this.ae(r),this.ue=r=>t.writeSequenceNumber(r))}ae(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.ue&&this.ue(e),e}}ui.ce=-1;const da=-1;function Jh(n){return n==null}function Th(n){return n===0&&1/n==-1/0}function eb(n){return typeof n=="number"&&Number.isInteger(n)&&!Th(n)&&n<=Number.MAX_SAFE_INTEGER&&n>=Number.MIN_SAFE_INTEGER}const Pf="";function kr(n){let e="";for(let t=0;t<n.length;t++)e.length>0&&(e=w2(e)),e=FR(n.get(t),e);return w2(e)}function FR(n,e){let t=e;const r=n.length;for(let i=0;i<r;i++){const s=n.charAt(i);switch(s){case"\0":t+="";break;case Pf:t+="";break;default:t+=s}}return t}function w2(n){return n+Pf+""}function Ms(n){const e=n.length;if(Ke(e>=2,64408,{path:n}),e===2)return Ke(n.charAt(0)===Pf&&n.charAt(1)==="",56145,{path:n}),Ot.emptyPath();const t=e-2,r=[];let i="";for(let s=0;s<e;){const o=n.indexOf(Pf,s);switch((o<0||o>t)&&qe(50515,{path:n}),n.charAt(o+1)){case"":const a=n.substring(s,o);let c;i.length===0?c=a:(i+=a,c=i,i=""),r.push(c);break;case"":i+=n.substring(s,o),i+="\0";break;case"":i+=n.substring(s,o+1);break;default:qe(61167,{path:n})}s=o+2}return new Ot(r)}const Qa="remoteDocuments",Qh="owner",Xc="owner",Sh="mutationQueues",MR="userId",is="mutations",b2="batchId",oc="userMutationsIndex",I2=["userId","batchId"];function Zd(n,e){return[n,kr(e)]}function tb(n,e,t){return[n,kr(e),t]}const VR={},Ou="documentMutations",xf="remoteDocumentsV14",BR=["prefixPath","collectionGroup","readTime","documentId"],ef="documentKeyIndex",UR=["prefixPath","collectionGroup","documentId"],nb="collectionGroupIndex",jR=["collectionGroup","readTime","prefixPath","documentId"],Ph="remoteDocumentGlobal",um="remoteDocumentGlobalKey",Fu="targets",rb="queryTargetsIndex",qR=["canonicalId","targetId"],Mu="targetDocuments",zR=["targetId","path"],L1="documentTargetsIndex",$R=["path","targetId"],Rf="targetGlobalKey",hc="targetGlobal",xh="collectionParents",WR=["collectionId","parent"],Vu="clientMetadata",HR="clientId",hp="bundles",GR="bundleId",dp="namedQueries",KR="name",D1="indexConfiguration",YR="indexId",lm="collectionGroupIndex",JR="collectionGroup",ah="indexState",QR=["indexId","uid"],ib="sequenceNumberIndex",XR=["uid","sequenceNumber"],ch="indexEntries",ZR=["indexId","uid","arrayValue","directionalValue","orderedDocumentKey","documentKey"],sb="documentKeyIndex",eN=["indexId","uid","orderedDocumentKey"],fp="documentOverlays",tN=["userId","collectionPath","documentId"],hm="collectionPathOverlayIndex",nN=["userId","collectionPath","largestBatchId"],ob="collectionGroupOverlayIndex",rN=["userId","collectionGroup","largestBatchId"],O1="globals",iN="name",ab=[Sh,is,Ou,Qa,Fu,Qh,hc,Mu,Vu,Ph,xh,hp,dp],sN=[...ab,fp],cb=[Sh,is,Ou,xf,Fu,Qh,hc,Mu,Vu,Ph,xh,hp,dp,fp],ub=cb,F1=[...ub,D1,ah,ch],oN=F1,lb=[...F1,O1],aN=lb;class dm extends Xw{constructor(e,t){super(),this.le=e,this.currentSequenceNumber=t}}function rr(n,e){const t=Be(n);return Us.O(t.le,e)}function A2(n){let e=0;for(const t in n)Object.prototype.hasOwnProperty.call(n,t)&&e++;return e}function ka(n,e){for(const t in n)Object.prototype.hasOwnProperty.call(n,t)&&e(t,n[t])}function hb(n){for(const e in n)if(Object.prototype.hasOwnProperty.call(n,e))return!1;return!0}class _n{constructor(e,t){this.comparator=e,this.root=t||mr.EMPTY}insert(e,t){return new _n(this.comparator,this.root.insert(e,t,this.comparator).copy(null,null,mr.BLACK,null,null))}remove(e){return new _n(this.comparator,this.root.remove(e,this.comparator).copy(null,null,mr.BLACK,null,null))}get(e){let t=this.root;for(;!t.isEmpty();){const r=this.comparator(e,t.key);if(r===0)return t.value;r<0?t=t.left:r>0&&(t=t.right)}return null}indexOf(e){let t=0,r=this.root;for(;!r.isEmpty();){const i=this.comparator(e,r.key);if(i===0)return t+r.left.size;i<0?r=r.left:(t+=r.left.size+1,r=r.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal(((t,r)=>(e(t,r),!1)))}toString(){const e=[];return this.inorderTraversal(((t,r)=>(e.push(`${t}:${r}`),!1))),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new Cd(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new Cd(this.root,e,this.comparator,!1)}getReverseIterator(){return new Cd(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new Cd(this.root,e,this.comparator,!0)}}class Cd{constructor(e,t,r,i){this.isReverse=i,this.nodeStack=[];let s=1;for(;!e.isEmpty();)if(s=t?r(e.key,t):1,t&&i&&(s*=-1),s<0)e=this.isReverse?e.left:e.right;else{if(s===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const t={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return t}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class mr{constructor(e,t,r,i,s){this.key=e,this.value=t,this.color=r??mr.RED,this.left=i??mr.EMPTY,this.right=s??mr.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,t,r,i,s){return new mr(e??this.key,t??this.value,r??this.color,i??this.left,s??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,t,r){let i=this;const s=r(e,i.key);return i=s<0?i.copy(null,null,null,i.left.insert(e,t,r),null):s===0?i.copy(null,t,null,null,null):i.copy(null,null,null,null,i.right.insert(e,t,r)),i.fixUp()}removeMin(){if(this.left.isEmpty())return mr.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,t){let r,i=this;if(t(e,i.key)<0)i.left.isEmpty()||i.left.isRed()||i.left.left.isRed()||(i=i.moveRedLeft()),i=i.copy(null,null,null,i.left.remove(e,t),null);else{if(i.left.isRed()&&(i=i.rotateRight()),i.right.isEmpty()||i.right.isRed()||i.right.left.isRed()||(i=i.moveRedRight()),t(e,i.key)===0){if(i.right.isEmpty())return mr.EMPTY;r=i.right.min(),i=i.copy(r.key,r.value,null,null,i.right.removeMin())}i=i.copy(null,null,null,null,i.right.remove(e,t))}return i.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,mr.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,mr.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed())throw qe(43730,{key:this.key,value:this.value});if(this.right.isRed())throw qe(14113,{key:this.key,value:this.value});const e=this.left.check();if(e!==this.right.check())throw qe(27949);return e+(this.isRed()?0:1)}}mr.EMPTY=null,mr.RED=!0,mr.BLACK=!1;mr.EMPTY=new class{constructor(){this.size=0}get key(){throw qe(57766)}get value(){throw qe(16141)}get color(){throw qe(16727)}get left(){throw qe(29726)}get right(){throw qe(36894)}copy(e,t,r,i,s){return this}insert(e,t,r){return new mr(e,t)}remove(e,t){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};class tn{constructor(e){this.comparator=e,this.data=new _n(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal(((t,r)=>(e(t),!1)))}forEachInRange(e,t){const r=this.data.getIteratorFrom(e[0]);for(;r.hasNext();){const i=r.getNext();if(this.comparator(i.key,e[1])>=0)return;t(i.key)}}forEachWhile(e,t){let r;for(r=t!==void 0?this.data.getIteratorFrom(t):this.data.getIterator();r.hasNext();)if(!e(r.getNext().key))return}firstAfterOrEqual(e){const t=this.data.getIteratorFrom(e);return t.hasNext()?t.getNext().key:null}getIterator(){return new E2(this.data.getIterator())}getIteratorFrom(e){return new E2(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let t=this;return t.size<e.size&&(t=e,e=this),e.forEach((r=>{t=t.add(r)})),t}isEqual(e){if(!(e instanceof tn)||this.size!==e.size)return!1;const t=this.data.getIterator(),r=e.data.getIterator();for(;t.hasNext();){const i=t.getNext().key,s=r.getNext().key;if(this.comparator(i,s)!==0)return!1}return!0}toArray(){const e=[];return this.forEach((t=>{e.push(t)})),e}toString(){const e=[];return this.forEach((t=>e.push(t))),"SortedSet("+e.toString()+")"}copy(e){const t=new tn(this.comparator);return t.data=e,t}}class E2{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}function Zc(n){return n.hasNext()?n.getNext():void 0}class li{constructor(e){this.fields=e,e.sort(xn.comparator)}static empty(){return new li([])}unionWith(e){let t=new tn(xn.comparator);for(const r of this.fields)t=t.add(r);for(const r of e)t=t.add(r);return new li(t.toArray())}covers(e){for(const t of this.fields)if(t.isPrefixOf(e))return!0;return!1}isEqual(e){return Lu(this.fields,e.fields,((t,r)=>t.isEqual(r)))}}class db extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}function cN(){return typeof atob<"u"}class On{constructor(e){this.binaryString=e}static fromBase64String(e){const t=(function(i){try{return atob(i)}catch(s){throw typeof DOMException<"u"&&s instanceof DOMException?new db("Invalid base64 string: "+s):s}})(e);return new On(t)}static fromUint8Array(e){const t=(function(i){let s="";for(let o=0;o<i.length;++o)s+=String.fromCharCode(i[o]);return s})(e);return new On(t)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return(function(t){return btoa(t)})(this.binaryString)}toUint8Array(){return(function(t){const r=new Uint8Array(t.length);for(let i=0;i<t.length;i++)r[i]=t.charCodeAt(i);return r})(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return wt(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}On.EMPTY_BYTE_STRING=new On("");const uN=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function wo(n){if(Ke(!!n,39018),typeof n=="string"){let e=0;const t=uN.exec(n);if(Ke(!!t,46558,{timestamp:n}),t[1]){let i=t[1];i=(i+"000000000").substr(0,9),e=Number(i)}const r=new Date(n);return{seconds:Math.floor(r.getTime()/1e3),nanos:e}}return{seconds:Sn(n.seconds),nanos:Sn(n.nanos)}}function Sn(n){return typeof n=="number"?n:typeof n=="string"?Number(n):0}function bo(n){return typeof n=="string"?On.fromBase64String(n):On.fromUint8Array(n)}const fb="server_timestamp",pb="__type__",gb="__previous_value__",mb="__local_write_time__";function pp(n){return(n?.mapValue?.fields||{})[pb]?.stringValue===fb}function gp(n){const e=n.mapValue.fields[gb];return pp(e)?gp(e):e}function Rh(n){const e=wo(n.mapValue.fields[mb].timestampValue);return new Jt(e.seconds,e.nanos)}class lN{constructor(e,t,r,i,s,o,a,c,u,d,g){this.databaseId=e,this.appId=t,this.persistenceKey=r,this.host=i,this.ssl=s,this.forceLongPolling=o,this.autoDetectLongPolling=a,this.longPollingOptions=c,this.useFetchStreams=u,this.isUsingEmulator=d,this.apiKey=g}}const fm="(default)";class wa{constructor(e,t){this.projectId=e,this.database=t||fm}static empty(){return new wa("","")}get isDefaultDatabase(){return this.database===fm}isEqual(e){return e instanceof wa&&e.projectId===this.projectId&&e.database===this.database}}function hN(n,e){if(!Object.prototype.hasOwnProperty.apply(n.options,["projectId"]))throw new Pe(pe.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new wa(n.options.projectId,e)}const M1="__type__",yb="__max__",oa={mapValue:{fields:{__type__:{stringValue:yb}}}},V1="__vector__",Bu="value",tf={nullValue:"NULL_VALUE"};function ba(n){return"nullValue"in n?0:"booleanValue"in n?1:"integerValue"in n||"doubleValue"in n?2:"timestampValue"in n?3:"stringValue"in n?5:"bytesValue"in n?6:"referenceValue"in n?7:"geoPointValue"in n?8:"arrayValue"in n?9:"mapValue"in n?pp(n)?4:_b(n)?9007199254740991:mp(n)?10:11:qe(28295,{value:n})}function Gs(n,e){if(n===e)return!0;const t=ba(n);if(t!==ba(e))return!1;switch(t){case 0:case 9007199254740991:return!0;case 1:return n.booleanValue===e.booleanValue;case 4:return Rh(n).isEqual(Rh(e));case 3:return(function(i,s){if(typeof i.timestampValue=="string"&&typeof s.timestampValue=="string"&&i.timestampValue.length===s.timestampValue.length)return i.timestampValue===s.timestampValue;const o=wo(i.timestampValue),a=wo(s.timestampValue);return o.seconds===a.seconds&&o.nanos===a.nanos})(n,e);case 5:return n.stringValue===e.stringValue;case 6:return(function(i,s){return bo(i.bytesValue).isEqual(bo(s.bytesValue))})(n,e);case 7:return n.referenceValue===e.referenceValue;case 8:return(function(i,s){return Sn(i.geoPointValue.latitude)===Sn(s.geoPointValue.latitude)&&Sn(i.geoPointValue.longitude)===Sn(s.geoPointValue.longitude)})(n,e);case 2:return(function(i,s){if("integerValue"in i&&"integerValue"in s)return Sn(i.integerValue)===Sn(s.integerValue);if("doubleValue"in i&&"doubleValue"in s){const o=Sn(i.doubleValue),a=Sn(s.doubleValue);return o===a?Th(o)===Th(a):isNaN(o)&&isNaN(a)}return!1})(n,e);case 9:return Lu(n.arrayValue.values||[],e.arrayValue.values||[],Gs);case 10:case 11:return(function(i,s){const o=i.mapValue.fields||{},a=s.mapValue.fields||{};if(A2(o)!==A2(a))return!1;for(const c in o)if(o.hasOwnProperty(c)&&(a[c]===void 0||!Gs(o[c],a[c])))return!1;return!0})(n,e);default:return qe(52216,{left:n})}}function Nh(n,e){return(n.values||[]).find((t=>Gs(t,e)))!==void 0}function Ia(n,e){if(n===e)return 0;const t=ba(n),r=ba(e);if(t!==r)return wt(t,r);switch(t){case 0:case 9007199254740991:return 0;case 1:return wt(n.booleanValue,e.booleanValue);case 2:return(function(s,o){const a=Sn(s.integerValue||s.doubleValue),c=Sn(o.integerValue||o.doubleValue);return a<c?-1:a>c?1:a===c?0:isNaN(a)?isNaN(c)?0:-1:1})(n,e);case 3:return T2(n.timestampValue,e.timestampValue);case 4:return T2(Rh(n),Rh(e));case 5:return am(n.stringValue,e.stringValue);case 6:return(function(s,o){const a=bo(s),c=bo(o);return a.compareTo(c)})(n.bytesValue,e.bytesValue);case 7:return(function(s,o){const a=s.split("/"),c=o.split("/");for(let u=0;u<a.length&&u<c.length;u++){const d=wt(a[u],c[u]);if(d!==0)return d}return wt(a.length,c.length)})(n.referenceValue,e.referenceValue);case 8:return(function(s,o){const a=wt(Sn(s.latitude),Sn(o.latitude));return a!==0?a:wt(Sn(s.longitude),Sn(o.longitude))})(n.geoPointValue,e.geoPointValue);case 9:return S2(n.arrayValue,e.arrayValue);case 10:return(function(s,o){const a=s.fields||{},c=o.fields||{},u=a[Bu]?.arrayValue,d=c[Bu]?.arrayValue,g=wt(u?.values?.length||0,d?.values?.length||0);return g!==0?g:S2(u,d)})(n.mapValue,e.mapValue);case 11:return(function(s,o){if(s===oa.mapValue&&o===oa.mapValue)return 0;if(s===oa.mapValue)return 1;if(o===oa.mapValue)return-1;const a=s.fields||{},c=Object.keys(a),u=o.fields||{},d=Object.keys(u);c.sort(),d.sort();for(let g=0;g<c.length&&g<d.length;++g){const y=am(c[g],d[g]);if(y!==0)return y;const p=Ia(a[c[g]],u[d[g]]);if(p!==0)return p}return wt(c.length,d.length)})(n.mapValue,e.mapValue);default:throw qe(23264,{he:t})}}function T2(n,e){if(typeof n=="string"&&typeof e=="string"&&n.length===e.length)return wt(n,e);const t=wo(n),r=wo(e),i=wt(t.seconds,r.seconds);return i!==0?i:wt(t.nanos,r.nanos)}function S2(n,e){const t=n.values||[],r=e.values||[];for(let i=0;i<t.length&&i<r.length;++i){const s=Ia(t[i],r[i]);if(s)return s}return wt(t.length,r.length)}function Uu(n){return pm(n)}function pm(n){return"nullValue"in n?"null":"booleanValue"in n?""+n.booleanValue:"integerValue"in n?""+n.integerValue:"doubleValue"in n?""+n.doubleValue:"timestampValue"in n?(function(t){const r=wo(t);return`time(${r.seconds},${r.nanos})`})(n.timestampValue):"stringValue"in n?n.stringValue:"bytesValue"in n?(function(t){return bo(t).toBase64()})(n.bytesValue):"referenceValue"in n?(function(t){return Fe.fromName(t).toString()})(n.referenceValue):"geoPointValue"in n?(function(t){return`geo(${t.latitude},${t.longitude})`})(n.geoPointValue):"arrayValue"in n?(function(t){let r="[",i=!0;for(const s of t.values||[])i?i=!1:r+=",",r+=pm(s);return r+"]"})(n.arrayValue):"mapValue"in n?(function(t){const r=Object.keys(t.fields||{}).sort();let i="{",s=!0;for(const o of r)s?s=!1:i+=",",i+=`${o}:${pm(t.fields[o])}`;return i+"}"})(n.mapValue):qe(61005,{value:n})}function nf(n){switch(ba(n)){case 0:case 1:return 4;case 2:return 8;case 3:case 8:return 16;case 4:const e=gp(n);return e?16+nf(e):16;case 5:return 2*n.stringValue.length;case 6:return bo(n.bytesValue).approximateByteSize();case 7:return n.referenceValue.length;case 9:return(function(r){return(r.values||[]).reduce(((i,s)=>i+nf(s)),0)})(n.arrayValue);case 10:case 11:return(function(r){let i=0;return ka(r.fields,((s,o)=>{i+=s.length+nf(o)})),i})(n.mapValue);default:throw qe(13486,{value:n})}}function yc(n,e){return{referenceValue:`projects/${n.projectId}/databases/${n.database}/documents/${e.path.canonicalString()}`}}function gm(n){return!!n&&"integerValue"in n}function kh(n){return!!n&&"arrayValue"in n}function P2(n){return!!n&&"nullValue"in n}function x2(n){return!!n&&"doubleValue"in n&&isNaN(Number(n.doubleValue))}function rf(n){return!!n&&"mapValue"in n}function mp(n){return(n?.mapValue?.fields||{})[M1]?.stringValue===V1}function uh(n){if(n.geoPointValue)return{geoPointValue:{...n.geoPointValue}};if(n.timestampValue&&typeof n.timestampValue=="object")return{timestampValue:{...n.timestampValue}};if(n.mapValue){const e={mapValue:{fields:{}}};return ka(n.mapValue.fields,((t,r)=>e.mapValue.fields[t]=uh(r))),e}if(n.arrayValue){const e={arrayValue:{values:[]}};for(let t=0;t<(n.arrayValue.values||[]).length;++t)e.arrayValue.values[t]=uh(n.arrayValue.values[t]);return e}return{...n}}function _b(n){return(((n.mapValue||{}).fields||{}).__type__||{}).stringValue===yb}const vb={mapValue:{fields:{[M1]:{stringValue:V1},[Bu]:{arrayValue:{}}}}};function dN(n){return"nullValue"in n?tf:"booleanValue"in n?{booleanValue:!1}:"integerValue"in n||"doubleValue"in n?{doubleValue:NaN}:"timestampValue"in n?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"stringValue"in n?{stringValue:""}:"bytesValue"in n?{bytesValue:""}:"referenceValue"in n?yc(wa.empty(),Fe.empty()):"geoPointValue"in n?{geoPointValue:{latitude:-90,longitude:-180}}:"arrayValue"in n?{arrayValue:{}}:"mapValue"in n?mp(n)?vb:{mapValue:{}}:qe(35942,{value:n})}function fN(n){return"nullValue"in n?{booleanValue:!1}:"booleanValue"in n?{doubleValue:NaN}:"integerValue"in n||"doubleValue"in n?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"timestampValue"in n?{stringValue:""}:"stringValue"in n?{bytesValue:""}:"bytesValue"in n?yc(wa.empty(),Fe.empty()):"referenceValue"in n?{geoPointValue:{latitude:-90,longitude:-180}}:"geoPointValue"in n?{arrayValue:{}}:"arrayValue"in n?vb:"mapValue"in n?mp(n)?{mapValue:{}}:oa:qe(61959,{value:n})}function R2(n,e){const t=Ia(n.value,e.value);return t!==0?t:n.inclusive&&!e.inclusive?-1:!n.inclusive&&e.inclusive?1:0}function N2(n,e){const t=Ia(n.value,e.value);return t!==0?t:n.inclusive&&!e.inclusive?1:!n.inclusive&&e.inclusive?-1:0}class yr{constructor(e){this.value=e}static empty(){return new yr({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let t=this.value;for(let r=0;r<e.length-1;++r)if(t=(t.mapValue.fields||{})[e.get(r)],!rf(t))return null;return t=(t.mapValue.fields||{})[e.lastSegment()],t||null}}set(e,t){this.getFieldsMap(e.popLast())[e.lastSegment()]=uh(t)}setAll(e){let t=xn.emptyPath(),r={},i=[];e.forEach(((o,a)=>{if(!t.isImmediateParentOf(a)){const c=this.getFieldsMap(t);this.applyChanges(c,r,i),r={},i=[],t=a.popLast()}o?r[a.lastSegment()]=uh(o):i.push(a.lastSegment())}));const s=this.getFieldsMap(t);this.applyChanges(s,r,i)}delete(e){const t=this.field(e.popLast());rf(t)&&t.mapValue.fields&&delete t.mapValue.fields[e.lastSegment()]}isEqual(e){return Gs(this.value,e.value)}getFieldsMap(e){let t=this.value;t.mapValue.fields||(t.mapValue={fields:{}});for(let r=0;r<e.length;++r){let i=t.mapValue.fields[e.get(r)];rf(i)&&i.mapValue.fields||(i={mapValue:{fields:{}}},t.mapValue.fields[e.get(r)]=i),t=i}return t.mapValue.fields}applyChanges(e,t,r){ka(t,((i,s)=>e[i]=s));for(const i of r)delete e[i]}clone(){return new yr(uh(this.value))}}function wb(n){const e=[];return ka(n.fields,((t,r)=>{const i=new xn([t]);if(rf(r)){const s=wb(r.mapValue).fields;if(s.length===0)e.push(i);else for(const o of s)e.push(i.child(o))}else e.push(i)})),new li(e)}class bn{constructor(e,t,r,i,s,o,a){this.key=e,this.documentType=t,this.version=r,this.readTime=i,this.createTime=s,this.data=o,this.documentState=a}static newInvalidDocument(e){return new bn(e,0,et.min(),et.min(),et.min(),yr.empty(),0)}static newFoundDocument(e,t,r,i){return new bn(e,1,t,et.min(),r,i,0)}static newNoDocument(e,t){return new bn(e,2,t,et.min(),et.min(),yr.empty(),0)}static newUnknownDocument(e,t){return new bn(e,3,t,et.min(),et.min(),yr.empty(),2)}convertToFoundDocument(e,t){return!this.createTime.isEqual(et.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=t,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=yr.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=yr.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=et.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof bn&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new bn(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}class Aa{constructor(e,t){this.position=e,this.inclusive=t}}function k2(n,e,t){let r=0;for(let i=0;i<n.position.length;i++){const s=e[i],o=n.position[i];if(s.field.isKeyField()?r=Fe.comparator(Fe.fromName(o.referenceValue),t.key):r=Ia(o,t.data.field(s.field)),s.dir==="desc"&&(r*=-1),r!==0)break}return r}function C2(n,e){if(n===null)return e===null;if(e===null||n.inclusive!==e.inclusive||n.position.length!==e.position.length)return!1;for(let t=0;t<n.position.length;t++)if(!Gs(n.position[t],e.position[t]))return!1;return!0}class Ch{constructor(e,t="asc"){this.field=e,this.dir=t}}function pN(n,e){return n.dir===e.dir&&n.field.isEqual(e.field)}class bb{}class Bt extends bb{constructor(e,t,r){super(),this.field=e,this.op=t,this.value=r}static create(e,t,r){return e.isKeyField()?t==="in"||t==="not-in"?this.createKeyFieldInFilter(e,t,r):new gN(e,t,r):t==="array-contains"?new _N(e,r):t==="in"?new Pb(e,r):t==="not-in"?new vN(e,r):t==="array-contains-any"?new wN(e,r):new Bt(e,t,r)}static createKeyFieldInFilter(e,t,r){return t==="in"?new mN(e,r):new yN(e,r)}matches(e){const t=e.data.field(this.field);return this.op==="!="?t!==null&&t.nullValue===void 0&&this.matchesComparison(Ia(t,this.value)):t!==null&&ba(this.value)===ba(t)&&this.matchesComparison(Ia(t,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return qe(47266,{operator:this.op})}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class en extends bb{constructor(e,t){super(),this.filters=e,this.op=t,this.Pe=null}static create(e,t){return new en(e,t)}matches(e){return ju(this)?this.filters.find((t=>!t.matches(e)))===void 0:this.filters.find((t=>t.matches(e)))!==void 0}getFlattenedFilters(){return this.Pe!==null||(this.Pe=this.filters.reduce(((e,t)=>e.concat(t.getFlattenedFilters())),[])),this.Pe}getFilters(){return Object.assign([],this.filters)}}function ju(n){return n.op==="and"}function mm(n){return n.op==="or"}function B1(n){return Ib(n)&&ju(n)}function Ib(n){for(const e of n.filters)if(e instanceof en)return!1;return!0}function ym(n){if(n instanceof Bt)return n.field.canonicalString()+n.op.toString()+Uu(n.value);if(B1(n))return n.filters.map((e=>ym(e))).join(",");{const e=n.filters.map((t=>ym(t))).join(",");return`${n.op}(${e})`}}function Ab(n,e){return n instanceof Bt?(function(r,i){return i instanceof Bt&&r.op===i.op&&r.field.isEqual(i.field)&&Gs(r.value,i.value)})(n,e):n instanceof en?(function(r,i){return i instanceof en&&r.op===i.op&&r.filters.length===i.filters.length?r.filters.reduce(((s,o,a)=>s&&Ab(o,i.filters[a])),!0):!1})(n,e):void qe(19439)}function Eb(n,e){const t=n.filters.concat(e);return en.create(t,n.op)}function Tb(n){return n instanceof Bt?(function(t){return`${t.field.canonicalString()} ${t.op} ${Uu(t.value)}`})(n):n instanceof en?(function(t){return t.op.toString()+" {"+t.getFilters().map(Tb).join(" ,")+"}"})(n):"Filter"}class gN extends Bt{constructor(e,t,r){super(e,t,r),this.key=Fe.fromName(r.referenceValue)}matches(e){const t=Fe.comparator(e.key,this.key);return this.matchesComparison(t)}}class mN extends Bt{constructor(e,t){super(e,"in",t),this.keys=Sb("in",t)}matches(e){return this.keys.some((t=>t.isEqual(e.key)))}}class yN extends Bt{constructor(e,t){super(e,"not-in",t),this.keys=Sb("not-in",t)}matches(e){return!this.keys.some((t=>t.isEqual(e.key)))}}function Sb(n,e){return(e.arrayValue?.values||[]).map((t=>Fe.fromName(t.referenceValue)))}class _N extends Bt{constructor(e,t){super(e,"array-contains",t)}matches(e){const t=e.data.field(this.field);return kh(t)&&Nh(t.arrayValue,this.value)}}class Pb extends Bt{constructor(e,t){super(e,"in",t)}matches(e){const t=e.data.field(this.field);return t!==null&&Nh(this.value.arrayValue,t)}}class vN extends Bt{constructor(e,t){super(e,"not-in",t)}matches(e){if(Nh(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const t=e.data.field(this.field);return t!==null&&t.nullValue===void 0&&!Nh(this.value.arrayValue,t)}}class wN extends Bt{constructor(e,t){super(e,"array-contains-any",t)}matches(e){const t=e.data.field(this.field);return!(!kh(t)||!t.arrayValue.values)&&t.arrayValue.values.some((r=>Nh(this.value.arrayValue,r)))}}class bN{constructor(e,t=null,r=[],i=[],s=null,o=null,a=null){this.path=e,this.collectionGroup=t,this.orderBy=r,this.filters=i,this.limit=s,this.startAt=o,this.endAt=a,this.Te=null}}function _m(n,e=null,t=[],r=[],i=null,s=null,o=null){return new bN(n,e,t,r,i,s,o)}function _c(n){const e=Be(n);if(e.Te===null){let t=e.path.canonicalString();e.collectionGroup!==null&&(t+="|cg:"+e.collectionGroup),t+="|f:",t+=e.filters.map((r=>ym(r))).join(","),t+="|ob:",t+=e.orderBy.map((r=>(function(s){return s.field.canonicalString()+s.dir})(r))).join(","),Jh(e.limit)||(t+="|l:",t+=e.limit),e.startAt&&(t+="|lb:",t+=e.startAt.inclusive?"b:":"a:",t+=e.startAt.position.map((r=>Uu(r))).join(",")),e.endAt&&(t+="|ub:",t+=e.endAt.inclusive?"a:":"b:",t+=e.endAt.position.map((r=>Uu(r))).join(",")),e.Te=t}return e.Te}function Xh(n,e){if(n.limit!==e.limit||n.orderBy.length!==e.orderBy.length)return!1;for(let t=0;t<n.orderBy.length;t++)if(!pN(n.orderBy[t],e.orderBy[t]))return!1;if(n.filters.length!==e.filters.length)return!1;for(let t=0;t<n.filters.length;t++)if(!Ab(n.filters[t],e.filters[t]))return!1;return n.collectionGroup===e.collectionGroup&&!!n.path.isEqual(e.path)&&!!C2(n.startAt,e.startAt)&&C2(n.endAt,e.endAt)}function Nf(n){return Fe.isDocumentKey(n.path)&&n.collectionGroup===null&&n.filters.length===0}function kf(n,e){return n.filters.filter((t=>t instanceof Bt&&t.field.isEqual(e)))}function L2(n,e,t){let r=tf,i=!0;for(const s of kf(n,e)){let o=tf,a=!0;switch(s.op){case"<":case"<=":o=dN(s.value);break;case"==":case"in":case">=":o=s.value;break;case">":o=s.value,a=!1;break;case"!=":case"not-in":o=tf}R2({value:r,inclusive:i},{value:o,inclusive:a})<0&&(r=o,i=a)}if(t!==null){for(let s=0;s<n.orderBy.length;++s)if(n.orderBy[s].field.isEqual(e)){const o=t.position[s];R2({value:r,inclusive:i},{value:o,inclusive:t.inclusive})<0&&(r=o,i=t.inclusive);break}}return{value:r,inclusive:i}}function D2(n,e,t){let r=oa,i=!0;for(const s of kf(n,e)){let o=oa,a=!0;switch(s.op){case">=":case">":o=fN(s.value),a=!1;break;case"==":case"in":case"<=":o=s.value;break;case"<":o=s.value,a=!1;break;case"!=":case"not-in":o=oa}N2({value:r,inclusive:i},{value:o,inclusive:a})>0&&(r=o,i=a)}if(t!==null){for(let s=0;s<n.orderBy.length;++s)if(n.orderBy[s].field.isEqual(e)){const o=t.position[s];N2({value:r,inclusive:i},{value:o,inclusive:t.inclusive})>0&&(r=o,i=t.inclusive);break}}return{value:r,inclusive:i}}class To{constructor(e,t=null,r=[],i=[],s=null,o="F",a=null,c=null){this.path=e,this.collectionGroup=t,this.explicitOrderBy=r,this.filters=i,this.limit=s,this.limitType=o,this.startAt=a,this.endAt=c,this.Ie=null,this.Ee=null,this.Re=null,this.startAt,this.endAt}}function xb(n,e,t,r,i,s,o,a){return new To(n,e,t,r,i,s,o,a)}function il(n){return new To(n)}function O2(n){return n.filters.length===0&&n.limit===null&&n.startAt==null&&n.endAt==null&&(n.explicitOrderBy.length===0||n.explicitOrderBy.length===1&&n.explicitOrderBy[0].field.isKeyField())}function IN(n){return Fe.isDocumentKey(n.path)&&n.collectionGroup===null&&n.filters.length===0}function U1(n){return n.collectionGroup!==null}function bu(n){const e=Be(n);if(e.Ie===null){e.Ie=[];const t=new Set;for(const s of e.explicitOrderBy)e.Ie.push(s),t.add(s.field.canonicalString());const r=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(o){let a=new tn(xn.comparator);return o.filters.forEach((c=>{c.getFlattenedFilters().forEach((u=>{u.isInequality()&&(a=a.add(u.field))}))})),a})(e).forEach((s=>{t.has(s.canonicalString())||s.isKeyField()||e.Ie.push(new Ch(s,r))})),t.has(xn.keyField().canonicalString())||e.Ie.push(new Ch(xn.keyField(),r))}return e.Ie}function Kr(n){const e=Be(n);return e.Ee||(e.Ee=AN(e,bu(n))),e.Ee}function AN(n,e){if(n.limitType==="F")return _m(n.path,n.collectionGroup,e,n.filters,n.limit,n.startAt,n.endAt);{e=e.map((i=>{const s=i.dir==="desc"?"asc":"desc";return new Ch(i.field,s)}));const t=n.endAt?new Aa(n.endAt.position,n.endAt.inclusive):null,r=n.startAt?new Aa(n.startAt.position,n.startAt.inclusive):null;return _m(n.path,n.collectionGroup,e,n.filters,n.limit,t,r)}}function vm(n,e){const t=n.filters.concat([e]);return new To(n.path,n.collectionGroup,n.explicitOrderBy.slice(),t,n.limit,n.limitType,n.startAt,n.endAt)}function EN(n,e){const t=n.explicitOrderBy.concat([e]);return new To(n.path,n.collectionGroup,t,n.filters.slice(),n.limit,n.limitType,n.startAt,n.endAt)}function Cf(n,e,t){return new To(n.path,n.collectionGroup,n.explicitOrderBy.slice(),n.filters.slice(),e,t,n.startAt,n.endAt)}function TN(n,e){return new To(n.path,n.collectionGroup,n.explicitOrderBy.slice(),n.filters.slice(),n.limit,n.limitType,e,n.endAt)}function SN(n,e){return new To(n.path,n.collectionGroup,n.explicitOrderBy.slice(),n.filters.slice(),n.limit,n.limitType,n.startAt,e)}function Zh(n,e){return Xh(Kr(n),Kr(e))&&n.limitType===e.limitType}function Rb(n){return`${_c(Kr(n))}|lt:${n.limitType}`}function cu(n){return`Query(target=${(function(t){let r=t.path.canonicalString();return t.collectionGroup!==null&&(r+=" collectionGroup="+t.collectionGroup),t.filters.length>0&&(r+=`, filters: [${t.filters.map((i=>Tb(i))).join(", ")}]`),Jh(t.limit)||(r+=", limit: "+t.limit),t.orderBy.length>0&&(r+=`, orderBy: [${t.orderBy.map((i=>(function(o){return`${o.field.canonicalString()} (${o.dir})`})(i))).join(", ")}]`),t.startAt&&(r+=", startAt: ",r+=t.startAt.inclusive?"b:":"a:",r+=t.startAt.position.map((i=>Uu(i))).join(",")),t.endAt&&(r+=", endAt: ",r+=t.endAt.inclusive?"a:":"b:",r+=t.endAt.position.map((i=>Uu(i))).join(",")),`Target(${r})`})(Kr(n))}; limitType=${n.limitType})`}function ed(n,e){return e.isFoundDocument()&&(function(r,i){const s=i.key.path;return r.collectionGroup!==null?i.key.hasCollectionId(r.collectionGroup)&&r.path.isPrefixOf(s):Fe.isDocumentKey(r.path)?r.path.isEqual(s):r.path.isImmediateParentOf(s)})(n,e)&&(function(r,i){for(const s of bu(r))if(!s.field.isKeyField()&&i.data.field(s.field)===null)return!1;return!0})(n,e)&&(function(r,i){for(const s of r.filters)if(!s.matches(i))return!1;return!0})(n,e)&&(function(r,i){return!(r.startAt&&!(function(o,a,c){const u=k2(o,a,c);return o.inclusive?u<=0:u<0})(r.startAt,bu(r),i)||r.endAt&&!(function(o,a,c){const u=k2(o,a,c);return o.inclusive?u>=0:u>0})(r.endAt,bu(r),i))})(n,e)}function Nb(n){return n.collectionGroup||(n.path.length%2==1?n.path.lastSegment():n.path.get(n.path.length-2))}function kb(n){return(e,t)=>{let r=!1;for(const i of bu(n)){const s=PN(i,e,t);if(s!==0)return s;r=r||i.field.isKeyField()}return 0}}function PN(n,e,t){const r=n.field.isKeyField()?Fe.comparator(e.key,t.key):(function(s,o,a){const c=o.data.field(s),u=a.data.field(s);return c!==null&&u!==null?Ia(c,u):qe(42886)})(n.field,e,t);switch(n.dir){case"asc":return r;case"desc":return-1*r;default:return qe(19790,{direction:n.dir})}}class So{constructor(e,t){this.mapKeyFn=e,this.equalsFn=t,this.inner={},this.innerSize=0}get(e){const t=this.mapKeyFn(e),r=this.inner[t];if(r!==void 0){for(const[i,s]of r)if(this.equalsFn(i,e))return s}}has(e){return this.get(e)!==void 0}set(e,t){const r=this.mapKeyFn(e),i=this.inner[r];if(i===void 0)return this.inner[r]=[[e,t]],void this.innerSize++;for(let s=0;s<i.length;s++)if(this.equalsFn(i[s][0],e))return void(i[s]=[e,t]);i.push([e,t]),this.innerSize++}delete(e){const t=this.mapKeyFn(e),r=this.inner[t];if(r===void 0)return!1;for(let i=0;i<r.length;i++)if(this.equalsFn(r[i][0],e))return r.length===1?delete this.inner[t]:r.splice(i,1),this.innerSize--,!0;return!1}forEach(e){ka(this.inner,((t,r)=>{for(const[i,s]of r)e(i,s)}))}isEmpty(){return hb(this.inner)}size(){return this.innerSize}}const xN=new _n(Fe.comparator);function hi(){return xN}const Cb=new _n(Fe.comparator);function Yl(...n){let e=Cb;for(const t of n)e=e.insert(t.key,t);return e}function Lb(n){let e=Cb;return n.forEach(((t,r)=>e=e.insert(t,r.overlayedDocument))),e}function Vs(){return lh()}function Db(){return lh()}function lh(){return new So((n=>n.toString()),((n,e)=>n.isEqual(e)))}const RN=new _n(Fe.comparator),NN=new tn(Fe.comparator);function xt(...n){let e=NN;for(const t of n)e=e.add(t);return e}const kN=new tn(wt);function j1(){return kN}function q1(n,e){if(n.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:Th(e)?"-0":e}}function Ob(n){return{integerValue:""+n}}function Fb(n,e){return eb(e)?Ob(e):q1(n,e)}class yp{constructor(){this._=void 0}}function CN(n,e,t){return n instanceof qu?(function(i,s){const o={fields:{[pb]:{stringValue:fb},[mb]:{timestampValue:{seconds:i.seconds,nanos:i.nanoseconds}}}};return s&&pp(s)&&(s=gp(s)),s&&(o.fields[gb]=s),{mapValue:o}})(t,e):n instanceof vc?Vb(n,e):n instanceof wc?Bb(n,e):(function(i,s){const o=Mb(i,s),a=F2(o)+F2(i.Ae);return gm(o)&&gm(i.Ae)?Ob(a):q1(i.serializer,a)})(n,e)}function LN(n,e,t){return n instanceof vc?Vb(n,e):n instanceof wc?Bb(n,e):t}function Mb(n,e){return n instanceof zu?(function(r){return gm(r)||(function(s){return!!s&&"doubleValue"in s})(r)})(e)?e:{integerValue:0}:null}class qu extends yp{}class vc extends yp{constructor(e){super(),this.elements=e}}function Vb(n,e){const t=Ub(e);for(const r of n.elements)t.some((i=>Gs(i,r)))||t.push(r);return{arrayValue:{values:t}}}class wc extends yp{constructor(e){super(),this.elements=e}}function Bb(n,e){let t=Ub(e);for(const r of n.elements)t=t.filter((i=>!Gs(i,r)));return{arrayValue:{values:t}}}class zu extends yp{constructor(e,t){super(),this.serializer=e,this.Ae=t}}function F2(n){return Sn(n.integerValue||n.doubleValue)}function Ub(n){return kh(n)&&n.arrayValue.values?n.arrayValue.values.slice():[]}class td{constructor(e,t){this.field=e,this.transform=t}}function DN(n,e){return n.field.isEqual(e.field)&&(function(r,i){return r instanceof vc&&i instanceof vc||r instanceof wc&&i instanceof wc?Lu(r.elements,i.elements,Gs):r instanceof zu&&i instanceof zu?Gs(r.Ae,i.Ae):r instanceof qu&&i instanceof qu})(n.transform,e.transform)}class ON{constructor(e,t){this.version=e,this.transformResults=t}}class Rn{constructor(e,t){this.updateTime=e,this.exists=t}static none(){return new Rn}static exists(e){return new Rn(void 0,e)}static updateTime(e){return new Rn(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function sf(n,e){return n.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(n.updateTime):n.exists===void 0||n.exists===e.isFoundDocument()}class _p{}function jb(n,e){if(!n.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return n.isNoDocument()?new ol(n.key,Rn.none()):new sl(n.key,n.data,Rn.none());{const t=n.data,r=yr.empty();let i=new tn(xn.comparator);for(let s of e.fields)if(!i.has(s)){let o=t.field(s);o===null&&s.length>1&&(s=s.popLast(),o=t.field(s)),o===null?r.delete(s):r.set(s,o),i=i.add(s)}return new Po(n.key,r,new li(i.toArray()),Rn.none())}}function FN(n,e,t){n instanceof sl?(function(i,s,o){const a=i.value.clone(),c=V2(i.fieldTransforms,s,o.transformResults);a.setAll(c),s.convertToFoundDocument(o.version,a).setHasCommittedMutations()})(n,e,t):n instanceof Po?(function(i,s,o){if(!sf(i.precondition,s))return void s.convertToUnknownDocument(o.version);const a=V2(i.fieldTransforms,s,o.transformResults),c=s.data;c.setAll(qb(i)),c.setAll(a),s.convertToFoundDocument(o.version,c).setHasCommittedMutations()})(n,e,t):(function(i,s,o){s.convertToNoDocument(o.version).setHasCommittedMutations()})(0,e,t)}function hh(n,e,t,r){return n instanceof sl?(function(s,o,a,c){if(!sf(s.precondition,o))return a;const u=s.value.clone(),d=B2(s.fieldTransforms,c,o);return u.setAll(d),o.convertToFoundDocument(o.version,u).setHasLocalMutations(),null})(n,e,t,r):n instanceof Po?(function(s,o,a,c){if(!sf(s.precondition,o))return a;const u=B2(s.fieldTransforms,c,o),d=o.data;return d.setAll(qb(s)),d.setAll(u),o.convertToFoundDocument(o.version,d).setHasLocalMutations(),a===null?null:a.unionWith(s.fieldMask.fields).unionWith(s.fieldTransforms.map((g=>g.field)))})(n,e,t,r):(function(s,o,a){return sf(s.precondition,o)?(o.convertToNoDocument(o.version).setHasLocalMutations(),null):a})(n,e,t)}function MN(n,e){let t=null;for(const r of n.fieldTransforms){const i=e.data.field(r.field),s=Mb(r.transform,i||null);s!=null&&(t===null&&(t=yr.empty()),t.set(r.field,s))}return t||null}function M2(n,e){return n.type===e.type&&!!n.key.isEqual(e.key)&&!!n.precondition.isEqual(e.precondition)&&!!(function(r,i){return r===void 0&&i===void 0||!(!r||!i)&&Lu(r,i,((s,o)=>DN(s,o)))})(n.fieldTransforms,e.fieldTransforms)&&(n.type===0?n.value.isEqual(e.value):n.type!==1||n.data.isEqual(e.data)&&n.fieldMask.isEqual(e.fieldMask))}class sl extends _p{constructor(e,t,r,i=[]){super(),this.key=e,this.value=t,this.precondition=r,this.fieldTransforms=i,this.type=0}getFieldMask(){return null}}class Po extends _p{constructor(e,t,r,i,s=[]){super(),this.key=e,this.data=t,this.fieldMask=r,this.precondition=i,this.fieldTransforms=s,this.type=1}getFieldMask(){return this.fieldMask}}function qb(n){const e=new Map;return n.fieldMask.fields.forEach((t=>{if(!t.isEmpty()){const r=n.data.field(t);e.set(t,r)}})),e}function V2(n,e,t){const r=new Map;Ke(n.length===t.length,32656,{Ve:t.length,de:n.length});for(let i=0;i<t.length;i++){const s=n[i],o=s.transform,a=e.data.field(s.field);r.set(s.field,LN(o,a,t[i]))}return r}function B2(n,e,t){const r=new Map;for(const i of n){const s=i.transform,o=t.data.field(i.field);r.set(i.field,CN(s,o,e))}return r}class ol extends _p{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class z1 extends _p{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}class $1{constructor(e,t,r,i){this.batchId=e,this.localWriteTime=t,this.baseMutations=r,this.mutations=i}applyToRemoteDocument(e,t){const r=t.mutationResults;for(let i=0;i<this.mutations.length;i++){const s=this.mutations[i];s.key.isEqual(e.key)&&FN(s,e,r[i])}}applyToLocalView(e,t){for(const r of this.baseMutations)r.key.isEqual(e.key)&&(t=hh(r,e,t,this.localWriteTime));for(const r of this.mutations)r.key.isEqual(e.key)&&(t=hh(r,e,t,this.localWriteTime));return t}applyToLocalDocumentSet(e,t){const r=Db();return this.mutations.forEach((i=>{const s=e.get(i.key),o=s.overlayedDocument;let a=this.applyToLocalView(o,s.mutatedFields);a=t.has(i.key)?null:a;const c=jb(o,a);c!==null&&r.set(i.key,c),o.isValidDocument()||o.convertToNoDocument(et.min())})),r}keys(){return this.mutations.reduce(((e,t)=>e.add(t.key)),xt())}isEqual(e){return this.batchId===e.batchId&&Lu(this.mutations,e.mutations,((t,r)=>M2(t,r)))&&Lu(this.baseMutations,e.baseMutations,((t,r)=>M2(t,r)))}}class W1{constructor(e,t,r,i){this.batch=e,this.commitVersion=t,this.mutationResults=r,this.docVersions=i}static from(e,t,r){Ke(e.mutations.length===r.length,58842,{me:e.mutations.length,fe:r.length});let i=(function(){return RN})();const s=e.mutations;for(let o=0;o<s.length;o++)i=i.insert(s[o].key,r[o].version);return new W1(e,t,r,i)}}class H1{constructor(e,t){this.largestBatchId=e,this.mutation=t}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}class VN{constructor(e,t){this.count=e,this.unchangedNames=t}}var Kn,qt;function zb(n){switch(n){case pe.OK:return qe(64938);case pe.CANCELLED:case pe.UNKNOWN:case pe.DEADLINE_EXCEEDED:case pe.RESOURCE_EXHAUSTED:case pe.INTERNAL:case pe.UNAVAILABLE:case pe.UNAUTHENTICATED:return!1;case pe.INVALID_ARGUMENT:case pe.NOT_FOUND:case pe.ALREADY_EXISTS:case pe.PERMISSION_DENIED:case pe.FAILED_PRECONDITION:case pe.ABORTED:case pe.OUT_OF_RANGE:case pe.UNIMPLEMENTED:case pe.DATA_LOSS:return!0;default:return qe(15467,{code:n})}}function $b(n){if(n===void 0)return Wn("GRPC error has no .code"),pe.UNKNOWN;switch(n){case Kn.OK:return pe.OK;case Kn.CANCELLED:return pe.CANCELLED;case Kn.UNKNOWN:return pe.UNKNOWN;case Kn.DEADLINE_EXCEEDED:return pe.DEADLINE_EXCEEDED;case Kn.RESOURCE_EXHAUSTED:return pe.RESOURCE_EXHAUSTED;case Kn.INTERNAL:return pe.INTERNAL;case Kn.UNAVAILABLE:return pe.UNAVAILABLE;case Kn.UNAUTHENTICATED:return pe.UNAUTHENTICATED;case Kn.INVALID_ARGUMENT:return pe.INVALID_ARGUMENT;case Kn.NOT_FOUND:return pe.NOT_FOUND;case Kn.ALREADY_EXISTS:return pe.ALREADY_EXISTS;case Kn.PERMISSION_DENIED:return pe.PERMISSION_DENIED;case Kn.FAILED_PRECONDITION:return pe.FAILED_PRECONDITION;case Kn.ABORTED:return pe.ABORTED;case Kn.OUT_OF_RANGE:return pe.OUT_OF_RANGE;case Kn.UNIMPLEMENTED:return pe.UNIMPLEMENTED;case Kn.DATA_LOSS:return pe.DATA_LOSS;default:return qe(39323,{code:n})}}(qt=Kn||(Kn={}))[qt.OK=0]="OK",qt[qt.CANCELLED=1]="CANCELLED",qt[qt.UNKNOWN=2]="UNKNOWN",qt[qt.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",qt[qt.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",qt[qt.NOT_FOUND=5]="NOT_FOUND",qt[qt.ALREADY_EXISTS=6]="ALREADY_EXISTS",qt[qt.PERMISSION_DENIED=7]="PERMISSION_DENIED",qt[qt.UNAUTHENTICATED=16]="UNAUTHENTICATED",qt[qt.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",qt[qt.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",qt[qt.ABORTED=10]="ABORTED",qt[qt.OUT_OF_RANGE=11]="OUT_OF_RANGE",qt[qt.UNIMPLEMENTED=12]="UNIMPLEMENTED",qt[qt.INTERNAL=13]="INTERNAL",qt[qt.UNAVAILABLE=14]="UNAVAILABLE",qt[qt.DATA_LOSS=15]="DATA_LOSS";function Wb(){return new TextEncoder}const BN=new ha([4294967295,4294967295],0);function U2(n){const e=Wb().encode(n),t=new Mw;return t.update(e),new Uint8Array(t.digest())}function j2(n){const e=new DataView(n.buffer),t=e.getUint32(0,!0),r=e.getUint32(4,!0),i=e.getUint32(8,!0),s=e.getUint32(12,!0);return[new ha([t,r],0),new ha([i,s],0)]}class G1{constructor(e,t,r){if(this.bitmap=e,this.padding=t,this.hashCount=r,t<0||t>=8)throw new Jl(`Invalid padding: ${t}`);if(r<0)throw new Jl(`Invalid hash count: ${r}`);if(e.length>0&&this.hashCount===0)throw new Jl(`Invalid hash count: ${r}`);if(e.length===0&&t!==0)throw new Jl(`Invalid padding when bitmap length is 0: ${t}`);this.ge=8*e.length-t,this.pe=ha.fromNumber(this.ge)}ye(e,t,r){let i=e.add(t.multiply(ha.fromNumber(r)));return i.compare(BN)===1&&(i=new ha([i.getBits(0),i.getBits(1)],0)),i.modulo(this.pe).toNumber()}we(e){return!!(this.bitmap[Math.floor(e/8)]&1<<e%8)}mightContain(e){if(this.ge===0)return!1;const t=U2(e),[r,i]=j2(t);for(let s=0;s<this.hashCount;s++){const o=this.ye(r,i,s);if(!this.we(o))return!1}return!0}static create(e,t,r){const i=e%8==0?0:8-e%8,s=new Uint8Array(Math.ceil(e/8)),o=new G1(s,i,t);return r.forEach((a=>o.insert(a))),o}insert(e){if(this.ge===0)return;const t=U2(e),[r,i]=j2(t);for(let s=0;s<this.hashCount;s++){const o=this.ye(r,i,s);this.be(o)}}be(e){const t=Math.floor(e/8),r=e%8;this.bitmap[t]|=1<<r}}class Jl extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}class nd{constructor(e,t,r,i,s){this.snapshotVersion=e,this.targetChanges=t,this.targetMismatches=r,this.documentUpdates=i,this.resolvedLimboDocuments=s}static createSynthesizedRemoteEventForCurrentChange(e,t,r){const i=new Map;return i.set(e,rd.createSynthesizedTargetChangeForCurrentChange(e,t,r)),new nd(et.min(),i,new _n(wt),hi(),xt())}}class rd{constructor(e,t,r,i,s){this.resumeToken=e,this.current=t,this.addedDocuments=r,this.modifiedDocuments=i,this.removedDocuments=s}static createSynthesizedTargetChangeForCurrentChange(e,t,r){return new rd(r,t,xt(),xt(),xt())}}class of{constructor(e,t,r,i){this.Se=e,this.removedTargetIds=t,this.key=r,this.De=i}}class Hb{constructor(e,t){this.targetId=e,this.Ce=t}}class Gb{constructor(e,t,r=On.EMPTY_BYTE_STRING,i=null){this.state=e,this.targetIds=t,this.resumeToken=r,this.cause=i}}class q2{constructor(){this.ve=0,this.Fe=z2(),this.Me=On.EMPTY_BYTE_STRING,this.xe=!1,this.Oe=!0}get current(){return this.xe}get resumeToken(){return this.Me}get Ne(){return this.ve!==0}get Be(){return this.Oe}Le(e){e.approximateByteSize()>0&&(this.Oe=!0,this.Me=e)}ke(){let e=xt(),t=xt(),r=xt();return this.Fe.forEach(((i,s)=>{switch(s){case 0:e=e.add(i);break;case 2:t=t.add(i);break;case 1:r=r.add(i);break;default:qe(38017,{changeType:s})}})),new rd(this.Me,this.xe,e,t,r)}Ke(){this.Oe=!1,this.Fe=z2()}qe(e,t){this.Oe=!0,this.Fe=this.Fe.insert(e,t)}Ue(e){this.Oe=!0,this.Fe=this.Fe.remove(e)}$e(){this.ve+=1}We(){this.ve-=1,Ke(this.ve>=0,3241,{ve:this.ve})}Qe(){this.Oe=!0,this.xe=!0}}class UN{constructor(e){this.Ge=e,this.ze=new Map,this.je=hi(),this.He=Ld(),this.Je=Ld(),this.Ze=new _n(wt)}Xe(e){for(const t of e.Se)e.De&&e.De.isFoundDocument()?this.Ye(t,e.De):this.et(t,e.key,e.De);for(const t of e.removedTargetIds)this.et(t,e.key,e.De)}tt(e){this.forEachTarget(e,(t=>{const r=this.nt(t);switch(e.state){case 0:this.rt(t)&&r.Le(e.resumeToken);break;case 1:r.We(),r.Ne||r.Ke(),r.Le(e.resumeToken);break;case 2:r.We(),r.Ne||this.removeTarget(t);break;case 3:this.rt(t)&&(r.Qe(),r.Le(e.resumeToken));break;case 4:this.rt(t)&&(this.it(t),r.Le(e.resumeToken));break;default:qe(56790,{state:e.state})}}))}forEachTarget(e,t){e.targetIds.length>0?e.targetIds.forEach(t):this.ze.forEach(((r,i)=>{this.rt(i)&&t(i)}))}st(e){const t=e.targetId,r=e.Ce.count,i=this.ot(t);if(i){const s=i.target;if(Nf(s))if(r===0){const o=new Fe(s.path);this.et(t,o,bn.newNoDocument(o,et.min()))}else Ke(r===1,20013,{expectedCount:r});else{const o=this._t(t);if(o!==r){const a=this.ut(e),c=a?this.ct(a,e,o):1;if(c!==0){this.it(t);const u=c===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Ze=this.Ze.insert(t,u)}}}}}ut(e){const t=e.Ce.unchangedNames;if(!t||!t.bits)return null;const{bits:{bitmap:r="",padding:i=0},hashCount:s=0}=t;let o,a;try{o=bo(r).toUint8Array()}catch(c){if(c instanceof db)return Hs("Decoding the base64 bloom filter in existence filter failed ("+c.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw c}try{a=new G1(o,i,s)}catch(c){return Hs(c instanceof Jl?"BloomFilter error: ":"Applying bloom filter failed: ",c),null}return a.ge===0?null:a}ct(e,t,r){return t.Ce.count===r-this.Pt(e,t.targetId)?0:2}Pt(e,t){const r=this.Ge.getRemoteKeysForTarget(t);let i=0;return r.forEach((s=>{const o=this.Ge.ht(),a=`projects/${o.projectId}/databases/${o.database}/documents/${s.path.canonicalString()}`;e.mightContain(a)||(this.et(t,s,null),i++)})),i}Tt(e){const t=new Map;this.ze.forEach(((s,o)=>{const a=this.ot(o);if(a){if(s.current&&Nf(a.target)){const c=new Fe(a.target.path);this.It(c).has(o)||this.Et(o,c)||this.et(o,c,bn.newNoDocument(c,e))}s.Be&&(t.set(o,s.ke()),s.Ke())}}));let r=xt();this.Je.forEach(((s,o)=>{let a=!0;o.forEachWhile((c=>{const u=this.ot(c);return!u||u.purpose==="TargetPurposeLimboResolution"||(a=!1,!1)})),a&&(r=r.add(s))})),this.je.forEach(((s,o)=>o.setReadTime(e)));const i=new nd(e,t,this.Ze,this.je,r);return this.je=hi(),this.He=Ld(),this.Je=Ld(),this.Ze=new _n(wt),i}Ye(e,t){if(!this.rt(e))return;const r=this.Et(e,t.key)?2:0;this.nt(e).qe(t.key,r),this.je=this.je.insert(t.key,t),this.He=this.He.insert(t.key,this.It(t.key).add(e)),this.Je=this.Je.insert(t.key,this.Rt(t.key).add(e))}et(e,t,r){if(!this.rt(e))return;const i=this.nt(e);this.Et(e,t)?i.qe(t,1):i.Ue(t),this.Je=this.Je.insert(t,this.Rt(t).delete(e)),this.Je=this.Je.insert(t,this.Rt(t).add(e)),r&&(this.je=this.je.insert(t,r))}removeTarget(e){this.ze.delete(e)}_t(e){const t=this.nt(e).ke();return this.Ge.getRemoteKeysForTarget(e).size+t.addedDocuments.size-t.removedDocuments.size}$e(e){this.nt(e).$e()}nt(e){let t=this.ze.get(e);return t||(t=new q2,this.ze.set(e,t)),t}Rt(e){let t=this.Je.get(e);return t||(t=new tn(wt),this.Je=this.Je.insert(e,t)),t}It(e){let t=this.He.get(e);return t||(t=new tn(wt),this.He=this.He.insert(e,t)),t}rt(e){const t=this.ot(e)!==null;return t||Ne("WatchChangeAggregator","Detected inactive target",e),t}ot(e){const t=this.ze.get(e);return t&&t.Ne?null:this.Ge.At(e)}it(e){this.ze.set(e,new q2),this.Ge.getRemoteKeysForTarget(e).forEach((t=>{this.et(e,t,null)}))}Et(e,t){return this.Ge.getRemoteKeysForTarget(e).has(t)}}function Ld(){return new _n(Fe.comparator)}function z2(){return new _n(Fe.comparator)}const jN={asc:"ASCENDING",desc:"DESCENDING"},qN={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},zN={and:"AND",or:"OR"};class $N{constructor(e,t){this.databaseId=e,this.useProto3Json=t}}function wm(n,e){return n.useProto3Json||Jh(e)?e:{value:e}}function $u(n,e){return n.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function Kb(n,e){return n.useProto3Json?e.toBase64():e.toUint8Array()}function WN(n,e){return $u(n,e.toTimestamp())}function Hn(n){return Ke(!!n,49232),et.fromTimestamp((function(t){const r=wo(t);return new Jt(r.seconds,r.nanos)})(n))}function K1(n,e){return bm(n,e).canonicalString()}function bm(n,e){const t=(function(i){return new Ot(["projects",i.projectId,"databases",i.database])})(n).child("documents");return e===void 0?t:t.child(e)}function Yb(n){const e=Ot.fromString(n);return Ke(sI(e),10190,{key:e.toString()}),e}function Lh(n,e){return K1(n.databaseId,e.path)}function js(n,e){const t=Yb(e);if(t.get(1)!==n.databaseId.projectId)throw new Pe(pe.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+t.get(1)+" vs "+n.databaseId.projectId);if(t.get(3)!==n.databaseId.database)throw new Pe(pe.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+t.get(3)+" vs "+n.databaseId.database);return new Fe(Xb(t))}function Jb(n,e){return K1(n.databaseId,e)}function Qb(n){const e=Yb(n);return e.length===4?Ot.emptyPath():Xb(e)}function Im(n){return new Ot(["projects",n.databaseId.projectId,"databases",n.databaseId.database]).canonicalString()}function Xb(n){return Ke(n.length>4&&n.get(4)==="documents",29091,{key:n.toString()}),n.popFirst(5)}function $2(n,e,t){return{name:Lh(n,e),fields:t.value.mapValue.fields}}function Zb(n,e,t){const r=js(n,e.name),i=Hn(e.updateTime),s=e.createTime?Hn(e.createTime):et.min(),o=new yr({mapValue:{fields:e.fields}}),a=bn.newFoundDocument(r,i,s,o);return t&&a.setHasCommittedMutations(),t?a.setHasCommittedMutations():a}function HN(n,e){return"found"in e?(function(r,i){Ke(!!i.found,43571),i.found.name,i.found.updateTime;const s=js(r,i.found.name),o=Hn(i.found.updateTime),a=i.found.createTime?Hn(i.found.createTime):et.min(),c=new yr({mapValue:{fields:i.found.fields}});return bn.newFoundDocument(s,o,a,c)})(n,e):"missing"in e?(function(r,i){Ke(!!i.missing,3894),Ke(!!i.readTime,22933);const s=js(r,i.missing),o=Hn(i.readTime);return bn.newNoDocument(s,o)})(n,e):qe(7234,{result:e})}function GN(n,e){let t;if("targetChange"in e){e.targetChange;const r=(function(u){return u==="NO_CHANGE"?0:u==="ADD"?1:u==="REMOVE"?2:u==="CURRENT"?3:u==="RESET"?4:qe(39313,{state:u})})(e.targetChange.targetChangeType||"NO_CHANGE"),i=e.targetChange.targetIds||[],s=(function(u,d){return u.useProto3Json?(Ke(d===void 0||typeof d=="string",58123),On.fromBase64String(d||"")):(Ke(d===void 0||d instanceof Buffer||d instanceof Uint8Array,16193),On.fromUint8Array(d||new Uint8Array))})(n,e.targetChange.resumeToken),o=e.targetChange.cause,a=o&&(function(u){const d=u.code===void 0?pe.UNKNOWN:$b(u.code);return new Pe(d,u.message||"")})(o);t=new Gb(r,i,s,a||null)}else if("documentChange"in e){e.documentChange;const r=e.documentChange;r.document,r.document.name,r.document.updateTime;const i=js(n,r.document.name),s=Hn(r.document.updateTime),o=r.document.createTime?Hn(r.document.createTime):et.min(),a=new yr({mapValue:{fields:r.document.fields}}),c=bn.newFoundDocument(i,s,o,a),u=r.targetIds||[],d=r.removedTargetIds||[];t=new of(u,d,c.key,c)}else if("documentDelete"in e){e.documentDelete;const r=e.documentDelete;r.document;const i=js(n,r.document),s=r.readTime?Hn(r.readTime):et.min(),o=bn.newNoDocument(i,s),a=r.removedTargetIds||[];t=new of([],a,o.key,o)}else if("documentRemove"in e){e.documentRemove;const r=e.documentRemove;r.document;const i=js(n,r.document),s=r.removedTargetIds||[];t=new of([],s,i,null)}else{if(!("filter"in e))return qe(11601,{Vt:e});{e.filter;const r=e.filter;r.targetId;const{count:i=0,unchangedNames:s}=r,o=new VN(i,s),a=r.targetId;t=new Hb(a,o)}}return t}function Dh(n,e){let t;if(e instanceof sl)t={update:$2(n,e.key,e.value)};else if(e instanceof ol)t={delete:Lh(n,e.key)};else if(e instanceof Po)t={update:$2(n,e.key,e.data),updateMask:ZN(e.fieldMask)};else{if(!(e instanceof z1))return qe(16599,{dt:e.type});t={verify:Lh(n,e.key)}}return e.fieldTransforms.length>0&&(t.updateTransforms=e.fieldTransforms.map((r=>(function(s,o){const a=o.transform;if(a instanceof qu)return{fieldPath:o.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(a instanceof vc)return{fieldPath:o.field.canonicalString(),appendMissingElements:{values:a.elements}};if(a instanceof wc)return{fieldPath:o.field.canonicalString(),removeAllFromArray:{values:a.elements}};if(a instanceof zu)return{fieldPath:o.field.canonicalString(),increment:a.Ae};throw qe(20930,{transform:o.transform})})(0,r)))),e.precondition.isNone||(t.currentDocument=(function(i,s){return s.updateTime!==void 0?{updateTime:WN(i,s.updateTime)}:s.exists!==void 0?{exists:s.exists}:qe(27497)})(n,e.precondition)),t}function Am(n,e){const t=e.currentDocument?(function(s){return s.updateTime!==void 0?Rn.updateTime(Hn(s.updateTime)):s.exists!==void 0?Rn.exists(s.exists):Rn.none()})(e.currentDocument):Rn.none(),r=e.updateTransforms?e.updateTransforms.map((i=>(function(o,a){let c=null;if("setToServerValue"in a)Ke(a.setToServerValue==="REQUEST_TIME",16630,{proto:a}),c=new qu;else if("appendMissingElements"in a){const d=a.appendMissingElements.values||[];c=new vc(d)}else if("removeAllFromArray"in a){const d=a.removeAllFromArray.values||[];c=new wc(d)}else"increment"in a?c=new zu(o,a.increment):qe(16584,{proto:a});const u=xn.fromServerFormat(a.fieldPath);return new td(u,c)})(n,i))):[];if(e.update){e.update.name;const i=js(n,e.update.name),s=new yr({mapValue:{fields:e.update.fields}});if(e.updateMask){const o=(function(c){const u=c.fieldPaths||[];return new li(u.map((d=>xn.fromServerFormat(d))))})(e.updateMask);return new Po(i,s,o,t,r)}return new sl(i,s,t,r)}if(e.delete){const i=js(n,e.delete);return new ol(i,t)}if(e.verify){const i=js(n,e.verify);return new z1(i,t)}return qe(1463,{proto:e})}function KN(n,e){return n&&n.length>0?(Ke(e!==void 0,14353),n.map((t=>(function(i,s){let o=i.updateTime?Hn(i.updateTime):Hn(s);return o.isEqual(et.min())&&(o=Hn(s)),new ON(o,i.transformResults||[])})(t,e)))):[]}function eI(n,e){return{documents:[Jb(n,e.path)]}}function tI(n,e){const t={structuredQuery:{}},r=e.path;let i;e.collectionGroup!==null?(i=r,t.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(i=r.popLast(),t.structuredQuery.from=[{collectionId:r.lastSegment()}]),t.parent=Jb(n,i);const s=(function(u){if(u.length!==0)return iI(en.create(u,"and"))})(e.filters);s&&(t.structuredQuery.where=s);const o=(function(u){if(u.length!==0)return u.map((d=>(function(y){return{field:uu(y.field),direction:JN(y.dir)}})(d)))})(e.orderBy);o&&(t.structuredQuery.orderBy=o);const a=wm(n,e.limit);return a!==null&&(t.structuredQuery.limit=a),e.startAt&&(t.structuredQuery.startAt=(function(u){return{before:u.inclusive,values:u.position}})(e.startAt)),e.endAt&&(t.structuredQuery.endAt=(function(u){return{before:!u.inclusive,values:u.position}})(e.endAt)),{ft:t,parent:i}}function nI(n){let e=Qb(n.parent);const t=n.structuredQuery,r=t.from?t.from.length:0;let i=null;if(r>0){Ke(r===1,65062);const d=t.from[0];d.allDescendants?i=d.collectionId:e=e.child(d.collectionId)}let s=[];t.where&&(s=(function(g){const y=rI(g);return y instanceof en&&B1(y)?y.getFilters():[y]})(t.where));let o=[];t.orderBy&&(o=(function(g){return g.map((y=>(function(S){return new Ch(lu(S.field),(function(C){switch(C){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}})(S.direction))})(y)))})(t.orderBy));let a=null;t.limit&&(a=(function(g){let y;return y=typeof g=="object"?g.value:g,Jh(y)?null:y})(t.limit));let c=null;t.startAt&&(c=(function(g){const y=!!g.before,p=g.values||[];return new Aa(p,y)})(t.startAt));let u=null;return t.endAt&&(u=(function(g){const y=!g.before,p=g.values||[];return new Aa(p,y)})(t.endAt)),xb(e,i,o,s,a,"F",c,u)}function YN(n,e){const t=(function(i){switch(i){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return qe(28987,{purpose:i})}})(e.purpose);return t==null?null:{"goog-listen-tags":t}}function rI(n){return n.unaryFilter!==void 0?(function(t){switch(t.unaryFilter.op){case"IS_NAN":const r=lu(t.unaryFilter.field);return Bt.create(r,"==",{doubleValue:NaN});case"IS_NULL":const i=lu(t.unaryFilter.field);return Bt.create(i,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const s=lu(t.unaryFilter.field);return Bt.create(s,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const o=lu(t.unaryFilter.field);return Bt.create(o,"!=",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":return qe(61313);default:return qe(60726)}})(n):n.fieldFilter!==void 0?(function(t){return Bt.create(lu(t.fieldFilter.field),(function(i){switch(i){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":return qe(58110);default:return qe(50506)}})(t.fieldFilter.op),t.fieldFilter.value)})(n):n.compositeFilter!==void 0?(function(t){return en.create(t.compositeFilter.filters.map((r=>rI(r))),(function(i){switch(i){case"AND":return"and";case"OR":return"or";default:return qe(1026)}})(t.compositeFilter.op))})(n):qe(30097,{filter:n})}function JN(n){return jN[n]}function QN(n){return qN[n]}function XN(n){return zN[n]}function uu(n){return{fieldPath:n.canonicalString()}}function lu(n){return xn.fromServerFormat(n.fieldPath)}function iI(n){return n instanceof Bt?(function(t){if(t.op==="=="){if(x2(t.value))return{unaryFilter:{field:uu(t.field),op:"IS_NAN"}};if(P2(t.value))return{unaryFilter:{field:uu(t.field),op:"IS_NULL"}}}else if(t.op==="!="){if(x2(t.value))return{unaryFilter:{field:uu(t.field),op:"IS_NOT_NAN"}};if(P2(t.value))return{unaryFilter:{field:uu(t.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:uu(t.field),op:QN(t.op),value:t.value}}})(n):n instanceof en?(function(t){const r=t.getFilters().map((i=>iI(i)));return r.length===1?r[0]:{compositeFilter:{op:XN(t.op),filters:r}}})(n):qe(54877,{filter:n})}function ZN(n){const e=[];return n.fields.forEach((t=>e.push(t.canonicalString()))),{fieldPaths:e}}function sI(n){return n.length>=4&&n.get(0)==="projects"&&n.get(2)==="databases"}function oI(n){return!!n&&typeof n._toProto=="function"&&n._protoValueType==="ProtoValue"}class fo{constructor(e,t,r,i,s=et.min(),o=et.min(),a=On.EMPTY_BYTE_STRING,c=null){this.target=e,this.targetId=t,this.purpose=r,this.sequenceNumber=i,this.snapshotVersion=s,this.lastLimboFreeSnapshotVersion=o,this.resumeToken=a,this.expectedCount=c}withSequenceNumber(e){return new fo(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,t){return new fo(this.target,this.targetId,this.purpose,this.sequenceNumber,t,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new fo(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new fo(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}class aI{constructor(e){this.yt=e}}function e6(n,e){let t;if(e.document)t=Zb(n.yt,e.document,!!e.hasCommittedMutations);else if(e.noDocument){const r=Fe.fromSegments(e.noDocument.path),i=Ic(e.noDocument.readTime);t=bn.newNoDocument(r,i),e.hasCommittedMutations&&t.setHasCommittedMutations()}else{if(!e.unknownDocument)return qe(56709);{const r=Fe.fromSegments(e.unknownDocument.path),i=Ic(e.unknownDocument.version);t=bn.newUnknownDocument(r,i)}}return e.readTime&&t.setReadTime((function(i){const s=new Jt(i[0],i[1]);return et.fromTimestamp(s)})(e.readTime)),t}function W2(n,e){const t=e.key,r={prefixPath:t.getCollectionPath().popLast().toArray(),collectionGroup:t.collectionGroup,documentId:t.path.lastSegment(),readTime:Lf(e.readTime),hasCommittedMutations:e.hasCommittedMutations};if(e.isFoundDocument())r.document=(function(s,o){return{name:Lh(s,o.key),fields:o.data.value.mapValue.fields,updateTime:$u(s,o.version.toTimestamp()),createTime:$u(s,o.createTime.toTimestamp())}})(n.yt,e);else if(e.isNoDocument())r.noDocument={path:t.path.toArray(),readTime:bc(e.version)};else{if(!e.isUnknownDocument())return qe(57904,{document:e});r.unknownDocument={path:t.path.toArray(),version:bc(e.version)}}return r}function Lf(n){const e=n.toTimestamp();return[e.seconds,e.nanoseconds]}function bc(n){const e=n.toTimestamp();return{seconds:e.seconds,nanoseconds:e.nanoseconds}}function Ic(n){const e=new Jt(n.seconds,n.nanoseconds);return et.fromTimestamp(e)}function ec(n,e){const t=(e.baseMutations||[]).map((s=>Am(n.yt,s)));for(let s=0;s<e.mutations.length-1;++s){const o=e.mutations[s];if(s+1<e.mutations.length&&e.mutations[s+1].transform!==void 0){const a=e.mutations[s+1];o.updateTransforms=a.transform.fieldTransforms,e.mutations.splice(s+1,1),++s}}const r=e.mutations.map((s=>Am(n.yt,s))),i=Jt.fromMillis(e.localWriteTimeMs);return new $1(e.batchId,i,t,r)}function Ql(n){const e=Ic(n.readTime),t=n.lastLimboFreeSnapshotVersion!==void 0?Ic(n.lastLimboFreeSnapshotVersion):et.min();let r;return r=(function(s){return s.documents!==void 0})(n.query)?(function(s){const o=s.documents.length;return Ke(o===1,1966,{count:o}),Kr(il(Qb(s.documents[0])))})(n.query):(function(s){return Kr(nI(s))})(n.query),new fo(r,n.targetId,"TargetPurposeListen",n.lastListenSequenceNumber,e,t,On.fromBase64String(n.resumeToken))}function cI(n,e){const t=bc(e.snapshotVersion),r=bc(e.lastLimboFreeSnapshotVersion);let i;i=Nf(e.target)?eI(n.yt,e.target):tI(n.yt,e.target).ft;const s=e.resumeToken.toBase64();return{targetId:e.targetId,canonicalId:_c(e.target),readTime:t,resumeToken:s,lastListenSequenceNumber:e.sequenceNumber,lastLimboFreeSnapshotVersion:r,query:i}}function Y1(n){const e=nI({parent:n.parent,structuredQuery:n.structuredQuery});return n.limitType==="LAST"?Cf(e,e.limit,"L"):e}function gg(n,e){return new H1(e.largestBatchId,Am(n.yt,e.overlayMutation))}function H2(n,e){const t=e.path.lastSegment();return[n,kr(e.path.popLast()),t]}function G2(n,e,t,r){return{indexId:n,uid:e,sequenceNumber:t,readTime:bc(r.readTime),documentKey:kr(r.documentKey.path),largestBatchId:r.largestBatchId}}class t6{getBundleMetadata(e,t){return K2(e).get(t).next((r=>{if(r)return(function(s){return{id:s.bundleId,createTime:Ic(s.createTime),version:s.version}})(r)}))}saveBundleMetadata(e,t){return K2(e).put((function(i){return{bundleId:i.id,createTime:bc(Hn(i.createTime)),version:i.version}})(t))}getNamedQuery(e,t){return Y2(e).get(t).next((r=>{if(r)return(function(s){return{name:s.name,query:Y1(s.bundledQuery),readTime:Ic(s.readTime)}})(r)}))}saveNamedQuery(e,t){return Y2(e).put((function(i){return{name:i.name,readTime:bc(Hn(i.readTime)),bundledQuery:i.bundledQuery}})(t))}}function K2(n){return rr(n,hp)}function Y2(n){return rr(n,dp)}class vp{constructor(e,t){this.serializer=e,this.userId=t}static wt(e,t){const r=t.uid||"";return new vp(e,r)}getOverlay(e,t){return Fl(e).get(H2(this.userId,t)).next((r=>r?gg(this.serializer,r):null))}getOverlays(e,t){const r=Vs();return oe.forEach(t,(i=>this.getOverlay(e,i).next((s=>{s!==null&&r.set(i,s)})))).next((()=>r))}saveOverlays(e,t,r){const i=[];return r.forEach(((s,o)=>{const a=new H1(t,o);i.push(this.bt(e,a))})),oe.waitFor(i)}removeOverlaysForBatchId(e,t,r){const i=new Set;t.forEach((o=>i.add(kr(o.getCollectionPath()))));const s=[];return i.forEach((o=>{const a=IDBKeyRange.bound([this.userId,o,r],[this.userId,o,r+1],!1,!0);s.push(Fl(e).X(hm,a))})),oe.waitFor(s)}getOverlaysForCollection(e,t,r){const i=Vs(),s=kr(t),o=IDBKeyRange.bound([this.userId,s,r],[this.userId,s,Number.POSITIVE_INFINITY],!0);return Fl(e).H(hm,o).next((a=>{for(const c of a){const u=gg(this.serializer,c);i.set(u.getKey(),u)}return i}))}getOverlaysForCollectionGroup(e,t,r,i){const s=Vs();let o;const a=IDBKeyRange.bound([this.userId,t,r],[this.userId,t,Number.POSITIVE_INFINITY],!0);return Fl(e).ee({index:ob,range:a},((c,u,d)=>{const g=gg(this.serializer,u);s.size()<i||g.largestBatchId===o?(s.set(g.getKey(),g),o=g.largestBatchId):d.done()})).next((()=>s))}bt(e,t){return Fl(e).put((function(i,s,o){const[a,c,u]=H2(s,o.mutation.key);return{userId:s,collectionPath:c,documentId:u,collectionGroup:o.mutation.key.getCollectionGroup(),largestBatchId:o.largestBatchId,overlayMutation:Dh(i.yt,o.mutation)}})(this.serializer,this.userId,t))}}function Fl(n){return rr(n,fp)}class n6{St(e){return rr(e,O1)}getSessionToken(e){return this.St(e).get("sessionToken").next((t=>{const r=t?.value;return r?On.fromUint8Array(r):On.EMPTY_BYTE_STRING}))}setSessionToken(e,t){return this.St(e).put({name:"sessionToken",value:t.toUint8Array()})}}class tc{constructor(){}Dt(e,t){this.Ct(e,t),t.vt()}Ct(e,t){if("nullValue"in e)this.Ft(t,5);else if("booleanValue"in e)this.Ft(t,10),t.Mt(e.booleanValue?1:0);else if("integerValue"in e)this.Ft(t,15),t.Mt(Sn(e.integerValue));else if("doubleValue"in e){const r=Sn(e.doubleValue);isNaN(r)?this.Ft(t,13):(this.Ft(t,15),Th(r)?t.Mt(0):t.Mt(r))}else if("timestampValue"in e){let r=e.timestampValue;this.Ft(t,20),typeof r=="string"&&(r=wo(r)),t.xt(`${r.seconds||""}`),t.Mt(r.nanos||0)}else if("stringValue"in e)this.Ot(e.stringValue,t),this.Nt(t);else if("bytesValue"in e)this.Ft(t,30),t.Bt(bo(e.bytesValue)),this.Nt(t);else if("referenceValue"in e)this.Lt(e.referenceValue,t);else if("geoPointValue"in e){const r=e.geoPointValue;this.Ft(t,45),t.Mt(r.latitude||0),t.Mt(r.longitude||0)}else"mapValue"in e?_b(e)?this.Ft(t,Number.MAX_SAFE_INTEGER):mp(e)?this.kt(e.mapValue,t):(this.Kt(e.mapValue,t),this.Nt(t)):"arrayValue"in e?(this.qt(e.arrayValue,t),this.Nt(t)):qe(19022,{Ut:e})}Ot(e,t){this.Ft(t,25),this.$t(e,t)}$t(e,t){t.xt(e)}Kt(e,t){const r=e.fields||{};this.Ft(t,55);for(const i of Object.keys(r))this.Ot(i,t),this.Ct(r[i],t)}kt(e,t){const r=e.fields||{};this.Ft(t,53);const i=Bu,s=r[i].arrayValue?.values?.length||0;this.Ft(t,15),t.Mt(Sn(s)),this.Ot(i,t),this.Ct(r[i],t)}qt(e,t){const r=e.values||[];this.Ft(t,50);for(const i of r)this.Ct(i,t)}Lt(e,t){this.Ft(t,37),Fe.fromName(e).path.forEach((r=>{this.Ft(t,60),this.$t(r,t)}))}Ft(e,t){e.Mt(t)}Nt(e){e.Mt(2)}}tc.Wt=new tc;const eu=255;function r6(n){if(n===0)return 8;let e=0;return n>>4||(e+=4,n<<=4),n>>6||(e+=2,n<<=2),n>>7||(e+=1),e}function J2(n){const e=64-(function(r){let i=0;for(let s=0;s<8;++s){const o=r6(255&r[s]);if(i+=o,o!==8)break}return i})(n);return Math.ceil(e/8)}class i6{constructor(){this.buffer=new Uint8Array(1024),this.position=0}Qt(e){const t=e[Symbol.iterator]();let r=t.next();for(;!r.done;)this.Gt(r.value),r=t.next();this.zt()}jt(e){const t=e[Symbol.iterator]();let r=t.next();for(;!r.done;)this.Ht(r.value),r=t.next();this.Jt()}Zt(e){for(const t of e){const r=t.charCodeAt(0);if(r<128)this.Gt(r);else if(r<2048)this.Gt(960|r>>>6),this.Gt(128|63&r);else if(t<"\uD800"||"\uDBFF"<t)this.Gt(480|r>>>12),this.Gt(128|63&r>>>6),this.Gt(128|63&r);else{const i=t.codePointAt(0);this.Gt(240|i>>>18),this.Gt(128|63&i>>>12),this.Gt(128|63&i>>>6),this.Gt(128|63&i)}}this.zt()}Xt(e){for(const t of e){const r=t.charCodeAt(0);if(r<128)this.Ht(r);else if(r<2048)this.Ht(960|r>>>6),this.Ht(128|63&r);else if(t<"\uD800"||"\uDBFF"<t)this.Ht(480|r>>>12),this.Ht(128|63&r>>>6),this.Ht(128|63&r);else{const i=t.codePointAt(0);this.Ht(240|i>>>18),this.Ht(128|63&i>>>12),this.Ht(128|63&i>>>6),this.Ht(128|63&i)}}this.Jt()}Yt(e){const t=this.en(e),r=J2(t);this.tn(1+r),this.buffer[this.position++]=255&r;for(let i=t.length-r;i<t.length;++i)this.buffer[this.position++]=255&t[i]}nn(e){const t=this.en(e),r=J2(t);this.tn(1+r),this.buffer[this.position++]=~(255&r);for(let i=t.length-r;i<t.length;++i)this.buffer[this.position++]=~(255&t[i])}rn(){this.sn(eu),this.sn(255)}_n(){this.an(eu),this.an(255)}reset(){this.position=0}seed(e){this.tn(e.length),this.buffer.set(e,this.position),this.position+=e.length}un(){return this.buffer.slice(0,this.position)}en(e){const t=(function(s){const o=new DataView(new ArrayBuffer(8));return o.setFloat64(0,s,!1),new Uint8Array(o.buffer)})(e),r=!!(128&t[0]);t[0]^=r?255:128;for(let i=1;i<t.length;++i)t[i]^=r?255:0;return t}Gt(e){const t=255&e;t===0?(this.sn(0),this.sn(255)):t===eu?(this.sn(eu),this.sn(0)):this.sn(t)}Ht(e){const t=255&e;t===0?(this.an(0),this.an(255)):t===eu?(this.an(eu),this.an(0)):this.an(e)}zt(){this.sn(0),this.sn(1)}Jt(){this.an(0),this.an(1)}sn(e){this.tn(1),this.buffer[this.position++]=e}an(e){this.tn(1),this.buffer[this.position++]=~e}tn(e){const t=e+this.position;if(t<=this.buffer.length)return;let r=2*this.buffer.length;r<t&&(r=t);const i=new Uint8Array(r);i.set(this.buffer),this.buffer=i}}class s6{constructor(e){this.cn=e}Bt(e){this.cn.Qt(e)}xt(e){this.cn.Zt(e)}Mt(e){this.cn.Yt(e)}vt(){this.cn.rn()}}class o6{constructor(e){this.cn=e}Bt(e){this.cn.jt(e)}xt(e){this.cn.Xt(e)}Mt(e){this.cn.nn(e)}vt(){this.cn._n()}}class Ml{constructor(){this.cn=new i6,this.ascending=new s6(this.cn),this.descending=new o6(this.cn)}seed(e){this.cn.seed(e)}ln(e){return e===0?this.ascending:this.descending}un(){return this.cn.un()}reset(){this.cn.reset()}}class nc{constructor(e,t,r,i){this.hn=e,this.Pn=t,this.Tn=r,this.In=i}En(){const e=this.In.length,t=e===0||this.In[e-1]===255?e+1:e,r=new Uint8Array(t);return r.set(this.In,0),t!==e?r.set([0],this.In.length):++r[r.length-1],new nc(this.hn,this.Pn,this.Tn,r)}Rn(e,t,r){return{indexId:this.hn,uid:e,arrayValue:af(this.Tn),directionalValue:af(this.In),orderedDocumentKey:af(t),documentKey:r.path.toArray()}}An(e,t,r){const i=this.Rn(e,t,r);return[i.indexId,i.uid,i.arrayValue,i.directionalValue,i.orderedDocumentKey,i.documentKey]}}function Xo(n,e){let t=n.hn-e.hn;return t!==0?t:(t=Q2(n.Tn,e.Tn),t!==0?t:(t=Q2(n.In,e.In),t!==0?t:Fe.comparator(n.Pn,e.Pn)))}function Q2(n,e){for(let t=0;t<n.length&&t<e.length;++t){const r=n[t]-e[t];if(r!==0)return r}return n.length-e.length}function af(n){return E5()?(function(t){let r="";for(let i=0;i<t.length;i++)r+=String.fromCharCode(t[i]);return r})(n):n}function X2(n){return typeof n!="string"?n:(function(t){const r=new Uint8Array(t.length);for(let i=0;i<t.length;i++)r[i]=t.charCodeAt(i);return r})(n)}class Z2{constructor(e){this.Vn=new tn(((t,r)=>xn.comparator(t.field,r.field))),this.collectionId=e.collectionGroup!=null?e.collectionGroup:e.path.lastSegment(),this.dn=e.orderBy,this.mn=[];for(const t of e.filters){const r=t;r.isInequality()?this.Vn=this.Vn.add(r):this.mn.push(r)}}get fn(){return this.Vn.size>1}gn(e){if(Ke(e.collectionGroup===this.collectionId,49279),this.fn)return!1;const t=cm(e);if(t!==void 0&&!this.pn(t))return!1;const r=Ja(e);let i=new Set,s=0,o=0;for(;s<r.length&&this.pn(r[s]);++s)i=i.add(r[s].fieldPath.canonicalString());if(s===r.length)return!0;if(this.Vn.size>0){const a=this.Vn.getIterator().getNext();if(!i.has(a.field.canonicalString())){const c=r[s];if(!this.yn(a,c)||!this.wn(this.dn[o++],c))return!1}++s}for(;s<r.length;++s){const a=r[s];if(o>=this.dn.length||!this.wn(this.dn[o++],a))return!1}return!0}bn(){if(this.fn)return null;let e=new tn(xn.comparator);const t=[];for(const r of this.mn)if(!r.field.isKeyField())if(r.op==="array-contains"||r.op==="array-contains-any")t.push(new Xd(r.field,2));else{if(e.has(r.field))continue;e=e.add(r.field),t.push(new Xd(r.field,0))}for(const r of this.dn)r.field.isKeyField()||e.has(r.field)||(e=e.add(r.field),t.push(new Xd(r.field,r.dir==="asc"?0:1)));return new Sf(Sf.UNKNOWN_ID,this.collectionId,t,Eh.empty())}pn(e){for(const t of this.mn)if(this.yn(t,e))return!0;return!1}yn(e,t){if(e===void 0||!e.field.isEqual(t.fieldPath))return!1;const r=e.op==="array-contains"||e.op==="array-contains-any";return t.kind===2===r}wn(e,t){return!!e.field.isEqual(t.fieldPath)&&(t.kind===0&&e.dir==="asc"||t.kind===1&&e.dir==="desc")}}function uI(n){if(Ke(n instanceof Bt||n instanceof en,20012),n instanceof Bt){if(n instanceof Pb){const t=n.value.arrayValue?.values?.map((r=>Bt.create(n.field,"==",r)))||[];return en.create(t,"or")}return n}const e=n.filters.map((t=>uI(t)));return en.create(e,n.op)}function a6(n){if(n.getFilters().length===0)return[];const e=Sm(uI(n));return Ke(lI(e),7391),Em(e)||Tm(e)?[e]:e.getFilters()}function Em(n){return n instanceof Bt}function Tm(n){return n instanceof en&&B1(n)}function lI(n){return Em(n)||Tm(n)||(function(t){if(t instanceof en&&mm(t)){for(const r of t.getFilters())if(!Em(r)&&!Tm(r))return!1;return!0}return!1})(n)}function Sm(n){if(Ke(n instanceof Bt||n instanceof en,34018),n instanceof Bt)return n;if(n.filters.length===1)return Sm(n.filters[0]);const e=n.filters.map((r=>Sm(r)));let t=en.create(e,n.op);return t=Df(t),lI(t)?t:(Ke(t instanceof en,64498),Ke(ju(t),40251),Ke(t.filters.length>1,57927),t.filters.reduce(((r,i)=>J1(r,i))))}function J1(n,e){let t;return Ke(n instanceof Bt||n instanceof en,38388),Ke(e instanceof Bt||e instanceof en,25473),t=n instanceof Bt?e instanceof Bt?(function(i,s){return en.create([i,s],"and")})(n,e):e_(n,e):e instanceof Bt?e_(e,n):(function(i,s){if(Ke(i.filters.length>0&&s.filters.length>0,48005),ju(i)&&ju(s))return Eb(i,s.getFilters());const o=mm(i)?i:s,a=mm(i)?s:i,c=o.filters.map((u=>J1(u,a)));return en.create(c,"or")})(n,e),Df(t)}function e_(n,e){if(ju(e))return Eb(e,n.getFilters());{const t=e.filters.map((r=>J1(n,r)));return en.create(t,"or")}}function Df(n){if(Ke(n instanceof Bt||n instanceof en,11850),n instanceof Bt)return n;const e=n.getFilters();if(e.length===1)return Df(e[0]);if(Ib(n))return n;const t=e.map((i=>Df(i))),r=[];return t.forEach((i=>{i instanceof Bt?r.push(i):i instanceof en&&(i.op===n.op?r.push(...i.filters):r.push(i))})),r.length===1?r[0]:en.create(r,n.op)}class c6{constructor(){this.Sn=new Q1}addToCollectionParentIndex(e,t){return this.Sn.add(t),oe.resolve()}getCollectionParents(e,t){return oe.resolve(this.Sn.getEntries(t))}addFieldIndex(e,t){return oe.resolve()}deleteFieldIndex(e,t){return oe.resolve()}deleteAllFieldIndexes(e){return oe.resolve()}createTargetIndexes(e,t){return oe.resolve()}getDocumentsMatchingTarget(e,t){return oe.resolve(null)}getIndexType(e,t){return oe.resolve(0)}getFieldIndexes(e,t){return oe.resolve([])}getNextCollectionGroupToUpdate(e){return oe.resolve(null)}getMinOffset(e,t){return oe.resolve(Ri.min())}getMinOffsetFromCollectionGroup(e,t){return oe.resolve(Ri.min())}updateCollectionGroup(e,t,r){return oe.resolve()}updateIndexEntries(e,t){return oe.resolve()}}class Q1{constructor(){this.index={}}add(e){const t=e.lastSegment(),r=e.popLast(),i=this.index[t]||new tn(Ot.comparator),s=!i.has(r);return this.index[t]=i.add(r),s}has(e){const t=e.lastSegment(),r=e.popLast(),i=this.index[t];return i&&i.has(r)}getEntries(e){return(this.index[e]||new tn(Ot.comparator)).toArray()}}const t_="IndexedDbIndexManager",Dd=new Uint8Array(0);class u6{constructor(e,t){this.databaseId=t,this.Dn=new Q1,this.Cn=new So((r=>_c(r)),((r,i)=>Xh(r,i))),this.uid=e.uid||""}addToCollectionParentIndex(e,t){if(!this.Dn.has(t)){const r=t.lastSegment(),i=t.popLast();e.addOnCommittedListener((()=>{this.Dn.add(t)}));const s={collectionId:r,parent:kr(i)};return n_(e).put(s)}return oe.resolve()}getCollectionParents(e,t){const r=[],i=IDBKeyRange.bound([t,""],[Ww(t),""],!1,!0);return n_(e).H(i).next((s=>{for(const o of s){if(o.collectionId!==t)break;r.push(Ms(o.parent))}return r}))}addFieldIndex(e,t){const r=Vl(e),i=(function(a){return{indexId:a.indexId,collectionGroup:a.collectionGroup,fields:a.fields.map((c=>[c.fieldPath.canonicalString(),c.kind]))}})(t);delete i.indexId;const s=r.add(i);if(t.indexState){const o=nu(e);return s.next((a=>{o.put(G2(a,this.uid,t.indexState.sequenceNumber,t.indexState.offset))}))}return s.next()}deleteFieldIndex(e,t){const r=Vl(e),i=nu(e),s=tu(e);return r.delete(t.indexId).next((()=>i.delete(IDBKeyRange.bound([t.indexId],[t.indexId+1],!1,!0)))).next((()=>s.delete(IDBKeyRange.bound([t.indexId],[t.indexId+1],!1,!0))))}deleteAllFieldIndexes(e){const t=Vl(e),r=tu(e),i=nu(e);return t.X().next((()=>r.X())).next((()=>i.X()))}createTargetIndexes(e,t){return oe.forEach(this.vn(t),(r=>this.getIndexType(e,r).next((i=>{if(i===0||i===1){const s=new Z2(r).bn();if(s!=null)return this.addFieldIndex(e,s)}}))))}getDocumentsMatchingTarget(e,t){const r=tu(e);let i=!0;const s=new Map;return oe.forEach(this.vn(t),(o=>this.Fn(e,o).next((a=>{i&&(i=!!a),s.set(o,a)})))).next((()=>{if(i){let o=xt();const a=[];return oe.forEach(s,((c,u)=>{Ne(t_,`Using index ${(function(G){return`id=${G.indexId}|cg=${G.collectionGroup}|f=${G.fields.map((W=>`${W.fieldPath}:${W.kind}`)).join(",")}`})(c)} to execute ${_c(t)}`);const d=(function(G,W){const ne=cm(W);if(ne===void 0)return null;for(const de of kf(G,ne.fieldPath))switch(de.op){case"array-contains-any":return de.value.arrayValue.values||[];case"array-contains":return[de.value]}return null})(u,c),g=(function(G,W){const ne=new Map;for(const de of Ja(W))for(const B of kf(G,de.fieldPath))switch(B.op){case"==":case"in":ne.set(de.fieldPath.canonicalString(),B.value);break;case"not-in":case"!=":return ne.set(de.fieldPath.canonicalString(),B.value),Array.from(ne.values())}return null})(u,c),y=(function(G,W){const ne=[];let de=!0;for(const B of Ja(W)){const x=B.kind===0?L2(G,B.fieldPath,G.startAt):D2(G,B.fieldPath,G.startAt);ne.push(x.value),de&&(de=x.inclusive)}return new Aa(ne,de)})(u,c),p=(function(G,W){const ne=[];let de=!0;for(const B of Ja(W)){const x=B.kind===0?D2(G,B.fieldPath,G.endAt):L2(G,B.fieldPath,G.endAt);ne.push(x.value),de&&(de=x.inclusive)}return new Aa(ne,de)})(u,c),S=this.Mn(c,u,y),N=this.Mn(c,u,p),C=this.xn(c,u,g),k=this.On(c.indexId,d,S,y.inclusive,N,p.inclusive,C);return oe.forEach(k,(K=>r.Z(K,t.limit).next((G=>{G.forEach((W=>{const ne=Fe.fromSegments(W.documentKey);o.has(ne)||(o=o.add(ne),a.push(ne))}))}))))})).next((()=>a))}return oe.resolve(null)}))}vn(e){let t=this.Cn.get(e);return t||(e.filters.length===0?t=[e]:t=a6(en.create(e.filters,"and")).map((r=>_m(e.path,e.collectionGroup,e.orderBy,r.getFilters(),e.limit,e.startAt,e.endAt))),this.Cn.set(e,t),t)}On(e,t,r,i,s,o,a){const c=(t!=null?t.length:1)*Math.max(r.length,s.length),u=c/(t!=null?t.length:1),d=[];for(let g=0;g<c;++g){const y=t?this.Nn(t[g/u]):Dd,p=this.Bn(e,y,r[g%u],i),S=this.Ln(e,y,s[g%u],o),N=a.map((C=>this.Bn(e,y,C,!0)));d.push(...this.createRange(p,S,N))}return d}Bn(e,t,r,i){const s=new nc(e,Fe.empty(),t,r);return i?s:s.En()}Ln(e,t,r,i){const s=new nc(e,Fe.empty(),t,r);return i?s.En():s}Fn(e,t){const r=new Z2(t),i=t.collectionGroup!=null?t.collectionGroup:t.path.lastSegment();return this.getFieldIndexes(e,i).next((s=>{let o=null;for(const a of s)r.gn(a)&&(!o||a.fields.length>o.fields.length)&&(o=a);return o}))}getIndexType(e,t){let r=2;const i=this.vn(t);return oe.forEach(i,(s=>this.Fn(e,s).next((o=>{o?r!==0&&o.fields.length<(function(c){let u=new tn(xn.comparator),d=!1;for(const g of c.filters)for(const y of g.getFlattenedFilters())y.field.isKeyField()||(y.op==="array-contains"||y.op==="array-contains-any"?d=!0:u=u.add(y.field));for(const g of c.orderBy)g.field.isKeyField()||(u=u.add(g.field));return u.size+(d?1:0)})(s)&&(r=1):r=0})))).next((()=>(function(o){return o.limit!==null})(t)&&i.length>1&&r===2?1:r))}kn(e,t){const r=new Ml;for(const i of Ja(e)){const s=t.data.field(i.fieldPath);if(s==null)return null;const o=r.ln(i.kind);tc.Wt.Dt(s,o)}return r.un()}Nn(e){const t=new Ml;return tc.Wt.Dt(e,t.ln(0)),t.un()}Kn(e,t){const r=new Ml;return tc.Wt.Dt(yc(this.databaseId,t),r.ln((function(s){const o=Ja(s);return o.length===0?0:o[o.length-1].kind})(e))),r.un()}xn(e,t,r){if(r===null)return[];let i=[];i.push(new Ml);let s=0;for(const o of Ja(e)){const a=r[s++];for(const c of i)if(this.qn(t,o.fieldPath)&&kh(a))i=this.Un(i,o,a);else{const u=c.ln(o.kind);tc.Wt.Dt(a,u)}}return this.$n(i)}Mn(e,t,r){return this.xn(e,t,r.position)}$n(e){const t=[];for(let r=0;r<e.length;++r)t[r]=e[r].un();return t}Un(e,t,r){const i=[...e],s=[];for(const o of r.arrayValue.values||[])for(const a of i){const c=new Ml;c.seed(a.un()),tc.Wt.Dt(o,c.ln(t.kind)),s.push(c)}return s}qn(e,t){return!!e.filters.find((r=>r instanceof Bt&&r.field.isEqual(t)&&(r.op==="in"||r.op==="not-in")))}getFieldIndexes(e,t){const r=Vl(e),i=nu(e);return(t?r.H(lm,IDBKeyRange.bound(t,t)):r.H()).next((s=>{const o=[];return oe.forEach(s,(a=>i.get([a.indexId,this.uid]).next((c=>{o.push((function(d,g){const y=g?new Eh(g.sequenceNumber,new Ri(Ic(g.readTime),new Fe(Ms(g.documentKey)),g.largestBatchId)):Eh.empty(),p=d.fields.map((([S,N])=>new Xd(xn.fromServerFormat(S),N)));return new Sf(d.indexId,d.collectionGroup,p,y)})(a,c))})))).next((()=>o))}))}getNextCollectionGroupToUpdate(e){return this.getFieldIndexes(e).next((t=>t.length===0?null:(t.sort(((r,i)=>{const s=r.indexState.sequenceNumber-i.indexState.sequenceNumber;return s!==0?s:wt(r.collectionGroup,i.collectionGroup)})),t[0].collectionGroup)))}updateCollectionGroup(e,t,r){const i=Vl(e),s=nu(e);return this.Wn(e).next((o=>i.H(lm,IDBKeyRange.bound(t,t)).next((a=>oe.forEach(a,(c=>s.put(G2(c.indexId,this.uid,o,r))))))))}updateIndexEntries(e,t){const r=new Map;return oe.forEach(t,((i,s)=>{const o=r.get(i.collectionGroup);return(o?oe.resolve(o):this.getFieldIndexes(e,i.collectionGroup)).next((a=>(r.set(i.collectionGroup,a),oe.forEach(a,(c=>this.Qn(e,i,c).next((u=>{const d=this.Gn(s,c);return u.isEqual(d)?oe.resolve():this.zn(e,s,c,u,d)})))))))}))}jn(e,t,r,i){return tu(e).put(i.Rn(this.uid,this.Kn(r,t.key),t.key))}Hn(e,t,r,i){return tu(e).delete(i.An(this.uid,this.Kn(r,t.key),t.key))}Qn(e,t,r){const i=tu(e);let s=new tn(Xo);return i.ee({index:sb,range:IDBKeyRange.only([r.indexId,this.uid,af(this.Kn(r,t))])},((o,a)=>{s=s.add(new nc(r.indexId,t,X2(a.arrayValue),X2(a.directionalValue)))})).next((()=>s))}Gn(e,t){let r=new tn(Xo);const i=this.kn(t,e);if(i==null)return r;const s=cm(t);if(s!=null){const o=e.data.field(s.fieldPath);if(kh(o))for(const a of o.arrayValue.values||[])r=r.add(new nc(t.indexId,e.key,this.Nn(a),i))}else r=r.add(new nc(t.indexId,e.key,Dd,i));return r}zn(e,t,r,i,s){Ne(t_,"Updating index entries for document '%s'",t.key);const o=[];return(function(c,u,d,g,y){const p=c.getIterator(),S=u.getIterator();let N=Zc(p),C=Zc(S);for(;N||C;){let k=!1,K=!1;if(N&&C){const G=d(N,C);G<0?K=!0:G>0&&(k=!0)}else N!=null?K=!0:k=!0;k?(g(C),C=Zc(S)):K?(y(N),N=Zc(p)):(N=Zc(p),C=Zc(S))}})(i,s,Xo,(a=>{o.push(this.jn(e,t,r,a))}),(a=>{o.push(this.Hn(e,t,r,a))})),oe.waitFor(o)}Wn(e){let t=1;return nu(e).ee({index:ib,reverse:!0,range:IDBKeyRange.upperBound([this.uid,Number.MAX_SAFE_INTEGER])},((r,i,s)=>{s.done(),t=i.sequenceNumber+1})).next((()=>t))}createRange(e,t,r){r=r.sort(((o,a)=>Xo(o,a))).filter(((o,a,c)=>!a||Xo(o,c[a-1])!==0));const i=[];i.push(e);for(const o of r){const a=Xo(o,e),c=Xo(o,t);if(a===0)i[0]=e.En();else if(a>0&&c<0)i.push(o),i.push(o.En());else if(c>0)break}i.push(t);const s=[];for(let o=0;o<i.length;o+=2){if(this.Jn(i[o],i[o+1]))return[];const a=i[o].An(this.uid,Dd,Fe.empty()),c=i[o+1].An(this.uid,Dd,Fe.empty());s.push(IDBKeyRange.bound(a,c))}return s}Jn(e,t){return Xo(e,t)>0}getMinOffsetFromCollectionGroup(e,t){return this.getFieldIndexes(e,t).next(r_)}getMinOffset(e,t){return oe.mapArray(this.vn(t),(r=>this.Fn(e,r).next((i=>i||qe(44426))))).next(r_)}}function n_(n){return rr(n,xh)}function tu(n){return rr(n,ch)}function Vl(n){return rr(n,D1)}function nu(n){return rr(n,ah)}function r_(n){Ke(n.length!==0,28825);let e=n[0].indexState.offset,t=e.largestBatchId;for(let r=1;r<n.length;r++){const i=n[r].indexState.offset;k1(i,e)<0&&(e=i),t<i.largestBatchId&&(t=i.largestBatchId)}return new Ri(e.readTime,e.documentKey,t)}const i_={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0},hI=41943040;class Rr{static withCacheSize(e){return new Rr(e,Rr.DEFAULT_COLLECTION_PERCENTILE,Rr.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}constructor(e,t,r){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=t,this.maximumSequenceNumbersToCollect=r}}function dI(n,e,t){const r=n.store(is),i=n.store(Ou),s=[],o=IDBKeyRange.only(t.batchId);let a=0;const c=r.ee({range:o},((d,g,y)=>(a++,y.delete())));s.push(c.next((()=>{Ke(a===1,47070,{batchId:t.batchId})})));const u=[];for(const d of t.mutations){const g=tb(e,d.key.path,t.batchId);s.push(i.delete(g)),u.push(d.key)}return oe.waitFor(s).next((()=>u))}function Of(n){if(!n)return 0;let e;if(n.document)e=n.document;else if(n.unknownDocument)e=n.unknownDocument;else{if(!n.noDocument)throw qe(14731);e=n.noDocument}return JSON.stringify(e).length}Rr.DEFAULT_COLLECTION_PERCENTILE=10,Rr.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,Rr.DEFAULT=new Rr(hI,Rr.DEFAULT_COLLECTION_PERCENTILE,Rr.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),Rr.DISABLED=new Rr(-1,0,0);class wp{constructor(e,t,r,i){this.userId=e,this.serializer=t,this.indexManager=r,this.referenceDelegate=i,this.Zn={}}static wt(e,t,r,i){Ke(e.uid!=="",64387);const s=e.isAuthenticated()?e.uid:"";return new wp(s,t,r,i)}checkEmpty(e){let t=!0;const r=IDBKeyRange.bound([this.userId,Number.NEGATIVE_INFINITY],[this.userId,Number.POSITIVE_INFINITY]);return Zo(e).ee({index:oc,range:r},((i,s,o)=>{t=!1,o.done()})).next((()=>t))}addMutationBatch(e,t,r,i){const s=hu(e),o=Zo(e);return o.add({}).next((a=>{Ke(typeof a=="number",49019);const c=new $1(a,t,r,i),u=(function(p,S,N){const C=N.baseMutations.map((K=>Dh(p.yt,K))),k=N.mutations.map((K=>Dh(p.yt,K)));return{userId:S,batchId:N.batchId,localWriteTimeMs:N.localWriteTime.toMillis(),baseMutations:C,mutations:k}})(this.serializer,this.userId,c),d=[];let g=new tn(((y,p)=>wt(y.canonicalString(),p.canonicalString())));for(const y of i){const p=tb(this.userId,y.key.path,a);g=g.add(y.key.path.popLast()),d.push(o.put(u)),d.push(s.put(p,VR))}return g.forEach((y=>{d.push(this.indexManager.addToCollectionParentIndex(e,y))})),e.addOnCommittedListener((()=>{this.Zn[a]=c.keys()})),oe.waitFor(d).next((()=>c))}))}lookupMutationBatch(e,t){return Zo(e).get(t).next((r=>r?(Ke(r.userId===this.userId,48,"Unexpected user for mutation batch",{userId:r.userId,batchId:t}),ec(this.serializer,r)):null))}Xn(e,t){return this.Zn[t]?oe.resolve(this.Zn[t]):this.lookupMutationBatch(e,t).next((r=>{if(r){const i=r.keys();return this.Zn[t]=i,i}return null}))}getNextMutationBatchAfterBatchId(e,t){const r=t+1,i=IDBKeyRange.lowerBound([this.userId,r]);let s=null;return Zo(e).ee({index:oc,range:i},((o,a,c)=>{a.userId===this.userId&&(Ke(a.batchId>=r,47524,{Yn:r}),s=ec(this.serializer,a)),c.done()})).next((()=>s))}getHighestUnacknowledgedBatchId(e){const t=IDBKeyRange.upperBound([this.userId,Number.POSITIVE_INFINITY]);let r=da;return Zo(e).ee({index:oc,range:t,reverse:!0},((i,s,o)=>{r=s.batchId,o.done()})).next((()=>r))}getAllMutationBatches(e){const t=IDBKeyRange.bound([this.userId,da],[this.userId,Number.POSITIVE_INFINITY]);return Zo(e).H(oc,t).next((r=>r.map((i=>ec(this.serializer,i)))))}getAllMutationBatchesAffectingDocumentKey(e,t){const r=Zd(this.userId,t.path),i=IDBKeyRange.lowerBound(r),s=[];return hu(e).ee({range:i},((o,a,c)=>{const[u,d,g]=o,y=Ms(d);if(u===this.userId&&t.path.isEqual(y))return Zo(e).get(g).next((p=>{if(!p)throw qe(61480,{er:o,batchId:g});Ke(p.userId===this.userId,10503,"Unexpected user for mutation batch",{userId:p.userId,batchId:g}),s.push(ec(this.serializer,p))}));c.done()})).next((()=>s))}getAllMutationBatchesAffectingDocumentKeys(e,t){let r=new tn(wt);const i=[];return t.forEach((s=>{const o=Zd(this.userId,s.path),a=IDBKeyRange.lowerBound(o),c=hu(e).ee({range:a},((u,d,g)=>{const[y,p,S]=u,N=Ms(p);y===this.userId&&s.path.isEqual(N)?r=r.add(S):g.done()}));i.push(c)})),oe.waitFor(i).next((()=>this.tr(e,r)))}getAllMutationBatchesAffectingQuery(e,t){const r=t.path,i=r.length+1,s=Zd(this.userId,r),o=IDBKeyRange.lowerBound(s);let a=new tn(wt);return hu(e).ee({range:o},((c,u,d)=>{const[g,y,p]=c,S=Ms(y);g===this.userId&&r.isPrefixOf(S)?S.length===i&&(a=a.add(p)):d.done()})).next((()=>this.tr(e,a)))}tr(e,t){const r=[],i=[];return t.forEach((s=>{i.push(Zo(e).get(s).next((o=>{if(o===null)throw qe(35274,{batchId:s});Ke(o.userId===this.userId,9748,"Unexpected user for mutation batch",{userId:o.userId,batchId:s}),r.push(ec(this.serializer,o))})))})),oe.waitFor(i).next((()=>r))}removeMutationBatch(e,t){return dI(e.le,this.userId,t).next((r=>(e.addOnCommittedListener((()=>{this.nr(t.batchId)})),oe.forEach(r,(i=>this.referenceDelegate.markPotentiallyOrphaned(e,i))))))}nr(e){delete this.Zn[e]}performConsistencyCheck(e){return this.checkEmpty(e).next((t=>{if(!t)return oe.resolve();const r=IDBKeyRange.lowerBound((function(o){return[o]})(this.userId)),i=[];return hu(e).ee({range:r},((s,o,a)=>{if(s[0]===this.userId){const c=Ms(s[1]);i.push(c)}else a.done()})).next((()=>{Ke(i.length===0,56720,{rr:i.map((s=>s.canonicalString()))})}))}))}containsKey(e,t){return fI(e,this.userId,t)}ir(e){return pI(e).get(this.userId).next((t=>t||{userId:this.userId,lastAcknowledgedBatchId:da,lastStreamToken:""}))}}function fI(n,e,t){const r=Zd(e,t.path),i=r[1],s=IDBKeyRange.lowerBound(r);let o=!1;return hu(n).ee({range:s,Y:!0},((a,c,u)=>{const[d,g,y]=a;d===e&&g===i&&(o=!0),u.done()})).next((()=>o))}function Zo(n){return rr(n,is)}function hu(n){return rr(n,Ou)}function pI(n){return rr(n,Sh)}class Ac{constructor(e){this.sr=e}next(){return this.sr+=2,this.sr}static _r(){return new Ac(0)}static ar(){return new Ac(-1)}}class l6{constructor(e,t){this.referenceDelegate=e,this.serializer=t}allocateTargetId(e){return this.ur(e).next((t=>{const r=new Ac(t.highestTargetId);return t.highestTargetId=r.next(),this.cr(e,t).next((()=>t.highestTargetId))}))}getLastRemoteSnapshotVersion(e){return this.ur(e).next((t=>et.fromTimestamp(new Jt(t.lastRemoteSnapshotVersion.seconds,t.lastRemoteSnapshotVersion.nanoseconds))))}getHighestSequenceNumber(e){return this.ur(e).next((t=>t.highestListenSequenceNumber))}setTargetsMetadata(e,t,r){return this.ur(e).next((i=>(i.highestListenSequenceNumber=t,r&&(i.lastRemoteSnapshotVersion=r.toTimestamp()),t>i.highestListenSequenceNumber&&(i.highestListenSequenceNumber=t),this.cr(e,i))))}addTargetData(e,t){return this.lr(e,t).next((()=>this.ur(e).next((r=>(r.targetCount+=1,this.hr(t,r),this.cr(e,r))))))}updateTargetData(e,t){return this.lr(e,t)}removeTargetData(e,t){return this.removeMatchingKeysForTargetId(e,t.targetId).next((()=>ru(e).delete(t.targetId))).next((()=>this.ur(e))).next((r=>(Ke(r.targetCount>0,8065),r.targetCount-=1,this.cr(e,r))))}removeTargets(e,t,r){let i=0;const s=[];return ru(e).ee(((o,a)=>{const c=Ql(a);c.sequenceNumber<=t&&r.get(c.targetId)===null&&(i++,s.push(this.removeTargetData(e,c)))})).next((()=>oe.waitFor(s))).next((()=>i))}forEachTarget(e,t){return ru(e).ee(((r,i)=>{const s=Ql(i);t(s)}))}ur(e){return s_(e).get(Rf).next((t=>(Ke(t!==null,2888),t)))}cr(e,t){return s_(e).put(Rf,t)}lr(e,t){return ru(e).put(cI(this.serializer,t))}hr(e,t){let r=!1;return e.targetId>t.highestTargetId&&(t.highestTargetId=e.targetId,r=!0),e.sequenceNumber>t.highestListenSequenceNumber&&(t.highestListenSequenceNumber=e.sequenceNumber,r=!0),r}getTargetCount(e){return this.ur(e).next((t=>t.targetCount))}getTargetData(e,t){const r=_c(t),i=IDBKeyRange.bound([r,Number.NEGATIVE_INFINITY],[r,Number.POSITIVE_INFINITY]);let s=null;return ru(e).ee({range:i,index:rb},((o,a,c)=>{const u=Ql(a);Xh(t,u.target)&&(s=u,c.done())})).next((()=>s))}addMatchingKeys(e,t,r){const i=[],s=ia(e);return t.forEach((o=>{const a=kr(o.path);i.push(s.put({targetId:r,path:a})),i.push(this.referenceDelegate.addReference(e,r,o))})),oe.waitFor(i)}removeMatchingKeys(e,t,r){const i=ia(e);return oe.forEach(t,(s=>{const o=kr(s.path);return oe.waitFor([i.delete([r,o]),this.referenceDelegate.removeReference(e,r,s)])}))}removeMatchingKeysForTargetId(e,t){const r=ia(e),i=IDBKeyRange.bound([t],[t+1],!1,!0);return r.delete(i)}getMatchingKeysForTargetId(e,t){const r=IDBKeyRange.bound([t],[t+1],!1,!0),i=ia(e);let s=xt();return i.ee({range:r,Y:!0},((o,a,c)=>{const u=Ms(o[1]),d=new Fe(u);s=s.add(d)})).next((()=>s))}containsKey(e,t){const r=kr(t.path),i=IDBKeyRange.bound([r],[Ww(r)],!1,!0);let s=0;return ia(e).ee({index:L1,Y:!0,range:i},(([o,a],c,u)=>{o!==0&&(s++,u.done())})).next((()=>s>0))}At(e,t){return ru(e).get(t).next((r=>r?Ql(r):null))}}function ru(n){return rr(n,Fu)}function s_(n){return rr(n,hc)}function ia(n){return rr(n,Mu)}const o_="LruGarbageCollector",h6=1048576;function a_([n,e],[t,r]){const i=wt(n,t);return i===0?wt(e,r):i}class d6{constructor(e){this.Pr=e,this.buffer=new tn(a_),this.Tr=0}Ir(){return++this.Tr}Er(e){const t=[e,this.Ir()];if(this.buffer.size<this.Pr)this.buffer=this.buffer.add(t);else{const r=this.buffer.last();a_(t,r)<0&&(this.buffer=this.buffer.delete(r).add(t))}}get maxValue(){return this.buffer.last()[0]}}class gI{constructor(e,t,r){this.garbageCollector=e,this.asyncQueue=t,this.localStore=r,this.Rr=null}start(){this.garbageCollector.params.cacheSizeCollectionThreshold!==-1&&this.Ar(6e4)}stop(){this.Rr&&(this.Rr.cancel(),this.Rr=null)}get started(){return this.Rr!==null}Ar(e){Ne(o_,`Garbage collection scheduled in ${e}ms`),this.Rr=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,(async()=>{this.Rr=null;try{await this.localStore.collectGarbage(this.garbageCollector)}catch(t){Na(t)?Ne(o_,"Ignoring IndexedDB error during garbage collection: ",t):await Ra(t)}await this.Ar(3e5)}))}}class f6{constructor(e,t){this.Vr=e,this.params=t}calculateTargetCount(e,t){return this.Vr.dr(e).next((r=>Math.floor(t/100*r)))}nthSequenceNumber(e,t){if(t===0)return oe.resolve(ui.ce);const r=new d6(t);return this.Vr.forEachTarget(e,(i=>r.Er(i.sequenceNumber))).next((()=>this.Vr.mr(e,(i=>r.Er(i))))).next((()=>r.maxValue))}removeTargets(e,t,r){return this.Vr.removeTargets(e,t,r)}removeOrphanedDocuments(e,t){return this.Vr.removeOrphanedDocuments(e,t)}collect(e,t){return this.params.cacheSizeCollectionThreshold===-1?(Ne("LruGarbageCollector","Garbage collection skipped; disabled"),oe.resolve(i_)):this.getCacheSize(e).next((r=>r<this.params.cacheSizeCollectionThreshold?(Ne("LruGarbageCollector",`Garbage collection skipped; Cache size ${r} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),i_):this.gr(e,t)))}getCacheSize(e){return this.Vr.getCacheSize(e)}gr(e,t){let r,i,s,o,a,c,u;const d=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next((g=>(g>this.params.maximumSequenceNumbersToCollect?(Ne("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${g}`),i=this.params.maximumSequenceNumbersToCollect):i=g,o=Date.now(),this.nthSequenceNumber(e,i)))).next((g=>(r=g,a=Date.now(),this.removeTargets(e,r,t)))).next((g=>(s=g,c=Date.now(),this.removeOrphanedDocuments(e,r)))).next((g=>(u=Date.now(),au()<=Dt.DEBUG&&Ne("LruGarbageCollector",`LRU Garbage Collection
	Counted targets in ${o-d}ms
	Determined least recently used ${i} in `+(a-o)+`ms
	Removed ${s} targets in `+(c-a)+`ms
	Removed ${g} documents in `+(u-c)+`ms
Total Duration: ${u-d}ms`),oe.resolve({didRun:!0,sequenceNumbersCollected:i,targetsRemoved:s,documentsRemoved:g}))))}}function mI(n,e){return new f6(n,e)}class p6{constructor(e,t){this.db=e,this.garbageCollector=mI(this,t)}dr(e){const t=this.pr(e);return this.db.getTargetCache().getTargetCount(e).next((r=>t.next((i=>r+i))))}pr(e){let t=0;return this.mr(e,(r=>{t++})).next((()=>t))}forEachTarget(e,t){return this.db.getTargetCache().forEachTarget(e,t)}mr(e,t){return this.yr(e,((r,i)=>t(i)))}addReference(e,t,r){return Od(e,r)}removeReference(e,t,r){return Od(e,r)}removeTargets(e,t,r){return this.db.getTargetCache().removeTargets(e,t,r)}markPotentiallyOrphaned(e,t){return Od(e,t)}wr(e,t){return(function(i,s){let o=!1;return pI(i).te((a=>fI(i,a,s).next((c=>(c&&(o=!0),oe.resolve(!c)))))).next((()=>o))})(e,t)}removeOrphanedDocuments(e,t){const r=this.db.getRemoteDocumentCache().newChangeBuffer(),i=[];let s=0;return this.yr(e,((o,a)=>{if(a<=t){const c=this.wr(e,o).next((u=>{if(!u)return s++,r.getEntry(e,o).next((()=>(r.removeEntry(o,et.min()),ia(e).delete((function(g){return[0,kr(g.path)]})(o)))))}));i.push(c)}})).next((()=>oe.waitFor(i))).next((()=>r.apply(e))).next((()=>s))}removeTarget(e,t){const r=t.withSequenceNumber(e.currentSequenceNumber);return this.db.getTargetCache().updateTargetData(e,r)}updateLimboDocument(e,t){return Od(e,t)}yr(e,t){const r=ia(e);let i,s=ui.ce;return r.ee({index:L1},(([o,a],{path:c,sequenceNumber:u})=>{o===0?(s!==ui.ce&&t(new Fe(Ms(i)),s),s=u,i=c):s=ui.ce})).next((()=>{s!==ui.ce&&t(new Fe(Ms(i)),s)}))}getCacheSize(e){return this.db.getRemoteDocumentCache().getSize(e)}}function Od(n,e){return ia(n).put((function(r,i){return{targetId:0,path:kr(r.path),sequenceNumber:i}})(e,n.currentSequenceNumber))}class yI{constructor(){this.changes=new So((e=>e.toString()),((e,t)=>e.isEqual(t))),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,t){this.assertNotApplied(),this.changes.set(e,bn.newInvalidDocument(e).setReadTime(t))}getEntry(e,t){this.assertNotApplied();const r=this.changes.get(t);return r!==void 0?oe.resolve(r):this.getFromCache(e,t)}getEntries(e,t){return this.getAllFromCache(e,t)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}class g6{constructor(e){this.serializer=e}setIndexManager(e){this.indexManager=e}addEntry(e,t,r){return Ka(e).put(r)}removeEntry(e,t,r){return Ka(e).delete((function(s,o){const a=s.path.toArray();return[a.slice(0,a.length-2),a[a.length-2],Lf(o),a[a.length-1]]})(t,r))}updateMetadata(e,t){return this.getMetadata(e).next((r=>(r.byteSize+=t,this.br(e,r))))}getEntry(e,t){let r=bn.newInvalidDocument(t);return Ka(e).ee({index:ef,range:IDBKeyRange.only(Bl(t))},((i,s)=>{r=this.Sr(t,s)})).next((()=>r))}Dr(e,t){let r={size:0,document:bn.newInvalidDocument(t)};return Ka(e).ee({index:ef,range:IDBKeyRange.only(Bl(t))},((i,s)=>{r={document:this.Sr(t,s),size:Of(s)}})).next((()=>r))}getEntries(e,t){let r=hi();return this.Cr(e,t,((i,s)=>{const o=this.Sr(i,s);r=r.insert(i,o)})).next((()=>r))}vr(e,t){let r=hi(),i=new _n(Fe.comparator);return this.Cr(e,t,((s,o)=>{const a=this.Sr(s,o);r=r.insert(s,a),i=i.insert(s,Of(o))})).next((()=>({documents:r,Fr:i})))}Cr(e,t,r){if(t.isEmpty())return oe.resolve();let i=new tn(l_);t.forEach((c=>i=i.add(c)));const s=IDBKeyRange.bound(Bl(i.first()),Bl(i.last())),o=i.getIterator();let a=o.getNext();return Ka(e).ee({index:ef,range:s},((c,u,d)=>{const g=Fe.fromSegments([...u.prefixPath,u.collectionGroup,u.documentId]);for(;a&&l_(a,g)<0;)r(a,null),a=o.getNext();a&&a.isEqual(g)&&(r(a,u),a=o.hasNext()?o.getNext():null),a?d.j(Bl(a)):d.done()})).next((()=>{for(;a;)r(a,null),a=o.hasNext()?o.getNext():null}))}getDocumentsMatchingQuery(e,t,r,i,s){const o=t.path,a=[o.popLast().toArray(),o.lastSegment(),Lf(r.readTime),r.documentKey.path.isEmpty()?"":r.documentKey.path.lastSegment()],c=[o.popLast().toArray(),o.lastSegment(),[Number.MAX_SAFE_INTEGER,Number.MAX_SAFE_INTEGER],""];return Ka(e).H(IDBKeyRange.bound(a,c,!0)).next((u=>{s?.incrementDocumentReadCount(u.length);let d=hi();for(const g of u){const y=this.Sr(Fe.fromSegments(g.prefixPath.concat(g.collectionGroup,g.documentId)),g);y.isFoundDocument()&&(ed(t,y)||i.has(y.key))&&(d=d.insert(y.key,y))}return d}))}getAllFromCollectionGroup(e,t,r,i){let s=hi();const o=u_(t,r),a=u_(t,Ri.max());return Ka(e).ee({index:nb,range:IDBKeyRange.bound(o,a,!0)},((c,u,d)=>{const g=this.Sr(Fe.fromSegments(u.prefixPath.concat(u.collectionGroup,u.documentId)),u);s=s.insert(g.key,g),s.size===i&&d.done()})).next((()=>s))}newChangeBuffer(e){return new m6(this,!!e&&e.trackRemovals)}getSize(e){return this.getMetadata(e).next((t=>t.byteSize))}getMetadata(e){return c_(e).get(um).next((t=>(Ke(!!t,20021),t)))}br(e,t){return c_(e).put(um,t)}Sr(e,t){if(t){const r=e6(this.serializer,t);if(!(r.isNoDocument()&&r.version.isEqual(et.min())))return r}return bn.newInvalidDocument(e)}}function _I(n){return new g6(n)}class m6 extends yI{constructor(e,t){super(),this.Mr=e,this.trackRemovals=t,this.Or=new So((r=>r.toString()),((r,i)=>r.isEqual(i)))}applyChanges(e){const t=[];let r=0,i=new tn(((s,o)=>wt(s.canonicalString(),o.canonicalString())));return this.changes.forEach(((s,o)=>{const a=this.Or.get(s);if(t.push(this.Mr.removeEntry(e,s,a.readTime)),o.isValidDocument()){const c=W2(this.Mr.serializer,o);i=i.add(s.path.popLast());const u=Of(c);r+=u-a.size,t.push(this.Mr.addEntry(e,s,c))}else if(r-=a.size,this.trackRemovals){const c=W2(this.Mr.serializer,o.convertToNoDocument(et.min()));t.push(this.Mr.addEntry(e,s,c))}})),i.forEach((s=>{t.push(this.Mr.indexManager.addToCollectionParentIndex(e,s))})),t.push(this.Mr.updateMetadata(e,r)),oe.waitFor(t)}getFromCache(e,t){return this.Mr.Dr(e,t).next((r=>(this.Or.set(t,{size:r.size,readTime:r.document.readTime}),r.document)))}getAllFromCache(e,t){return this.Mr.vr(e,t).next((({documents:r,Fr:i})=>(i.forEach(((s,o)=>{this.Or.set(s,{size:o,readTime:r.get(s).readTime})})),r)))}}function c_(n){return rr(n,Ph)}function Ka(n){return rr(n,xf)}function Bl(n){const e=n.path.toArray();return[e.slice(0,e.length-2),e[e.length-2],e[e.length-1]]}function u_(n,e){const t=e.documentKey.path.toArray();return[n,Lf(e.readTime),t.slice(0,t.length-2),t.length>0?t[t.length-1]:""]}function l_(n,e){const t=n.path.toArray(),r=e.path.toArray();let i=0;for(let s=0;s<t.length-2&&s<r.length-2;++s)if(i=wt(t[s],r[s]),i)return i;return i=wt(t.length,r.length),i||(i=wt(t[t.length-2],r[r.length-2]),i||wt(t[t.length-1],r[r.length-1]))}class y6{constructor(e,t){this.overlayedDocument=e,this.mutatedFields=t}}class vI{constructor(e,t,r,i){this.remoteDocumentCache=e,this.mutationQueue=t,this.documentOverlayCache=r,this.indexManager=i}getDocument(e,t){let r=null;return this.documentOverlayCache.getOverlay(e,t).next((i=>(r=i,this.remoteDocumentCache.getEntry(e,t)))).next((i=>(r!==null&&hh(r.mutation,i,li.empty(),Jt.now()),i)))}getDocuments(e,t){return this.remoteDocumentCache.getEntries(e,t).next((r=>this.getLocalViewOfDocuments(e,r,xt()).next((()=>r))))}getLocalViewOfDocuments(e,t,r=xt()){const i=Vs();return this.populateOverlays(e,i,t).next((()=>this.computeViews(e,t,i,r).next((s=>{let o=Yl();return s.forEach(((a,c)=>{o=o.insert(a,c.overlayedDocument)})),o}))))}getOverlayedDocuments(e,t){const r=Vs();return this.populateOverlays(e,r,t).next((()=>this.computeViews(e,t,r,xt())))}populateOverlays(e,t,r){const i=[];return r.forEach((s=>{t.has(s)||i.push(s)})),this.documentOverlayCache.getOverlays(e,i).next((s=>{s.forEach(((o,a)=>{t.set(o,a)}))}))}computeViews(e,t,r,i){let s=hi();const o=lh(),a=(function(){return lh()})();return t.forEach(((c,u)=>{const d=r.get(u.key);i.has(u.key)&&(d===void 0||d.mutation instanceof Po)?s=s.insert(u.key,u):d!==void 0?(o.set(u.key,d.mutation.getFieldMask()),hh(d.mutation,u,d.mutation.getFieldMask(),Jt.now())):o.set(u.key,li.empty())})),this.recalculateAndSaveOverlays(e,s).next((c=>(c.forEach(((u,d)=>o.set(u,d))),t.forEach(((u,d)=>a.set(u,new y6(d,o.get(u)??null)))),a)))}recalculateAndSaveOverlays(e,t){const r=lh();let i=new _n(((o,a)=>o-a)),s=xt();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,t).next((o=>{for(const a of o)a.keys().forEach((c=>{const u=t.get(c);if(u===null)return;let d=r.get(c)||li.empty();d=a.applyToLocalView(u,d),r.set(c,d);const g=(i.get(a.batchId)||xt()).add(c);i=i.insert(a.batchId,g)}))})).next((()=>{const o=[],a=i.getReverseIterator();for(;a.hasNext();){const c=a.getNext(),u=c.key,d=c.value,g=Db();d.forEach((y=>{if(!s.has(y)){const p=jb(t.get(y),r.get(y));p!==null&&g.set(y,p),s=s.add(y)}})),o.push(this.documentOverlayCache.saveOverlays(e,u,g))}return oe.waitFor(o)})).next((()=>r))}recalculateAndSaveOverlaysForDocumentKeys(e,t){return this.remoteDocumentCache.getEntries(e,t).next((r=>this.recalculateAndSaveOverlays(e,r)))}getDocumentsMatchingQuery(e,t,r,i){return IN(t)?this.getDocumentsMatchingDocumentQuery(e,t.path):U1(t)?this.getDocumentsMatchingCollectionGroupQuery(e,t,r,i):this.getDocumentsMatchingCollectionQuery(e,t,r,i)}getNextDocuments(e,t,r,i){return this.remoteDocumentCache.getAllFromCollectionGroup(e,t,r,i).next((s=>{const o=i-s.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,t,r.largestBatchId,i-s.size):oe.resolve(Vs());let a=Du,c=s;return o.next((u=>oe.forEach(u,((d,g)=>(a<g.largestBatchId&&(a=g.largestBatchId),s.get(d)?oe.resolve():this.remoteDocumentCache.getEntry(e,d).next((y=>{c=c.insert(d,y)}))))).next((()=>this.populateOverlays(e,u,s))).next((()=>this.computeViews(e,c,u,xt()))).next((d=>({batchId:a,changes:Lb(d)})))))}))}getDocumentsMatchingDocumentQuery(e,t){return this.getDocument(e,new Fe(t)).next((r=>{let i=Yl();return r.isFoundDocument()&&(i=i.insert(r.key,r)),i}))}getDocumentsMatchingCollectionGroupQuery(e,t,r,i){const s=t.collectionGroup;let o=Yl();return this.indexManager.getCollectionParents(e,s).next((a=>oe.forEach(a,(c=>{const u=(function(g,y){return new To(y,null,g.explicitOrderBy.slice(),g.filters.slice(),g.limit,g.limitType,g.startAt,g.endAt)})(t,c.child(s));return this.getDocumentsMatchingCollectionQuery(e,u,r,i).next((d=>{d.forEach(((g,y)=>{o=o.insert(g,y)}))}))})).next((()=>o))))}getDocumentsMatchingCollectionQuery(e,t,r,i){let s;return this.documentOverlayCache.getOverlaysForCollection(e,t.path,r.largestBatchId).next((o=>(s=o,this.remoteDocumentCache.getDocumentsMatchingQuery(e,t,r,s,i)))).next((o=>{s.forEach(((c,u)=>{const d=u.getKey();o.get(d)===null&&(o=o.insert(d,bn.newInvalidDocument(d)))}));let a=Yl();return o.forEach(((c,u)=>{const d=s.get(c);d!==void 0&&hh(d.mutation,u,li.empty(),Jt.now()),ed(t,u)&&(a=a.insert(c,u))})),a}))}}class _6{constructor(e){this.serializer=e,this.Nr=new Map,this.Br=new Map}getBundleMetadata(e,t){return oe.resolve(this.Nr.get(t))}saveBundleMetadata(e,t){return this.Nr.set(t.id,(function(i){return{id:i.id,version:i.version,createTime:Hn(i.createTime)}})(t)),oe.resolve()}getNamedQuery(e,t){return oe.resolve(this.Br.get(t))}saveNamedQuery(e,t){return this.Br.set(t.name,(function(i){return{name:i.name,query:Y1(i.bundledQuery),readTime:Hn(i.readTime)}})(t)),oe.resolve()}}class v6{constructor(){this.overlays=new _n(Fe.comparator),this.Lr=new Map}getOverlay(e,t){return oe.resolve(this.overlays.get(t))}getOverlays(e,t){const r=Vs();return oe.forEach(t,(i=>this.getOverlay(e,i).next((s=>{s!==null&&r.set(i,s)})))).next((()=>r))}saveOverlays(e,t,r){return r.forEach(((i,s)=>{this.bt(e,t,s)})),oe.resolve()}removeOverlaysForBatchId(e,t,r){const i=this.Lr.get(r);return i!==void 0&&(i.forEach((s=>this.overlays=this.overlays.remove(s))),this.Lr.delete(r)),oe.resolve()}getOverlaysForCollection(e,t,r){const i=Vs(),s=t.length+1,o=new Fe(t.child("")),a=this.overlays.getIteratorFrom(o);for(;a.hasNext();){const c=a.getNext().value,u=c.getKey();if(!t.isPrefixOf(u.path))break;u.path.length===s&&c.largestBatchId>r&&i.set(c.getKey(),c)}return oe.resolve(i)}getOverlaysForCollectionGroup(e,t,r,i){let s=new _n(((u,d)=>u-d));const o=this.overlays.getIterator();for(;o.hasNext();){const u=o.getNext().value;if(u.getKey().getCollectionGroup()===t&&u.largestBatchId>r){let d=s.get(u.largestBatchId);d===null&&(d=Vs(),s=s.insert(u.largestBatchId,d)),d.set(u.getKey(),u)}}const a=Vs(),c=s.getIterator();for(;c.hasNext()&&(c.getNext().value.forEach(((u,d)=>a.set(u,d))),!(a.size()>=i)););return oe.resolve(a)}bt(e,t,r){const i=this.overlays.get(r.key);if(i!==null){const o=this.Lr.get(i.largestBatchId).delete(r.key);this.Lr.set(i.largestBatchId,o)}this.overlays=this.overlays.insert(r.key,new H1(t,r));let s=this.Lr.get(t);s===void 0&&(s=xt(),this.Lr.set(t,s)),this.Lr.set(t,s.add(r.key))}}class w6{constructor(){this.sessionToken=On.EMPTY_BYTE_STRING}getSessionToken(e){return oe.resolve(this.sessionToken)}setSessionToken(e,t){return this.sessionToken=t,oe.resolve()}}class X1{constructor(){this.kr=new tn(ar.Kr),this.qr=new tn(ar.Ur)}isEmpty(){return this.kr.isEmpty()}addReference(e,t){const r=new ar(e,t);this.kr=this.kr.add(r),this.qr=this.qr.add(r)}$r(e,t){e.forEach((r=>this.addReference(r,t)))}removeReference(e,t){this.Wr(new ar(e,t))}Qr(e,t){e.forEach((r=>this.removeReference(r,t)))}Gr(e){const t=new Fe(new Ot([])),r=new ar(t,e),i=new ar(t,e+1),s=[];return this.qr.forEachInRange([r,i],(o=>{this.Wr(o),s.push(o.key)})),s}zr(){this.kr.forEach((e=>this.Wr(e)))}Wr(e){this.kr=this.kr.delete(e),this.qr=this.qr.delete(e)}jr(e){const t=new Fe(new Ot([])),r=new ar(t,e),i=new ar(t,e+1);let s=xt();return this.qr.forEachInRange([r,i],(o=>{s=s.add(o.key)})),s}containsKey(e){const t=new ar(e,0),r=this.kr.firstAfterOrEqual(t);return r!==null&&e.isEqual(r.key)}}class ar{constructor(e,t){this.key=e,this.Hr=t}static Kr(e,t){return Fe.comparator(e.key,t.key)||wt(e.Hr,t.Hr)}static Ur(e,t){return wt(e.Hr,t.Hr)||Fe.comparator(e.key,t.key)}}class b6{constructor(e,t){this.indexManager=e,this.referenceDelegate=t,this.mutationQueue=[],this.Yn=1,this.Jr=new tn(ar.Kr)}checkEmpty(e){return oe.resolve(this.mutationQueue.length===0)}addMutationBatch(e,t,r,i){const s=this.Yn;this.Yn++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const o=new $1(s,t,r,i);this.mutationQueue.push(o);for(const a of i)this.Jr=this.Jr.add(new ar(a.key,s)),this.indexManager.addToCollectionParentIndex(e,a.key.path.popLast());return oe.resolve(o)}lookupMutationBatch(e,t){return oe.resolve(this.Zr(t))}getNextMutationBatchAfterBatchId(e,t){const r=t+1,i=this.Xr(r),s=i<0?0:i;return oe.resolve(this.mutationQueue.length>s?this.mutationQueue[s]:null)}getHighestUnacknowledgedBatchId(){return oe.resolve(this.mutationQueue.length===0?da:this.Yn-1)}getAllMutationBatches(e){return oe.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,t){const r=new ar(t,0),i=new ar(t,Number.POSITIVE_INFINITY),s=[];return this.Jr.forEachInRange([r,i],(o=>{const a=this.Zr(o.Hr);s.push(a)})),oe.resolve(s)}getAllMutationBatchesAffectingDocumentKeys(e,t){let r=new tn(wt);return t.forEach((i=>{const s=new ar(i,0),o=new ar(i,Number.POSITIVE_INFINITY);this.Jr.forEachInRange([s,o],(a=>{r=r.add(a.Hr)}))})),oe.resolve(this.Yr(r))}getAllMutationBatchesAffectingQuery(e,t){const r=t.path,i=r.length+1;let s=r;Fe.isDocumentKey(s)||(s=s.child(""));const o=new ar(new Fe(s),0);let a=new tn(wt);return this.Jr.forEachWhile((c=>{const u=c.key.path;return!!r.isPrefixOf(u)&&(u.length===i&&(a=a.add(c.Hr)),!0)}),o),oe.resolve(this.Yr(a))}Yr(e){const t=[];return e.forEach((r=>{const i=this.Zr(r);i!==null&&t.push(i)})),t}removeMutationBatch(e,t){Ke(this.ei(t.batchId,"removed")===0,55003),this.mutationQueue.shift();let r=this.Jr;return oe.forEach(t.mutations,(i=>{const s=new ar(i.key,t.batchId);return r=r.delete(s),this.referenceDelegate.markPotentiallyOrphaned(e,i.key)})).next((()=>{this.Jr=r}))}nr(e){}containsKey(e,t){const r=new ar(t,0),i=this.Jr.firstAfterOrEqual(r);return oe.resolve(t.isEqual(i&&i.key))}performConsistencyCheck(e){return this.mutationQueue.length,oe.resolve()}ei(e,t){return this.Xr(e)}Xr(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}Zr(e){const t=this.Xr(e);return t<0||t>=this.mutationQueue.length?null:this.mutationQueue[t]}}class I6{constructor(e){this.ti=e,this.docs=(function(){return new _n(Fe.comparator)})(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,t){const r=t.key,i=this.docs.get(r),s=i?i.size:0,o=this.ti(t);return this.docs=this.docs.insert(r,{document:t.mutableCopy(),size:o}),this.size+=o-s,this.indexManager.addToCollectionParentIndex(e,r.path.popLast())}removeEntry(e){const t=this.docs.get(e);t&&(this.docs=this.docs.remove(e),this.size-=t.size)}getEntry(e,t){const r=this.docs.get(t);return oe.resolve(r?r.document.mutableCopy():bn.newInvalidDocument(t))}getEntries(e,t){let r=hi();return t.forEach((i=>{const s=this.docs.get(i);r=r.insert(i,s?s.document.mutableCopy():bn.newInvalidDocument(i))})),oe.resolve(r)}getDocumentsMatchingQuery(e,t,r,i){let s=hi();const o=t.path,a=new Fe(o.child("__id-9223372036854775808__")),c=this.docs.getIteratorFrom(a);for(;c.hasNext();){const{key:u,value:{document:d}}=c.getNext();if(!o.isPrefixOf(u.path))break;u.path.length>o.length+1||k1(Jw(d),r)<=0||(i.has(d.key)||ed(t,d))&&(s=s.insert(d.key,d.mutableCopy()))}return oe.resolve(s)}getAllFromCollectionGroup(e,t,r,i){qe(9500)}ni(e,t){return oe.forEach(this.docs,(r=>t(r)))}newChangeBuffer(e){return new A6(this)}getSize(e){return oe.resolve(this.size)}}class A6 extends yI{constructor(e){super(),this.Mr=e}applyChanges(e){const t=[];return this.changes.forEach(((r,i)=>{i.isValidDocument()?t.push(this.Mr.addEntry(e,i)):this.Mr.removeEntry(r)})),oe.waitFor(t)}getFromCache(e,t){return this.Mr.getEntry(e,t)}getAllFromCache(e,t){return this.Mr.getEntries(e,t)}}class E6{constructor(e){this.persistence=e,this.ri=new So((t=>_c(t)),Xh),this.lastRemoteSnapshotVersion=et.min(),this.highestTargetId=0,this.ii=0,this.si=new X1,this.targetCount=0,this.oi=Ac._r()}forEachTarget(e,t){return this.ri.forEach(((r,i)=>t(i))),oe.resolve()}getLastRemoteSnapshotVersion(e){return oe.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return oe.resolve(this.ii)}allocateTargetId(e){return this.highestTargetId=this.oi.next(),oe.resolve(this.highestTargetId)}setTargetsMetadata(e,t,r){return r&&(this.lastRemoteSnapshotVersion=r),t>this.ii&&(this.ii=t),oe.resolve()}lr(e){this.ri.set(e.target,e);const t=e.targetId;t>this.highestTargetId&&(this.oi=new Ac(t),this.highestTargetId=t),e.sequenceNumber>this.ii&&(this.ii=e.sequenceNumber)}addTargetData(e,t){return this.lr(t),this.targetCount+=1,oe.resolve()}updateTargetData(e,t){return this.lr(t),oe.resolve()}removeTargetData(e,t){return this.ri.delete(t.target),this.si.Gr(t.targetId),this.targetCount-=1,oe.resolve()}removeTargets(e,t,r){let i=0;const s=[];return this.ri.forEach(((o,a)=>{a.sequenceNumber<=t&&r.get(a.targetId)===null&&(this.ri.delete(o),s.push(this.removeMatchingKeysForTargetId(e,a.targetId)),i++)})),oe.waitFor(s).next((()=>i))}getTargetCount(e){return oe.resolve(this.targetCount)}getTargetData(e,t){const r=this.ri.get(t)||null;return oe.resolve(r)}addMatchingKeys(e,t,r){return this.si.$r(t,r),oe.resolve()}removeMatchingKeys(e,t,r){this.si.Qr(t,r);const i=this.persistence.referenceDelegate,s=[];return i&&t.forEach((o=>{s.push(i.markPotentiallyOrphaned(e,o))})),oe.waitFor(s)}removeMatchingKeysForTargetId(e,t){return this.si.Gr(t),oe.resolve()}getMatchingKeysForTargetId(e,t){const r=this.si.jr(t);return oe.resolve(r)}containsKey(e,t){return oe.resolve(this.si.containsKey(t))}}class Z1{constructor(e,t){this._i={},this.overlays={},this.ai=new ui(0),this.ui=!1,this.ui=!0,this.ci=new w6,this.referenceDelegate=e(this),this.li=new E6(this),this.indexManager=new c6,this.remoteDocumentCache=(function(i){return new I6(i)})((r=>this.referenceDelegate.hi(r))),this.serializer=new aI(t),this.Pi=new _6(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.ui=!1,Promise.resolve()}get started(){return this.ui}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let t=this.overlays[e.toKey()];return t||(t=new v6,this.overlays[e.toKey()]=t),t}getMutationQueue(e,t){let r=this._i[e.toKey()];return r||(r=new b6(t,this.referenceDelegate),this._i[e.toKey()]=r),r}getGlobalsCache(){return this.ci}getTargetCache(){return this.li}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Pi}runTransaction(e,t,r){Ne("MemoryPersistence","Starting transaction:",e);const i=new T6(this.ai.next());return this.referenceDelegate.Ti(),r(i).next((s=>this.referenceDelegate.Ii(i).next((()=>s)))).toPromise().then((s=>(i.raiseOnCommittedEvent(),s)))}Ei(e,t){return oe.or(Object.values(this._i).map((r=>()=>r.containsKey(e,t))))}}class T6 extends Xw{constructor(e){super(),this.currentSequenceNumber=e}}class bp{constructor(e){this.persistence=e,this.Ri=new X1,this.Ai=null}static Vi(e){return new bp(e)}get di(){if(this.Ai)return this.Ai;throw qe(60996)}addReference(e,t,r){return this.Ri.addReference(r,t),this.di.delete(r.toString()),oe.resolve()}removeReference(e,t,r){return this.Ri.removeReference(r,t),this.di.add(r.toString()),oe.resolve()}markPotentiallyOrphaned(e,t){return this.di.add(t.toString()),oe.resolve()}removeTarget(e,t){this.Ri.Gr(t.targetId).forEach((i=>this.di.add(i.toString())));const r=this.persistence.getTargetCache();return r.getMatchingKeysForTargetId(e,t.targetId).next((i=>{i.forEach((s=>this.di.add(s.toString())))})).next((()=>r.removeTargetData(e,t)))}Ti(){this.Ai=new Set}Ii(e){const t=this.persistence.getRemoteDocumentCache().newChangeBuffer();return oe.forEach(this.di,(r=>{const i=Fe.fromPath(r);return this.mi(e,i).next((s=>{s||t.removeEntry(i,et.min())}))})).next((()=>(this.Ai=null,t.apply(e))))}updateLimboDocument(e,t){return this.mi(e,t).next((r=>{r?this.di.delete(t.toString()):this.di.add(t.toString())}))}hi(e){return 0}mi(e,t){return oe.or([()=>oe.resolve(this.Ri.containsKey(t)),()=>this.persistence.getTargetCache().containsKey(e,t),()=>this.persistence.Ei(e,t)])}}class Ff{constructor(e,t){this.persistence=e,this.fi=new So((r=>kr(r.path)),((r,i)=>r.isEqual(i))),this.garbageCollector=mI(this,t)}static Vi(e,t){return new Ff(e,t)}Ti(){}Ii(e){return oe.resolve()}forEachTarget(e,t){return this.persistence.getTargetCache().forEachTarget(e,t)}dr(e){const t=this.pr(e);return this.persistence.getTargetCache().getTargetCount(e).next((r=>t.next((i=>r+i))))}pr(e){let t=0;return this.mr(e,(r=>{t++})).next((()=>t))}mr(e,t){return oe.forEach(this.fi,((r,i)=>this.wr(e,r,i).next((s=>s?oe.resolve():t(i)))))}removeTargets(e,t,r){return this.persistence.getTargetCache().removeTargets(e,t,r)}removeOrphanedDocuments(e,t){let r=0;const i=this.persistence.getRemoteDocumentCache(),s=i.newChangeBuffer();return i.ni(e,(o=>this.wr(e,o,t).next((a=>{a||(r++,s.removeEntry(o,et.min()))})))).next((()=>s.apply(e))).next((()=>r))}markPotentiallyOrphaned(e,t){return this.fi.set(t,e.currentSequenceNumber),oe.resolve()}removeTarget(e,t){const r=t.withSequenceNumber(e.currentSequenceNumber);return this.persistence.getTargetCache().updateTargetData(e,r)}addReference(e,t,r){return this.fi.set(r,e.currentSequenceNumber),oe.resolve()}removeReference(e,t,r){return this.fi.set(r,e.currentSequenceNumber),oe.resolve()}updateLimboDocument(e,t){return this.fi.set(t,e.currentSequenceNumber),oe.resolve()}hi(e){let t=e.key.toString().length;return e.isFoundDocument()&&(t+=nf(e.data.value)),t}wr(e,t,r){return oe.or([()=>this.persistence.Ei(e,t),()=>this.persistence.getTargetCache().containsKey(e,t),()=>{const i=this.fi.get(t);return oe.resolve(i!==void 0&&i>r)}])}getCacheSize(e){return this.persistence.getRemoteDocumentCache().getSize(e)}}class S6{constructor(e){this.serializer=e}k(e,t,r,i){const s=new lp("createOrUpgrade",t);r<1&&i>=1&&((function(c){c.createObjectStore(Qh)})(e),(function(c){c.createObjectStore(Sh,{keyPath:MR}),c.createObjectStore(is,{keyPath:b2,autoIncrement:!0}).createIndex(oc,I2,{unique:!0}),c.createObjectStore(Ou)})(e),h_(e),(function(c){c.createObjectStore(Qa)})(e));let o=oe.resolve();return r<3&&i>=3&&(r!==0&&((function(c){c.deleteObjectStore(Mu),c.deleteObjectStore(Fu),c.deleteObjectStore(hc)})(e),h_(e)),o=o.next((()=>(function(c){const u=c.store(hc),d={highestTargetId:0,highestListenSequenceNumber:0,lastRemoteSnapshotVersion:et.min().toTimestamp(),targetCount:0};return u.put(Rf,d)})(s)))),r<4&&i>=4&&(r!==0&&(o=o.next((()=>(function(c,u){return u.store(is).H().next((g=>{c.deleteObjectStore(is),c.createObjectStore(is,{keyPath:b2,autoIncrement:!0}).createIndex(oc,I2,{unique:!0});const y=u.store(is),p=g.map((S=>y.put(S)));return oe.waitFor(p)}))})(e,s)))),o=o.next((()=>{(function(c){c.createObjectStore(Vu,{keyPath:HR})})(e)}))),r<5&&i>=5&&(o=o.next((()=>this.gi(s)))),r<6&&i>=6&&(o=o.next((()=>((function(c){c.createObjectStore(Ph)})(e),this.pi(s))))),r<7&&i>=7&&(o=o.next((()=>this.yi(s)))),r<8&&i>=8&&(o=o.next((()=>this.wi(e,s)))),r<9&&i>=9&&(o=o.next((()=>{(function(c){c.objectStoreNames.contains("remoteDocumentChanges")&&c.deleteObjectStore("remoteDocumentChanges")})(e)}))),r<10&&i>=10&&(o=o.next((()=>this.bi(s)))),r<11&&i>=11&&(o=o.next((()=>{(function(c){c.createObjectStore(hp,{keyPath:GR})})(e),(function(c){c.createObjectStore(dp,{keyPath:KR})})(e)}))),r<12&&i>=12&&(o=o.next((()=>{(function(c){const u=c.createObjectStore(fp,{keyPath:tN});u.createIndex(hm,nN,{unique:!1}),u.createIndex(ob,rN,{unique:!1})})(e)}))),r<13&&i>=13&&(o=o.next((()=>(function(c){const u=c.createObjectStore(xf,{keyPath:BR});u.createIndex(ef,UR),u.createIndex(nb,jR)})(e))).next((()=>this.Si(e,s))).next((()=>e.deleteObjectStore(Qa)))),r<14&&i>=14&&(o=o.next((()=>this.Di(e,s)))),r<15&&i>=15&&(o=o.next((()=>(function(c){c.createObjectStore(D1,{keyPath:YR,autoIncrement:!0}).createIndex(lm,JR,{unique:!1}),c.createObjectStore(ah,{keyPath:QR}).createIndex(ib,XR,{unique:!1}),c.createObjectStore(ch,{keyPath:ZR}).createIndex(sb,eN,{unique:!1})})(e)))),r<16&&i>=16&&(o=o.next((()=>{t.objectStore(ah).clear()})).next((()=>{t.objectStore(ch).clear()}))),r<17&&i>=17&&(o=o.next((()=>{(function(c){c.createObjectStore(O1,{keyPath:iN})})(e)}))),r<18&&i>=18&&E5()&&(o=o.next((()=>{t.objectStore(ah).clear()})).next((()=>{t.objectStore(ch).clear()}))),o}pi(e){let t=0;return e.store(Qa).ee(((r,i)=>{t+=Of(i)})).next((()=>{const r={byteSize:t};return e.store(Ph).put(um,r)}))}gi(e){const t=e.store(Sh),r=e.store(is);return t.H().next((i=>oe.forEach(i,(s=>{const o=IDBKeyRange.bound([s.userId,da],[s.userId,s.lastAcknowledgedBatchId]);return r.H(oc,o).next((a=>oe.forEach(a,(c=>{Ke(c.userId===s.userId,18650,"Cannot process batch from unexpected user",{batchId:c.batchId});const u=ec(this.serializer,c);return dI(e,s.userId,u).next((()=>{}))}))))}))))}yi(e){const t=e.store(Mu),r=e.store(Qa);return e.store(hc).get(Rf).next((i=>{const s=[];return r.ee(((o,a)=>{const c=new Ot(o),u=(function(g){return[0,kr(g)]})(c);s.push(t.get(u).next((d=>d?oe.resolve():(g=>t.put({targetId:0,path:kr(g),sequenceNumber:i.highestListenSequenceNumber}))(c))))})).next((()=>oe.waitFor(s)))}))}wi(e,t){e.createObjectStore(xh,{keyPath:WR});const r=t.store(xh),i=new Q1,s=o=>{if(i.add(o)){const a=o.lastSegment(),c=o.popLast();return r.put({collectionId:a,parent:kr(c)})}};return t.store(Qa).ee({Y:!0},((o,a)=>{const c=new Ot(o);return s(c.popLast())})).next((()=>t.store(Ou).ee({Y:!0},(([o,a,c],u)=>{const d=Ms(a);return s(d.popLast())}))))}bi(e){const t=e.store(Fu);return t.ee(((r,i)=>{const s=Ql(i),o=cI(this.serializer,s);return t.put(o)}))}Si(e,t){const r=t.store(Qa),i=[];return r.ee(((s,o)=>{const a=t.store(xf),c=(function(g){return g.document?new Fe(Ot.fromString(g.document.name).popFirst(5)):g.noDocument?Fe.fromSegments(g.noDocument.path):g.unknownDocument?Fe.fromSegments(g.unknownDocument.path):qe(36783)})(o).path.toArray(),u={prefixPath:c.slice(0,c.length-2),collectionGroup:c[c.length-2],documentId:c[c.length-1],readTime:o.readTime||[0,0],unknownDocument:o.unknownDocument,noDocument:o.noDocument,document:o.document,hasCommittedMutations:!!o.hasCommittedMutations};i.push(a.put(u))})).next((()=>oe.waitFor(i)))}Di(e,t){const r=t.store(is),i=_I(this.serializer),s=new Z1(bp.Vi,this.serializer.yt);return r.H().next((o=>{const a=new Map;return o.forEach((c=>{let u=a.get(c.userId)??xt();ec(this.serializer,c).keys().forEach((d=>u=u.add(d))),a.set(c.userId,u)})),oe.forEach(a,((c,u)=>{const d=new cr(u),g=vp.wt(this.serializer,d),y=s.getIndexManager(d),p=wp.wt(d,this.serializer,y,s.referenceDelegate);return new vI(i,p,g,y).recalculateAndSaveOverlaysForDocumentKeys(new dm(t,ui.ce),c).next()}))}))}}function h_(n){n.createObjectStore(Mu,{keyPath:zR}).createIndex(L1,$R,{unique:!0}),n.createObjectStore(Fu,{keyPath:"targetId"}).createIndex(rb,qR,{unique:!0}),n.createObjectStore(hc)}const ea="IndexedDbPersistence",mg=18e5,yg=5e3,_g="Failed to obtain exclusive access to the persistence layer. To allow shared access, multi-tab synchronization has to be enabled in all tabs. If you are using `experimentalForceOwningTab:true`, make sure that only one tab has persistence enabled at any given time.",wI="main";class e0{constructor(e,t,r,i,s,o,a,c,u,d,g=18){if(this.allowTabSynchronization=e,this.persistenceKey=t,this.clientId=r,this.Ci=s,this.window=o,this.document=a,this.Fi=u,this.Mi=d,this.xi=g,this.ai=null,this.ui=!1,this.isPrimary=!1,this.networkEnabled=!0,this.Oi=null,this.inForeground=!1,this.Ni=null,this.Bi=null,this.Li=Number.NEGATIVE_INFINITY,this.ki=y=>Promise.resolve(),!e0.v())throw new Pe(pe.UNIMPLEMENTED,"This platform is either missing IndexedDB or is known to have an incomplete implementation. Offline persistence has been disabled.");this.referenceDelegate=new p6(this,i),this.Ki=t+wI,this.serializer=new aI(c),this.qi=new Us(this.Ki,this.xi,new S6(this.serializer)),this.ci=new n6,this.li=new l6(this.referenceDelegate,this.serializer),this.remoteDocumentCache=_I(this.serializer),this.Pi=new t6,this.window&&this.window.localStorage?this.Ui=this.window.localStorage:(this.Ui=null,d===!1&&Wn(ea,"LocalStorage is unavailable. As a result, persistence may not work reliably. In particular enablePersistence() could fail immediately after refreshing the page."))}start(){return this.$i().then((()=>{if(!this.isPrimary&&!this.allowTabSynchronization)throw new Pe(pe.FAILED_PRECONDITION,_g);return this.Wi(),this.Qi(),this.Gi(),this.runTransaction("getHighestListenSequenceNumber","readonly",(e=>this.li.getHighestSequenceNumber(e)))})).then((e=>{this.ai=new ui(e,this.Fi)})).then((()=>{this.ui=!0})).catch((e=>(this.qi&&this.qi.close(),Promise.reject(e))))}zi(e){return this.ki=async t=>{if(this.started)return e(t)},e(this.isPrimary)}setDatabaseDeletedListener(e){this.qi.q((async t=>{t.newVersion===null&&await e()}))}setNetworkEnabled(e){this.networkEnabled!==e&&(this.networkEnabled=e,this.Ci.enqueueAndForget((async()=>{this.started&&await this.$i()})))}$i(){return this.runTransaction("updateClientMetadataAndTryBecomePrimary","readwrite",(e=>Fd(e).put({clientId:this.clientId,updateTimeMs:Date.now(),networkEnabled:this.networkEnabled,inForeground:this.inForeground}).next((()=>{if(this.isPrimary)return this.ji(e).next((t=>{t||(this.isPrimary=!1,this.Ci.enqueueRetryable((()=>this.ki(!1))))}))})).next((()=>this.Hi(e))).next((t=>this.isPrimary&&!t?this.Ji(e).next((()=>!1)):!!t&&this.Zi(e).next((()=>!0)))))).catch((e=>{if(Na(e))return Ne(ea,"Failed to extend owner lease: ",e),this.isPrimary;if(!this.allowTabSynchronization)throw e;return Ne(ea,"Releasing owner lease after error during lease refresh",e),!1})).then((e=>{this.isPrimary!==e&&this.Ci.enqueueRetryable((()=>this.ki(e))),this.isPrimary=e}))}ji(e){return Ul(e).get(Xc).next((t=>oe.resolve(this.Xi(t))))}Yi(e){return Fd(e).delete(this.clientId)}async es(){if(this.isPrimary&&!this.ts(this.Li,mg)){this.Li=Date.now();const e=await this.runTransaction("maybeGarbageCollectMultiClientState","readwrite-primary",(t=>{const r=rr(t,Vu);return r.H().next((i=>{const s=this.ns(i,mg),o=i.filter((a=>s.indexOf(a)===-1));return oe.forEach(o,(a=>r.delete(a.clientId))).next((()=>o))}))})).catch((()=>[]));if(this.Ui)for(const t of e)this.Ui.removeItem(this.rs(t.clientId))}}Gi(){this.Bi=this.Ci.enqueueAfterDelay("client_metadata_refresh",4e3,(()=>this.$i().then((()=>this.es())).then((()=>this.Gi()))))}Xi(e){return!!e&&e.ownerId===this.clientId}Hi(e){return this.Mi?oe.resolve(!0):Ul(e).get(Xc).next((t=>{if(t!==null&&this.ts(t.leaseTimestampMs,yg)&&!this.ss(t.ownerId)){if(this.Xi(t)&&this.networkEnabled)return!0;if(!this.Xi(t)){if(!t.allowTabSynchronization)throw new Pe(pe.FAILED_PRECONDITION,_g);return!1}}return!(!this.networkEnabled||!this.inForeground)||Fd(e).H().next((r=>this.ns(r,yg).find((i=>{if(this.clientId!==i.clientId){const s=!this.networkEnabled&&i.networkEnabled,o=!this.inForeground&&i.inForeground,a=this.networkEnabled===i.networkEnabled;if(s||o&&a)return!0}return!1}))===void 0))})).next((t=>(this.isPrimary!==t&&Ne(ea,`Client ${t?"is":"is not"} eligible for a primary lease.`),t)))}async shutdown(){this.ui=!1,this._s(),this.Bi&&(this.Bi.cancel(),this.Bi=null),this.us(),this.cs(),await this.qi.runTransaction("shutdown","readwrite",[Qh,Vu],(e=>{const t=new dm(e,ui.ce);return this.Ji(t).next((()=>this.Yi(t)))})),this.qi.close(),this.ls()}ns(e,t){return e.filter((r=>this.ts(r.updateTimeMs,t)&&!this.ss(r.clientId)))}hs(){return this.runTransaction("getActiveClients","readonly",(e=>Fd(e).H().next((t=>this.ns(t,mg).map((r=>r.clientId))))))}get started(){return this.ui}getGlobalsCache(){return this.ci}getMutationQueue(e,t){return wp.wt(e,this.serializer,t,this.referenceDelegate)}getTargetCache(){return this.li}getRemoteDocumentCache(){return this.remoteDocumentCache}getIndexManager(e){return new u6(e,this.serializer.yt.databaseId)}getDocumentOverlayCache(e){return vp.wt(this.serializer,e)}getBundleCache(){return this.Pi}runTransaction(e,t,r){Ne(ea,"Starting transaction:",e);const i=t==="readonly"?"readonly":"readwrite",s=(function(c){return c===18?aN:c===17?lb:c===16?oN:c===15?F1:c===14?ub:c===13?cb:c===12?sN:c===11?ab:void qe(60245)})(this.xi);let o;return this.qi.runTransaction(e,i,s,(a=>(o=new dm(a,this.ai?this.ai.next():ui.ce),t==="readwrite-primary"?this.ji(o).next((c=>!!c||this.Hi(o))).next((c=>{if(!c)throw Wn(`Failed to obtain primary lease for action '${e}'.`),this.isPrimary=!1,this.Ci.enqueueRetryable((()=>this.ki(!1))),new Pe(pe.FAILED_PRECONDITION,Qw);return r(o)})).next((c=>this.Zi(o).next((()=>c)))):this.Ps(o).next((()=>r(o)))))).then((a=>(o.raiseOnCommittedEvent(),a)))}Ps(e){return Ul(e).get(Xc).next((t=>{if(t!==null&&this.ts(t.leaseTimestampMs,yg)&&!this.ss(t.ownerId)&&!this.Xi(t)&&!(this.Mi||this.allowTabSynchronization&&t.allowTabSynchronization))throw new Pe(pe.FAILED_PRECONDITION,_g)}))}Zi(e){const t={ownerId:this.clientId,allowTabSynchronization:this.allowTabSynchronization,leaseTimestampMs:Date.now()};return Ul(e).put(Xc,t)}static v(){return Us.v()}Ji(e){const t=Ul(e);return t.get(Xc).next((r=>this.Xi(r)?(Ne(ea,"Releasing primary lease."),t.delete(Xc)):oe.resolve()))}ts(e,t){const r=Date.now();return!(e<r-t)&&(!(e>r)||(Wn(`Detected an update time that is in the future: ${e} > ${r}`),!1))}Wi(){this.document!==null&&typeof this.document.addEventListener=="function"&&(this.Ni=()=>{this.Ci.enqueueAndForget((()=>(this.inForeground=this.document.visibilityState==="visible",this.$i())))},this.document.addEventListener("visibilitychange",this.Ni),this.inForeground=this.document.visibilityState==="visible")}us(){this.Ni&&(this.document.removeEventListener("visibilitychange",this.Ni),this.Ni=null)}Qi(){typeof this.window?.addEventListener=="function"&&(this.Oi=()=>{this._s();const e=/(?:Version|Mobile)\/1[456]/;A5()&&(navigator.appVersion.match(e)||navigator.userAgent.match(e))&&this.Ci.enterRestrictedMode(!0),this.Ci.enqueueAndForget((()=>this.shutdown()))},this.window.addEventListener("pagehide",this.Oi))}cs(){this.Oi&&(this.window.removeEventListener("pagehide",this.Oi),this.Oi=null)}ss(e){try{const t=this.Ui?.getItem(this.rs(e))!==null;return Ne(ea,`Client '${e}' ${t?"is":"is not"} zombied in LocalStorage`),t}catch(t){return Wn(ea,"Failed to get zombied client id.",t),!1}}_s(){if(this.Ui)try{this.Ui.setItem(this.rs(this.clientId),String(Date.now()))}catch(e){Wn("Failed to set zombie client id.",e)}}ls(){if(this.Ui)try{this.Ui.removeItem(this.rs(this.clientId))}catch{}}rs(e){return`firestore_zombie_${this.persistenceKey}_${e}`}}function Ul(n){return rr(n,Qh)}function Fd(n){return rr(n,Vu)}function t0(n,e){let t=n.projectId;return n.isDefaultDatabase||(t+="."+n.database),"firestore/"+e+"/"+t+"/"}class n0{constructor(e,t,r,i){this.targetId=e,this.fromCache=t,this.Ts=r,this.Is=i}static Es(e,t){let r=xt(),i=xt();for(const s of t.docChanges)switch(s.type){case 0:r=r.add(s.doc.key);break;case 1:i=i.add(s.doc.key)}return new n0(e,t.fromCache,r,i)}}class P6{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}}class bI{constructor(){this.Rs=!1,this.As=!1,this.Vs=100,this.ds=(function(){return A5()?8:Zw(Nn())>0?6:4})()}initialize(e,t){this.fs=e,this.indexManager=t,this.Rs=!0}getDocumentsMatchingQuery(e,t,r,i){const s={result:null};return this.gs(e,t).next((o=>{s.result=o})).next((()=>{if(!s.result)return this.ps(e,t,i,r).next((o=>{s.result=o}))})).next((()=>{if(s.result)return;const o=new P6;return this.ys(e,t,o).next((a=>{if(s.result=a,this.As)return this.ws(e,t,o,a.size)}))})).next((()=>s.result))}ws(e,t,r,i){return r.documentReadCount<this.Vs?(au()<=Dt.DEBUG&&Ne("QueryEngine","SDK will not create cache indexes for query:",cu(t),"since it only creates cache indexes for collection contains","more than or equal to",this.Vs,"documents"),oe.resolve()):(au()<=Dt.DEBUG&&Ne("QueryEngine","Query:",cu(t),"scans",r.documentReadCount,"local documents and returns",i,"documents as results."),r.documentReadCount>this.ds*i?(au()<=Dt.DEBUG&&Ne("QueryEngine","The SDK decides to create cache indexes for query:",cu(t),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,Kr(t))):oe.resolve())}gs(e,t){if(O2(t))return oe.resolve(null);let r=Kr(t);return this.indexManager.getIndexType(e,r).next((i=>i===0?null:(t.limit!==null&&i===1&&(t=Cf(t,null,"F"),r=Kr(t)),this.indexManager.getDocumentsMatchingTarget(e,r).next((s=>{const o=xt(...s);return this.fs.getDocuments(e,o).next((a=>this.indexManager.getMinOffset(e,r).next((c=>{const u=this.bs(t,a);return this.Ss(t,u,o,c.readTime)?this.gs(e,Cf(t,null,"F")):this.Ds(e,u,t,c)}))))})))))}ps(e,t,r,i){return O2(t)||i.isEqual(et.min())?oe.resolve(null):this.fs.getDocuments(e,r).next((s=>{const o=this.bs(t,s);return this.Ss(t,o,r,i)?oe.resolve(null):(au()<=Dt.DEBUG&&Ne("QueryEngine","Re-using previous result from %s to execute query: %s",i.toString(),cu(t)),this.Ds(e,o,t,Yw(i,Du)).next((a=>a)))}))}bs(e,t){let r=new tn(kb(e));return t.forEach(((i,s)=>{ed(e,s)&&(r=r.add(s))})),r}Ss(e,t,r,i){if(e.limit===null)return!1;if(r.size!==t.size)return!0;const s=e.limitType==="F"?t.last():t.first();return!!s&&(s.hasPendingWrites||s.version.compareTo(i)>0)}ys(e,t,r){return au()<=Dt.DEBUG&&Ne("QueryEngine","Using full collection scan to execute query:",cu(t)),this.fs.getDocumentsMatchingQuery(e,t,Ri.min(),r)}Ds(e,t,r,i){return this.fs.getDocumentsMatchingQuery(e,r,i).next((s=>(t.forEach((o=>{s=s.insert(o.key,o)})),s)))}}const r0="LocalStore",x6=3e8;class R6{constructor(e,t,r,i){this.persistence=e,this.Cs=t,this.serializer=i,this.vs=new _n(wt),this.Fs=new So((s=>_c(s)),Xh),this.Ms=new Map,this.xs=e.getRemoteDocumentCache(),this.li=e.getTargetCache(),this.Pi=e.getBundleCache(),this.Os(r)}Os(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new vI(this.xs,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.xs.setIndexManager(this.indexManager),this.Cs.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",(t=>e.collect(t,this.vs)))}}function II(n,e,t,r){return new R6(n,e,t,r)}async function AI(n,e){const t=Be(n);return await t.persistence.runTransaction("Handle user change","readonly",(r=>{let i;return t.mutationQueue.getAllMutationBatches(r).next((s=>(i=s,t.Os(e),t.mutationQueue.getAllMutationBatches(r)))).next((s=>{const o=[],a=[];let c=xt();for(const u of i){o.push(u.batchId);for(const d of u.mutations)c=c.add(d.key)}for(const u of s){a.push(u.batchId);for(const d of u.mutations)c=c.add(d.key)}return t.localDocuments.getDocuments(r,c).next((u=>({Ns:u,removedBatchIds:o,addedBatchIds:a})))}))}))}function N6(n,e){const t=Be(n);return t.persistence.runTransaction("Acknowledge batch","readwrite-primary",(r=>{const i=e.batch.keys(),s=t.xs.newChangeBuffer({trackRemovals:!0});return(function(a,c,u,d){const g=u.batch,y=g.keys();let p=oe.resolve();return y.forEach((S=>{p=p.next((()=>d.getEntry(c,S))).next((N=>{const C=u.docVersions.get(S);Ke(C!==null,48541),N.version.compareTo(C)<0&&(g.applyToRemoteDocument(N,u),N.isValidDocument()&&(N.setReadTime(u.commitVersion),d.addEntry(N)))}))})),p.next((()=>a.mutationQueue.removeMutationBatch(c,g)))})(t,r,e,s).next((()=>s.apply(r))).next((()=>t.mutationQueue.performConsistencyCheck(r))).next((()=>t.documentOverlayCache.removeOverlaysForBatchId(r,i,e.batch.batchId))).next((()=>t.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(r,(function(a){let c=xt();for(let u=0;u<a.mutationResults.length;++u)a.mutationResults[u].transformResults.length>0&&(c=c.add(a.batch.mutations[u].key));return c})(e)))).next((()=>t.localDocuments.getDocuments(r,i)))}))}function EI(n){const e=Be(n);return e.persistence.runTransaction("Get last remote snapshot version","readonly",(t=>e.li.getLastRemoteSnapshotVersion(t)))}function k6(n,e){const t=Be(n),r=e.snapshotVersion;let i=t.vs;return t.persistence.runTransaction("Apply remote event","readwrite-primary",(s=>{const o=t.xs.newChangeBuffer({trackRemovals:!0});i=t.vs;const a=[];e.targetChanges.forEach(((d,g)=>{const y=i.get(g);if(!y)return;a.push(t.li.removeMatchingKeys(s,d.removedDocuments,g).next((()=>t.li.addMatchingKeys(s,d.addedDocuments,g))));let p=y.withSequenceNumber(s.currentSequenceNumber);e.targetMismatches.get(g)!==null?p=p.withResumeToken(On.EMPTY_BYTE_STRING,et.min()).withLastLimboFreeSnapshotVersion(et.min()):d.resumeToken.approximateByteSize()>0&&(p=p.withResumeToken(d.resumeToken,r)),i=i.insert(g,p),(function(N,C,k){return N.resumeToken.approximateByteSize()===0||C.snapshotVersion.toMicroseconds()-N.snapshotVersion.toMicroseconds()>=x6?!0:k.addedDocuments.size+k.modifiedDocuments.size+k.removedDocuments.size>0})(y,p,d)&&a.push(t.li.updateTargetData(s,p))}));let c=hi(),u=xt();if(e.documentUpdates.forEach((d=>{e.resolvedLimboDocuments.has(d)&&a.push(t.persistence.referenceDelegate.updateLimboDocument(s,d))})),a.push(TI(s,o,e.documentUpdates).next((d=>{c=d.Bs,u=d.Ls}))),!r.isEqual(et.min())){const d=t.li.getLastRemoteSnapshotVersion(s).next((g=>t.li.setTargetsMetadata(s,s.currentSequenceNumber,r)));a.push(d)}return oe.waitFor(a).next((()=>o.apply(s))).next((()=>t.localDocuments.getLocalViewOfDocuments(s,c,u))).next((()=>c))})).then((s=>(t.vs=i,s)))}function TI(n,e,t){let r=xt(),i=xt();return t.forEach((s=>r=r.add(s))),e.getEntries(n,r).next((s=>{let o=hi();return t.forEach(((a,c)=>{const u=s.get(a);c.isFoundDocument()!==u.isFoundDocument()&&(i=i.add(a)),c.isNoDocument()&&c.version.isEqual(et.min())?(e.removeEntry(a,c.readTime),o=o.insert(a,c)):!u.isValidDocument()||c.version.compareTo(u.version)>0||c.version.compareTo(u.version)===0&&u.hasPendingWrites?(e.addEntry(c),o=o.insert(a,c)):Ne(r0,"Ignoring outdated watch update for ",a,". Current version:",u.version," Watch version:",c.version)})),{Bs:o,Ls:i}}))}function C6(n,e){const t=Be(n);return t.persistence.runTransaction("Get next mutation batch","readonly",(r=>(e===void 0&&(e=da),t.mutationQueue.getNextMutationBatchAfterBatchId(r,e))))}function Wu(n,e){const t=Be(n);return t.persistence.runTransaction("Allocate target","readwrite",(r=>{let i;return t.li.getTargetData(r,e).next((s=>s?(i=s,oe.resolve(i)):t.li.allocateTargetId(r).next((o=>(i=new fo(e,o,"TargetPurposeListen",r.currentSequenceNumber),t.li.addTargetData(r,i).next((()=>i)))))))})).then((r=>{const i=t.vs.get(r.targetId);return(i===null||r.snapshotVersion.compareTo(i.snapshotVersion)>0)&&(t.vs=t.vs.insert(r.targetId,r),t.Fs.set(e,r.targetId)),r}))}async function Hu(n,e,t){const r=Be(n),i=r.vs.get(e),s=t?"readwrite":"readwrite-primary";try{t||await r.persistence.runTransaction("Release target",s,(o=>r.persistence.referenceDelegate.removeTarget(o,i)))}catch(o){if(!Na(o))throw o;Ne(r0,`Failed to update sequence numbers for target ${e}: ${o}`)}r.vs=r.vs.remove(e),r.Fs.delete(i.target)}function Mf(n,e,t){const r=Be(n);let i=et.min(),s=xt();return r.persistence.runTransaction("Execute query","readwrite",(o=>(function(c,u,d){const g=Be(c),y=g.Fs.get(d);return y!==void 0?oe.resolve(g.vs.get(y)):g.li.getTargetData(u,d)})(r,o,Kr(e)).next((a=>{if(a)return i=a.lastLimboFreeSnapshotVersion,r.li.getMatchingKeysForTargetId(o,a.targetId).next((c=>{s=c}))})).next((()=>r.Cs.getDocumentsMatchingQuery(o,e,t?i:et.min(),t?s:xt()))).next((a=>(xI(r,Nb(e),a),{documents:a,ks:s})))))}function SI(n,e){const t=Be(n),r=Be(t.li),i=t.vs.get(e);return i?Promise.resolve(i.target):t.persistence.runTransaction("Get target data","readonly",(s=>r.At(s,e).next((o=>o?o.target:null))))}function PI(n,e){const t=Be(n),r=t.Ms.get(e)||et.min();return t.persistence.runTransaction("Get new document changes","readonly",(i=>t.xs.getAllFromCollectionGroup(i,e,Yw(r,Du),Number.MAX_SAFE_INTEGER))).then((i=>(xI(t,e,i),i)))}function xI(n,e,t){let r=n.Ms.get(e)||et.min();t.forEach(((i,s)=>{s.readTime.compareTo(r)>0&&(r=s.readTime)})),n.Ms.set(e,r)}async function L6(n,e,t,r){const i=Be(n);let s=xt(),o=hi();for(const u of t){const d=e.Ks(u.metadata.name);u.document&&(s=s.add(d));const g=e.qs(u);g.setReadTime(e.Us(u.metadata.readTime)),o=o.insert(d,g)}const a=i.xs.newChangeBuffer({trackRemovals:!0}),c=await Wu(i,(function(d){return Kr(il(Ot.fromString(`__bundle__/docs/${d}`)))})(r));return i.persistence.runTransaction("Apply bundle documents","readwrite",(u=>TI(u,a,o).next((d=>(a.apply(u),d))).next((d=>i.li.removeMatchingKeysForTargetId(u,c.targetId).next((()=>i.li.addMatchingKeys(u,s,c.targetId))).next((()=>i.localDocuments.getLocalViewOfDocuments(u,d.Bs,d.Ls))).next((()=>d.Bs))))))}async function D6(n,e,t=xt()){const r=await Wu(n,Kr(Y1(e.bundledQuery))),i=Be(n);return i.persistence.runTransaction("Save named query","readwrite",(s=>{const o=Hn(e.readTime);if(r.snapshotVersion.compareTo(o)>=0)return i.Pi.saveNamedQuery(s,e);const a=r.withResumeToken(On.EMPTY_BYTE_STRING,o);return i.vs=i.vs.insert(a.targetId,a),i.li.updateTargetData(s,a).next((()=>i.li.removeMatchingKeysForTargetId(s,r.targetId))).next((()=>i.li.addMatchingKeys(s,t,r.targetId))).next((()=>i.Pi.saveNamedQuery(s,e)))}))}const RI="firestore_clients";function d_(n,e){return`${RI}_${n}_${e}`}const NI="firestore_mutations";function f_(n,e,t){let r=`${NI}_${n}_${t}`;return e.isAuthenticated()&&(r+=`_${e.uid}`),r}const kI="firestore_targets";function vg(n,e){return`${kI}_${n}_${e}`}const ks="SharedClientState";class Vf{constructor(e,t,r,i){this.user=e,this.batchId=t,this.state=r,this.error=i}static $s(e,t,r){const i=JSON.parse(r);let s,o=typeof i=="object"&&["pending","acknowledged","rejected"].indexOf(i.state)!==-1&&(i.error===void 0||typeof i.error=="object");return o&&i.error&&(o=typeof i.error.message=="string"&&typeof i.error.code=="string",o&&(s=new Pe(i.error.code,i.error.message))),o?new Vf(e,t,i.state,s):(Wn(ks,`Failed to parse mutation state for ID '${t}': ${r}`),null)}Ws(){const e={state:this.state,updateTimeMs:Date.now()};return this.error&&(e.error={code:this.error.code,message:this.error.message}),JSON.stringify(e)}}class dh{constructor(e,t,r){this.targetId=e,this.state=t,this.error=r}static $s(e,t){const r=JSON.parse(t);let i,s=typeof r=="object"&&["not-current","current","rejected"].indexOf(r.state)!==-1&&(r.error===void 0||typeof r.error=="object");return s&&r.error&&(s=typeof r.error.message=="string"&&typeof r.error.code=="string",s&&(i=new Pe(r.error.code,r.error.message))),s?new dh(e,r.state,i):(Wn(ks,`Failed to parse target state for ID '${e}': ${t}`),null)}Ws(){const e={state:this.state,updateTimeMs:Date.now()};return this.error&&(e.error={code:this.error.code,message:this.error.message}),JSON.stringify(e)}}class Bf{constructor(e,t){this.clientId=e,this.activeTargetIds=t}static $s(e,t){const r=JSON.parse(t);let i=typeof r=="object"&&r.activeTargetIds instanceof Array,s=j1();for(let o=0;i&&o<r.activeTargetIds.length;++o)i=eb(r.activeTargetIds[o]),s=s.add(r.activeTargetIds[o]);return i?new Bf(e,s):(Wn(ks,`Failed to parse client data for instance '${e}': ${t}`),null)}}class i0{constructor(e,t){this.clientId=e,this.onlineState=t}static $s(e){const t=JSON.parse(e);return typeof t=="object"&&["Unknown","Online","Offline"].indexOf(t.onlineState)!==-1&&typeof t.clientId=="string"?new i0(t.clientId,t.onlineState):(Wn(ks,`Failed to parse online state: ${e}`),null)}}class Pm{constructor(){this.activeTargetIds=j1()}Qs(e){this.activeTargetIds=this.activeTargetIds.add(e)}Gs(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Ws(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class wg{constructor(e,t,r,i,s){this.window=e,this.Ci=t,this.persistenceKey=r,this.zs=i,this.syncEngine=null,this.onlineStateHandler=null,this.sequenceNumberHandler=null,this.js=this.Hs.bind(this),this.Js=new _n(wt),this.started=!1,this.Zs=[];const o=r.replace(/[.*+?^${}()|[\]\\]/g,"\\$&");this.storage=this.window.localStorage,this.currentUser=s,this.Xs=d_(this.persistenceKey,this.zs),this.Ys=(function(c){return`firestore_sequence_number_${c}`})(this.persistenceKey),this.Js=this.Js.insert(this.zs,new Pm),this.eo=new RegExp(`^${RI}_${o}_([^_]*)$`),this.no=new RegExp(`^${NI}_${o}_(\\d+)(?:_(.*))?$`),this.ro=new RegExp(`^${kI}_${o}_(\\d+)$`),this.io=(function(c){return`firestore_online_state_${c}`})(this.persistenceKey),this.so=(function(c){return`firestore_bundle_loaded_v2_${c}`})(this.persistenceKey),this.window.addEventListener("storage",this.js)}static v(e){return!(!e||!e.localStorage)}async start(){const e=await this.syncEngine.hs();for(const r of e){if(r===this.zs)continue;const i=this.getItem(d_(this.persistenceKey,r));if(i){const s=Bf.$s(r,i);s&&(this.Js=this.Js.insert(s.clientId,s))}}this.oo();const t=this.storage.getItem(this.io);if(t){const r=this._o(t);r&&this.ao(r)}for(const r of this.Zs)this.Hs(r);this.Zs=[],this.window.addEventListener("pagehide",(()=>this.shutdown())),this.started=!0}writeSequenceNumber(e){this.setItem(this.Ys,JSON.stringify(e))}getAllActiveQueryTargets(){return this.uo(this.Js)}isActiveQueryTarget(e){let t=!1;return this.Js.forEach(((r,i)=>{i.activeTargetIds.has(e)&&(t=!0)})),t}addPendingMutation(e){this.co(e,"pending")}updateMutationState(e,t,r){this.co(e,t,r),this.lo(e)}addLocalQueryTarget(e,t=!0){let r="not-current";if(this.isActiveQueryTarget(e)){const i=this.storage.getItem(vg(this.persistenceKey,e));if(i){const s=dh.$s(e,i);s&&(r=s.state)}}return t&&this.ho.Qs(e),this.oo(),r}removeLocalQueryTarget(e){this.ho.Gs(e),this.oo()}isLocalQueryTarget(e){return this.ho.activeTargetIds.has(e)}clearQueryState(e){this.removeItem(vg(this.persistenceKey,e))}updateQueryState(e,t,r){this.Po(e,t,r)}handleUserChange(e,t,r){t.forEach((i=>{this.lo(i)})),this.currentUser=e,r.forEach((i=>{this.addPendingMutation(i)}))}setOnlineState(e){this.To(e)}notifyBundleLoaded(e){this.Io(e)}shutdown(){this.started&&(this.window.removeEventListener("storage",this.js),this.removeItem(this.Xs),this.started=!1)}getItem(e){const t=this.storage.getItem(e);return Ne(ks,"READ",e,t),t}setItem(e,t){Ne(ks,"SET",e,t),this.storage.setItem(e,t)}removeItem(e){Ne(ks,"REMOVE",e),this.storage.removeItem(e)}Hs(e){const t=e;if(t.storageArea===this.storage){if(Ne(ks,"EVENT",t.key,t.newValue),t.key===this.Xs)return void Wn("Received WebStorage notification for local change. Another client might have garbage-collected our state");this.Ci.enqueueRetryable((async()=>{if(this.started){if(t.key!==null){if(this.eo.test(t.key)){if(t.newValue==null){const r=this.Eo(t.key);return this.Ro(r,null)}{const r=this.Ao(t.key,t.newValue);if(r)return this.Ro(r.clientId,r)}}else if(this.no.test(t.key)){if(t.newValue!==null){const r=this.Vo(t.key,t.newValue);if(r)return this.mo(r)}}else if(this.ro.test(t.key)){if(t.newValue!==null){const r=this.fo(t.key,t.newValue);if(r)return this.po(r)}}else if(t.key===this.io){if(t.newValue!==null){const r=this._o(t.newValue);if(r)return this.ao(r)}}else if(t.key===this.Ys){const r=(function(s){let o=ui.ce;if(s!=null)try{const a=JSON.parse(s);Ke(typeof a=="number",30636,{yo:s}),o=a}catch(a){Wn(ks,"Failed to read sequence number from WebStorage",a)}return o})(t.newValue);r!==ui.ce&&this.sequenceNumberHandler(r)}else if(t.key===this.so){const r=this.wo(t.newValue);await Promise.all(r.map((i=>this.syncEngine.bo(i))))}}}else this.Zs.push(t)}))}}get ho(){return this.Js.get(this.zs)}oo(){this.setItem(this.Xs,this.ho.Ws())}co(e,t,r){const i=new Vf(this.currentUser,e,t,r),s=f_(this.persistenceKey,this.currentUser,e);this.setItem(s,i.Ws())}lo(e){const t=f_(this.persistenceKey,this.currentUser,e);this.removeItem(t)}To(e){const t={clientId:this.zs,onlineState:e};this.storage.setItem(this.io,JSON.stringify(t))}Po(e,t,r){const i=vg(this.persistenceKey,e),s=new dh(e,t,r);this.setItem(i,s.Ws())}Io(e){const t=JSON.stringify(Array.from(e));this.setItem(this.so,t)}Eo(e){const t=this.eo.exec(e);return t?t[1]:null}Ao(e,t){const r=this.Eo(e);return Bf.$s(r,t)}Vo(e,t){const r=this.no.exec(e),i=Number(r[1]),s=r[2]!==void 0?r[2]:null;return Vf.$s(new cr(s),i,t)}fo(e,t){const r=this.ro.exec(e),i=Number(r[1]);return dh.$s(i,t)}_o(e){return i0.$s(e)}wo(e){return JSON.parse(e)}async mo(e){if(e.user.uid===this.currentUser.uid)return this.syncEngine.So(e.batchId,e.state,e.error);Ne(ks,`Ignoring mutation for non-active user ${e.user.uid}`)}po(e){return this.syncEngine.Do(e.targetId,e.state,e.error)}Ro(e,t){const r=t?this.Js.insert(e,t):this.Js.remove(e),i=this.uo(this.Js),s=this.uo(r),o=[],a=[];return s.forEach((c=>{i.has(c)||o.push(c)})),i.forEach((c=>{s.has(c)||a.push(c)})),this.syncEngine.Co(o,a).then((()=>{this.Js=r}))}ao(e){this.Js.get(e.clientId)&&this.onlineStateHandler(e.onlineState)}uo(e){let t=j1();return e.forEach(((r,i)=>{t=t.unionWith(i.activeTargetIds)})),t}}class CI{constructor(){this.vo=new Pm,this.Fo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,t,r){}addLocalQueryTarget(e,t=!0){return t&&this.vo.Qs(e),this.Fo[e]||"not-current"}updateQueryState(e,t,r){this.Fo[e]=t}removeLocalQueryTarget(e){this.vo.Gs(e)}isLocalQueryTarget(e){return this.vo.activeTargetIds.has(e)}clearQueryState(e){delete this.Fo[e]}getAllActiveQueryTargets(){return this.vo.activeTargetIds}isActiveQueryTarget(e){return this.vo.activeTargetIds.has(e)}start(){return this.vo=new Pm,Promise.resolve()}handleUserChange(e,t,r){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}class O6{Mo(e){}shutdown(){}}const p_="ConnectivityMonitor";class g_{constructor(){this.xo=()=>this.Oo(),this.No=()=>this.Bo(),this.Lo=[],this.ko()}Mo(e){this.Lo.push(e)}shutdown(){window.removeEventListener("online",this.xo),window.removeEventListener("offline",this.No)}ko(){window.addEventListener("online",this.xo),window.addEventListener("offline",this.No)}Oo(){Ne(p_,"Network connectivity changed: AVAILABLE");for(const e of this.Lo)e(0)}Bo(){Ne(p_,"Network connectivity changed: UNAVAILABLE");for(const e of this.Lo)e(1)}static v(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}let Md=null;function xm(){return Md===null?Md=(function(){return 268435456+Math.round(2147483648*Math.random())})():Md++,"0x"+Md.toString(16)}const bg="RestConnection",F6={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery",ExecutePipeline:"executePipeline"};class M6{get Ko(){return!1}constructor(e){this.databaseInfo=e,this.databaseId=e.databaseId;const t=e.ssl?"https":"http",r=encodeURIComponent(this.databaseId.projectId),i=encodeURIComponent(this.databaseId.database);this.qo=t+"://"+e.host,this.Uo=`projects/${r}/databases/${i}`,this.$o=this.databaseId.database===fm?`project_id=${r}`:`project_id=${r}&database_id=${i}`}Wo(e,t,r,i,s){const o=xm(),a=this.Qo(e,t.toUriEncodedString());Ne(bg,`Sending RPC '${e}' ${o}:`,a,r);const c={"google-cloud-resource-prefix":this.Uo,"x-goog-request-params":this.$o};this.Go(c,i,s);const{host:u}=new URL(a),d=Xu(u);return this.zo(e,a,c,r,d).then((g=>(Ne(bg,`Received RPC '${e}' ${o}: `,g),g)),(g=>{throw Hs(bg,`RPC '${e}' ${o} failed with error: `,g,"url: ",a,"request:",r),g}))}jo(e,t,r,i,s,o){return this.Wo(e,t,r,i,s)}Go(e,t,r){e["X-Goog-Api-Client"]=(function(){return"gl-js/ fire/"+rl})(),e["Content-Type"]="text/plain",this.databaseInfo.appId&&(e["X-Firebase-GMPID"]=this.databaseInfo.appId),t&&t.headers.forEach(((i,s)=>e[s]=i)),r&&r.headers.forEach(((i,s)=>e[s]=i))}Qo(e,t){const r=F6[e];let i=`${this.qo}/v1/${t}:${r}`;return this.databaseInfo.apiKey&&(i=`${i}?key=${encodeURIComponent(this.databaseInfo.apiKey)}`),i}terminate(){}}class V6{constructor(e){this.Ho=e.Ho,this.Jo=e.Jo}Zo(e){this.Xo=e}Yo(e){this.e_=e}t_(e){this.n_=e}onMessage(e){this.r_=e}close(){this.Jo()}send(e){this.Ho(e)}i_(){this.Xo()}s_(){this.e_()}o_(e){this.n_(e)}__(e){this.r_(e)}}const Er="WebChannelConnection",jl=(n,e,t)=>{n.listen(e,(r=>{try{t(r)}catch(i){setTimeout((()=>{throw i}),0)}}))};class Iu extends M6{constructor(e){super(e),this.a_=[],this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}static u_(){if(!Iu.c_){const e=jw();jl(e,Uw.STAT_EVENT,(t=>{t.stat===om.PROXY?Ne(Er,"STAT_EVENT: detected buffering proxy"):t.stat===om.NOPROXY&&Ne(Er,"STAT_EVENT: detected no buffering proxy")})),Iu.c_=!0}}zo(e,t,r,i,s){const o=xm();return new Promise(((a,c)=>{const u=new Vw;u.setWithCredentials(!0),u.listenOnce(Bw.COMPLETE,(()=>{try{switch(u.getLastErrorCode()){case Qd.NO_ERROR:const g=u.getResponseJson();Ne(Er,`XHR for RPC '${e}' ${o} received:`,JSON.stringify(g)),a(g);break;case Qd.TIMEOUT:Ne(Er,`RPC '${e}' ${o} timed out`),c(new Pe(pe.DEADLINE_EXCEEDED,"Request time out"));break;case Qd.HTTP_ERROR:const y=u.getStatus();if(Ne(Er,`RPC '${e}' ${o} failed with status:`,y,"response text:",u.getResponseText()),y>0){let p=u.getResponseJson();Array.isArray(p)&&(p=p[0]);const S=p?.error;if(S&&S.status&&S.message){const N=(function(k){const K=k.toLowerCase().replace(/_/g,"-");return Object.values(pe).indexOf(K)>=0?K:pe.UNKNOWN})(S.status);c(new Pe(N,S.message))}else c(new Pe(pe.UNKNOWN,"Server responded with status "+u.getStatus()))}else c(new Pe(pe.UNAVAILABLE,"Connection failed."));break;default:qe(9055,{l_:e,streamId:o,h_:u.getLastErrorCode(),P_:u.getLastError()})}}finally{Ne(Er,`RPC '${e}' ${o} completed.`)}}));const d=JSON.stringify(i);Ne(Er,`RPC '${e}' ${o} sending request:`,i),u.send(t,"POST",d,r,15)}))}T_(e,t,r){const i=xm(),s=[this.qo,"/","google.firestore.v1.Firestore","/",e,"/channel"],o=this.createWebChannelTransport(),a={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},c=this.longPollingOptions.timeoutSeconds;c!==void 0&&(a.longPollingTimeout=Math.round(1e3*c)),this.useFetchStreams&&(a.useFetchStreams=!0),this.Go(a.initMessageHeaders,t,r),a.encodeInitMessageHeaders=!0;const u=s.join("");Ne(Er,`Creating RPC '${e}' stream ${i}: ${u}`,a);const d=o.createWebChannel(u,a);this.I_(d);let g=!1,y=!1;const p=new V6({Ho:S=>{y?Ne(Er,`Not sending because RPC '${e}' stream ${i} is closed:`,S):(g||(Ne(Er,`Opening RPC '${e}' stream ${i} transport.`),d.open(),g=!0),Ne(Er,`RPC '${e}' stream ${i} sending:`,S),d.send(S))},Jo:()=>d.close()});return jl(d,Kl.EventType.OPEN,(()=>{y||(Ne(Er,`RPC '${e}' stream ${i} transport opened.`),p.i_())})),jl(d,Kl.EventType.CLOSE,(()=>{y||(y=!0,Ne(Er,`RPC '${e}' stream ${i} transport closed`),p.o_(),this.E_(d))})),jl(d,Kl.EventType.ERROR,(S=>{y||(y=!0,Hs(Er,`RPC '${e}' stream ${i} transport errored. Name:`,S.name,"Message:",S.message),p.o_(new Pe(pe.UNAVAILABLE,"The operation could not be completed")))})),jl(d,Kl.EventType.MESSAGE,(S=>{if(!y){const N=S.data[0];Ke(!!N,16349);const C=N,k=C?.error||C[0]?.error;if(k){Ne(Er,`RPC '${e}' stream ${i} received error:`,k);const K=k.status;let G=(function(de){const B=Kn[de];if(B!==void 0)return $b(B)})(K),W=k.message;G===void 0&&(G=pe.INTERNAL,W="Unknown error status: "+K+" with message "+k.message),y=!0,p.o_(new Pe(G,W)),d.close()}else Ne(Er,`RPC '${e}' stream ${i} received:`,N),p.__(N)}})),Iu.u_(),setTimeout((()=>{p.s_()}),0),p}terminate(){this.a_.forEach((e=>e.close())),this.a_=[]}I_(e){this.a_.push(e)}E_(e){this.a_=this.a_.filter((t=>t===e))}Go(e,t,r){super.Go(e,t,r),this.databaseInfo.apiKey&&(e["x-goog-api-key"]=this.databaseInfo.apiKey)}createWebChannelTransport(){return qw()}}function B6(n){return new Iu(n)}function LI(){return typeof window<"u"?window:null}function cf(){return typeof document<"u"?document:null}function id(n){return new $N(n,!0)}Iu.c_=!1;class s0{constructor(e,t,r=1e3,i=1.5,s=6e4){this.Ci=e,this.timerId=t,this.R_=r,this.A_=i,this.V_=s,this.d_=0,this.m_=null,this.f_=Date.now(),this.reset()}reset(){this.d_=0}g_(){this.d_=this.V_}p_(e){this.cancel();const t=Math.floor(this.d_+this.y_()),r=Math.max(0,Date.now()-this.f_),i=Math.max(0,t-r);i>0&&Ne("ExponentialBackoff",`Backing off for ${i} ms (base delay: ${this.d_} ms, delay with jitter: ${t} ms, last attempt: ${r} ms ago)`),this.m_=this.Ci.enqueueAfterDelay(this.timerId,i,(()=>(this.f_=Date.now(),e()))),this.d_*=this.A_,this.d_<this.R_&&(this.d_=this.R_),this.d_>this.V_&&(this.d_=this.V_)}w_(){this.m_!==null&&(this.m_.skipDelay(),this.m_=null)}cancel(){this.m_!==null&&(this.m_.cancel(),this.m_=null)}y_(){return(Math.random()-.5)*this.d_}}const m_="PersistentStream";class DI{constructor(e,t,r,i,s,o,a,c){this.Ci=e,this.b_=r,this.S_=i,this.connection=s,this.authCredentialsProvider=o,this.appCheckCredentialsProvider=a,this.listener=c,this.state=0,this.D_=0,this.C_=null,this.v_=null,this.stream=null,this.F_=0,this.M_=new s0(e,t)}x_(){return this.state===1||this.state===5||this.O_()}O_(){return this.state===2||this.state===3}start(){this.F_=0,this.state!==4?this.auth():this.N_()}async stop(){this.x_()&&await this.close(0)}B_(){this.state=0,this.M_.reset()}L_(){this.O_()&&this.C_===null&&(this.C_=this.Ci.enqueueAfterDelay(this.b_,6e4,(()=>this.k_())))}K_(e){this.q_(),this.stream.send(e)}async k_(){if(this.O_())return this.close(0)}q_(){this.C_&&(this.C_.cancel(),this.C_=null)}U_(){this.v_&&(this.v_.cancel(),this.v_=null)}async close(e,t){this.q_(),this.U_(),this.M_.cancel(),this.D_++,e!==4?this.M_.reset():t&&t.code===pe.RESOURCE_EXHAUSTED?(Wn(t.toString()),Wn("Using maximum backoff delay to prevent overloading the backend."),this.M_.g_()):t&&t.code===pe.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.W_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.t_(t)}W_(){}auth(){this.state=1;const e=this.Q_(this.D_),t=this.D_;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then((([r,i])=>{this.D_===t&&this.G_(r,i)}),(r=>{e((()=>{const i=new Pe(pe.UNKNOWN,"Fetching auth token failed: "+r.message);return this.z_(i)}))}))}G_(e,t){const r=this.Q_(this.D_);this.stream=this.j_(e,t),this.stream.Zo((()=>{r((()=>this.listener.Zo()))})),this.stream.Yo((()=>{r((()=>(this.state=2,this.v_=this.Ci.enqueueAfterDelay(this.S_,1e4,(()=>(this.O_()&&(this.state=3),Promise.resolve()))),this.listener.Yo())))})),this.stream.t_((i=>{r((()=>this.z_(i)))})),this.stream.onMessage((i=>{r((()=>++this.F_==1?this.H_(i):this.onNext(i)))}))}N_(){this.state=5,this.M_.p_((async()=>{this.state=0,this.start()}))}z_(e){return Ne(m_,`close with error: ${e}`),this.stream=null,this.close(4,e)}Q_(e){return t=>{this.Ci.enqueueAndForget((()=>this.D_===e?t():(Ne(m_,"stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve())))}}}class U6 extends DI{constructor(e,t,r,i,s,o){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",t,r,i,o),this.serializer=s}j_(e,t){return this.connection.T_("Listen",e,t)}H_(e){return this.onNext(e)}onNext(e){this.M_.reset();const t=GN(this.serializer,e),r=(function(s){if(!("targetChange"in s))return et.min();const o=s.targetChange;return o.targetIds&&o.targetIds.length?et.min():o.readTime?Hn(o.readTime):et.min()})(e);return this.listener.J_(t,r)}Z_(e){const t={};t.database=Im(this.serializer),t.addTarget=(function(s,o){let a;const c=o.target;if(a=Nf(c)?{documents:eI(s,c)}:{query:tI(s,c).ft},a.targetId=o.targetId,o.resumeToken.approximateByteSize()>0){a.resumeToken=Kb(s,o.resumeToken);const u=wm(s,o.expectedCount);u!==null&&(a.expectedCount=u)}else if(o.snapshotVersion.compareTo(et.min())>0){a.readTime=$u(s,o.snapshotVersion.toTimestamp());const u=wm(s,o.expectedCount);u!==null&&(a.expectedCount=u)}return a})(this.serializer,e);const r=YN(this.serializer,e);r&&(t.labels=r),this.K_(t)}X_(e){const t={};t.database=Im(this.serializer),t.removeTarget=e,this.K_(t)}}class j6 extends DI{constructor(e,t,r,i,s,o){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",t,r,i,o),this.serializer=s}get Y_(){return this.F_>0}start(){this.lastStreamToken=void 0,super.start()}W_(){this.Y_&&this.ea([])}j_(e,t){return this.connection.T_("Write",e,t)}H_(e){return Ke(!!e.streamToken,31322),this.lastStreamToken=e.streamToken,Ke(!e.writeResults||e.writeResults.length===0,55816),this.listener.ta()}onNext(e){Ke(!!e.streamToken,12678),this.lastStreamToken=e.streamToken,this.M_.reset();const t=KN(e.writeResults,e.commitTime),r=Hn(e.commitTime);return this.listener.na(r,t)}ra(){const e={};e.database=Im(this.serializer),this.K_(e)}ea(e){const t={streamToken:this.lastStreamToken,writes:e.map((r=>Dh(this.serializer,r)))};this.K_(t)}}class q6{}class z6 extends q6{constructor(e,t,r,i){super(),this.authCredentials=e,this.appCheckCredentials=t,this.connection=r,this.serializer=i,this.ia=!1}sa(){if(this.ia)throw new Pe(pe.FAILED_PRECONDITION,"The client has already been terminated.")}Wo(e,t,r,i){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((([s,o])=>this.connection.Wo(e,bm(t,r),i,s,o))).catch((s=>{throw s.name==="FirebaseError"?(s.code===pe.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),s):new Pe(pe.UNKNOWN,s.toString())}))}jo(e,t,r,i,s){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((([o,a])=>this.connection.jo(e,bm(t,r),i,o,a,s))).catch((o=>{throw o.name==="FirebaseError"?(o.code===pe.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),o):new Pe(pe.UNKNOWN,o.toString())}))}terminate(){this.ia=!0,this.connection.terminate()}}function $6(n,e,t,r){return new z6(n,e,t,r)}class W6{constructor(e,t){this.asyncQueue=e,this.onlineStateHandler=t,this.state="Unknown",this.oa=0,this._a=null,this.aa=!0}ua(){this.oa===0&&(this.ca("Unknown"),this._a=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,(()=>(this._a=null,this.la("Backend didn't respond within 10 seconds."),this.ca("Offline"),Promise.resolve()))))}ha(e){this.state==="Online"?this.ca("Unknown"):(this.oa++,this.oa>=1&&(this.Pa(),this.la(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.ca("Offline")))}set(e){this.Pa(),this.oa=0,e==="Online"&&(this.aa=!1),this.ca(e)}ca(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}la(e){const t=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.aa?(Wn(t),this.aa=!1):Ne("OnlineStateTracker",t)}Pa(){this._a!==null&&(this._a.cancel(),this._a=null)}}const Ec="RemoteStore";class H6{constructor(e,t,r,i,s){this.localStore=e,this.datastore=t,this.asyncQueue=r,this.remoteSyncer={},this.Ta=[],this.Ia=new Map,this.Ea=new Set,this.Ra=[],this.Aa=s,this.Aa.Mo((o=>{r.enqueueAndForget((async()=>{Ca(this)&&(Ne(Ec,"Restarting streams for network reachability change."),await(async function(c){const u=Be(c);u.Ea.add(4),await al(u),u.Va.set("Unknown"),u.Ea.delete(4),await sd(u)})(this))}))})),this.Va=new W6(r,i)}}async function sd(n){if(Ca(n))for(const e of n.Ra)await e(!0)}async function al(n){for(const e of n.Ra)await e(!1)}function Ip(n,e){const t=Be(n);t.Ia.has(e.targetId)||(t.Ia.set(e.targetId,e),c0(t)?a0(t):ul(t).O_()&&o0(t,e))}function Gu(n,e){const t=Be(n),r=ul(t);t.Ia.delete(e),r.O_()&&OI(t,e),t.Ia.size===0&&(r.O_()?r.L_():Ca(t)&&t.Va.set("Unknown"))}function o0(n,e){if(n.da.$e(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(et.min())>0){const t=n.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(t)}ul(n).Z_(e)}function OI(n,e){n.da.$e(e),ul(n).X_(e)}function a0(n){n.da=new UN({getRemoteKeysForTarget:e=>n.remoteSyncer.getRemoteKeysForTarget(e),At:e=>n.Ia.get(e)||null,ht:()=>n.datastore.serializer.databaseId}),ul(n).start(),n.Va.ua()}function c0(n){return Ca(n)&&!ul(n).x_()&&n.Ia.size>0}function Ca(n){return Be(n).Ea.size===0}function FI(n){n.da=void 0}async function G6(n){n.Va.set("Online")}async function K6(n){n.Ia.forEach(((e,t)=>{o0(n,e)}))}async function Y6(n,e){FI(n),c0(n)?(n.Va.ha(e),a0(n)):n.Va.set("Unknown")}async function J6(n,e,t){if(n.Va.set("Online"),e instanceof Gb&&e.state===2&&e.cause)try{await(async function(i,s){const o=s.cause;for(const a of s.targetIds)i.Ia.has(a)&&(await i.remoteSyncer.rejectListen(a,o),i.Ia.delete(a),i.da.removeTarget(a))})(n,e)}catch(r){Ne(Ec,"Failed to remove targets %s: %s ",e.targetIds.join(","),r),await Uf(n,r)}else if(e instanceof of?n.da.Xe(e):e instanceof Hb?n.da.st(e):n.da.tt(e),!t.isEqual(et.min()))try{const r=await EI(n.localStore);t.compareTo(r)>=0&&await(function(s,o){const a=s.da.Tt(o);return a.targetChanges.forEach(((c,u)=>{if(c.resumeToken.approximateByteSize()>0){const d=s.Ia.get(u);d&&s.Ia.set(u,d.withResumeToken(c.resumeToken,o))}})),a.targetMismatches.forEach(((c,u)=>{const d=s.Ia.get(c);if(!d)return;s.Ia.set(c,d.withResumeToken(On.EMPTY_BYTE_STRING,d.snapshotVersion)),OI(s,c);const g=new fo(d.target,c,u,d.sequenceNumber);o0(s,g)})),s.remoteSyncer.applyRemoteEvent(a)})(n,t)}catch(r){Ne(Ec,"Failed to raise snapshot:",r),await Uf(n,r)}}async function Uf(n,e,t){if(!Na(e))throw e;n.Ea.add(1),await al(n),n.Va.set("Offline"),t||(t=()=>EI(n.localStore)),n.asyncQueue.enqueueRetryable((async()=>{Ne(Ec,"Retrying IndexedDB access"),await t(),n.Ea.delete(1),await sd(n)}))}function MI(n,e){return e().catch((t=>Uf(n,t,e)))}async function cl(n){const e=Be(n),t=Ea(e);let r=e.Ta.length>0?e.Ta[e.Ta.length-1].batchId:da;for(;Q6(e);)try{const i=await C6(e.localStore,r);if(i===null){e.Ta.length===0&&t.L_();break}r=i.batchId,X6(e,i)}catch(i){await Uf(e,i)}VI(e)&&BI(e)}function Q6(n){return Ca(n)&&n.Ta.length<10}function X6(n,e){n.Ta.push(e);const t=Ea(n);t.O_()&&t.Y_&&t.ea(e.mutations)}function VI(n){return Ca(n)&&!Ea(n).x_()&&n.Ta.length>0}function BI(n){Ea(n).start()}async function Z6(n){Ea(n).ra()}async function ek(n){const e=Ea(n);for(const t of n.Ta)e.ea(t.mutations)}async function tk(n,e,t){const r=n.Ta.shift(),i=W1.from(r,e,t);await MI(n,(()=>n.remoteSyncer.applySuccessfulWrite(i))),await cl(n)}async function nk(n,e){e&&Ea(n).Y_&&await(async function(r,i){if((function(o){return zb(o)&&o!==pe.ABORTED})(i.code)){const s=r.Ta.shift();Ea(r).B_(),await MI(r,(()=>r.remoteSyncer.rejectFailedWrite(s.batchId,i))),await cl(r)}})(n,e),VI(n)&&BI(n)}async function y_(n,e){const t=Be(n);t.asyncQueue.verifyOperationInProgress(),Ne(Ec,"RemoteStore received new credentials");const r=Ca(t);t.Ea.add(3),await al(t),r&&t.Va.set("Unknown"),await t.remoteSyncer.handleCredentialChange(e),t.Ea.delete(3),await sd(t)}async function Rm(n,e){const t=Be(n);e?(t.Ea.delete(2),await sd(t)):e||(t.Ea.add(2),await al(t),t.Va.set("Unknown"))}function ul(n){return n.ma||(n.ma=(function(t,r,i){const s=Be(t);return s.sa(),new U6(r,s.connection,s.authCredentials,s.appCheckCredentials,s.serializer,i)})(n.datastore,n.asyncQueue,{Zo:G6.bind(null,n),Yo:K6.bind(null,n),t_:Y6.bind(null,n),J_:J6.bind(null,n)}),n.Ra.push((async e=>{e?(n.ma.B_(),c0(n)?a0(n):n.Va.set("Unknown")):(await n.ma.stop(),FI(n))}))),n.ma}function Ea(n){return n.fa||(n.fa=(function(t,r,i){const s=Be(t);return s.sa(),new j6(r,s.connection,s.authCredentials,s.appCheckCredentials,s.serializer,i)})(n.datastore,n.asyncQueue,{Zo:()=>Promise.resolve(),Yo:Z6.bind(null,n),t_:nk.bind(null,n),ta:ek.bind(null,n),na:tk.bind(null,n)}),n.Ra.push((async e=>{e?(n.fa.B_(),await cl(n)):(await n.fa.stop(),n.Ta.length>0&&(Ne(Ec,`Stopping write stream with ${n.Ta.length} pending writes`),n.Ta=[]))}))),n.fa}class u0{constructor(e,t,r,i,s){this.asyncQueue=e,this.timerId=t,this.targetTimeMs=r,this.op=i,this.removalCallback=s,this.deferred=new _r,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch((o=>{}))}get promise(){return this.deferred.promise}static createAndSchedule(e,t,r,i,s){const o=Date.now()+r,a=new u0(e,t,o,i,s);return a.start(r),a}start(e){this.timerHandle=setTimeout((()=>this.handleDelayElapsed()),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new Pe(pe.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget((()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then((e=>this.deferred.resolve(e)))):Promise.resolve()))}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function ll(n,e){if(Wn("AsyncQueue",`${e}: ${n}`),Na(n))return new Pe(pe.UNAVAILABLE,`${e}: ${n}`);throw n}class Au{static emptySet(e){return new Au(e.comparator)}constructor(e){this.comparator=e?(t,r)=>e(t,r)||Fe.comparator(t.key,r.key):(t,r)=>Fe.comparator(t.key,r.key),this.keyedMap=Yl(),this.sortedSet=new _n(this.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const t=this.keyedMap.get(e);return t?this.sortedSet.indexOf(t):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal(((t,r)=>(e(t),!1)))}add(e){const t=this.delete(e.key);return t.copy(t.keyedMap.insert(e.key,e),t.sortedSet.insert(e,null))}delete(e){const t=this.get(e);return t?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(t)):this}isEqual(e){if(!(e instanceof Au)||this.size!==e.size)return!1;const t=this.sortedSet.getIterator(),r=e.sortedSet.getIterator();for(;t.hasNext();){const i=t.getNext().key,s=r.getNext().key;if(!i.isEqual(s))return!1}return!0}toString(){const e=[];return this.forEach((t=>{e.push(t.toString())})),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,t){const r=new Au;return r.comparator=this.comparator,r.keyedMap=e,r.sortedSet=t,r}}class __{constructor(){this.ga=new _n(Fe.comparator)}track(e){const t=e.doc.key,r=this.ga.get(t);r?e.type!==0&&r.type===3?this.ga=this.ga.insert(t,e):e.type===3&&r.type!==1?this.ga=this.ga.insert(t,{type:r.type,doc:e.doc}):e.type===2&&r.type===2?this.ga=this.ga.insert(t,{type:2,doc:e.doc}):e.type===2&&r.type===0?this.ga=this.ga.insert(t,{type:0,doc:e.doc}):e.type===1&&r.type===0?this.ga=this.ga.remove(t):e.type===1&&r.type===2?this.ga=this.ga.insert(t,{type:1,doc:r.doc}):e.type===0&&r.type===1?this.ga=this.ga.insert(t,{type:2,doc:e.doc}):qe(63341,{Vt:e,pa:r}):this.ga=this.ga.insert(t,e)}ya(){const e=[];return this.ga.inorderTraversal(((t,r)=>{e.push(r)})),e}}class Ku{constructor(e,t,r,i,s,o,a,c,u){this.query=e,this.docs=t,this.oldDocs=r,this.docChanges=i,this.mutatedKeys=s,this.fromCache=o,this.syncStateChanged=a,this.excludesMetadataChanges=c,this.hasCachedResults=u}static fromInitialDocuments(e,t,r,i,s){const o=[];return t.forEach((a=>{o.push({type:0,doc:a})})),new Ku(e,t,Au.emptySet(t),o,r,i,!0,!1,s)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&Zh(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const t=this.docChanges,r=e.docChanges;if(t.length!==r.length)return!1;for(let i=0;i<t.length;i++)if(t[i].type!==r[i].type||!t[i].doc.isEqual(r[i].doc))return!1;return!0}}class rk{constructor(){this.wa=void 0,this.ba=[]}Sa(){return this.ba.some((e=>e.Da()))}}class ik{constructor(){this.queries=v_(),this.onlineState="Unknown",this.Ca=new Set}terminate(){(function(t,r){const i=Be(t),s=i.queries;i.queries=v_(),s.forEach(((o,a)=>{for(const c of a.ba)c.onError(r)}))})(this,new Pe(pe.ABORTED,"Firestore shutting down"))}}function v_(){return new So((n=>Rb(n)),Zh)}async function l0(n,e){const t=Be(n);let r=3;const i=e.query;let s=t.queries.get(i);s?!s.Sa()&&e.Da()&&(r=2):(s=new rk,r=e.Da()?0:1);try{switch(r){case 0:s.wa=await t.onListen(i,!0);break;case 1:s.wa=await t.onListen(i,!1);break;case 2:await t.onFirstRemoteStoreListen(i)}}catch(o){const a=ll(o,`Initialization of query '${cu(e.query)}' failed`);return void e.onError(a)}t.queries.set(i,s),s.ba.push(e),e.va(t.onlineState),s.wa&&e.Fa(s.wa)&&d0(t)}async function h0(n,e){const t=Be(n),r=e.query;let i=3;const s=t.queries.get(r);if(s){const o=s.ba.indexOf(e);o>=0&&(s.ba.splice(o,1),s.ba.length===0?i=e.Da()?0:1:!s.Sa()&&e.Da()&&(i=2))}switch(i){case 0:return t.queries.delete(r),t.onUnlisten(r,!0);case 1:return t.queries.delete(r),t.onUnlisten(r,!1);case 2:return t.onLastRemoteStoreUnlisten(r);default:return}}function sk(n,e){const t=Be(n);let r=!1;for(const i of e){const s=i.query,o=t.queries.get(s);if(o){for(const a of o.ba)a.Fa(i)&&(r=!0);o.wa=i}}r&&d0(t)}function ok(n,e,t){const r=Be(n),i=r.queries.get(e);if(i)for(const s of i.ba)s.onError(t);r.queries.delete(e)}function d0(n){n.Ca.forEach((e=>{e.next()}))}var Nm,w_;(w_=Nm||(Nm={})).Ma="default",w_.Cache="cache";class f0{constructor(e,t,r){this.query=e,this.xa=t,this.Oa=!1,this.Na=null,this.onlineState="Unknown",this.options=r||{}}Fa(e){if(!this.options.includeMetadataChanges){const r=[];for(const i of e.docChanges)i.type!==3&&r.push(i);e=new Ku(e.query,e.docs,e.oldDocs,r,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let t=!1;return this.Oa?this.Ba(e)&&(this.xa.next(e),t=!0):this.La(e,this.onlineState)&&(this.ka(e),t=!0),this.Na=e,t}onError(e){this.xa.error(e)}va(e){this.onlineState=e;let t=!1;return this.Na&&!this.Oa&&this.La(this.Na,e)&&(this.ka(this.Na),t=!0),t}La(e,t){if(!e.fromCache||!this.Da())return!0;const r=t!=="Offline";return(!this.options.Ka||!r)&&(!e.docs.isEmpty()||e.hasCachedResults||t==="Offline")}Ba(e){if(e.docChanges.length>0)return!0;const t=this.Na&&this.Na.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!t)&&this.options.includeMetadataChanges===!0}ka(e){e=Ku.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.Oa=!0,this.xa.next(e)}Da(){return this.options.source!==Nm.Cache}}class ak{constructor(e,t){this.qa=e,this.byteLength=t}Ua(){return"metadata"in this.qa}}class b_{constructor(e){this.serializer=e}Ks(e){return js(this.serializer,e)}qs(e){return e.metadata.exists?Zb(this.serializer,e.document,!1):bn.newNoDocument(this.Ks(e.metadata.name),this.Us(e.metadata.readTime))}Us(e){return Hn(e)}}class ck{constructor(e,t){this.$a=e,this.serializer=t,this.Wa=[],this.Qa=[],this.collectionGroups=new Set,this.progress=UI(e)}get queries(){return this.Wa}get documents(){return this.Qa}Ga(e){this.progress.bytesLoaded+=e.byteLength;let t=this.progress.documentsLoaded;if(e.qa.namedQuery)this.Wa.push(e.qa.namedQuery);else if(e.qa.documentMetadata){this.Qa.push({metadata:e.qa.documentMetadata}),e.qa.documentMetadata.exists||++t;const r=Ot.fromString(e.qa.documentMetadata.name);this.collectionGroups.add(r.get(r.length-2))}else e.qa.document&&(this.Qa[this.Qa.length-1].document=e.qa.document,++t);return t!==this.progress.documentsLoaded?(this.progress.documentsLoaded=t,{...this.progress}):null}za(e){const t=new Map,r=new b_(this.serializer);for(const i of e)if(i.metadata.queries){const s=r.Ks(i.metadata.name);for(const o of i.metadata.queries){const a=(t.get(o)||xt()).add(s);t.set(o,a)}}return t}async ja(e){const t=await L6(e,new b_(this.serializer),this.Qa,this.$a.id),r=this.za(this.documents);for(const i of this.Wa)await D6(e,i,r.get(i.name));return this.progress.taskState="Success",{progress:this.progress,Ha:this.collectionGroups,Ja:t}}}function UI(n){return{taskState:"Running",documentsLoaded:0,bytesLoaded:0,totalDocuments:n.totalDocuments,totalBytes:n.totalBytes}}class jI{constructor(e){this.key=e}}class qI{constructor(e){this.key=e}}class zI{constructor(e,t){this.query=e,this.Za=t,this.Xa=null,this.hasCachedResults=!1,this.current=!1,this.Ya=xt(),this.mutatedKeys=xt(),this.eu=kb(e),this.tu=new Au(this.eu)}get nu(){return this.Za}ru(e,t){const r=t?t.iu:new __,i=t?t.tu:this.tu;let s=t?t.mutatedKeys:this.mutatedKeys,o=i,a=!1;const c=this.query.limitType==="F"&&i.size===this.query.limit?i.last():null,u=this.query.limitType==="L"&&i.size===this.query.limit?i.first():null;if(e.inorderTraversal(((d,g)=>{const y=i.get(d),p=ed(this.query,g)?g:null,S=!!y&&this.mutatedKeys.has(y.key),N=!!p&&(p.hasLocalMutations||this.mutatedKeys.has(p.key)&&p.hasCommittedMutations);let C=!1;y&&p?y.data.isEqual(p.data)?S!==N&&(r.track({type:3,doc:p}),C=!0):this.su(y,p)||(r.track({type:2,doc:p}),C=!0,(c&&this.eu(p,c)>0||u&&this.eu(p,u)<0)&&(a=!0)):!y&&p?(r.track({type:0,doc:p}),C=!0):y&&!p&&(r.track({type:1,doc:y}),C=!0,(c||u)&&(a=!0)),C&&(p?(o=o.add(p),s=N?s.add(d):s.delete(d)):(o=o.delete(d),s=s.delete(d)))})),this.query.limit!==null)for(;o.size>this.query.limit;){const d=this.query.limitType==="F"?o.last():o.first();o=o.delete(d.key),s=s.delete(d.key),r.track({type:1,doc:d})}return{tu:o,iu:r,Ss:a,mutatedKeys:s}}su(e,t){return e.hasLocalMutations&&t.hasCommittedMutations&&!t.hasLocalMutations}applyChanges(e,t,r,i){const s=this.tu;this.tu=e.tu,this.mutatedKeys=e.mutatedKeys;const o=e.iu.ya();o.sort(((d,g)=>(function(p,S){const N=C=>{switch(C){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return qe(20277,{Vt:C})}};return N(p)-N(S)})(d.type,g.type)||this.eu(d.doc,g.doc))),this.ou(r),i=i??!1;const a=t&&!i?this._u():[],c=this.Ya.size===0&&this.current&&!i?1:0,u=c!==this.Xa;return this.Xa=c,o.length!==0||u?{snapshot:new Ku(this.query,e.tu,s,o,e.mutatedKeys,c===0,u,!1,!!r&&r.resumeToken.approximateByteSize()>0),au:a}:{au:a}}va(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({tu:this.tu,iu:new __,mutatedKeys:this.mutatedKeys,Ss:!1},!1)):{au:[]}}uu(e){return!this.Za.has(e)&&!!this.tu.has(e)&&!this.tu.get(e).hasLocalMutations}ou(e){e&&(e.addedDocuments.forEach((t=>this.Za=this.Za.add(t))),e.modifiedDocuments.forEach((t=>{})),e.removedDocuments.forEach((t=>this.Za=this.Za.delete(t))),this.current=e.current)}_u(){if(!this.current)return[];const e=this.Ya;this.Ya=xt(),this.tu.forEach((r=>{this.uu(r.key)&&(this.Ya=this.Ya.add(r.key))}));const t=[];return e.forEach((r=>{this.Ya.has(r)||t.push(new qI(r))})),this.Ya.forEach((r=>{e.has(r)||t.push(new jI(r))})),t}cu(e){this.Za=e.ks,this.Ya=xt();const t=this.ru(e.documents);return this.applyChanges(t,!0)}lu(){return Ku.fromInitialDocuments(this.query,this.tu,this.mutatedKeys,this.Xa===0,this.hasCachedResults)}}const La="SyncEngine";class uk{constructor(e,t,r){this.query=e,this.targetId=t,this.view=r}}class lk{constructor(e){this.key=e,this.hu=!1}}class hk{constructor(e,t,r,i,s,o){this.localStore=e,this.remoteStore=t,this.eventManager=r,this.sharedClientState=i,this.currentUser=s,this.maxConcurrentLimboResolutions=o,this.Pu={},this.Tu=new So((a=>Rb(a)),Zh),this.Iu=new Map,this.Eu=new Set,this.Ru=new _n(Fe.comparator),this.Au=new Map,this.Vu=new X1,this.du={},this.mu=new Map,this.fu=Ac.ar(),this.onlineState="Unknown",this.gu=void 0}get isPrimaryClient(){return this.gu===!0}}async function dk(n,e,t=!0){const r=Ap(n);let i;const s=r.Tu.get(e);return s?(r.sharedClientState.addLocalQueryTarget(s.targetId),i=s.view.lu()):i=await $I(r,e,t,!0),i}async function fk(n,e){const t=Ap(n);await $I(t,e,!0,!1)}async function $I(n,e,t,r){const i=await Wu(n.localStore,Kr(e)),s=i.targetId,o=n.sharedClientState.addLocalQueryTarget(s,t);let a;return r&&(a=await p0(n,e,s,o==="current",i.resumeToken)),n.isPrimaryClient&&t&&Ip(n.remoteStore,i),a}async function p0(n,e,t,r,i){n.pu=(g,y,p)=>(async function(N,C,k,K){let G=C.view.ru(k);G.Ss&&(G=await Mf(N.localStore,C.query,!1).then((({documents:B})=>C.view.ru(B,G))));const W=K&&K.targetChanges.get(C.targetId),ne=K&&K.targetMismatches.get(C.targetId)!=null,de=C.view.applyChanges(G,N.isPrimaryClient,W,ne);return km(N,C.targetId,de.au),de.snapshot})(n,g,y,p);const s=await Mf(n.localStore,e,!0),o=new zI(e,s.ks),a=o.ru(s.documents),c=rd.createSynthesizedTargetChangeForCurrentChange(t,r&&n.onlineState!=="Offline",i),u=o.applyChanges(a,n.isPrimaryClient,c);km(n,t,u.au);const d=new uk(e,t,o);return n.Tu.set(e,d),n.Iu.has(t)?n.Iu.get(t).push(e):n.Iu.set(t,[e]),u.snapshot}async function pk(n,e,t){const r=Be(n),i=r.Tu.get(e),s=r.Iu.get(i.targetId);if(s.length>1)return r.Iu.set(i.targetId,s.filter((o=>!Zh(o,e)))),void r.Tu.delete(e);r.isPrimaryClient?(r.sharedClientState.removeLocalQueryTarget(i.targetId),r.sharedClientState.isActiveQueryTarget(i.targetId)||await Hu(r.localStore,i.targetId,!1).then((()=>{r.sharedClientState.clearQueryState(i.targetId),t&&Gu(r.remoteStore,i.targetId),Yu(r,i.targetId)})).catch(Ra)):(Yu(r,i.targetId),await Hu(r.localStore,i.targetId,!0))}async function gk(n,e){const t=Be(n),r=t.Tu.get(e),i=t.Iu.get(r.targetId);t.isPrimaryClient&&i.length===1&&(t.sharedClientState.removeLocalQueryTarget(r.targetId),Gu(t.remoteStore,r.targetId))}async function mk(n,e,t){const r=_0(n);try{const i=await(function(o,a){const c=Be(o),u=Jt.now(),d=a.reduce(((p,S)=>p.add(S.key)),xt());let g,y;return c.persistence.runTransaction("Locally write mutations","readwrite",(p=>{let S=hi(),N=xt();return c.xs.getEntries(p,d).next((C=>{S=C,S.forEach(((k,K)=>{K.isValidDocument()||(N=N.add(k))}))})).next((()=>c.localDocuments.getOverlayedDocuments(p,S))).next((C=>{g=C;const k=[];for(const K of a){const G=MN(K,g.get(K.key).overlayedDocument);G!=null&&k.push(new Po(K.key,G,wb(G.value.mapValue),Rn.exists(!0)))}return c.mutationQueue.addMutationBatch(p,u,k,a)})).next((C=>{y=C;const k=C.applyToLocalDocumentSet(g,N);return c.documentOverlayCache.saveOverlays(p,C.batchId,k)}))})).then((()=>({batchId:y.batchId,changes:Lb(g)})))})(r.localStore,e);r.sharedClientState.addPendingMutation(i.batchId),(function(o,a,c){let u=o.du[o.currentUser.toKey()];u||(u=new _n(wt)),u=u.insert(a,c),o.du[o.currentUser.toKey()]=u})(r,i.batchId,t),await xo(r,i.changes),await cl(r.remoteStore)}catch(i){const s=ll(i,"Failed to persist write");t.reject(s)}}async function WI(n,e){const t=Be(n);try{const r=await k6(t.localStore,e);e.targetChanges.forEach(((i,s)=>{const o=t.Au.get(s);o&&(Ke(i.addedDocuments.size+i.modifiedDocuments.size+i.removedDocuments.size<=1,22616),i.addedDocuments.size>0?o.hu=!0:i.modifiedDocuments.size>0?Ke(o.hu,14607):i.removedDocuments.size>0&&(Ke(o.hu,42227),o.hu=!1))})),await xo(t,r,e)}catch(r){await Ra(r)}}function I_(n,e,t){const r=Be(n);if(r.isPrimaryClient&&t===0||!r.isPrimaryClient&&t===1){const i=[];r.Tu.forEach(((s,o)=>{const a=o.view.va(e);a.snapshot&&i.push(a.snapshot)})),(function(o,a){const c=Be(o);c.onlineState=a;let u=!1;c.queries.forEach(((d,g)=>{for(const y of g.ba)y.va(a)&&(u=!0)})),u&&d0(c)})(r.eventManager,e),i.length&&r.Pu.J_(i),r.onlineState=e,r.isPrimaryClient&&r.sharedClientState.setOnlineState(e)}}async function yk(n,e,t){const r=Be(n);r.sharedClientState.updateQueryState(e,"rejected",t);const i=r.Au.get(e),s=i&&i.key;if(s){let o=new _n(Fe.comparator);o=o.insert(s,bn.newNoDocument(s,et.min()));const a=xt().add(s),c=new nd(et.min(),new Map,new _n(wt),o,a);await WI(r,c),r.Ru=r.Ru.remove(s),r.Au.delete(e),y0(r)}else await Hu(r.localStore,e,!1).then((()=>Yu(r,e,t))).catch(Ra)}async function _k(n,e){const t=Be(n),r=e.batch.batchId;try{const i=await N6(t.localStore,e);m0(t,r,null),g0(t,r),t.sharedClientState.updateMutationState(r,"acknowledged"),await xo(t,i)}catch(i){await Ra(i)}}async function vk(n,e,t){const r=Be(n);try{const i=await(function(o,a){const c=Be(o);return c.persistence.runTransaction("Reject batch","readwrite-primary",(u=>{let d;return c.mutationQueue.lookupMutationBatch(u,a).next((g=>(Ke(g!==null,37113),d=g.keys(),c.mutationQueue.removeMutationBatch(u,g)))).next((()=>c.mutationQueue.performConsistencyCheck(u))).next((()=>c.documentOverlayCache.removeOverlaysForBatchId(u,d,a))).next((()=>c.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(u,d))).next((()=>c.localDocuments.getDocuments(u,d)))}))})(r.localStore,e);m0(r,e,t),g0(r,e),r.sharedClientState.updateMutationState(e,"rejected",t),await xo(r,i)}catch(i){await Ra(i)}}async function wk(n,e){const t=Be(n);Ca(t.remoteStore)||Ne(La,"The network is disabled. The task returned by 'awaitPendingWrites()' will not complete until the network is enabled.");try{const r=await(function(o){const a=Be(o);return a.persistence.runTransaction("Get highest unacknowledged batch id","readonly",(c=>a.mutationQueue.getHighestUnacknowledgedBatchId(c)))})(t.localStore);if(r===da)return void e.resolve();const i=t.mu.get(r)||[];i.push(e),t.mu.set(r,i)}catch(r){const i=ll(r,"Initialization of waitForPendingWrites() operation failed");e.reject(i)}}function g0(n,e){(n.mu.get(e)||[]).forEach((t=>{t.resolve()})),n.mu.delete(e)}function m0(n,e,t){const r=Be(n);let i=r.du[r.currentUser.toKey()];if(i){const s=i.get(e);s&&(t?s.reject(t):s.resolve(),i=i.remove(e)),r.du[r.currentUser.toKey()]=i}}function Yu(n,e,t=null){n.sharedClientState.removeLocalQueryTarget(e);for(const r of n.Iu.get(e))n.Tu.delete(r),t&&n.Pu.yu(r,t);n.Iu.delete(e),n.isPrimaryClient&&n.Vu.Gr(e).forEach((r=>{n.Vu.containsKey(r)||HI(n,r)}))}function HI(n,e){n.Eu.delete(e.path.canonicalString());const t=n.Ru.get(e);t!==null&&(Gu(n.remoteStore,t),n.Ru=n.Ru.remove(e),n.Au.delete(t),y0(n))}function km(n,e,t){for(const r of t)r instanceof jI?(n.Vu.addReference(r.key,e),bk(n,r)):r instanceof qI?(Ne(La,"Document no longer in limbo: "+r.key),n.Vu.removeReference(r.key,e),n.Vu.containsKey(r.key)||HI(n,r.key)):qe(19791,{wu:r})}function bk(n,e){const t=e.key,r=t.path.canonicalString();n.Ru.get(t)||n.Eu.has(r)||(Ne(La,"New document in limbo: "+t),n.Eu.add(r),y0(n))}function y0(n){for(;n.Eu.size>0&&n.Ru.size<n.maxConcurrentLimboResolutions;){const e=n.Eu.values().next().value;n.Eu.delete(e);const t=new Fe(Ot.fromString(e)),r=n.fu.next();n.Au.set(r,new lk(t)),n.Ru=n.Ru.insert(t,r),Ip(n.remoteStore,new fo(Kr(il(t.path)),r,"TargetPurposeLimboResolution",ui.ce))}}async function xo(n,e,t){const r=Be(n),i=[],s=[],o=[];r.Tu.isEmpty()||(r.Tu.forEach(((a,c)=>{o.push(r.pu(c,e,t).then((u=>{if((u||t)&&r.isPrimaryClient){const d=u?!u.fromCache:t?.targetChanges.get(c.targetId)?.current;r.sharedClientState.updateQueryState(c.targetId,d?"current":"not-current")}if(u){i.push(u);const d=n0.Es(c.targetId,u);s.push(d)}})))})),await Promise.all(o),r.Pu.J_(i),await(async function(c,u){const d=Be(c);try{await d.persistence.runTransaction("notifyLocalViewChanges","readwrite",(g=>oe.forEach(u,(y=>oe.forEach(y.Ts,(p=>d.persistence.referenceDelegate.addReference(g,y.targetId,p))).next((()=>oe.forEach(y.Is,(p=>d.persistence.referenceDelegate.removeReference(g,y.targetId,p)))))))))}catch(g){if(!Na(g))throw g;Ne(r0,"Failed to update sequence numbers: "+g)}for(const g of u){const y=g.targetId;if(!g.fromCache){const p=d.vs.get(y),S=p.snapshotVersion,N=p.withLastLimboFreeSnapshotVersion(S);d.vs=d.vs.insert(y,N)}}})(r.localStore,s))}async function Ik(n,e){const t=Be(n);if(!t.currentUser.isEqual(e)){Ne(La,"User change. New user:",e.toKey());const r=await AI(t.localStore,e);t.currentUser=e,(function(s,o){s.mu.forEach((a=>{a.forEach((c=>{c.reject(new Pe(pe.CANCELLED,o))}))})),s.mu.clear()})(t,"'waitForPendingWrites' promise is rejected due to a user change."),t.sharedClientState.handleUserChange(e,r.removedBatchIds,r.addedBatchIds),await xo(t,r.Ns)}}function Ak(n,e){const t=Be(n),r=t.Au.get(e);if(r&&r.hu)return xt().add(r.key);{let i=xt();const s=t.Iu.get(e);if(!s)return i;for(const o of s){const a=t.Tu.get(o);i=i.unionWith(a.view.nu)}return i}}async function Ek(n,e){const t=Be(n),r=await Mf(t.localStore,e.query,!0),i=e.view.cu(r);return t.isPrimaryClient&&km(t,e.targetId,i.au),i}async function Tk(n,e){const t=Be(n);return PI(t.localStore,e).then((r=>xo(t,r)))}async function Sk(n,e,t,r){const i=Be(n),s=await(function(a,c){const u=Be(a),d=Be(u.mutationQueue);return u.persistence.runTransaction("Lookup mutation documents","readonly",(g=>d.Xn(g,c).next((y=>y?u.localDocuments.getDocuments(g,y):oe.resolve(null)))))})(i.localStore,e);s!==null?(t==="pending"?await cl(i.remoteStore):t==="acknowledged"||t==="rejected"?(m0(i,e,r||null),g0(i,e),(function(a,c){Be(Be(a).mutationQueue).nr(c)})(i.localStore,e)):qe(6720,"Unknown batchState",{bu:t}),await xo(i,s)):Ne(La,"Cannot apply mutation batch with id: "+e)}async function Pk(n,e){const t=Be(n);if(Ap(t),_0(t),e===!0&&t.gu!==!0){const r=t.sharedClientState.getAllActiveQueryTargets(),i=await A_(t,r.toArray());t.gu=!0,await Rm(t.remoteStore,!0);for(const s of i)Ip(t.remoteStore,s)}else if(e===!1&&t.gu!==!1){const r=[];let i=Promise.resolve();t.Iu.forEach(((s,o)=>{t.sharedClientState.isLocalQueryTarget(o)?r.push(o):i=i.then((()=>(Yu(t,o),Hu(t.localStore,o,!0)))),Gu(t.remoteStore,o)})),await i,await A_(t,r),(function(o){const a=Be(o);a.Au.forEach(((c,u)=>{Gu(a.remoteStore,u)})),a.Vu.zr(),a.Au=new Map,a.Ru=new _n(Fe.comparator)})(t),t.gu=!1,await Rm(t.remoteStore,!1)}}async function A_(n,e,t){const r=Be(n),i=[],s=[];for(const o of e){let a;const c=r.Iu.get(o);if(c&&c.length!==0){a=await Wu(r.localStore,Kr(c[0]));for(const u of c){const d=r.Tu.get(u),g=await Ek(r,d);g.snapshot&&s.push(g.snapshot)}}else{const u=await SI(r.localStore,o);a=await Wu(r.localStore,u),await p0(r,GI(u),o,!1,a.resumeToken)}i.push(a)}return r.Pu.J_(s),i}function GI(n){return xb(n.path,n.collectionGroup,n.orderBy,n.filters,n.limit,"F",n.startAt,n.endAt)}function xk(n){return(function(t){return Be(Be(t).persistence).hs()})(Be(n).localStore)}async function Rk(n,e,t,r){const i=Be(n);if(i.gu)return void Ne(La,"Ignoring unexpected query state notification.");const s=i.Iu.get(e);if(s&&s.length>0)switch(t){case"current":case"not-current":{const o=await PI(i.localStore,Nb(s[0])),a=nd.createSynthesizedRemoteEventForCurrentChange(e,t==="current",On.EMPTY_BYTE_STRING);await xo(i,o,a);break}case"rejected":await Hu(i.localStore,e,!0),Yu(i,e,r);break;default:qe(64155,t)}}async function Nk(n,e,t){const r=Ap(n);if(r.gu){for(const i of e){if(r.Iu.has(i)&&r.sharedClientState.isActiveQueryTarget(i)){Ne(La,"Adding an already active target "+i);continue}const s=await SI(r.localStore,i),o=await Wu(r.localStore,s);await p0(r,GI(s),o.targetId,!1,o.resumeToken),Ip(r.remoteStore,o)}for(const i of t)r.Iu.has(i)&&await Hu(r.localStore,i,!1).then((()=>{Gu(r.remoteStore,i),Yu(r,i)})).catch(Ra)}}function Ap(n){const e=Be(n);return e.remoteStore.remoteSyncer.applyRemoteEvent=WI.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=Ak.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=yk.bind(null,e),e.Pu.J_=sk.bind(null,e.eventManager),e.Pu.yu=ok.bind(null,e.eventManager),e}function _0(n){const e=Be(n);return e.remoteStore.remoteSyncer.applySuccessfulWrite=_k.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=vk.bind(null,e),e}function kk(n,e,t){const r=Be(n);(async function(s,o,a){try{const c=await o.getMetadata();if(await(function(p,S){const N=Be(p),C=Hn(S.createTime);return N.persistence.runTransaction("hasNewerBundle","readonly",(k=>N.Pi.getBundleMetadata(k,S.id))).then((k=>!!k&&k.createTime.compareTo(C)>=0))})(s.localStore,c))return await o.close(),a._completeWith((function(p){return{taskState:"Success",documentsLoaded:p.totalDocuments,bytesLoaded:p.totalBytes,totalDocuments:p.totalDocuments,totalBytes:p.totalBytes}})(c)),Promise.resolve(new Set);a._updateProgress(UI(c));const u=new ck(c,o.serializer);let d=await o.Su();for(;d;){const y=await u.Ga(d);y&&a._updateProgress(y),d=await o.Su()}const g=await u.ja(s.localStore);return await xo(s,g.Ja,void 0),await(function(p,S){const N=Be(p);return N.persistence.runTransaction("Save bundle","readwrite",(C=>N.Pi.saveBundleMetadata(C,S)))})(s.localStore,c),a._completeWith(g.progress),Promise.resolve(g.Ha)}catch(c){return Hs(La,`Loading bundle failed with ${c}`),a._failWith(c),Promise.resolve(new Set)}})(r,e,t).then((i=>{r.sharedClientState.notifyBundleLoaded(i)}))}class Oh{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(e){this.serializer=id(e.databaseInfo.databaseId),this.sharedClientState=this.Du(e),this.persistence=this.Cu(e),await this.persistence.start(),this.localStore=this.vu(e),this.gcScheduler=this.Fu(e,this.localStore),this.indexBackfillerScheduler=this.Mu(e,this.localStore)}Fu(e,t){return null}Mu(e,t){return null}vu(e){return II(this.persistence,new bI,e.initialUser,this.serializer)}Cu(e){return new Z1(bp.Vi,this.serializer)}Du(e){return new CI}async terminate(){this.gcScheduler?.stop(),this.indexBackfillerScheduler?.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}Oh.provider={build:()=>new Oh};class Ck extends Oh{constructor(e){super(),this.cacheSizeBytes=e}Fu(e,t){Ke(this.persistence.referenceDelegate instanceof Ff,46915);const r=this.persistence.referenceDelegate.garbageCollector;return new gI(r,e.asyncQueue,t)}Cu(e){const t=this.cacheSizeBytes!==void 0?Rr.withCacheSize(this.cacheSizeBytes):Rr.DEFAULT;return new Z1((r=>Ff.Vi(r,t)),this.serializer)}}class KI extends Oh{constructor(e,t,r){super(),this.xu=e,this.cacheSizeBytes=t,this.forceOwnership=r,this.kind="persistent",this.synchronizeTabs=!1}async initialize(e){await super.initialize(e),await this.xu.initialize(this,e),await _0(this.xu.syncEngine),await cl(this.xu.remoteStore),await this.persistence.zi((()=>(this.gcScheduler&&!this.gcScheduler.started&&this.gcScheduler.start(),this.indexBackfillerScheduler&&!this.indexBackfillerScheduler.started&&this.indexBackfillerScheduler.start(),Promise.resolve())))}vu(e){return II(this.persistence,new bI,e.initialUser,this.serializer)}Fu(e,t){const r=this.persistence.referenceDelegate.garbageCollector;return new gI(r,e.asyncQueue,t)}Mu(e,t){const r=new OR(t,this.persistence);return new DR(e.asyncQueue,r)}Cu(e){const t=t0(e.databaseInfo.databaseId,e.databaseInfo.persistenceKey),r=this.cacheSizeBytes!==void 0?Rr.withCacheSize(this.cacheSizeBytes):Rr.DEFAULT;return new e0(this.synchronizeTabs,t,e.clientId,r,e.asyncQueue,LI(),cf(),this.serializer,this.sharedClientState,!!this.forceOwnership)}Du(e){return new CI}}class Lk extends KI{constructor(e,t){super(e,t,!1),this.xu=e,this.cacheSizeBytes=t,this.synchronizeTabs=!0}async initialize(e){await super.initialize(e);const t=this.xu.syncEngine;this.sharedClientState instanceof wg&&(this.sharedClientState.syncEngine={So:Sk.bind(null,t),Do:Rk.bind(null,t),Co:Nk.bind(null,t),hs:xk.bind(null,t),bo:Tk.bind(null,t)},await this.sharedClientState.start()),await this.persistence.zi((async r=>{await Pk(this.xu.syncEngine,r),this.gcScheduler&&(r&&!this.gcScheduler.started?this.gcScheduler.start():r||this.gcScheduler.stop()),this.indexBackfillerScheduler&&(r&&!this.indexBackfillerScheduler.started?this.indexBackfillerScheduler.start():r||this.indexBackfillerScheduler.stop())}))}Du(e){const t=LI();if(!wg.v(t))throw new Pe(pe.UNIMPLEMENTED,"IndexedDB persistence is only available on platforms that support LocalStorage.");const r=t0(e.databaseInfo.databaseId,e.databaseInfo.persistenceKey);return new wg(t,e.asyncQueue,r,e.clientId,e.initialUser)}}class Fh{async initialize(e,t){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(t),this.remoteStore=this.createRemoteStore(t),this.eventManager=this.createEventManager(t),this.syncEngine=this.createSyncEngine(t,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=r=>I_(this.syncEngine,r,1),this.remoteStore.remoteSyncer.handleCredentialChange=Ik.bind(null,this.syncEngine),await Rm(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return(function(){return new ik})()}createDatastore(e){const t=id(e.databaseInfo.databaseId),r=B6(e.databaseInfo);return $6(e.authCredentials,e.appCheckCredentials,r,t)}createRemoteStore(e){return(function(r,i,s,o,a){return new H6(r,i,s,o,a)})(this.localStore,this.datastore,e.asyncQueue,(t=>I_(this.syncEngine,t,0)),(function(){return g_.v()?new g_:new O6})())}createSyncEngine(e,t){return(function(i,s,o,a,c,u,d){const g=new hk(i,s,o,a,c,u);return d&&(g.gu=!0),g})(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,t)}async terminate(){await(async function(t){const r=Be(t);Ne(Ec,"RemoteStore shutting down."),r.Ea.add(5),await al(r),r.Aa.shutdown(),r.Va.set("Unknown")})(this.remoteStore),this.datastore?.terminate(),this.eventManager?.terminate()}}Fh.provider={build:()=>new Fh};function E_(n,e=10240){let t=0;return{async read(){if(t<n.byteLength){const r={value:n.slice(t,t+e),done:!1};return t+=e,r}return{done:!0}},async cancel(){},releaseLock(){},closed:Promise.resolve()}}class Ep{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.Ou(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.Ou(this.observer.error,e):Wn("Uncaught Error in snapshot listener:",e.toString()))}Nu(){this.muted=!0}Ou(e,t){setTimeout((()=>{this.muted||e(t)}),0)}}class Dk{constructor(e,t){this.Bu=e,this.serializer=t,this.metadata=new _r,this.buffer=new Uint8Array,this.Lu=(function(){return new TextDecoder("utf-8")})(),this.ku().then((r=>{r&&r.Ua()?this.metadata.resolve(r.qa.metadata):this.metadata.reject(new Error(`The first element of the bundle is not a metadata, it is
             ${JSON.stringify(r?.qa)}`))}),(r=>this.metadata.reject(r)))}close(){return this.Bu.cancel()}async getMetadata(){return this.metadata.promise}async Su(){return await this.getMetadata(),this.ku()}async ku(){const e=await this.Ku();if(e===null)return null;const t=this.Lu.decode(e),r=Number(t);isNaN(r)&&this.qu(`length string (${t}) is not valid number`);const i=await this.Uu(r);return new ak(JSON.parse(i),e.length+r)}$u(){return this.buffer.findIndex((e=>e===123))}async Ku(){for(;this.$u()<0&&!await this.Wu(););if(this.buffer.length===0)return null;const e=this.$u();e<0&&this.qu("Reached the end of bundle when a length string is expected.");const t=this.buffer.slice(0,e);return this.buffer=this.buffer.slice(e),t}async Uu(e){for(;this.buffer.length<e;)await this.Wu()&&this.qu("Reached the end of bundle when more is expected.");const t=this.Lu.decode(this.buffer.slice(0,e));return this.buffer=this.buffer.slice(e),t}qu(e){throw this.Bu.cancel(),new Error(`Invalid bundle format: ${e}`)}async Wu(){const e=await this.Bu.read();if(!e.done){const t=new Uint8Array(this.buffer.length+e.value.length);t.set(this.buffer),t.set(e.value,this.buffer.length),this.buffer=t}return e.done}}let Ok=class{constructor(e){this.datastore=e,this.readVersions=new Map,this.mutations=[],this.committed=!1,this.lastTransactionError=null,this.writtenDocs=new Set}async lookup(e){if(this.ensureCommitNotCalled(),this.mutations.length>0)throw this.lastTransactionError=new Pe(pe.INVALID_ARGUMENT,"Firestore transactions require all reads to be executed before all writes."),this.lastTransactionError;const t=await(async function(i,s){const o=Be(i),a={documents:s.map((g=>Lh(o.serializer,g)))},c=await o.jo("BatchGetDocuments",o.serializer.databaseId,Ot.emptyPath(),a,s.length),u=new Map;c.forEach((g=>{const y=HN(o.serializer,g);u.set(y.key.toString(),y)}));const d=[];return s.forEach((g=>{const y=u.get(g.toString());Ke(!!y,55234,{key:g}),d.push(y)})),d})(this.datastore,e);return t.forEach((r=>this.recordVersion(r))),t}set(e,t){this.write(t.toMutation(e,this.precondition(e))),this.writtenDocs.add(e.toString())}update(e,t){try{this.write(t.toMutation(e,this.preconditionForUpdate(e)))}catch(r){this.lastTransactionError=r}this.writtenDocs.add(e.toString())}delete(e){this.write(new ol(e,this.precondition(e))),this.writtenDocs.add(e.toString())}async commit(){if(this.ensureCommitNotCalled(),this.lastTransactionError)throw this.lastTransactionError;const e=this.readVersions;this.mutations.forEach((t=>{e.delete(t.key.toString())})),e.forEach(((t,r)=>{const i=Fe.fromPath(r);this.mutations.push(new z1(i,this.precondition(i)))})),await(async function(r,i){const s=Be(r),o={writes:i.map((a=>Dh(s.serializer,a)))};await s.Wo("Commit",s.serializer.databaseId,Ot.emptyPath(),o)})(this.datastore,this.mutations),this.committed=!0}recordVersion(e){let t;if(e.isFoundDocument())t=e.version;else{if(!e.isNoDocument())throw qe(50498,{Gu:e.constructor.name});t=et.min()}const r=this.readVersions.get(e.key.toString());if(r){if(!t.isEqual(r))throw new Pe(pe.ABORTED,"Document version changed between two reads.")}else this.readVersions.set(e.key.toString(),t)}precondition(e){const t=this.readVersions.get(e.toString());return!this.writtenDocs.has(e.toString())&&t?t.isEqual(et.min())?Rn.exists(!1):Rn.updateTime(t):Rn.none()}preconditionForUpdate(e){const t=this.readVersions.get(e.toString());if(!this.writtenDocs.has(e.toString())&&t){if(t.isEqual(et.min()))throw new Pe(pe.INVALID_ARGUMENT,"Can't update a document that doesn't exist.");return Rn.updateTime(t)}return Rn.exists(!0)}write(e){this.ensureCommitNotCalled(),this.mutations.push(e)}ensureCommitNotCalled(){}};class Fk{constructor(e,t,r,i,s){this.asyncQueue=e,this.datastore=t,this.options=r,this.updateFunction=i,this.deferred=s,this.zu=r.maxAttempts,this.M_=new s0(this.asyncQueue,"transaction_retry")}ju(){this.zu-=1,this.Hu()}Hu(){this.M_.p_((async()=>{const e=new Ok(this.datastore),t=this.Ju(e);t&&t.then((r=>{this.asyncQueue.enqueueAndForget((()=>e.commit().then((()=>{this.deferred.resolve(r)})).catch((i=>{this.Zu(i)}))))})).catch((r=>{this.Zu(r)}))}))}Ju(e){try{const t=this.updateFunction(e);return!Jh(t)&&t.catch&&t.then?t:(this.deferred.reject(Error("Transaction callback must return a Promise")),null)}catch(t){return this.deferred.reject(t),null}}Zu(e){this.zu>0&&this.Xu(e)?(this.zu-=1,this.asyncQueue.enqueueAndForget((()=>(this.Hu(),Promise.resolve())))):this.deferred.reject(e)}Xu(e){if(e?.name==="FirebaseError"){const t=e.code;return t==="aborted"||t==="failed-precondition"||t==="already-exists"||!zb(t)}return!1}}const Ta="FirestoreClient";class Mk{constructor(e,t,r,i,s){this.authCredentials=e,this.appCheckCredentials=t,this.asyncQueue=r,this._databaseInfo=i,this.user=cr.UNAUTHENTICATED,this.clientId=R1.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=s,this.authCredentials.start(r,(async o=>{Ne(Ta,"Received user=",o.uid),await this.authCredentialListener(o),this.user=o})),this.appCheckCredentials.start(r,(o=>(Ne(Ta,"Received new app check token=",o),this.appCheckCredentialListener(o,this.user))))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this._databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();const e=new _r;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted((async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(t){const r=ll(t,"Failed to shutdown persistence");e.reject(r)}})),e.promise}}async function Ig(n,e){n.asyncQueue.verifyOperationInProgress(),Ne(Ta,"Initializing OfflineComponentProvider");const t=n.configuration;await e.initialize(t);let r=t.initialUser;n.setCredentialChangeListener((async i=>{r.isEqual(i)||(await AI(e.localStore,i),r=i)})),e.persistence.setDatabaseDeletedListener((()=>n.terminate())),n._offlineComponents=e}async function T_(n,e){n.asyncQueue.verifyOperationInProgress();const t=await v0(n);Ne(Ta,"Initializing OnlineComponentProvider"),await e.initialize(t,n.configuration),n.setCredentialChangeListener((r=>y_(e.remoteStore,r))),n.setAppCheckTokenChangeListener(((r,i)=>y_(e.remoteStore,i))),n._onlineComponents=e}async function v0(n){if(!n._offlineComponents)if(n._uninitializedComponentsProvider){Ne(Ta,"Using user provided OfflineComponentProvider");try{await Ig(n,n._uninitializedComponentsProvider._offline)}catch(e){const t=e;if(!(function(i){return i.name==="FirebaseError"?i.code===pe.FAILED_PRECONDITION||i.code===pe.UNIMPLEMENTED:!(typeof DOMException<"u"&&i instanceof DOMException)||i.code===22||i.code===20||i.code===11})(t))throw t;Hs("Error using user provided cache. Falling back to memory cache: "+t),await Ig(n,new Oh)}}else Ne(Ta,"Using default OfflineComponentProvider"),await Ig(n,new Ck(void 0));return n._offlineComponents}async function Tp(n){return n._onlineComponents||(n._uninitializedComponentsProvider?(Ne(Ta,"Using user provided OnlineComponentProvider"),await T_(n,n._uninitializedComponentsProvider._online)):(Ne(Ta,"Using default OnlineComponentProvider"),await T_(n,new Fh))),n._onlineComponents}function YI(n){return v0(n).then((e=>e.persistence))}function w0(n){return v0(n).then((e=>e.localStore))}function JI(n){return Tp(n).then((e=>e.remoteStore))}function b0(n){return Tp(n).then((e=>e.syncEngine))}function Vk(n){return Tp(n).then((e=>e.datastore))}async function Ju(n){const e=await Tp(n),t=e.eventManager;return t.onListen=dk.bind(null,e.syncEngine),t.onUnlisten=pk.bind(null,e.syncEngine),t.onFirstRemoteStoreListen=fk.bind(null,e.syncEngine),t.onLastRemoteStoreUnlisten=gk.bind(null,e.syncEngine),t}function Bk(n){return n.asyncQueue.enqueue((async()=>{const e=await YI(n),t=await JI(n);return e.setNetworkEnabled(!0),(function(i){const s=Be(i);return s.Ea.delete(0),sd(s)})(t)}))}function Uk(n){return n.asyncQueue.enqueue((async()=>{const e=await YI(n),t=await JI(n);return e.setNetworkEnabled(!1),(async function(i){const s=Be(i);s.Ea.add(0),await al(s),s.Va.set("Offline")})(t)}))}function jk(n,e,t,r){const i=new Ep(r),s=new f0(e,i,t);return n.asyncQueue.enqueueAndForget((async()=>l0(await Ju(n),s))),()=>{i.Nu(),n.asyncQueue.enqueueAndForget((async()=>h0(await Ju(n),s)))}}function qk(n,e){const t=new _r;return n.asyncQueue.enqueueAndForget((async()=>(async function(i,s,o){try{const a=await(function(u,d){const g=Be(u);return g.persistence.runTransaction("read document","readonly",(y=>g.localDocuments.getDocument(y,d)))})(i,s);a.isFoundDocument()?o.resolve(a):a.isNoDocument()?o.resolve(null):o.reject(new Pe(pe.UNAVAILABLE,"Failed to get document from cache. (However, this document may exist on the server. Run again without setting 'source' in the GetOptions to attempt to retrieve the document from the server.)"))}catch(a){const c=ll(a,`Failed to get document '${s} from cache`);o.reject(c)}})(await w0(n),e,t))),t.promise}function QI(n,e,t={}){const r=new _r;return n.asyncQueue.enqueueAndForget((async()=>(function(s,o,a,c,u){const d=new Ep({next:y=>{d.Nu(),o.enqueueAndForget((()=>h0(s,g)));const p=y.docs.has(a);!p&&y.fromCache?u.reject(new Pe(pe.UNAVAILABLE,"Failed to get document because the client is offline.")):p&&y.fromCache&&c&&c.source==="server"?u.reject(new Pe(pe.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):u.resolve(y)},error:y=>u.reject(y)}),g=new f0(il(a.path),d,{includeMetadataChanges:!0,Ka:!0});return l0(s,g)})(await Ju(n),n.asyncQueue,e,t,r))),r.promise}function zk(n,e){const t=new _r;return n.asyncQueue.enqueueAndForget((async()=>(async function(i,s,o){try{const a=await Mf(i,s,!0),c=new zI(s,a.ks),u=c.ru(a.documents),d=c.applyChanges(u,!1);o.resolve(d.snapshot)}catch(a){const c=ll(a,`Failed to execute query '${s} against cache`);o.reject(c)}})(await w0(n),e,t))),t.promise}function XI(n,e,t={}){const r=new _r;return n.asyncQueue.enqueueAndForget((async()=>(function(s,o,a,c,u){const d=new Ep({next:y=>{d.Nu(),o.enqueueAndForget((()=>h0(s,g))),y.fromCache&&c.source==="server"?u.reject(new Pe(pe.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):u.resolve(y)},error:y=>u.reject(y)}),g=new f0(a,d,{includeMetadataChanges:!0,Ka:!0});return l0(s,g)})(await Ju(n),n.asyncQueue,e,t,r))),r.promise}function $k(n,e){const t=new _r;return n.asyncQueue.enqueueAndForget((async()=>mk(await b0(n),e,t))),t.promise}function Wk(n,e){const t=new Ep(e);return n.asyncQueue.enqueueAndForget((async()=>(function(i,s){Be(i).Ca.add(s),s.next()})(await Ju(n),t))),()=>{t.Nu(),n.asyncQueue.enqueueAndForget((async()=>(function(i,s){Be(i).Ca.delete(s)})(await Ju(n),t)))}}function Hk(n,e,t){const r=new _r;return n.asyncQueue.enqueueAndForget((async()=>{const i=await Vk(n);new Fk(n.asyncQueue,i,t,e,r).ju()})),r.promise}function Gk(n,e,t,r){const i=(function(o,a){let c;return c=typeof o=="string"?Wb().encode(o):o,(function(d,g){return new Dk(d,g)})((function(d,g){if(d instanceof Uint8Array)return E_(d,g);if(d instanceof ArrayBuffer)return E_(new Uint8Array(d),g);if(d instanceof ReadableStream)return d.getReader();throw new Error("Source of `toByteStreamReader` has to be a ArrayBuffer or ReadableStream")})(c),a)})(t,id(e));n.asyncQueue.enqueueAndForget((async()=>{kk(await b0(n),i,r)}))}function Kk(n,e){return n.asyncQueue.enqueue((async()=>(function(r,i){const s=Be(r);return s.persistence.runTransaction("Get named query","readonly",(o=>s.Pi.getNamedQuery(o,i)))})(await w0(n),e)))}function ZI(n){const e={};return n.timeoutSeconds!==void 0&&(e.timeoutSeconds=n.timeoutSeconds),e}const Yk="ComponentProvider",S_=new Map;function Jk(n,e,t,r,i){return new lN(n,e,t,i.host,i.ssl,i.experimentalForceLongPolling,i.experimentalAutoDetectLongPolling,ZI(i.experimentalLongPollingOptions),i.useFetchStreams,i.isUsingEmulator,r)}const eA="firestore.googleapis.com",P_=!0;class x_{constructor(e){if(e.host===void 0){if(e.ssl!==void 0)throw new Pe(pe.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host=eA,this.ssl=P_}else this.host=e.host,this.ssl=e.ssl??P_;if(this.isUsingEmulator=e.emulatorOptions!==void 0,this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=hI;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<h6)throw new Pe(pe.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}Hw("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=ZI(e.experimentalLongPollingOptions??{}),(function(r){if(r.timeoutSeconds!==void 0){if(isNaN(r.timeoutSeconds))throw new Pe(pe.INVALID_ARGUMENT,`invalid long polling timeout: ${r.timeoutSeconds} (must not be NaN)`);if(r.timeoutSeconds<5)throw new Pe(pe.INVALID_ARGUMENT,`invalid long polling timeout: ${r.timeoutSeconds} (minimum allowed value is 5)`);if(r.timeoutSeconds>30)throw new Pe(pe.INVALID_ARGUMENT,`invalid long polling timeout: ${r.timeoutSeconds} (maximum allowed value is 30)`)}})(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&(function(r,i){return r.timeoutSeconds===i.timeoutSeconds})(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class od{constructor(e,t,r,i){this._authCredentials=e,this._appCheckCredentials=t,this._databaseId=r,this._app=i,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new x_({}),this._settingsFrozen=!1,this._emulatorOptions={},this._terminateTask="notTerminated"}get app(){if(!this._app)throw new Pe(pe.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(e){if(this._settingsFrozen)throw new Pe(pe.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new x_(e),this._emulatorOptions=e.emulatorOptions||{},e.credentials!==void 0&&(this._authCredentials=(function(r){if(!r)return new IR;switch(r.type){case"firstParty":return new SR(r.sessionIndex||"0",r.iamToken||null,r.authTokenFactory||null);case"provider":return r.client;default:throw new Pe(pe.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}})(e.credentials))}_getSettings(){return this._settings}_getEmulatorOptions(){return this._emulatorOptions}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){this._terminateTask==="notTerminated"?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return(function(t){const r=S_.get(t);r&&(Ne(Yk,"Removing Datastore"),S_.delete(t),r.terminate())})(this),Promise.resolve()}}function Qk(n,e,t,r={}){n=Gt(n,od);const i=Xu(e),s=n._getSettings(),o={...s,emulatorOptions:n._getEmulatorOptions()},a=`${e}:${t}`;i&&(_5(`https://${a}`),v5("Firestore",!0)),s.host!==eA&&s.host!==a&&Hs("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used.");const c={...s,host:a,ssl:i,emulatorOptions:r};if(!ga(c,o)&&(n._setSettings(c),r.mockUserToken)){let u,d;if(typeof r.mockUserToken=="string")u=r.mockUserToken,d=cr.MOCK_USER;else{u=VT(r.mockUserToken,n._app?.options.projectId);const g=r.mockUserToken.sub||r.mockUserToken.user_id;if(!g)throw new Pe(pe.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");d=new cr(g)}n._authCredentials=new AR(new $w(u,d))}}let Yr=class tA{constructor(e,t,r){this.converter=t,this._query=r,this.type="query",this.firestore=e}withConverter(e){return new tA(this.firestore,e,this._query)}},yn=class Xl{constructor(e,t,r){this.converter=t,this._key=r,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new fa(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new Xl(this.firestore,e,this._key)}toJSON(){return{type:Xl._jsonSchemaVersion,referencePath:this._key.toString()}}static fromJSON(e,t,r){if(Yh(t,Xl._jsonSchema))return new Xl(e,r||null,new Fe(Ot.fromString(t.referencePath)))}};yn._jsonSchemaVersion="firestore/documentReference/1.0",yn._jsonSchema={type:Jn("string",yn._jsonSchemaVersion),referencePath:Jn("string")};let fa=class nA extends Yr{constructor(e,t,r){super(e,t,il(r)),this._path=r,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new yn(this.firestore,null,new Fe(e))}withConverter(e){return new nA(this.firestore,e,this._path)}};function rA(n,e,...t){if(n=ft(n),N1("collection","path",e),n instanceof od){const r=Ot.fromString(e,...t);return m2(r),new fa(n,null,r)}{if(!(n instanceof yn||n instanceof fa))throw new Pe(pe.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=n._path.child(Ot.fromString(e,...t));return m2(r),new fa(n.firestore,null,r)}}function Xk(n,e){if(n=Gt(n,od),N1("collectionGroup","collection id",e),e.indexOf("/")>=0)throw new Pe(pe.INVALID_ARGUMENT,`Invalid collection ID '${e}' passed to function collectionGroup(). Collection IDs must not contain '/'.`);return new Yr(n,null,(function(r){return new To(Ot.emptyPath(),r)})(e))}function jf(n,e,...t){if(n=ft(n),arguments.length===1&&(e=R1.newId()),N1("doc","path",e),n instanceof od){const r=Ot.fromString(e,...t);return g2(r),new yn(n,null,new Fe(r))}{if(!(n instanceof yn||n instanceof fa))throw new Pe(pe.INVALID_ARGUMENT,"Expected first argument to doc() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=n._path.child(Ot.fromString(e,...t));return g2(r),new yn(n.firestore,n instanceof fa?n.converter:null,new Fe(r))}}function iA(n,e){return n=ft(n),e=ft(e),(n instanceof yn||n instanceof fa)&&(e instanceof yn||e instanceof fa)&&n.firestore===e.firestore&&n.path===e.path&&n.converter===e.converter}function sA(n,e){return n=ft(n),e=ft(e),n instanceof Yr&&e instanceof Yr&&n.firestore===e.firestore&&Zh(n._query,e._query)&&n.converter===e.converter}const R_="AsyncQueue";class N_{constructor(e=Promise.resolve()){this.Yu=[],this.ec=!1,this.tc=[],this.nc=null,this.rc=!1,this.sc=!1,this.oc=[],this.M_=new s0(this,"async_queue_retry"),this._c=()=>{const r=cf();r&&Ne(R_,"Visibility state changed to "+r.visibilityState),this.M_.w_()},this.ac=e;const t=cf();t&&typeof t.addEventListener=="function"&&t.addEventListener("visibilitychange",this._c)}get isShuttingDown(){return this.ec}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.uc(),this.cc(e)}enterRestrictedMode(e){if(!this.ec){this.ec=!0,this.sc=e||!1;const t=cf();t&&typeof t.removeEventListener=="function"&&t.removeEventListener("visibilitychange",this._c)}}enqueue(e){if(this.uc(),this.ec)return new Promise((()=>{}));const t=new _r;return this.cc((()=>this.ec&&this.sc?Promise.resolve():(e().then(t.resolve,t.reject),t.promise))).then((()=>t.promise))}enqueueRetryable(e){this.enqueueAndForget((()=>(this.Yu.push(e),this.lc())))}async lc(){if(this.Yu.length!==0){try{await this.Yu[0](),this.Yu.shift(),this.M_.reset()}catch(e){if(!Na(e))throw e;Ne(R_,"Operation failed with retryable error: "+e)}this.Yu.length>0&&this.M_.p_((()=>this.lc()))}}cc(e){const t=this.ac.then((()=>(this.rc=!0,e().catch((r=>{throw this.nc=r,this.rc=!1,Wn("INTERNAL UNHANDLED ERROR: ",k_(r)),r})).then((r=>(this.rc=!1,r))))));return this.ac=t,t}enqueueAfterDelay(e,t,r){this.uc(),this.oc.indexOf(e)>-1&&(t=0);const i=u0.createAndSchedule(this,e,t,r,(s=>this.hc(s)));return this.tc.push(i),i}uc(){this.nc&&qe(47125,{Pc:k_(this.nc)})}verifyOperationInProgress(){}async Tc(){let e;do e=this.ac,await e;while(e!==this.ac)}Ic(e){for(const t of this.tc)if(t.timerId===e)return!0;return!1}Ec(e){return this.Tc().then((()=>{this.tc.sort(((t,r)=>t.targetTimeMs-r.targetTimeMs));for(const t of this.tc)if(t.skipDelay(),e!=="all"&&t.timerId===e)break;return this.Tc()}))}Rc(e){this.oc.push(e)}hc(e){const t=this.tc.indexOf(e);this.tc.splice(t,1)}}function k_(n){let e=n.message||"";return n.stack&&(e=n.stack.includes(n.message)?n.stack:n.message+`
`+n.stack),e}class Zk{constructor(){this._progressObserver={},this._taskCompletionResolver=new _r,this._lastProgress={taskState:"Running",totalBytes:0,totalDocuments:0,bytesLoaded:0,documentsLoaded:0}}onProgress(e,t,r){this._progressObserver={next:e,error:t,complete:r}}catch(e){return this._taskCompletionResolver.promise.catch(e)}then(e,t){return this._taskCompletionResolver.promise.then(e,t)}_completeWith(e){this._updateProgress(e),this._progressObserver.complete&&this._progressObserver.complete(),this._taskCompletionResolver.resolve(e)}_failWith(e){this._lastProgress.taskState="Error",this._progressObserver.next&&this._progressObserver.next(this._lastProgress),this._progressObserver.error&&this._progressObserver.error(e),this._taskCompletionResolver.reject(e)}_updateProgress(e){this._lastProgress=e,this._progressObserver.next&&this._progressObserver.next(e)}}const eC=-1;let Gn=class extends od{constructor(e,t,r,i){super(e,t,r,i),this.type="firestore",this._queue=new N_,this._persistenceKey=i?.name||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const e=this._firestoreClient.terminate();this._queue=new N_(e),this._firestoreClient=void 0,await e}}};function Cr(n){if(n._terminated)throw new Pe(pe.FAILED_PRECONDITION,"The client has already been terminated.");return n._firestoreClient||oA(n),n._firestoreClient}function oA(n){const e=n._freezeSettings(),t=Jk(n._databaseId,n._app?.options.appId||"",n._persistenceKey,n._app?.options.apiKey,e);n._componentsProvider||e.localCache?._offlineComponentProvider&&e.localCache?._onlineComponentProvider&&(n._componentsProvider={_offline:e.localCache._offlineComponentProvider,_online:e.localCache._onlineComponentProvider}),n._firestoreClient=new Mk(n._authCredentials,n._appCheckCredentials,n._queue,t,n._componentsProvider&&(function(i){const s=i?._online.build();return{_offline:i?._offline.build(s),_online:s}})(n._componentsProvider))}function tC(n,e){Hs("enableIndexedDbPersistence() will be deprecated in the future, you can use `FirestoreSettings.cache` instead.");const t=n._freezeSettings();return aA(n,Fh.provider,{build:r=>new KI(r,t.cacheSizeBytes,e?.forceOwnership)}),Promise.resolve()}async function nC(n){Hs("enableMultiTabIndexedDbPersistence() will be deprecated in the future, you can use `FirestoreSettings.cache` instead.");const e=n._freezeSettings();aA(n,Fh.provider,{build:t=>new Lk(t,e.cacheSizeBytes)})}function aA(n,e,t){if((n=Gt(n,Gn))._firestoreClient||n._terminated)throw new Pe(pe.FAILED_PRECONDITION,"Firestore has already been started and persistence can no longer be enabled. You can only enable persistence before calling any other methods on a Firestore object.");if(n._componentsProvider||n._getSettings().localCache)throw new Pe(pe.FAILED_PRECONDITION,"SDK cache is already specified.");n._componentsProvider={_online:e,_offline:t},oA(n)}function rC(n){if(n._initialized&&!n._terminated)throw new Pe(pe.FAILED_PRECONDITION,"Persistence can only be cleared before a Firestore instance is initialized or after it is terminated.");const e=new _r;return n._queue.enqueueAndForgetEvenWhileRestricted((async()=>{try{await(async function(r){if(!Us.v())return Promise.resolve();const i=r+wI;await Us.delete(i)})(t0(n._databaseId,n._persistenceKey)),e.resolve()}catch(t){e.reject(t)}})),e.promise}function iC(n){return(function(t){const r=new _r;return t.asyncQueue.enqueueAndForget((async()=>wk(await b0(t),r))),r.promise})(Cr(n=Gt(n,Gn)))}function sC(n){return Bk(Cr(n=Gt(n,Gn)))}function oC(n){return Uk(Cr(n=Gt(n,Gn)))}function aC(n,e){const t=Cr(n=Gt(n,Gn)),r=new Zk;return Gk(t,n._databaseId,e,r),r}function cC(n,e){return Kk(Cr(n=Gt(n,Gn)),e).then((t=>t?new Yr(n,null,t.query):null))}class Nr{constructor(e){this._byteString=e}static fromBase64String(e){try{return new Nr(On.fromBase64String(e))}catch(t){throw new Pe(pe.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+t)}}static fromUint8Array(e){return new Nr(On.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}toJSON(){return{type:Nr._jsonSchemaVersion,bytes:this.toBase64()}}static fromJSON(e){if(Yh(e,Nr._jsonSchema))return Nr.fromBase64String(e.bytes)}}Nr._jsonSchemaVersion="firestore/bytes/1.0",Nr._jsonSchema={type:Jn("string",Nr._jsonSchemaVersion),bytes:Jn("string")};let Tc=class{constructor(...e){for(let t=0;t<e.length;++t)if(e[t].length===0)throw new Pe(pe.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new xn(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}};let Cc=class{constructor(e){this._methodName=e}};class cs{constructor(e,t){if(!isFinite(e)||e<-90||e>90)throw new Pe(pe.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(t)||t<-180||t>180)throw new Pe(pe.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+t);this._lat=e,this._long=t}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}_compareTo(e){return wt(this._lat,e._lat)||wt(this._long,e._long)}toJSON(){return{latitude:this._lat,longitude:this._long,type:cs._jsonSchemaVersion}}static fromJSON(e){if(Yh(e,cs._jsonSchema))return new cs(e.latitude,e.longitude)}}cs._jsonSchemaVersion="firestore/geoPoint/1.0",cs._jsonSchema={type:Jn("string",cs._jsonSchemaVersion),latitude:Jn("number"),longitude:Jn("number")};class us{constructor(e){this._values=(e||[]).map((t=>t))}toArray(){return this._values.map((e=>e))}isEqual(e){return(function(r,i){if(r.length!==i.length)return!1;for(let s=0;s<r.length;++s)if(r[s]!==i[s])return!1;return!0})(this._values,e._values)}toJSON(){return{type:us._jsonSchemaVersion,vectorValues:this._values}}static fromJSON(e){if(Yh(e,us._jsonSchema)){if(Array.isArray(e.vectorValues)&&e.vectorValues.every((t=>typeof t=="number")))return new us(e.vectorValues);throw new Pe(pe.INVALID_ARGUMENT,"Expected 'vectorValues' field to be a number array")}}}us._jsonSchemaVersion="firestore/vectorValue/1.0",us._jsonSchema={type:Jn("string",us._jsonSchemaVersion),vectorValues:Jn("object")};const uC=/^__.*__$/;class lC{constructor(e,t,r){this.data=e,this.fieldMask=t,this.fieldTransforms=r}toMutation(e,t){return this.fieldMask!==null?new Po(e,this.data,this.fieldMask,t,this.fieldTransforms):new sl(e,this.data,t,this.fieldTransforms)}}class cA{constructor(e,t,r){this.data=e,this.fieldMask=t,this.fieldTransforms=r}toMutation(e,t){return new Po(e,this.data,this.fieldMask,t,this.fieldTransforms)}}function uA(n){switch(n){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw qe(40011,{dataSource:n})}}class Sp{constructor(e,t,r,i,s,o){this.settings=e,this.databaseId=t,this.serializer=r,this.ignoreUndefinedProperties=i,s===void 0&&this.validatePath(),this.fieldTransforms=s||[],this.fieldMask=o||[]}get path(){return this.settings.path}get dataSource(){return this.settings.dataSource}contextWith(e){return new Sp({...this.settings,...e},this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}childContextForField(e){const t=this.path?.child(e),r=this.contextWith({path:t,arrayElement:!1});return r.validatePathSegment(e),r}childContextForFieldPath(e){const t=this.path?.child(e),r=this.contextWith({path:t,arrayElement:!1});return r.validatePath(),r}childContextForArray(e){return this.contextWith({path:void 0,arrayElement:!0})}createError(e){return qf(e,this.settings.methodName,this.settings.hasConverter||!1,this.path,this.settings.targetDoc)}contains(e){return this.fieldMask.find((t=>e.isPrefixOf(t)))!==void 0||this.fieldTransforms.find((t=>e.isPrefixOf(t.field)))!==void 0}validatePath(){if(this.path)for(let e=0;e<this.path.length;e++)this.validatePathSegment(this.path.get(e))}validatePathSegment(e){if(e.length===0)throw this.createError("Document fields must not be empty");if(uA(this.dataSource)&&uC.test(e))throw this.createError('Document fields cannot begin and end with "__"')}}class hC{constructor(e,t,r){this.databaseId=e,this.ignoreUndefinedProperties=t,this.serializer=r||id(e)}createContext(e,t,r,i=!1){return new Sp({dataSource:e,methodName:t,targetDoc:r,path:xn.emptyPath(),arrayElement:!1,hasConverter:i},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function Lc(n){const e=n._freezeSettings(),t=id(n._databaseId);return new hC(n._databaseId,!!e.ignoreUndefinedProperties,t)}function Pp(n,e,t,r,i,s={}){const o=n.createContext(s.merge||s.mergeFields?2:0,e,t,i);x0("Data must be an object, but it was:",o,r);const a=dA(r,o);let c,u;if(s.merge)c=new li(o.fieldMask),u=o.fieldTransforms;else if(s.mergeFields){const d=[];for(const g of s.mergeFields){const y=Sc(e,g,t);if(!o.contains(y))throw new Pe(pe.INVALID_ARGUMENT,`Field '${y}' is specified in your field mask but missing from your input data.`);gA(d,y)||d.push(y)}c=new li(d),u=o.fieldTransforms.filter((g=>c.covers(g.field)))}else c=null,u=o.fieldTransforms;return new lC(new yr(a),c,u)}class ad extends Cc{_toFieldTransform(e){if(e.dataSource!==2)throw e.dataSource===1?e.createError(`${this._methodName}() can only appear at the top level of your update data`):e.createError(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof ad}}function lA(n,e,t){return new Sp({dataSource:3,targetDoc:e.settings.targetDoc,methodName:n._methodName,arrayElement:t},e.databaseId,e.serializer,e.ignoreUndefinedProperties)}class I0 extends Cc{_toFieldTransform(e){return new td(e.path,new qu)}isEqual(e){return e instanceof I0}}class A0 extends Cc{constructor(e,t){super(e),this.Ac=t}_toFieldTransform(e){const t=lA(this,e,!0),r=this.Ac.map((s=>Dc(s,t))),i=new vc(r);return new td(e.path,i)}isEqual(e){return e instanceof A0&&ga(this.Ac,e.Ac)}}class E0 extends Cc{constructor(e,t){super(e),this.Ac=t}_toFieldTransform(e){const t=lA(this,e,!0),r=this.Ac.map((s=>Dc(s,t))),i=new wc(r);return new td(e.path,i)}isEqual(e){return e instanceof E0&&ga(this.Ac,e.Ac)}}class T0 extends Cc{constructor(e,t){super(e),this.Vc=t}_toFieldTransform(e){const t=new zu(e.serializer,Fb(e.serializer,this.Vc));return new td(e.path,t)}isEqual(e){return e instanceof T0&&this.Vc===e.Vc}}function S0(n,e,t,r){const i=n.createContext(1,e,t);x0("Data must be an object, but it was:",i,r);const s=[],o=yr.empty();ka(r,((c,u)=>{const d=pA(e,c,t);u=ft(u);const g=i.childContextForFieldPath(d);if(u instanceof ad)s.push(d);else{const y=Dc(u,g);y!=null&&(s.push(d),o.set(d,y))}}));const a=new li(s);return new cA(o,a,i.fieldTransforms)}function P0(n,e,t,r,i,s){const o=n.createContext(1,e,t),a=[Sc(e,r,t)],c=[i];if(s.length%2!=0)throw new Pe(pe.INVALID_ARGUMENT,`Function ${e}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let y=0;y<s.length;y+=2)a.push(Sc(e,s[y])),c.push(s[y+1]);const u=[],d=yr.empty();for(let y=a.length-1;y>=0;--y)if(!gA(u,a[y])){const p=a[y];let S=c[y];S=ft(S);const N=o.childContextForFieldPath(p);if(S instanceof ad)u.push(p);else{const C=Dc(S,N);C!=null&&(u.push(p),d.set(p,C))}}const g=new li(u);return new cA(d,g,o.fieldTransforms)}function hA(n,e,t,r=!1){return Dc(t,n.createContext(r?4:3,e))}function Dc(n,e){if(fA(n=ft(n)))return x0("Unsupported field value:",e,n),dA(n,e);if(n instanceof Cc)return(function(r,i){if(!uA(i.dataSource))throw i.createError(`${r._methodName}() can only be used with update() and set()`);if(!i.path)throw i.createError(`${r._methodName}() is not currently supported inside arrays`);const s=r._toFieldTransform(i);s&&i.fieldTransforms.push(s)})(n,e),null;if(n===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),n instanceof Array){if(e.settings.arrayElement&&e.dataSource!==4)throw e.createError("Nested arrays are not supported");return(function(r,i){const s=[];let o=0;for(const a of r){let c=Dc(a,i.childContextForArray(o));c==null&&(c={nullValue:"NULL_VALUE"}),s.push(c),o++}return{arrayValue:{values:s}}})(n,e)}return(function(r,i){if((r=ft(r))===null)return{nullValue:"NULL_VALUE"};if(typeof r=="number")return Fb(i.serializer,r);if(typeof r=="boolean")return{booleanValue:r};if(typeof r=="string")return{stringValue:r};if(r instanceof Date){const s=Jt.fromDate(r);return{timestampValue:$u(i.serializer,s)}}if(r instanceof Jt){const s=new Jt(r.seconds,1e3*Math.floor(r.nanoseconds/1e3));return{timestampValue:$u(i.serializer,s)}}if(r instanceof cs)return{geoPointValue:{latitude:r.latitude,longitude:r.longitude}};if(r instanceof Nr)return{bytesValue:Kb(i.serializer,r._byteString)};if(r instanceof yn){const s=i.databaseId,o=r.firestore._databaseId;if(!o.isEqual(s))throw i.createError(`Document reference is for database ${o.projectId}/${o.database} but should be for database ${s.projectId}/${s.database}`);return{referenceValue:K1(r.firestore._databaseId||i.databaseId,r._key.path)}}if(r instanceof us)return(function(o,a){const c=o instanceof us?o.toArray():o;return{mapValue:{fields:{[M1]:{stringValue:V1},[Bu]:{arrayValue:{values:c.map((d=>{if(typeof d!="number")throw a.createError("VectorValues must only contain numeric values.");return q1(a.serializer,d)}))}}}}}})(r,i);if(oI(r))return r._toProto(i.serializer);throw i.createError(`Unsupported field value: ${up(r)}`)})(n,e)}function dA(n,e){const t={};return hb(n)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):ka(n,((r,i)=>{const s=Dc(i,e.childContextForField(r));s!=null&&(t[r]=s)})),{mapValue:{fields:t}}}function fA(n){return!(typeof n!="object"||n===null||n instanceof Array||n instanceof Date||n instanceof Jt||n instanceof cs||n instanceof Nr||n instanceof yn||n instanceof Cc||n instanceof us||oI(n))}function x0(n,e,t){if(!fA(t)||!Gw(t)){const r=up(t);throw r==="an object"?e.createError(n+" a custom object"):e.createError(n+" "+r)}}function Sc(n,e,t){if((e=ft(e))instanceof Tc)return e._internalPath;if(typeof e=="string")return pA(n,e);throw qf("Field path arguments must be of type string or ",n,!1,void 0,t)}const dC=new RegExp("[~\\*/\\[\\]]");function pA(n,e,t){if(e.search(dC)>=0)throw qf(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,n,!1,void 0,t);try{return new Tc(...e.split("."))._internalPath}catch{throw qf(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,n,!1,void 0,t)}}function qf(n,e,t,r,i){const s=r&&!r.isEmpty(),o=i!==void 0;let a=`Function ${e}() called with invalid data`;t&&(a+=" (via `toFirestore()`)"),a+=". ";let c="";return(s||o)&&(c+=" (found",s&&(c+=` in field ${r}`),o&&(c+=` in document ${i}`),c+=")"),new Pe(pe.INVALID_ARGUMENT,a+n+c)}function gA(n,e){return n.some((t=>t.isEqual(e)))}class R0{convertValue(e,t="none"){switch(ba(e)){case 0:return null;case 1:return e.booleanValue;case 2:return Sn(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,t);case 5:return e.stringValue;case 6:return this.convertBytes(bo(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,t);case 11:return this.convertObject(e.mapValue,t);case 10:return this.convertVectorValue(e.mapValue);default:throw qe(62114,{value:e})}}convertObject(e,t){return this.convertObjectMap(e.fields,t)}convertObjectMap(e,t="none"){const r={};return ka(e,((i,s)=>{r[i]=this.convertValue(s,t)})),r}convertVectorValue(e){const t=e.fields?.[Bu].arrayValue?.values?.map((r=>Sn(r.doubleValue)));return new us(t)}convertGeoPoint(e){return new cs(Sn(e.latitude),Sn(e.longitude))}convertArray(e,t){return(e.values||[]).map((r=>this.convertValue(r,t)))}convertServerTimestamp(e,t){switch(t){case"previous":const r=gp(e);return r==null?null:this.convertValue(r,t);case"estimate":return this.convertTimestamp(Rh(e));default:return null}}convertTimestamp(e){const t=wo(e);return new Jt(t.seconds,t.nanos)}convertDocumentKey(e,t){const r=Ot.fromString(e);Ke(sI(r),9688,{name:e});const i=new wa(r.get(1),r.get(3)),s=new Fe(r.popFirst(5));return i.isEqual(t)||Wn(`Document ${s} contains a document reference within a different database (${i.projectId}/${i.database}) which is not supported. It will be treated as a reference in the current database (${t.projectId}/${t.database}) instead.`),s}}class Oc extends R0{constructor(e){super(),this.firestore=e}convertBytes(e){return new Nr(e)}convertReference(e){const t=this.convertDocumentKey(e,this.firestore._databaseId);return new yn(this.firestore,null,t)}}function fC(){return new ad("deleteField")}function pC(){return new I0("serverTimestamp")}function gC(...n){return new A0("arrayUnion",n)}function mC(...n){return new E0("arrayRemove",n)}function yC(n){return new T0("increment",n)}const C_="@firebase/firestore",L_="4.10.0";function Cm(n){return(function(t,r){if(typeof t!="object"||t===null)return!1;const i=t;for(const s of r)if(s in i&&typeof i[s]=="function")return!0;return!1})(n,["next","error","complete"])}class Mh{constructor(e,t,r,i,s){this._firestore=e,this._userDataWriter=t,this._key=r,this._document=i,this._converter=s}get id(){return this._key.path.lastSegment()}get ref(){return new yn(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const e=new _C(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}_fieldsProto(){return this._document?.data.clone().value.mapValue.fields??void 0}get(e){if(this._document){const t=this._document.data.field(Sc("DocumentSnapshot.get",e));if(t!==null)return this._userDataWriter.convertValue(t)}}}class _C extends Mh{data(){return super.data()}}function mA(n){if(n.limitType==="L"&&n.explicitOrderBy.length===0)throw new Pe(pe.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class N0{}class cd extends N0{}function ta(n,e,...t){let r=[];e instanceof N0&&r.push(e),r=r.concat(t),(function(s){const o=s.filter((c=>c instanceof k0)).length,a=s.filter((c=>c instanceof xp)).length;if(o>1||o>0&&a>0)throw new Pe(pe.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")})(r);for(const i of r)n=i._apply(n);return n}class xp extends cd{constructor(e,t,r){super(),this._field=e,this._op=t,this._value=r,this.type="where"}static _create(e,t,r){return new xp(e,t,r)}_apply(e){const t=this._parse(e);return _A(e._query,t),new Yr(e.firestore,e.converter,vm(e._query,t))}_parse(e){const t=Lc(e.firestore);return(function(s,o,a,c,u,d,g){let y;if(u.isKeyField()){if(d==="array-contains"||d==="array-contains-any")throw new Pe(pe.INVALID_ARGUMENT,`Invalid Query. You can't perform '${d}' queries on documentId().`);if(d==="in"||d==="not-in"){O_(g,d);const S=[];for(const N of g)S.push(D_(c,s,N));y={arrayValue:{values:S}}}else y=D_(c,s,g)}else d!=="in"&&d!=="not-in"&&d!=="array-contains-any"||O_(g,d),y=hA(a,o,g,d==="in"||d==="not-in");return Bt.create(u,d,y)})(e._query,"where",t,e.firestore._databaseId,this._field,this._op,this._value)}}function vC(n,e,t){const r=e,i=Sc("where",n);return xp._create(i,r,t)}class k0 extends N0{constructor(e,t){super(),this.type=e,this._queryConstraints=t}static _create(e,t){return new k0(e,t)}_parse(e){const t=this._queryConstraints.map((r=>r._parse(e))).filter((r=>r.getFilters().length>0));return t.length===1?t[0]:en.create(t,this._getOperator())}_apply(e){const t=this._parse(e);return t.getFilters().length===0?e:((function(i,s){let o=i;const a=s.getFlattenedFilters();for(const c of a)_A(o,c),o=vm(o,c)})(e._query,t),new Yr(e.firestore,e.converter,vm(e._query,t)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return this.type==="and"?"and":"or"}}class C0 extends cd{constructor(e,t){super(),this._field=e,this._direction=t,this.type="orderBy"}static _create(e,t){return new C0(e,t)}_apply(e){const t=(function(i,s,o){if(i.startAt!==null)throw new Pe(pe.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(i.endAt!==null)throw new Pe(pe.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");return new Ch(s,o)})(e._query,this._field,this._direction);return new Yr(e.firestore,e.converter,EN(e._query,t))}}function wC(n,e="asc"){const t=e,r=Sc("orderBy",n);return C0._create(r,t)}class Rp extends cd{constructor(e,t,r){super(),this.type=e,this._limit=t,this._limitType=r}static _create(e,t,r){return new Rp(e,t,r)}_apply(e){return new Yr(e.firestore,e.converter,Cf(e._query,this._limit,this._limitType))}}function bC(n){return Kw("limit",n),Rp._create("limit",n,"F")}function IC(n){return Kw("limitToLast",n),Rp._create("limitToLast",n,"L")}class Np extends cd{constructor(e,t,r){super(),this.type=e,this._docOrFields=t,this._inclusive=r}static _create(e,t,r){return new Np(e,t,r)}_apply(e){const t=yA(e,this.type,this._docOrFields,this._inclusive);return new Yr(e.firestore,e.converter,TN(e._query,t))}}function AC(...n){return Np._create("startAt",n,!0)}function EC(...n){return Np._create("startAfter",n,!1)}class kp extends cd{constructor(e,t,r){super(),this.type=e,this._docOrFields=t,this._inclusive=r}static _create(e,t,r){return new kp(e,t,r)}_apply(e){const t=yA(e,this.type,this._docOrFields,this._inclusive);return new Yr(e.firestore,e.converter,SN(e._query,t))}}function TC(...n){return kp._create("endBefore",n,!1)}function SC(...n){return kp._create("endAt",n,!0)}function yA(n,e,t,r){if(t[0]=ft(t[0]),t[0]instanceof Mh)return(function(s,o,a,c,u){if(!c)throw new Pe(pe.NOT_FOUND,`Can't use a DocumentSnapshot that doesn't exist for ${a}().`);const d=[];for(const g of bu(s))if(g.field.isKeyField())d.push(yc(o,c.key));else{const y=c.data.field(g.field);if(pp(y))throw new Pe(pe.INVALID_ARGUMENT,'Invalid query. You are trying to start or end a query using a document for which the field "'+g.field+'" is an uncommitted server timestamp. (Since the value of this field is unknown, you cannot start/end a query with it.)');if(y===null){const p=g.field.canonicalString();throw new Pe(pe.INVALID_ARGUMENT,`Invalid query. You are trying to start or end a query using a document for which the field '${p}' (used as the orderBy) does not exist.`)}d.push(y)}return new Aa(d,u)})(n._query,n.firestore._databaseId,e,t[0]._document,r);{const i=Lc(n.firestore);return(function(o,a,c,u,d,g){const y=o.explicitOrderBy;if(d.length>y.length)throw new Pe(pe.INVALID_ARGUMENT,`Too many arguments provided to ${u}(). The number of arguments must be less than or equal to the number of orderBy() clauses`);const p=[];for(let S=0;S<d.length;S++){const N=d[S];if(y[S].field.isKeyField()){if(typeof N!="string")throw new Pe(pe.INVALID_ARGUMENT,`Invalid query. Expected a string for document ID in ${u}(), but got a ${typeof N}`);if(!U1(o)&&N.indexOf("/")!==-1)throw new Pe(pe.INVALID_ARGUMENT,`Invalid query. When querying a collection and ordering by documentId(), the value passed to ${u}() must be a plain document ID, but '${N}' contains a slash.`);const C=o.path.child(Ot.fromString(N));if(!Fe.isDocumentKey(C))throw new Pe(pe.INVALID_ARGUMENT,`Invalid query. When querying a collection group and ordering by documentId(), the value passed to ${u}() must result in a valid document path, but '${C}' is not because it contains an odd number of segments.`);const k=new Fe(C);p.push(yc(a,k))}else{const C=hA(c,u,N);p.push(C)}}return new Aa(p,g)})(n._query,n.firestore._databaseId,i,e,t,r)}}function D_(n,e,t){if(typeof(t=ft(t))=="string"){if(t==="")throw new Pe(pe.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!U1(e)&&t.indexOf("/")!==-1)throw new Pe(pe.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${t}' contains a '/' character.`);const r=e.path.child(Ot.fromString(t));if(!Fe.isDocumentKey(r))throw new Pe(pe.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${r}' is not because it has an odd number of segments (${r.length}).`);return yc(n,new Fe(r))}if(t instanceof yn)return yc(n,t._key);throw new Pe(pe.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${up(t)}.`)}function O_(n,e){if(!Array.isArray(n)||n.length===0)throw new Pe(pe.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${e.toString()}' filters.`)}function _A(n,e){const t=(function(i,s){for(const o of i)for(const a of o.getFlattenedFilters())if(s.indexOf(a.op)>=0)return a.op;return null})(n.filters,(function(i){switch(i){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}})(e.op));if(t!==null)throw t===e.op?new Pe(pe.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${e.op.toString()}' filter.`):new Pe(pe.INVALID_ARGUMENT,`Invalid query. You cannot use '${e.op.toString()}' filters with '${t.toString()}' filters.`)}function Cp(n,e,t){let r;return r=n?t&&(t.merge||t.mergeFields)?n.toFirestore(e,t):n.toFirestore(e):e,r}class PC extends R0{constructor(e){super(),this.firestore=e}convertBytes(e){return new Nr(e)}convertReference(e){const t=this.convertDocumentKey(e,this.firestore._databaseId);return new yn(this.firestore,null,t)}}class ac{constructor(e,t){this.hasPendingWrites=e,this.fromCache=t}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}let $i=class vA extends Mh{constructor(e,t,r,i,s,o){super(e,t,r,i,o),this._firestore=e,this._firestoreImpl=e,this.metadata=s}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const t=new fh(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(t,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,t={}){if(this._document){const r=this._document.data.field(Sc("DocumentSnapshot.get",e));if(r!==null)return this._userDataWriter.convertValue(r,t.serverTimestamps)}}toJSON(){if(this.metadata.hasPendingWrites)throw new Pe(pe.FAILED_PRECONDITION,"DocumentSnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e=this._document,t={};return t.type=vA._jsonSchemaVersion,t.bundle="",t.bundleSource="DocumentSnapshot",t.bundleName=this._key.toString(),!e||!e.isValidDocument()||!e.isFoundDocument()?t:(this._userDataWriter.convertObjectMap(e.data.value.mapValue.fields,"previous"),t.bundle=(this._firestore,this.ref.path,"NOT SUPPORTED"),t)}};$i._jsonSchemaVersion="firestore/documentSnapshot/1.0",$i._jsonSchema={type:Jn("string",$i._jsonSchemaVersion),bundleSource:Jn("string","DocumentSnapshot"),bundleName:Jn("string"),bundle:Jn("string")};let fh=class extends $i{data(e={}){return super.data(e)}},ls=class wA{constructor(e,t,r,i){this._firestore=e,this._userDataWriter=t,this._snapshot=i,this.metadata=new ac(i.hasPendingWrites,i.fromCache),this.query=r}get docs(){const e=[];return this.forEach((t=>e.push(t))),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,t){this._snapshot.docs.forEach((r=>{e.call(t,new fh(this._firestore,this._userDataWriter,r.key,r,new ac(this._snapshot.mutatedKeys.has(r.key),this._snapshot.fromCache),this.query.converter))}))}docChanges(e={}){const t=!!e.includeMetadataChanges;if(t&&this._snapshot.excludesMetadataChanges)throw new Pe(pe.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===t||(this._cachedChanges=(function(i,s){if(i._snapshot.oldDocs.isEmpty()){let o=0;return i._snapshot.docChanges.map((a=>{const c=new fh(i._firestore,i._userDataWriter,a.doc.key,a.doc,new ac(i._snapshot.mutatedKeys.has(a.doc.key),i._snapshot.fromCache),i.query.converter);return a.doc,{type:"added",doc:c,oldIndex:-1,newIndex:o++}}))}{let o=i._snapshot.oldDocs;return i._snapshot.docChanges.filter((a=>s||a.type!==3)).map((a=>{const c=new fh(i._firestore,i._userDataWriter,a.doc.key,a.doc,new ac(i._snapshot.mutatedKeys.has(a.doc.key),i._snapshot.fromCache),i.query.converter);let u=-1,d=-1;return a.type!==0&&(u=o.indexOf(a.doc.key),o=o.delete(a.doc.key)),a.type!==1&&(o=o.add(a.doc),d=o.indexOf(a.doc.key)),{type:xC(a.type),doc:c,oldIndex:u,newIndex:d}}))}})(this,t),this._cachedChangesIncludeMetadataChanges=t),this._cachedChanges}toJSON(){if(this.metadata.hasPendingWrites)throw new Pe(pe.FAILED_PRECONDITION,"QuerySnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e={};e.type=wA._jsonSchemaVersion,e.bundleSource="QuerySnapshot",e.bundleName=R1.newId(),this._firestore._databaseId.database,this._firestore._databaseId.projectId;const t=[],r=[],i=[];return this.docs.forEach((s=>{s._document!==null&&(t.push(s._document),r.push(this._userDataWriter.convertObjectMap(s._document.data.value.mapValue.fields,"previous")),i.push(s.ref.path))})),e.bundle=(this._firestore,this.query._query,e.bundleName,"NOT SUPPORTED"),e}};function xC(n){switch(n){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return qe(61501,{type:n})}}function bA(n,e){return n instanceof $i&&e instanceof $i?n._firestore===e._firestore&&n._key.isEqual(e._key)&&(n._document===null?e._document===null:n._document.isEqual(e._document))&&n._converter===e._converter:n instanceof ls&&e instanceof ls&&n._firestore===e._firestore&&sA(n.query,e.query)&&n.metadata.isEqual(e.metadata)&&n._snapshot.isEqual(e._snapshot)}ls._jsonSchemaVersion="firestore/querySnapshot/1.0",ls._jsonSchema={type:Jn("string",ls._jsonSchemaVersion),bundleSource:Jn("string","QuerySnapshot"),bundleName:Jn("string"),bundle:Jn("string")};const RC={maxAttempts:5};let NC=class{constructor(e,t){this._firestore=e,this._commitHandler=t,this._mutations=[],this._committed=!1,this._dataReader=Lc(e)}set(e,t,r){this._verifyNotCommitted();const i=aa(e,this._firestore),s=Cp(i.converter,t,r),o=Pp(this._dataReader,"WriteBatch.set",i._key,s,i.converter!==null,r);return this._mutations.push(o.toMutation(i._key,Rn.none())),this}update(e,t,r,...i){this._verifyNotCommitted();const s=aa(e,this._firestore);let o;return o=typeof(t=ft(t))=="string"||t instanceof Tc?P0(this._dataReader,"WriteBatch.update",s._key,t,r,i):S0(this._dataReader,"WriteBatch.update",s._key,t),this._mutations.push(o.toMutation(s._key,Rn.exists(!0))),this}delete(e){this._verifyNotCommitted();const t=aa(e,this._firestore);return this._mutations=this._mutations.concat(new ol(t._key,Rn.none())),this}commit(){return this._verifyNotCommitted(),this._committed=!0,this._mutations.length>0?this._commitHandler(this._mutations):Promise.resolve()}_verifyNotCommitted(){if(this._committed)throw new Pe(pe.FAILED_PRECONDITION,"A write batch can no longer be used after commit() has been called.")}};function aa(n,e){if((n=ft(n)).firestore!==e)throw new Pe(pe.INVALID_ARGUMENT,"Provided document reference is from a different Firestore instance.");return n}class kC{constructor(e,t){this._firestore=e,this._transaction=t,this._dataReader=Lc(e)}get(e){const t=aa(e,this._firestore),r=new PC(this._firestore);return this._transaction.lookup([t._key]).then((i=>{if(!i||i.length!==1)return qe(24041);const s=i[0];if(s.isFoundDocument())return new Mh(this._firestore,r,s.key,s,t.converter);if(s.isNoDocument())return new Mh(this._firestore,r,t._key,null,t.converter);throw qe(18433,{doc:s})}))}set(e,t,r){const i=aa(e,this._firestore),s=Cp(i.converter,t,r),o=Pp(this._dataReader,"Transaction.set",i._key,s,i.converter!==null,r);return this._transaction.set(i._key,o),this}update(e,t,r,...i){const s=aa(e,this._firestore);let o;return o=typeof(t=ft(t))=="string"||t instanceof Tc?P0(this._dataReader,"Transaction.update",s._key,t,r,i):S0(this._dataReader,"Transaction.update",s._key,t),this._transaction.update(s._key,o),this}delete(e){const t=aa(e,this._firestore);return this._transaction.delete(t._key),this}}let CC=class extends kC{constructor(e,t){super(e,t),this._firestore=e}get(e){const t=aa(e,this._firestore),r=new Oc(this._firestore);return super.get(e).then((i=>new $i(this._firestore,r,t._key,i._document,new ac(!1,!1),t.converter)))}};function LC(n,e,t){n=Gt(n,Gn);const r={...RC,...t};(function(o){if(o.maxAttempts<1)throw new Pe(pe.INVALID_ARGUMENT,"Max attempts must be at least 1")})(r);const i=Cr(n);return Hk(i,(s=>e(new CC(n,s))),r)}function DC(n){n=Gt(n,yn);const e=Gt(n.firestore,Gn),t=Cr(e);return QI(t,n._key).then((r=>L0(e,n,r)))}function OC(n){n=Gt(n,yn);const e=Gt(n.firestore,Gn),t=Cr(e),r=new Oc(e);return qk(t,n._key).then((i=>new $i(e,r,n._key,i,new ac(i!==null&&i.hasLocalMutations,!0),n.converter)))}function FC(n){n=Gt(n,yn);const e=Gt(n.firestore,Gn),t=Cr(e);return QI(t,n._key,{source:"server"}).then((r=>L0(e,n,r)))}function MC(n){n=Gt(n,Yr);const e=Gt(n.firestore,Gn),t=Cr(e),r=new Oc(e);return mA(n._query),XI(t,n._query).then((i=>new ls(e,r,n,i)))}function VC(n){n=Gt(n,Yr);const e=Gt(n.firestore,Gn),t=Cr(e),r=new Oc(e);return zk(t,n._query).then((i=>new ls(e,r,n,i)))}function BC(n){n=Gt(n,Yr);const e=Gt(n.firestore,Gn),t=Cr(e),r=new Oc(e);return XI(t,n._query,{source:"server"}).then((i=>new ls(e,r,n,i)))}function F_(n,e,t){n=Gt(n,yn);const r=Gt(n.firestore,Gn),i=Cp(n.converter,e,t),s=Lc(r);return ud(r,[Pp(s,"setDoc",n._key,i,n.converter!==null,t).toMutation(n._key,Rn.none())])}function M_(n,e,t,...r){n=Gt(n,yn);const i=Gt(n.firestore,Gn),s=Lc(i);let o;return o=typeof(e=ft(e))=="string"||e instanceof Tc?P0(s,"updateDoc",n._key,e,t,r):S0(s,"updateDoc",n._key,e),ud(i,[o.toMutation(n._key,Rn.exists(!0))])}function UC(n){return ud(Gt(n.firestore,Gn),[new ol(n._key,Rn.none())])}function jC(n,e){const t=Gt(n.firestore,Gn),r=jf(n),i=Cp(n.converter,e),s=Lc(n.firestore);return ud(t,[Pp(s,"addDoc",r._key,i,n.converter!==null,{}).toMutation(r._key,Rn.exists(!1))]).then((()=>r))}function IA(n,...e){n=ft(n);let t={includeMetadataChanges:!1,source:"default"},r=0;typeof e[r]!="object"||Cm(e[r])||(t=e[r++]);const i={includeMetadataChanges:t.includeMetadataChanges,source:t.source};if(Cm(e[r])){const u=e[r];e[r]=u.next?.bind(u),e[r+1]=u.error?.bind(u),e[r+2]=u.complete?.bind(u)}let s,o,a;if(n instanceof yn)o=Gt(n.firestore,Gn),a=il(n._key.path),s={next:u=>{e[r]&&e[r](L0(o,n,u))},error:e[r+1],complete:e[r+2]};else{const u=Gt(n,Yr);o=Gt(u.firestore,Gn),a=u._query;const d=new Oc(o);s={next:g=>{e[r]&&e[r](new ls(o,d,u,g))},error:e[r+1],complete:e[r+2]},mA(n._query)}const c=Cr(o);return jk(c,a,i,s)}function qC(n,e){n=Gt(n,Gn);const t=Cr(n),r=Cm(e)?e:{next:e};return Wk(t,r)}function ud(n,e){const t=Cr(n);return $k(t,e)}function L0(n,e,t){const r=t.docs.get(e._key),i=new Oc(n);return new $i(n,i,e._key,r,new ac(t.hasPendingWrites,t.fromCache),e.converter)}(function(e,t=!0){vR(Pa),_a(new zs("firestore",((r,{instanceIdentifier:i,options:s})=>{const o=r.getProvider("app").getImmediate(),a=new Gn(new ER(r.getProvider("auth-internal")),new PR(o,r.getProvider("app-check-internal")),hN(o,i),o);return s={useFetchStreams:t,...s},a._setSettings(s),a}),"PUBLIC").setMultipleInstances(!0)),as(C_,L_,e),as(C_,L_,"esm2020")})();const zC="@firebase/firestore-compat",$C="0.4.4";function D0(n,e){if(e===void 0)return{merge:!1};if(e.mergeFields!==void 0&&e.merge!==void 0)throw new Pe("invalid-argument",`Invalid options passed to function ${n}(): You cannot specify both "merge" and "mergeFields".`);return e}function V_(){if(typeof Uint8Array>"u")throw new Pe("unimplemented","Uint8Arrays are not available in this environment.")}function B_(){if(!cN())throw new Pe("unimplemented","Blobs are unavailable in Firestore in this environment.")}let AA=class Lm{constructor(e){this._delegate=e}static fromBase64String(e){return B_(),new Lm(Nr.fromBase64String(e))}static fromUint8Array(e){return V_(),new Lm(Nr.fromUint8Array(e))}toBase64(){return B_(),this._delegate.toBase64()}toUint8Array(){return V_(),this._delegate.toUint8Array()}isEqual(e){return this._delegate.isEqual(e._delegate)}toString(){return"Blob(base64: "+this.toBase64()+")"}};function Dm(n){return WC(n,["next","error","complete"])}function WC(n,e){if(typeof n!="object"||n===null)return!1;const t=n;for(const r of e)if(r in t&&typeof t[r]=="function")return!0;return!1}class HC{enableIndexedDbPersistence(e,t){return tC(e._delegate,{forceOwnership:t})}enableMultiTabIndexedDbPersistence(e){return nC(e._delegate)}clearIndexedDbPersistence(e){return rC(e._delegate)}}class EA{constructor(e,t,r){this._delegate=t,this._persistenceProvider=r,this.INTERNAL={delete:()=>this.terminate()},e instanceof wa||(this._appCompat=e)}get _databaseId(){return this._delegate._databaseId}settings(e){const t=this._delegate._getSettings();!e.merge&&t.host!==e.host&&Hs("You are overriding the original host. If you did not intend to override your settings, use {merge: true}."),e.merge&&(e={...t,...e},delete e.merge),this._delegate._setSettings(e)}useEmulator(e,t,r={}){Qk(this._delegate,e,t,r)}enableNetwork(){return sC(this._delegate)}disableNetwork(){return oC(this._delegate)}enablePersistence(e){let t=!1,r=!1;return e&&(t=!!e.synchronizeTabs,r=!!e.experimentalForceOwningTab,Hw("synchronizeTabs",t,"experimentalForceOwningTab",r)),t?this._persistenceProvider.enableMultiTabIndexedDbPersistence(this):this._persistenceProvider.enableIndexedDbPersistence(this,r)}clearPersistence(){return this._persistenceProvider.clearIndexedDbPersistence(this)}terminate(){return this._appCompat&&(this._appCompat._removeServiceInstance("firestore-compat"),this._appCompat._removeServiceInstance("firestore")),this._delegate._delete()}waitForPendingWrites(){return iC(this._delegate)}onSnapshotsInSync(e){return qC(this._delegate,e)}get app(){if(!this._appCompat)throw new Pe("failed-precondition","Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._appCompat}collection(e){try{return new Qu(this,rA(this._delegate,e))}catch(t){throw Hr(t,"collection()","Firestore.collection()")}}doc(e){try{return new zi(this,jf(this._delegate,e))}catch(t){throw Hr(t,"doc()","Firestore.doc()")}}collectionGroup(e){try{return new Wr(this,Xk(this._delegate,e))}catch(t){throw Hr(t,"collectionGroup()","Firestore.collectionGroup()")}}runTransaction(e){return LC(this._delegate,t=>e(new TA(this,t)))}batch(){return Cr(this._delegate),new SA(new NC(this._delegate,e=>ud(this._delegate,e)))}loadBundle(e){return aC(this._delegate,e)}namedQuery(e){return cC(this._delegate,e).then(t=>t?new Wr(this,t):null)}}class Lp extends R0{constructor(e){super(),this.firestore=e}convertBytes(e){return new AA(new Nr(e))}convertReference(e){const t=this.convertDocumentKey(e,this.firestore._databaseId);return zi.forKey(t,this.firestore,null)}}function GC(n){wR(n)}class TA{constructor(e,t){this._firestore=e,this._delegate=t,this._userDataWriter=new Lp(e)}get(e){const t=cc(e);return this._delegate.get(t).then(r=>new Vh(this._firestore,new $i(this._firestore._delegate,this._userDataWriter,r._key,r._document,r.metadata,t.converter)))}set(e,t,r){const i=cc(e);return r?(D0("Transaction.set",r),this._delegate.set(i,t,r)):this._delegate.set(i,t),this}update(e,t,r,...i){const s=cc(e);return arguments.length===2?this._delegate.update(s,t):this._delegate.update(s,t,r,...i),this}delete(e){const t=cc(e);return this._delegate.delete(t),this}}class SA{constructor(e){this._delegate=e}set(e,t,r){const i=cc(e);return r?(D0("WriteBatch.set",r),this._delegate.set(i,t,r)):this._delegate.set(i,t),this}update(e,t,r,...i){const s=cc(e);return arguments.length===2?this._delegate.update(s,t):this._delegate.update(s,t,r,...i),this}delete(e){const t=cc(e);return this._delegate.delete(t),this}commit(){return this._delegate.commit()}}class Pc{constructor(e,t,r){this._firestore=e,this._userDataWriter=t,this._delegate=r}fromFirestore(e,t){const r=new fh(this._firestore._delegate,this._userDataWriter,e._key,e._document,e.metadata,null);return this._delegate.fromFirestore(new Bh(this._firestore,r),t??{})}toFirestore(e,t){return t?this._delegate.toFirestore(e,t):this._delegate.toFirestore(e)}static getInstance(e,t){const r=Pc.INSTANCES;let i=r.get(e);i||(i=new WeakMap,r.set(e,i));let s=i.get(t);return s||(s=new Pc(e,new Lp(e),t),i.set(t,s)),s}}Pc.INSTANCES=new WeakMap;class zi{constructor(e,t){this.firestore=e,this._delegate=t,this._userDataWriter=new Lp(e)}static forPath(e,t,r){if(e.length%2!==0)throw new Pe("invalid-argument",`Invalid document reference. Document references must have an even number of segments, but ${e.canonicalString()} has ${e.length}`);return new zi(t,new yn(t._delegate,r,new Fe(e)))}static forKey(e,t,r){return new zi(t,new yn(t._delegate,r,e))}get id(){return this._delegate.id}get parent(){return new Qu(this.firestore,this._delegate.parent)}get path(){return this._delegate.path}collection(e){try{return new Qu(this.firestore,rA(this._delegate,e))}catch(t){throw Hr(t,"collection()","DocumentReference.collection()")}}isEqual(e){return e=ft(e),e instanceof yn?iA(this._delegate,e):!1}set(e,t){t=D0("DocumentReference.set",t);try{return t?F_(this._delegate,e,t):F_(this._delegate,e)}catch(r){throw Hr(r,"setDoc()","DocumentReference.set()")}}update(e,t,...r){try{return arguments.length===1?M_(this._delegate,e):M_(this._delegate,e,t,...r)}catch(i){throw Hr(i,"updateDoc()","DocumentReference.update()")}}delete(){return UC(this._delegate)}onSnapshot(...e){const t=PA(e),r=xA(e,i=>new Vh(this.firestore,new $i(this.firestore._delegate,this._userDataWriter,i._key,i._document,i.metadata,this._delegate.converter)));return IA(this._delegate,t,r)}get(e){let t;return e?.source==="cache"?t=OC(this._delegate):e?.source==="server"?t=FC(this._delegate):t=DC(this._delegate),t.then(r=>new Vh(this.firestore,new $i(this.firestore._delegate,this._userDataWriter,r._key,r._document,r.metadata,this._delegate.converter)))}withConverter(e){return new zi(this.firestore,e?this._delegate.withConverter(Pc.getInstance(this.firestore,e)):this._delegate.withConverter(null))}}function Hr(n,e,t){return n.message=n.message.replace(e,t),n}function PA(n){for(const e of n)if(typeof e=="object"&&!Dm(e))return e;return{}}function xA(n,e){let t;return Dm(n[0])?t=n[0]:Dm(n[1])?t=n[1]:typeof n[0]=="function"?t={next:n[0],error:n[1],complete:n[2]}:t={next:n[1],error:n[2],complete:n[3]},{next:r=>{t.next&&t.next(e(r))},error:t.error?.bind(t),complete:t.complete?.bind(t)}}class Vh{constructor(e,t){this._firestore=e,this._delegate=t}get ref(){return new zi(this._firestore,this._delegate.ref)}get id(){return this._delegate.id}get metadata(){return this._delegate.metadata}get exists(){return this._delegate.exists()}data(e){return this._delegate.data(e)}get(e,t){return this._delegate.get(e,t)}isEqual(e){return bA(this._delegate,e._delegate)}}class Bh extends Vh{data(e){const t=this._delegate.data(e);return this._delegate._converter||bR(t!==void 0,"Document in a QueryDocumentSnapshot should exist"),t}}class Wr{constructor(e,t){this.firestore=e,this._delegate=t,this._userDataWriter=new Lp(e)}where(e,t,r){try{return new Wr(this.firestore,ta(this._delegate,vC(e,t,r)))}catch(i){throw Hr(i,/(orderBy|where)\(\)/,"Query.$1()")}}orderBy(e,t){try{return new Wr(this.firestore,ta(this._delegate,wC(e,t)))}catch(r){throw Hr(r,/(orderBy|where)\(\)/,"Query.$1()")}}limit(e){try{return new Wr(this.firestore,ta(this._delegate,bC(e)))}catch(t){throw Hr(t,"limit()","Query.limit()")}}limitToLast(e){try{return new Wr(this.firestore,ta(this._delegate,IC(e)))}catch(t){throw Hr(t,"limitToLast()","Query.limitToLast()")}}startAt(...e){try{return new Wr(this.firestore,ta(this._delegate,AC(...e)))}catch(t){throw Hr(t,"startAt()","Query.startAt()")}}startAfter(...e){try{return new Wr(this.firestore,ta(this._delegate,EC(...e)))}catch(t){throw Hr(t,"startAfter()","Query.startAfter()")}}endBefore(...e){try{return new Wr(this.firestore,ta(this._delegate,TC(...e)))}catch(t){throw Hr(t,"endBefore()","Query.endBefore()")}}endAt(...e){try{return new Wr(this.firestore,ta(this._delegate,SC(...e)))}catch(t){throw Hr(t,"endAt()","Query.endAt()")}}isEqual(e){return sA(this._delegate,e._delegate)}get(e){let t;return e?.source==="cache"?t=VC(this._delegate):e?.source==="server"?t=BC(this._delegate):t=MC(this._delegate),t.then(r=>new Om(this.firestore,new ls(this.firestore._delegate,this._userDataWriter,this._delegate,r._snapshot)))}onSnapshot(...e){const t=PA(e),r=xA(e,i=>new Om(this.firestore,new ls(this.firestore._delegate,this._userDataWriter,this._delegate,i._snapshot)));return IA(this._delegate,t,r)}withConverter(e){return new Wr(this.firestore,e?this._delegate.withConverter(Pc.getInstance(this.firestore,e)):this._delegate.withConverter(null))}}class KC{constructor(e,t){this._firestore=e,this._delegate=t}get type(){return this._delegate.type}get doc(){return new Bh(this._firestore,this._delegate.doc)}get oldIndex(){return this._delegate.oldIndex}get newIndex(){return this._delegate.newIndex}}class Om{constructor(e,t){this._firestore=e,this._delegate=t}get query(){return new Wr(this._firestore,this._delegate.query)}get metadata(){return this._delegate.metadata}get size(){return this._delegate.size}get empty(){return this._delegate.empty}get docs(){return this._delegate.docs.map(e=>new Bh(this._firestore,e))}docChanges(e){return this._delegate.docChanges(e).map(t=>new KC(this._firestore,t))}forEach(e,t){this._delegate.forEach(r=>{e.call(t,new Bh(this._firestore,r))})}isEqual(e){return bA(this._delegate,e._delegate)}}class Qu extends Wr{constructor(e,t){super(e,t),this.firestore=e,this._delegate=t}get id(){return this._delegate.id}get path(){return this._delegate.path}get parent(){const e=this._delegate.parent;return e?new zi(this.firestore,e):null}doc(e){try{return e===void 0?new zi(this.firestore,jf(this._delegate)):new zi(this.firestore,jf(this._delegate,e))}catch(t){throw Hr(t,"doc()","CollectionReference.doc()")}}add(e){return jC(this._delegate,e).then(t=>new zi(this.firestore,t))}isEqual(e){return iA(this._delegate,e._delegate)}withConverter(e){return new Qu(this.firestore,e?this._delegate.withConverter(Pc.getInstance(this.firestore,e)):this._delegate.withConverter(null))}}function cc(n){return Gt(n,yn)}class O0{constructor(...e){this._delegate=new Tc(...e)}static documentId(){return new O0(xn.keyField().canonicalString())}isEqual(e){return e=ft(e),e instanceof Tc?this._delegate._internalPath.isEqual(e._internalPath):!1}}class rc{static serverTimestamp(){const e=pC();return e._methodName="FieldValue.serverTimestamp",new rc(e)}static delete(){const e=fC();return e._methodName="FieldValue.delete",new rc(e)}static arrayUnion(...e){const t=gC(...e);return t._methodName="FieldValue.arrayUnion",new rc(t)}static arrayRemove(...e){const t=mC(...e);return t._methodName="FieldValue.arrayRemove",new rc(t)}static increment(e){const t=yC(e);return t._methodName="FieldValue.increment",new rc(t)}constructor(e){this._delegate=e}isEqual(e){return this._delegate.isEqual(e._delegate)}}const YC={Firestore:EA,GeoPoint:cs,Timestamp:Jt,Blob:AA,Transaction:TA,WriteBatch:SA,DocumentReference:zi,DocumentSnapshot:Vh,Query:Wr,QueryDocumentSnapshot:Bh,QuerySnapshot:Om,CollectionReference:Qu,FieldPath:O0,FieldValue:rc,setLogLevel:GC,CACHE_SIZE_UNLIMITED:eC};function JC(n,e){n.INTERNAL.registerComponent(new zs("firestore-compat",t=>{const r=t.getProvider("app-compat").getImmediate(),i=t.getProvider("firestore").getImmediate();return e(r,i)},"PUBLIC").setServiceProps({...YC}))}function QC(n){JC(n,(e,t)=>new EA(e,t,new HC)),n.registerVersion(zC,$C)}QC($s);const XC={apiKey:"AIzaSyBWcbJIz5oKCVCtHfDYxAOKb4io1mgg4JQ",authDomain:"appdate-backend.firebaseapp.com",projectId:"appdate-backend",storageBucket:"appdate-backend.firebasestorage.app",messagingSenderId:"335885703338",appId:"1:335885703338:web:3b94d4fe98322ed337d8d3"};$s.apps.length||$s.initializeApp(XC);const yo=$s.auth(),lr=$s.firestore(),ZC="appdate-secured@app.local",F0="AppDate_Sec_2024",nn={currentUser:null,events:{exchange:[],app:[]},allEvents:[]},eL="modulepreload",tL=function(n){return"/"+n},U_={},Ag=function(e,t,r){let i=Promise.resolve();if(t&&t.length>0){let c=function(u){return Promise.all(u.map(d=>Promise.resolve(d).then(g=>({status:"fulfilled",value:g}),g=>({status:"rejected",reason:g}))))};document.getElementsByTagName("link");const o=document.querySelector("meta[property=csp-nonce]"),a=o?.nonce||o?.getAttribute("nonce");i=c(t.map(u=>{if(u=tL(u),u in U_)return;U_[u]=!0;const d=u.endsWith(".css"),g=d?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${u}"]${g}`))return;const y=document.createElement("link");if(y.rel=d?"stylesheet":eL,d||(y.as="script"),y.crossOrigin="",y.href=u,a&&y.setAttribute("nonce",a),document.head.appendChild(y),d)return new Promise((p,S)=>{y.addEventListener("load",p),y.addEventListener("error",()=>S(new Error(`Unable to preload CSS for ${u}`)))})}))}function s(o){const a=new Event("vite:preloadError",{cancelable:!0});if(a.payload=o,window.dispatchEvent(a),!a.defaultPrevented)throw o}return i.then(o=>{for(const a of o||[])a.status==="rejected"&&s(a.reason);return e().catch(s)})};function Zt(n){"@babel/helpers - typeof";return Zt=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Zt(n)}var ds=Uint8Array,Pi=Uint16Array,M0=Int32Array,V0=new ds([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),B0=new ds([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),j_=new ds([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),RA=function(n,e){for(var t=new Pi(31),r=0;r<31;++r)t[r]=e+=1<<n[r-1];for(var i=new M0(t[30]),r=1;r<30;++r)for(var s=t[r];s<t[r+1];++s)i[s]=s-t[r]<<5|r;return{b:t,r:i}},NA=RA(V0,2),nL=NA.b,Fm=NA.r;nL[28]=258,Fm[258]=28;var rL=RA(B0,0),q_=rL.r,Mm=new Pi(32768);for(var In=0;In<32768;++In){var na=(In&43690)>>1|(In&21845)<<1;na=(na&52428)>>2|(na&13107)<<2,na=(na&61680)>>4|(na&3855)<<4,Mm[In]=((na&65280)>>8|(na&255)<<8)>>1}var ph=(function(n,e,t){for(var r=n.length,i=0,s=new Pi(e);i<r;++i)n[i]&&++s[n[i]-1];var o=new Pi(e);for(i=1;i<e;++i)o[i]=o[i-1]+s[i-1]<<1;var a;if(t){a=new Pi(1<<e);var c=15-e;for(i=0;i<r;++i)if(n[i])for(var u=i<<4|n[i],d=e-n[i],g=o[n[i]-1]++<<d,y=g|(1<<d)-1;g<=y;++g)a[Mm[g]>>c]=u}else for(a=new Pi(r),i=0;i<r;++i)n[i]&&(a[i]=Mm[o[n[i]-1]++]>>15-n[i]);return a}),xc=new ds(288);for(var In=0;In<144;++In)xc[In]=8;for(var In=144;In<256;++In)xc[In]=9;for(var In=256;In<280;++In)xc[In]=7;for(var In=280;In<288;++In)xc[In]=8;var zf=new ds(32);for(var In=0;In<32;++In)zf[In]=5;var iL=ph(xc,9,0),sL=ph(zf,5,0),kA=function(n){return(n+7)/8|0},oL=function(n,e,t){return(t==null||t>n.length)&&(t=n.length),new ds(n.subarray(e,t))},co=function(n,e,t){t<<=e&7;var r=e/8|0;n[r]|=t,n[r+1]|=t>>8},ql=function(n,e,t){t<<=e&7;var r=e/8|0;n[r]|=t,n[r+1]|=t>>8,n[r+2]|=t>>16},Eg=function(n,e){for(var t=[],r=0;r<n.length;++r)n[r]&&t.push({s:r,f:n[r]});var i=t.length,s=t.slice();if(!i)return{t:LA,l:0};if(i==1){var o=new ds(t[0].s+1);return o[t[0].s]=1,{t:o,l:1}}t.sort(function(ne,de){return ne.f-de.f}),t.push({s:-1,f:25001});var a=t[0],c=t[1],u=0,d=1,g=2;for(t[0]={s:-1,f:a.f+c.f,l:a,r:c};d!=i-1;)a=t[t[u].f<t[g].f?u++:g++],c=t[u!=d&&t[u].f<t[g].f?u++:g++],t[d++]={s:-1,f:a.f+c.f,l:a,r:c};for(var y=s[0].s,r=1;r<i;++r)s[r].s>y&&(y=s[r].s);var p=new Pi(y+1),S=Vm(t[d-1],p,0);if(S>e){var r=0,N=0,C=S-e,k=1<<C;for(s.sort(function(de,B){return p[B.s]-p[de.s]||de.f-B.f});r<i;++r){var K=s[r].s;if(p[K]>e)N+=k-(1<<S-p[K]),p[K]=e;else break}for(N>>=C;N>0;){var G=s[r].s;p[G]<e?N-=1<<e-p[G]++-1:++r}for(;r>=0&&N;--r){var W=s[r].s;p[W]==e&&(--p[W],++N)}S=e}return{t:new ds(p),l:S}},Vm=function(n,e,t){return n.s==-1?Math.max(Vm(n.l,e,t+1),Vm(n.r,e,t+1)):e[n.s]=t},z_=function(n){for(var e=n.length;e&&!n[--e];);for(var t=new Pi(++e),r=0,i=n[0],s=1,o=function(c){t[r++]=c},a=1;a<=e;++a)if(n[a]==i&&a!=e)++s;else{if(!i&&s>2){for(;s>138;s-=138)o(32754);s>2&&(o(s>10?s-11<<5|28690:s-3<<5|12305),s=0)}else if(s>3){for(o(i),--s;s>6;s-=6)o(8304);s>2&&(o(s-3<<5|8208),s=0)}for(;s--;)o(i);s=1,i=n[a]}return{c:t.subarray(0,r),n:e}},zl=function(n,e){for(var t=0,r=0;r<e.length;++r)t+=n[r]*e[r];return t},CA=function(n,e,t){var r=t.length,i=kA(e+2);n[i]=r&255,n[i+1]=r>>8,n[i+2]=n[i]^255,n[i+3]=n[i+1]^255;for(var s=0;s<r;++s)n[i+s+4]=t[s];return(i+4+r)*8},$_=function(n,e,t,r,i,s,o,a,c,u,d){co(e,d++,t),++i[256];for(var g=Eg(i,15),y=g.t,p=g.l,S=Eg(s,15),N=S.t,C=S.l,k=z_(y),K=k.c,G=k.n,W=z_(N),ne=W.c,de=W.n,B=new Pi(19),x=0;x<K.length;++x)++B[K[x]&31];for(var x=0;x<ne.length;++x)++B[ne[x]&31];for(var A=Eg(B,7),F=A.t,b=A.l,E=19;E>4&&!F[j_[E-1]];--E);var T=u+5<<3,J=zl(i,xc)+zl(s,zf)+o,fe=zl(i,y)+zl(s,N)+o+14+3*E+zl(B,F)+2*B[16]+3*B[17]+7*B[18];if(c>=0&&T<=J&&T<=fe)return CA(e,d,n.subarray(c,c+u));var ye,_e,ce,ve;if(co(e,d,1+(fe<J)),d+=2,fe<J){ye=ph(y,p,0),_e=y,ce=ph(N,C,0),ve=N;var Oe=ph(F,b,0);co(e,d,G-257),co(e,d+5,de-1),co(e,d+10,E-4),d+=14;for(var x=0;x<E;++x)co(e,d+3*x,F[j_[x]]);d+=3*E;for(var xe=[K,ne],O=0;O<2;++O)for(var H=xe[O],x=0;x<H.length;++x){var Y=H[x]&31;co(e,d,Oe[Y]),d+=F[Y],Y>15&&(co(e,d,H[x]>>5&127),d+=H[x]>>12)}}else ye=iL,_e=xc,ce=sL,ve=zf;for(var x=0;x<a;++x){var X=r[x];if(X>255){var Y=X>>18&31;ql(e,d,ye[Y+257]),d+=_e[Y+257],Y>7&&(co(e,d,X>>23&31),d+=V0[Y]);var te=X&31;ql(e,d,ce[te]),d+=ve[te],te>3&&(ql(e,d,X>>5&8191),d+=B0[te])}else ql(e,d,ye[X]),d+=_e[X]}return ql(e,d,ye[256]),d+_e[256]},aL=new M0([65540,131080,131088,131104,262176,1048704,1048832,2114560,2117632]),LA=new ds(0),cL=function(n,e,t,r,i,s){var o=s.z||n.length,a=new ds(r+o+5*(1+Math.ceil(o/7e3))+i),c=a.subarray(r,a.length-i),u=s.l,d=(s.r||0)&7;if(e){d&&(c[0]=s.r>>3);for(var g=aL[e-1],y=g>>13,p=g&8191,S=(1<<t)-1,N=s.p||new Pi(32768),C=s.h||new Pi(S+1),k=Math.ceil(t/3),K=2*k,G=function(tt){return(n[tt]^n[tt+1]<<k^n[tt+2]<<K)&S},W=new M0(25e3),ne=new Pi(288),de=new Pi(32),B=0,x=0,A=s.i||0,F=0,b=s.w||0,E=0;A+2<o;++A){var T=G(A),J=A&32767,fe=C[T];if(N[J]=fe,C[T]=J,b<=A){var ye=o-A;if((B>7e3||F>24576)&&(ye>423||!u)){d=$_(n,c,0,W,ne,de,x,F,E,A-E,d),F=B=x=0,E=A;for(var _e=0;_e<286;++_e)ne[_e]=0;for(var _e=0;_e<30;++_e)de[_e]=0}var ce=2,ve=0,Oe=p,xe=J-fe&32767;if(ye>2&&T==G(A-xe))for(var O=Math.min(y,ye)-1,H=Math.min(32767,A),Y=Math.min(258,ye);xe<=H&&--Oe&&J!=fe;){if(n[A+ce]==n[A+ce-xe]){for(var X=0;X<Y&&n[A+X]==n[A+X-xe];++X);if(X>ce){if(ce=X,ve=xe,X>O)break;for(var te=Math.min(xe,X-2),ae=0,_e=0;_e<te;++_e){var ge=A-xe+_e&32767,me=N[ge],Ee=ge-me&32767;Ee>ae&&(ae=Ee,fe=ge)}}}J=fe,fe=N[J],xe+=J-fe&32767}if(ve){W[F++]=268435456|Fm[ce]<<18|q_[ve];var Le=Fm[ce]&31,je=q_[ve]&31;x+=V0[Le]+B0[je],++ne[257+Le],++de[je],b=A+ce,++B}else W[F++]=n[A],++ne[n[A]]}}for(A=Math.max(A,b);A<o;++A)W[F++]=n[A],++ne[n[A]];d=$_(n,c,u,W,ne,de,x,F,E,A-E,d),u||(s.r=d&7|c[d/8|0]<<3,d-=7,s.h=C,s.p=N,s.i=A,s.w=b)}else{for(var A=s.w||0;A<o+u;A+=65535){var Ue=A+65535;Ue>=o&&(c[d/8|0]=u,Ue=o),d=CA(c,d+1,n.subarray(A,Ue))}s.i=o}return oL(a,0,r+kA(d)+i)},DA=function(){var n=1,e=0;return{p:function(t){for(var r=n,i=e,s=t.length|0,o=0;o!=s;){for(var a=Math.min(o+2655,s);o<a;++o)i+=r+=t[o];r=(r&65535)+15*(r>>16),i=(i&65535)+15*(i>>16)}n=r,e=i},d:function(){return n%=65521,e%=65521,(n&255)<<24|(n&65280)<<8|(e&255)<<8|e>>8}}},uL=function(n,e,t,r,i){if(!i&&(i={l:1},e.dictionary)){var s=e.dictionary.subarray(-32768),o=new ds(s.length+n.length);o.set(s),o.set(n,s.length),n=o,i.w=s.length}return cL(n,e.level==null?6:e.level,e.mem==null?i.l?Math.ceil(Math.max(8,Math.min(13,Math.log(n.length)))*1.5):20:12+e.mem,t,r,i)},OA=function(n,e,t){for(;t;++e)n[e]=t,t>>>=8},lL=function(n,e){var t=e.level,r=t==0?0:t<6?1:t==9?3:2;if(n[0]=120,n[1]=r<<6|(e.dictionary&&32),n[1]|=31-(n[0]<<8|n[1])%31,e.dictionary){var i=DA();i.p(e.dictionary),OA(n,2,i.d())}};function Bm(n,e){e||(e={});var t=DA();t.p(n);var r=uL(n,e,e.dictionary?6:2,4);return lL(r,e),OA(r,r.length-4,t.d()),r}var hL=typeof TextDecoder<"u"&&new TextDecoder,dL=0;try{hL.decode(LA,{stream:!0}),dL=1}catch{}function fL(n){if(Array.isArray(n))return n}function pL(n,e){var t=n==null?null:typeof Symbol<"u"&&n[Symbol.iterator]||n["@@iterator"];if(t!=null){var r,i,s,o,a=[],c=!0,u=!1;try{if(s=(t=t.call(n)).next,e!==0)for(;!(c=(r=s.call(t)).done)&&(a.push(r.value),a.length!==e);c=!0);}catch(d){u=!0,i=d}finally{try{if(!c&&t.return!=null&&(o=t.return(),Object(o)!==o))return}finally{if(u)throw i}}return a}}function W_(n,e){(e==null||e>n.length)&&(e=n.length);for(var t=0,r=Array(e);t<e;t++)r[t]=n[t];return r}function gL(n,e){if(n){if(typeof n=="string")return W_(n,e);var t={}.toString.call(n).slice(8,-1);return t==="Object"&&n.constructor&&(t=n.constructor.name),t==="Map"||t==="Set"?Array.from(n):t==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)?W_(n,e):void 0}}function mL(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function H_(n,e){return fL(n)||pL(n,e)||gL(n,e)||mL()}function G_(n,e="utf8"){return new TextDecoder(e).decode(n)}const yL=new TextEncoder;function _L(n){return yL.encode(n)}const vL=1024*8,wL=(()=>{const n=new Uint8Array(4),e=new Uint32Array(n.buffer);return!((e[0]=1)&n[0])})(),Tg={int8:globalThis.Int8Array,uint8:globalThis.Uint8Array,int16:globalThis.Int16Array,uint16:globalThis.Uint16Array,int32:globalThis.Int32Array,uint32:globalThis.Uint32Array,uint64:globalThis.BigUint64Array,int64:globalThis.BigInt64Array,float32:globalThis.Float32Array,float64:globalThis.Float64Array};class U0{buffer;byteLength;byteOffset;length;offset;lastWrittenByte;littleEndian;_data;_mark;_marks;constructor(e=vL,t={}){let r=!1;typeof e=="number"?e=new ArrayBuffer(e):(r=!0,this.lastWrittenByte=e.byteLength);const i=t.offset?t.offset>>>0:0,s=e.byteLength-i;let o=i;(ArrayBuffer.isView(e)||e instanceof U0)&&(e.byteLength!==e.buffer.byteLength&&(o=e.byteOffset+i),e=e.buffer),r?this.lastWrittenByte=s:this.lastWrittenByte=0,this.buffer=e,this.length=s,this.byteLength=s,this.byteOffset=o,this.offset=0,this.littleEndian=!0,this._data=new DataView(this.buffer,o,s),this._mark=0,this._marks=[]}available(e=1){return this.offset+e<=this.length}isLittleEndian(){return this.littleEndian}setLittleEndian(){return this.littleEndian=!0,this}isBigEndian(){return!this.littleEndian}setBigEndian(){return this.littleEndian=!1,this}skip(e=1){return this.offset+=e,this}back(e=1){return this.offset-=e,this}seek(e){return this.offset=e,this}mark(){return this._mark=this.offset,this}reset(){return this.offset=this._mark,this}pushMark(){return this._marks.push(this.offset),this}popMark(){const e=this._marks.pop();if(e===void 0)throw new Error("Mark stack empty");return this.seek(e),this}rewind(){return this.offset=0,this}ensureAvailable(e=1){if(!this.available(e)){const r=(this.offset+e)*2,i=new Uint8Array(r);i.set(new Uint8Array(this.buffer)),this.buffer=i.buffer,this.length=r,this.byteLength=r,this._data=new DataView(this.buffer)}return this}readBoolean(){return this.readUint8()!==0}readInt8(){return this._data.getInt8(this.offset++)}readUint8(){return this._data.getUint8(this.offset++)}readByte(){return this.readUint8()}readBytes(e=1){return this.readArray(e,"uint8")}readArray(e,t){const r=Tg[t].BYTES_PER_ELEMENT*e,i=this.byteOffset+this.offset,s=this.buffer.slice(i,i+r);if(this.littleEndian===wL&&t!=="uint8"&&t!=="int8"){const a=new Uint8Array(this.buffer.slice(i,i+r));a.reverse();const c=new Tg[t](a.buffer);return this.offset+=r,c.reverse(),c}const o=new Tg[t](s);return this.offset+=r,o}readInt16(){const e=this._data.getInt16(this.offset,this.littleEndian);return this.offset+=2,e}readUint16(){const e=this._data.getUint16(this.offset,this.littleEndian);return this.offset+=2,e}readInt32(){const e=this._data.getInt32(this.offset,this.littleEndian);return this.offset+=4,e}readUint32(){const e=this._data.getUint32(this.offset,this.littleEndian);return this.offset+=4,e}readFloat32(){const e=this._data.getFloat32(this.offset,this.littleEndian);return this.offset+=4,e}readFloat64(){const e=this._data.getFloat64(this.offset,this.littleEndian);return this.offset+=8,e}readBigInt64(){const e=this._data.getBigInt64(this.offset,this.littleEndian);return this.offset+=8,e}readBigUint64(){const e=this._data.getBigUint64(this.offset,this.littleEndian);return this.offset+=8,e}readChar(){return String.fromCharCode(this.readInt8())}readChars(e=1){let t="";for(let r=0;r<e;r++)t+=this.readChar();return t}readUtf8(e=1){return G_(this.readBytes(e))}decodeText(e=1,t="utf8"){return G_(this.readBytes(e),t)}writeBoolean(e){return this.writeUint8(e?255:0),this}writeInt8(e){return this.ensureAvailable(1),this._data.setInt8(this.offset++,e),this._updateLastWrittenByte(),this}writeUint8(e){return this.ensureAvailable(1),this._data.setUint8(this.offset++,e),this._updateLastWrittenByte(),this}writeByte(e){return this.writeUint8(e)}writeBytes(e){this.ensureAvailable(e.length);for(let t=0;t<e.length;t++)this._data.setUint8(this.offset++,e[t]);return this._updateLastWrittenByte(),this}writeInt16(e){return this.ensureAvailable(2),this._data.setInt16(this.offset,e,this.littleEndian),this.offset+=2,this._updateLastWrittenByte(),this}writeUint16(e){return this.ensureAvailable(2),this._data.setUint16(this.offset,e,this.littleEndian),this.offset+=2,this._updateLastWrittenByte(),this}writeInt32(e){return this.ensureAvailable(4),this._data.setInt32(this.offset,e,this.littleEndian),this.offset+=4,this._updateLastWrittenByte(),this}writeUint32(e){return this.ensureAvailable(4),this._data.setUint32(this.offset,e,this.littleEndian),this.offset+=4,this._updateLastWrittenByte(),this}writeFloat32(e){return this.ensureAvailable(4),this._data.setFloat32(this.offset,e,this.littleEndian),this.offset+=4,this._updateLastWrittenByte(),this}writeFloat64(e){return this.ensureAvailable(8),this._data.setFloat64(this.offset,e,this.littleEndian),this.offset+=8,this._updateLastWrittenByte(),this}writeBigInt64(e){return this.ensureAvailable(8),this._data.setBigInt64(this.offset,e,this.littleEndian),this.offset+=8,this._updateLastWrittenByte(),this}writeBigUint64(e){return this.ensureAvailable(8),this._data.setBigUint64(this.offset,e,this.littleEndian),this.offset+=8,this._updateLastWrittenByte(),this}writeChar(e){return this.writeUint8(e.charCodeAt(0))}writeChars(e){for(let t=0;t<e.length;t++)this.writeUint8(e.charCodeAt(t));return this}writeUtf8(e){return this.writeBytes(_L(e))}toArray(){return new Uint8Array(this.buffer,this.byteOffset,this.lastWrittenByte)}getWrittenByteLength(){return this.lastWrittenByte-this.byteOffset}_updateLastWrittenByte(){this.offset>this.lastWrittenByte&&(this.lastWrittenByte=this.offset)}}function hl(n){let e=n.length;for(;--e>=0;)n[e]=0}const bL=3,IL=258,FA=29,AL=256,EL=AL+1+FA,MA=30,TL=512,SL=new Array((EL+2)*2);hl(SL);const PL=new Array(MA*2);hl(PL);const xL=new Array(TL);hl(xL);const RL=new Array(IL-bL+1);hl(RL);const NL=new Array(FA);hl(NL);const kL=new Array(MA);hl(kL);const CL=(n,e,t,r)=>{let i=n&65535|0,s=n>>>16&65535|0,o=0;for(;t!==0;){o=t>2e3?2e3:t,t-=o;do i=i+e[r++]|0,s=s+i|0;while(--o);i%=65521,s%=65521}return i|s<<16|0};var Um=CL;const LL=()=>{let n,e=[];for(var t=0;t<256;t++){n=t;for(var r=0;r<8;r++)n=n&1?3988292384^n>>>1:n>>>1;e[t]=n}return e},DL=new Uint32Array(LL()),OL=(n,e,t,r)=>{const i=DL,s=r+t;n^=-1;for(let o=r;o<s;o++)n=n>>>8^i[(n^e[o])&255];return n^-1};var xs=OL,jm={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"},VA={Z_NO_FLUSH:0,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_MEM_ERROR:-4,Z_BUF_ERROR:-5,Z_DEFLATED:8};const FL=(n,e)=>Object.prototype.hasOwnProperty.call(n,e);var ML=function(n){const e=Array.prototype.slice.call(arguments,1);for(;e.length;){const t=e.shift();if(t){if(typeof t!="object")throw new TypeError(t+"must be non-object");for(const r in t)FL(t,r)&&(n[r]=t[r])}}return n},VL=n=>{let e=0;for(let r=0,i=n.length;r<i;r++)e+=n[r].length;const t=new Uint8Array(e);for(let r=0,i=0,s=n.length;r<s;r++){let o=n[r];t.set(o,i),i+=o.length}return t},BA={assign:ML,flattenChunks:VL};let UA=!0;try{String.fromCharCode.apply(null,new Uint8Array(1))}catch{UA=!1}const Uh=new Uint8Array(256);for(let n=0;n<256;n++)Uh[n]=n>=252?6:n>=248?5:n>=240?4:n>=224?3:n>=192?2:1;Uh[254]=Uh[254]=1;var BL=n=>{if(typeof TextEncoder=="function"&&TextEncoder.prototype.encode)return new TextEncoder().encode(n);let e,t,r,i,s,o=n.length,a=0;for(i=0;i<o;i++)t=n.charCodeAt(i),(t&64512)===55296&&i+1<o&&(r=n.charCodeAt(i+1),(r&64512)===56320&&(t=65536+(t-55296<<10)+(r-56320),i++)),a+=t<128?1:t<2048?2:t<65536?3:4;for(e=new Uint8Array(a),s=0,i=0;s<a;i++)t=n.charCodeAt(i),(t&64512)===55296&&i+1<o&&(r=n.charCodeAt(i+1),(r&64512)===56320&&(t=65536+(t-55296<<10)+(r-56320),i++)),t<128?e[s++]=t:t<2048?(e[s++]=192|t>>>6,e[s++]=128|t&63):t<65536?(e[s++]=224|t>>>12,e[s++]=128|t>>>6&63,e[s++]=128|t&63):(e[s++]=240|t>>>18,e[s++]=128|t>>>12&63,e[s++]=128|t>>>6&63,e[s++]=128|t&63);return e};const UL=(n,e)=>{if(e<65534&&n.subarray&&UA)return String.fromCharCode.apply(null,n.length===e?n:n.subarray(0,e));let t="";for(let r=0;r<e;r++)t+=String.fromCharCode(n[r]);return t};var jL=(n,e)=>{const t=e||n.length;if(typeof TextDecoder=="function"&&TextDecoder.prototype.decode)return new TextDecoder().decode(n.subarray(0,e));let r,i;const s=new Array(t*2);for(i=0,r=0;r<t;){let o=n[r++];if(o<128){s[i++]=o;continue}let a=Uh[o];if(a>4){s[i++]=65533,r+=a-1;continue}for(o&=a===2?31:a===3?15:7;a>1&&r<t;)o=o<<6|n[r++]&63,a--;if(a>1){s[i++]=65533;continue}o<65536?s[i++]=o:(o-=65536,s[i++]=55296|o>>10&1023,s[i++]=56320|o&1023)}return UL(s,i)},qL=(n,e)=>{e=e||n.length,e>n.length&&(e=n.length);let t=e-1;for(;t>=0&&(n[t]&192)===128;)t--;return t<0||t===0?e:t+Uh[n[t]]>e?t:e},qm={string2buf:BL,buf2string:jL,utf8border:qL};function zL(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}var $L=zL;const Vd=16209,WL=16191;var HL=function(e,t){let r,i,s,o,a,c,u,d,g,y,p,S,N,C,k,K,G,W,ne,de,B,x,A,F;const b=e.state;r=e.next_in,A=e.input,i=r+(e.avail_in-5),s=e.next_out,F=e.output,o=s-(t-e.avail_out),a=s+(e.avail_out-257),c=b.dmax,u=b.wsize,d=b.whave,g=b.wnext,y=b.window,p=b.hold,S=b.bits,N=b.lencode,C=b.distcode,k=(1<<b.lenbits)-1,K=(1<<b.distbits)-1;e:do{S<15&&(p+=A[r++]<<S,S+=8,p+=A[r++]<<S,S+=8),G=N[p&k];t:for(;;){if(W=G>>>24,p>>>=W,S-=W,W=G>>>16&255,W===0)F[s++]=G&65535;else if(W&16){ne=G&65535,W&=15,W&&(S<W&&(p+=A[r++]<<S,S+=8),ne+=p&(1<<W)-1,p>>>=W,S-=W),S<15&&(p+=A[r++]<<S,S+=8,p+=A[r++]<<S,S+=8),G=C[p&K];n:for(;;){if(W=G>>>24,p>>>=W,S-=W,W=G>>>16&255,W&16){if(de=G&65535,W&=15,S<W&&(p+=A[r++]<<S,S+=8,S<W&&(p+=A[r++]<<S,S+=8)),de+=p&(1<<W)-1,de>c){e.msg="invalid distance too far back",b.mode=Vd;break e}if(p>>>=W,S-=W,W=s-o,de>W){if(W=de-W,W>d&&b.sane){e.msg="invalid distance too far back",b.mode=Vd;break e}if(B=0,x=y,g===0){if(B+=u-W,W<ne){ne-=W;do F[s++]=y[B++];while(--W);B=s-de,x=F}}else if(g<W){if(B+=u+g-W,W-=g,W<ne){ne-=W;do F[s++]=y[B++];while(--W);if(B=0,g<ne){W=g,ne-=W;do F[s++]=y[B++];while(--W);B=s-de,x=F}}}else if(B+=g-W,W<ne){ne-=W;do F[s++]=y[B++];while(--W);B=s-de,x=F}for(;ne>2;)F[s++]=x[B++],F[s++]=x[B++],F[s++]=x[B++],ne-=3;ne&&(F[s++]=x[B++],ne>1&&(F[s++]=x[B++]))}else{B=s-de;do F[s++]=F[B++],F[s++]=F[B++],F[s++]=F[B++],ne-=3;while(ne>2);ne&&(F[s++]=F[B++],ne>1&&(F[s++]=F[B++]))}}else if((W&64)===0){G=C[(G&65535)+(p&(1<<W)-1)];continue n}else{e.msg="invalid distance code",b.mode=Vd;break e}break}}else if((W&64)===0){G=N[(G&65535)+(p&(1<<W)-1)];continue t}else if(W&32){b.mode=WL;break e}else{e.msg="invalid literal/length code",b.mode=Vd;break e}break}}while(r<i&&s<a);ne=S>>3,r-=ne,S-=ne<<3,p&=(1<<S)-1,e.next_in=r,e.next_out=s,e.avail_in=r<i?5+(i-r):5-(r-i),e.avail_out=s<a?257+(a-s):257-(s-a),b.hold=p,b.bits=S};const iu=15,K_=852,Y_=592,J_=0,Sg=1,Q_=2,GL=new Uint16Array([3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0]),KL=new Uint8Array([16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78]),YL=new Uint16Array([1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0]),JL=new Uint8Array([16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64]),QL=(n,e,t,r,i,s,o,a)=>{const c=a.bits;let u=0,d=0,g=0,y=0,p=0,S=0,N=0,C=0,k=0,K=0,G,W,ne,de,B,x=null,A;const F=new Uint16Array(iu+1),b=new Uint16Array(iu+1);let E=null,T,J,fe;for(u=0;u<=iu;u++)F[u]=0;for(d=0;d<r;d++)F[e[t+d]]++;for(p=c,y=iu;y>=1&&F[y]===0;y--);if(p>y&&(p=y),y===0)return i[s++]=1<<24|64<<16|0,i[s++]=1<<24|64<<16|0,a.bits=1,0;for(g=1;g<y&&F[g]===0;g++);for(p<g&&(p=g),C=1,u=1;u<=iu;u++)if(C<<=1,C-=F[u],C<0)return-1;if(C>0&&(n===J_||y!==1))return-1;for(b[1]=0,u=1;u<iu;u++)b[u+1]=b[u]+F[u];for(d=0;d<r;d++)e[t+d]!==0&&(o[b[e[t+d]]++]=d);if(n===J_?(x=E=o,A=20):n===Sg?(x=GL,E=KL,A=257):(x=YL,E=JL,A=0),K=0,d=0,u=g,B=s,S=p,N=0,ne=-1,k=1<<p,de=k-1,n===Sg&&k>K_||n===Q_&&k>Y_)return 1;for(;;){T=u-N,o[d]+1<A?(J=0,fe=o[d]):o[d]>=A?(J=E[o[d]-A],fe=x[o[d]-A]):(J=96,fe=0),G=1<<u-N,W=1<<S,g=W;do W-=G,i[B+(K>>N)+W]=T<<24|J<<16|fe|0;while(W!==0);for(G=1<<u-1;K&G;)G>>=1;if(G!==0?(K&=G-1,K+=G):K=0,d++,--F[u]===0){if(u===y)break;u=e[t+o[d]]}if(u>p&&(K&de)!==ne){for(N===0&&(N=p),B+=g,S=u-N,C=1<<S;S+N<y&&(C-=F[S+N],!(C<=0));)S++,C<<=1;if(k+=1<<S,n===Sg&&k>K_||n===Q_&&k>Y_)return 1;ne=K&de,i[ne]=p<<24|S<<16|B-s|0}}return K!==0&&(i[B+K]=u-N<<24|64<<16|0),a.bits=p,0};var gh=QL;const XL=0,jA=1,qA=2,{Z_FINISH:X_,Z_BLOCK:ZL,Z_TREES:Bd,Z_OK:Rc,Z_STREAM_END:eD,Z_NEED_DICT:tD,Z_STREAM_ERROR:Hi,Z_DATA_ERROR:zA,Z_MEM_ERROR:$A,Z_BUF_ERROR:nD,Z_DEFLATED:Z_}=VA,Dp=16180,ev=16181,tv=16182,nv=16183,rv=16184,iv=16185,sv=16186,ov=16187,av=16188,cv=16189,$f=16190,uo=16191,Pg=16192,uv=16193,xg=16194,lv=16195,hv=16196,dv=16197,fv=16198,Ud=16199,jd=16200,pv=16201,gv=16202,mv=16203,yv=16204,_v=16205,Rg=16206,vv=16207,wv=16208,Tn=16209,WA=16210,HA=16211,rD=852,iD=592,sD=15,oD=sD,bv=n=>(n>>>24&255)+(n>>>8&65280)+((n&65280)<<8)+((n&255)<<24);function aD(){this.strm=null,this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new Uint16Array(320),this.work=new Uint16Array(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}const Fc=n=>{if(!n)return 1;const e=n.state;return!e||e.strm!==n||e.mode<Dp||e.mode>HA?1:0},GA=n=>{if(Fc(n))return Hi;const e=n.state;return n.total_in=n.total_out=e.total=0,n.msg="",e.wrap&&(n.adler=e.wrap&1),e.mode=Dp,e.last=0,e.havedict=0,e.flags=-1,e.dmax=32768,e.head=null,e.hold=0,e.bits=0,e.lencode=e.lendyn=new Int32Array(rD),e.distcode=e.distdyn=new Int32Array(iD),e.sane=1,e.back=-1,Rc},KA=n=>{if(Fc(n))return Hi;const e=n.state;return e.wsize=0,e.whave=0,e.wnext=0,GA(n)},YA=(n,e)=>{let t;if(Fc(n))return Hi;const r=n.state;return e<0?(t=0,e=-e):(t=(e>>4)+5,e<48&&(e&=15)),e&&(e<8||e>15)?Hi:(r.window!==null&&r.wbits!==e&&(r.window=null),r.wrap=t,r.wbits=e,KA(n))},JA=(n,e)=>{if(!n)return Hi;const t=new aD;n.state=t,t.strm=n,t.window=null,t.mode=Dp;const r=YA(n,e);return r!==Rc&&(n.state=null),r},cD=n=>JA(n,oD);let Iv=!0,Ng,kg;const uD=n=>{if(Iv){Ng=new Int32Array(512),kg=new Int32Array(32);let e=0;for(;e<144;)n.lens[e++]=8;for(;e<256;)n.lens[e++]=9;for(;e<280;)n.lens[e++]=7;for(;e<288;)n.lens[e++]=8;for(gh(jA,n.lens,0,288,Ng,0,n.work,{bits:9}),e=0;e<32;)n.lens[e++]=5;gh(qA,n.lens,0,32,kg,0,n.work,{bits:5}),Iv=!1}n.lencode=Ng,n.lenbits=9,n.distcode=kg,n.distbits=5},QA=(n,e,t,r)=>{let i;const s=n.state;return s.window===null&&(s.wsize=1<<s.wbits,s.wnext=0,s.whave=0,s.window=new Uint8Array(s.wsize)),r>=s.wsize?(s.window.set(e.subarray(t-s.wsize,t),0),s.wnext=0,s.whave=s.wsize):(i=s.wsize-s.wnext,i>r&&(i=r),s.window.set(e.subarray(t-r,t-r+i),s.wnext),r-=i,r?(s.window.set(e.subarray(t-r,t),0),s.wnext=r,s.whave=s.wsize):(s.wnext+=i,s.wnext===s.wsize&&(s.wnext=0),s.whave<s.wsize&&(s.whave+=i))),0},lD=(n,e)=>{let t,r,i,s,o,a,c,u,d,g,y,p,S,N,C=0,k,K,G,W,ne,de,B,x;const A=new Uint8Array(4);let F,b;const E=new Uint8Array([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]);if(Fc(n)||!n.output||!n.input&&n.avail_in!==0)return Hi;t=n.state,t.mode===uo&&(t.mode=Pg),o=n.next_out,i=n.output,c=n.avail_out,s=n.next_in,r=n.input,a=n.avail_in,u=t.hold,d=t.bits,g=a,y=c,x=Rc;e:for(;;)switch(t.mode){case Dp:if(t.wrap===0){t.mode=Pg;break}for(;d<16;){if(a===0)break e;a--,u+=r[s++]<<d,d+=8}if(t.wrap&2&&u===35615){t.wbits===0&&(t.wbits=15),t.check=0,A[0]=u&255,A[1]=u>>>8&255,t.check=xs(t.check,A,2,0),u=0,d=0,t.mode=ev;break}if(t.head&&(t.head.done=!1),!(t.wrap&1)||(((u&255)<<8)+(u>>8))%31){n.msg="incorrect header check",t.mode=Tn;break}if((u&15)!==Z_){n.msg="unknown compression method",t.mode=Tn;break}if(u>>>=4,d-=4,B=(u&15)+8,t.wbits===0&&(t.wbits=B),B>15||B>t.wbits){n.msg="invalid window size",t.mode=Tn;break}t.dmax=1<<t.wbits,t.flags=0,n.adler=t.check=1,t.mode=u&512?cv:uo,u=0,d=0;break;case ev:for(;d<16;){if(a===0)break e;a--,u+=r[s++]<<d,d+=8}if(t.flags=u,(t.flags&255)!==Z_){n.msg="unknown compression method",t.mode=Tn;break}if(t.flags&57344){n.msg="unknown header flags set",t.mode=Tn;break}t.head&&(t.head.text=u>>8&1),t.flags&512&&t.wrap&4&&(A[0]=u&255,A[1]=u>>>8&255,t.check=xs(t.check,A,2,0)),u=0,d=0,t.mode=tv;case tv:for(;d<32;){if(a===0)break e;a--,u+=r[s++]<<d,d+=8}t.head&&(t.head.time=u),t.flags&512&&t.wrap&4&&(A[0]=u&255,A[1]=u>>>8&255,A[2]=u>>>16&255,A[3]=u>>>24&255,t.check=xs(t.check,A,4,0)),u=0,d=0,t.mode=nv;case nv:for(;d<16;){if(a===0)break e;a--,u+=r[s++]<<d,d+=8}t.head&&(t.head.xflags=u&255,t.head.os=u>>8),t.flags&512&&t.wrap&4&&(A[0]=u&255,A[1]=u>>>8&255,t.check=xs(t.check,A,2,0)),u=0,d=0,t.mode=rv;case rv:if(t.flags&1024){for(;d<16;){if(a===0)break e;a--,u+=r[s++]<<d,d+=8}t.length=u,t.head&&(t.head.extra_len=u),t.flags&512&&t.wrap&4&&(A[0]=u&255,A[1]=u>>>8&255,t.check=xs(t.check,A,2,0)),u=0,d=0}else t.head&&(t.head.extra=null);t.mode=iv;case iv:if(t.flags&1024&&(p=t.length,p>a&&(p=a),p&&(t.head&&(B=t.head.extra_len-t.length,t.head.extra||(t.head.extra=new Uint8Array(t.head.extra_len)),t.head.extra.set(r.subarray(s,s+p),B)),t.flags&512&&t.wrap&4&&(t.check=xs(t.check,r,p,s)),a-=p,s+=p,t.length-=p),t.length))break e;t.length=0,t.mode=sv;case sv:if(t.flags&2048){if(a===0)break e;p=0;do B=r[s+p++],t.head&&B&&t.length<65536&&(t.head.name+=String.fromCharCode(B));while(B&&p<a);if(t.flags&512&&t.wrap&4&&(t.check=xs(t.check,r,p,s)),a-=p,s+=p,B)break e}else t.head&&(t.head.name=null);t.length=0,t.mode=ov;case ov:if(t.flags&4096){if(a===0)break e;p=0;do B=r[s+p++],t.head&&B&&t.length<65536&&(t.head.comment+=String.fromCharCode(B));while(B&&p<a);if(t.flags&512&&t.wrap&4&&(t.check=xs(t.check,r,p,s)),a-=p,s+=p,B)break e}else t.head&&(t.head.comment=null);t.mode=av;case av:if(t.flags&512){for(;d<16;){if(a===0)break e;a--,u+=r[s++]<<d,d+=8}if(t.wrap&4&&u!==(t.check&65535)){n.msg="header crc mismatch",t.mode=Tn;break}u=0,d=0}t.head&&(t.head.hcrc=t.flags>>9&1,t.head.done=!0),n.adler=t.check=0,t.mode=uo;break;case cv:for(;d<32;){if(a===0)break e;a--,u+=r[s++]<<d,d+=8}n.adler=t.check=bv(u),u=0,d=0,t.mode=$f;case $f:if(t.havedict===0)return n.next_out=o,n.avail_out=c,n.next_in=s,n.avail_in=a,t.hold=u,t.bits=d,tD;n.adler=t.check=1,t.mode=uo;case uo:if(e===ZL||e===Bd)break e;case Pg:if(t.last){u>>>=d&7,d-=d&7,t.mode=Rg;break}for(;d<3;){if(a===0)break e;a--,u+=r[s++]<<d,d+=8}switch(t.last=u&1,u>>>=1,d-=1,u&3){case 0:t.mode=uv;break;case 1:if(uD(t),t.mode=Ud,e===Bd){u>>>=2,d-=2;break e}break;case 2:t.mode=hv;break;case 3:n.msg="invalid block type",t.mode=Tn}u>>>=2,d-=2;break;case uv:for(u>>>=d&7,d-=d&7;d<32;){if(a===0)break e;a--,u+=r[s++]<<d,d+=8}if((u&65535)!==(u>>>16^65535)){n.msg="invalid stored block lengths",t.mode=Tn;break}if(t.length=u&65535,u=0,d=0,t.mode=xg,e===Bd)break e;case xg:t.mode=lv;case lv:if(p=t.length,p){if(p>a&&(p=a),p>c&&(p=c),p===0)break e;i.set(r.subarray(s,s+p),o),a-=p,s+=p,c-=p,o+=p,t.length-=p;break}t.mode=uo;break;case hv:for(;d<14;){if(a===0)break e;a--,u+=r[s++]<<d,d+=8}if(t.nlen=(u&31)+257,u>>>=5,d-=5,t.ndist=(u&31)+1,u>>>=5,d-=5,t.ncode=(u&15)+4,u>>>=4,d-=4,t.nlen>286||t.ndist>30){n.msg="too many length or distance symbols",t.mode=Tn;break}t.have=0,t.mode=dv;case dv:for(;t.have<t.ncode;){for(;d<3;){if(a===0)break e;a--,u+=r[s++]<<d,d+=8}t.lens[E[t.have++]]=u&7,u>>>=3,d-=3}for(;t.have<19;)t.lens[E[t.have++]]=0;if(t.lencode=t.lendyn,t.lenbits=7,F={bits:t.lenbits},x=gh(XL,t.lens,0,19,t.lencode,0,t.work,F),t.lenbits=F.bits,x){n.msg="invalid code lengths set",t.mode=Tn;break}t.have=0,t.mode=fv;case fv:for(;t.have<t.nlen+t.ndist;){for(;C=t.lencode[u&(1<<t.lenbits)-1],k=C>>>24,K=C>>>16&255,G=C&65535,!(k<=d);){if(a===0)break e;a--,u+=r[s++]<<d,d+=8}if(G<16)u>>>=k,d-=k,t.lens[t.have++]=G;else{if(G===16){for(b=k+2;d<b;){if(a===0)break e;a--,u+=r[s++]<<d,d+=8}if(u>>>=k,d-=k,t.have===0){n.msg="invalid bit length repeat",t.mode=Tn;break}B=t.lens[t.have-1],p=3+(u&3),u>>>=2,d-=2}else if(G===17){for(b=k+3;d<b;){if(a===0)break e;a--,u+=r[s++]<<d,d+=8}u>>>=k,d-=k,B=0,p=3+(u&7),u>>>=3,d-=3}else{for(b=k+7;d<b;){if(a===0)break e;a--,u+=r[s++]<<d,d+=8}u>>>=k,d-=k,B=0,p=11+(u&127),u>>>=7,d-=7}if(t.have+p>t.nlen+t.ndist){n.msg="invalid bit length repeat",t.mode=Tn;break}for(;p--;)t.lens[t.have++]=B}}if(t.mode===Tn)break;if(t.lens[256]===0){n.msg="invalid code -- missing end-of-block",t.mode=Tn;break}if(t.lenbits=9,F={bits:t.lenbits},x=gh(jA,t.lens,0,t.nlen,t.lencode,0,t.work,F),t.lenbits=F.bits,x){n.msg="invalid literal/lengths set",t.mode=Tn;break}if(t.distbits=6,t.distcode=t.distdyn,F={bits:t.distbits},x=gh(qA,t.lens,t.nlen,t.ndist,t.distcode,0,t.work,F),t.distbits=F.bits,x){n.msg="invalid distances set",t.mode=Tn;break}if(t.mode=Ud,e===Bd)break e;case Ud:t.mode=jd;case jd:if(a>=6&&c>=258){n.next_out=o,n.avail_out=c,n.next_in=s,n.avail_in=a,t.hold=u,t.bits=d,HL(n,y),o=n.next_out,i=n.output,c=n.avail_out,s=n.next_in,r=n.input,a=n.avail_in,u=t.hold,d=t.bits,t.mode===uo&&(t.back=-1);break}for(t.back=0;C=t.lencode[u&(1<<t.lenbits)-1],k=C>>>24,K=C>>>16&255,G=C&65535,!(k<=d);){if(a===0)break e;a--,u+=r[s++]<<d,d+=8}if(K&&(K&240)===0){for(W=k,ne=K,de=G;C=t.lencode[de+((u&(1<<W+ne)-1)>>W)],k=C>>>24,K=C>>>16&255,G=C&65535,!(W+k<=d);){if(a===0)break e;a--,u+=r[s++]<<d,d+=8}u>>>=W,d-=W,t.back+=W}if(u>>>=k,d-=k,t.back+=k,t.length=G,K===0){t.mode=_v;break}if(K&32){t.back=-1,t.mode=uo;break}if(K&64){n.msg="invalid literal/length code",t.mode=Tn;break}t.extra=K&15,t.mode=pv;case pv:if(t.extra){for(b=t.extra;d<b;){if(a===0)break e;a--,u+=r[s++]<<d,d+=8}t.length+=u&(1<<t.extra)-1,u>>>=t.extra,d-=t.extra,t.back+=t.extra}t.was=t.length,t.mode=gv;case gv:for(;C=t.distcode[u&(1<<t.distbits)-1],k=C>>>24,K=C>>>16&255,G=C&65535,!(k<=d);){if(a===0)break e;a--,u+=r[s++]<<d,d+=8}if((K&240)===0){for(W=k,ne=K,de=G;C=t.distcode[de+((u&(1<<W+ne)-1)>>W)],k=C>>>24,K=C>>>16&255,G=C&65535,!(W+k<=d);){if(a===0)break e;a--,u+=r[s++]<<d,d+=8}u>>>=W,d-=W,t.back+=W}if(u>>>=k,d-=k,t.back+=k,K&64){n.msg="invalid distance code",t.mode=Tn;break}t.offset=G,t.extra=K&15,t.mode=mv;case mv:if(t.extra){for(b=t.extra;d<b;){if(a===0)break e;a--,u+=r[s++]<<d,d+=8}t.offset+=u&(1<<t.extra)-1,u>>>=t.extra,d-=t.extra,t.back+=t.extra}if(t.offset>t.dmax){n.msg="invalid distance too far back",t.mode=Tn;break}t.mode=yv;case yv:if(c===0)break e;if(p=y-c,t.offset>p){if(p=t.offset-p,p>t.whave&&t.sane){n.msg="invalid distance too far back",t.mode=Tn;break}p>t.wnext?(p-=t.wnext,S=t.wsize-p):S=t.wnext-p,p>t.length&&(p=t.length),N=t.window}else N=i,S=o-t.offset,p=t.length;p>c&&(p=c),c-=p,t.length-=p;do i[o++]=N[S++];while(--p);t.length===0&&(t.mode=jd);break;case _v:if(c===0)break e;i[o++]=t.length,c--,t.mode=jd;break;case Rg:if(t.wrap){for(;d<32;){if(a===0)break e;a--,u|=r[s++]<<d,d+=8}if(y-=c,n.total_out+=y,t.total+=y,t.wrap&4&&y&&(n.adler=t.check=t.flags?xs(t.check,i,y,o-y):Um(t.check,i,y,o-y)),y=c,t.wrap&4&&(t.flags?u:bv(u))!==t.check){n.msg="incorrect data check",t.mode=Tn;break}u=0,d=0}t.mode=vv;case vv:if(t.wrap&&t.flags){for(;d<32;){if(a===0)break e;a--,u+=r[s++]<<d,d+=8}if(t.wrap&4&&u!==(t.total&4294967295)){n.msg="incorrect length check",t.mode=Tn;break}u=0,d=0}t.mode=wv;case wv:x=eD;break e;case Tn:x=zA;break e;case WA:return $A;case HA:default:return Hi}return n.next_out=o,n.avail_out=c,n.next_in=s,n.avail_in=a,t.hold=u,t.bits=d,(t.wsize||y!==n.avail_out&&t.mode<Tn&&(t.mode<Rg||e!==X_))&&QA(n,n.output,n.next_out,y-n.avail_out),g-=n.avail_in,y-=n.avail_out,n.total_in+=g,n.total_out+=y,t.total+=y,t.wrap&4&&y&&(n.adler=t.check=t.flags?xs(t.check,i,y,n.next_out-y):Um(t.check,i,y,n.next_out-y)),n.data_type=t.bits+(t.last?64:0)+(t.mode===uo?128:0)+(t.mode===Ud||t.mode===xg?256:0),(g===0&&y===0||e===X_)&&x===Rc&&(x=nD),x},hD=n=>{if(Fc(n))return Hi;let e=n.state;return e.window&&(e.window=null),n.state=null,Rc},dD=(n,e)=>{if(Fc(n))return Hi;const t=n.state;return(t.wrap&2)===0?Hi:(t.head=e,e.done=!1,Rc)},fD=(n,e)=>{const t=e.length;let r,i,s;return Fc(n)||(r=n.state,r.wrap!==0&&r.mode!==$f)?Hi:r.mode===$f&&(i=1,i=Um(i,e,t,0),i!==r.check)?zA:(s=QA(n,e,t,t),s?(r.mode=WA,$A):(r.havedict=1,Rc))};var pD=KA,gD=YA,mD=GA,yD=cD,_D=JA,vD=lD,wD=hD,bD=dD,ID=fD,AD="pako inflate (from Nodeca project)",lo={inflateReset:pD,inflateReset2:gD,inflateResetKeep:mD,inflateInit:yD,inflateInit2:_D,inflate:vD,inflateEnd:wD,inflateGetHeader:bD,inflateSetDictionary:ID,inflateInfo:AD};function ED(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1}var TD=ED;const XA=Object.prototype.toString,{Z_NO_FLUSH:SD,Z_FINISH:PD,Z_OK:jh,Z_STREAM_END:Cg,Z_NEED_DICT:Lg,Z_STREAM_ERROR:xD,Z_DATA_ERROR:Av,Z_MEM_ERROR:RD}=VA;function ld(n){this.options=BA.assign({chunkSize:1024*64,windowBits:15,to:""},n||{});const e=this.options;e.raw&&e.windowBits>=0&&e.windowBits<16&&(e.windowBits=-e.windowBits,e.windowBits===0&&(e.windowBits=-15)),e.windowBits>=0&&e.windowBits<16&&!(n&&n.windowBits)&&(e.windowBits+=32),e.windowBits>15&&e.windowBits<48&&(e.windowBits&15)===0&&(e.windowBits|=15),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new $L,this.strm.avail_out=0;let t=lo.inflateInit2(this.strm,e.windowBits);if(t!==jh)throw new Error(jm[t]);if(this.header=new TD,lo.inflateGetHeader(this.strm,this.header),e.dictionary&&(typeof e.dictionary=="string"?e.dictionary=qm.string2buf(e.dictionary):XA.call(e.dictionary)==="[object ArrayBuffer]"&&(e.dictionary=new Uint8Array(e.dictionary)),e.raw&&(t=lo.inflateSetDictionary(this.strm,e.dictionary),t!==jh)))throw new Error(jm[t])}ld.prototype.push=function(n,e){const t=this.strm,r=this.options.chunkSize,i=this.options.dictionary;let s,o,a;if(this.ended)return!1;for(e===~~e?o=e:o=e===!0?PD:SD,XA.call(n)==="[object ArrayBuffer]"?t.input=new Uint8Array(n):t.input=n,t.next_in=0,t.avail_in=t.input.length;;){for(t.avail_out===0&&(t.output=new Uint8Array(r),t.next_out=0,t.avail_out=r),s=lo.inflate(t,o),s===Lg&&i&&(s=lo.inflateSetDictionary(t,i),s===jh?s=lo.inflate(t,o):s===Av&&(s=Lg));t.avail_in>0&&s===Cg&&t.state.wrap>0&&n[t.next_in]!==0;)lo.inflateReset(t),s=lo.inflate(t,o);switch(s){case xD:case Av:case Lg:case RD:return this.onEnd(s),this.ended=!0,!1}if(a=t.avail_out,t.next_out&&(t.avail_out===0||s===Cg))if(this.options.to==="string"){let c=qm.utf8border(t.output,t.next_out),u=t.next_out-c,d=qm.buf2string(t.output,c);t.next_out=u,t.avail_out=r-u,u&&t.output.set(t.output.subarray(c,c+u),0),this.onData(d)}else this.onData(t.output.length===t.next_out?t.output:t.output.subarray(0,t.next_out));if(!(s===jh&&a===0)){if(s===Cg)return s=lo.inflateEnd(this.strm),this.onEnd(s),this.ended=!0,!0;if(t.avail_in===0)break}}return!0};ld.prototype.onData=function(n){this.chunks.push(n)};ld.prototype.onEnd=function(n){n===jh&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=BA.flattenChunks(this.chunks)),this.chunks=[],this.err=n,this.msg=this.strm.msg};function ND(n,e){const t=new ld(e);if(t.push(n),t.err)throw t.msg||jm[t.err];return t.result}var kD=ld,CD=ND,LD={Inflate:kD,inflate:CD};const{Inflate:DD,inflate:OD}=LD;var Ev=DD,FD=OD;const ZA=[];for(let n=0;n<256;n++){let e=n;for(let t=0;t<8;t++)e&1?e=3988292384^e>>>1:e=e>>>1;ZA[n]=e}const Tv=4294967295;function MD(n,e,t){let r=n;for(let i=0;i<t;i++)r=ZA[(r^e[i])&255]^r>>>8;return r}function VD(n,e){return(MD(Tv,n,e)^Tv)>>>0}function Sv(n,e,t){const r=n.readUint32(),i=VD(new Uint8Array(n.buffer,n.byteOffset+n.offset-e-4,e),e);if(i!==r)throw new Error(`CRC mismatch for chunk ${t}. Expected ${r}, found ${i}`)}function eE(n,e,t){for(let r=0;r<t;r++)e[r]=n[r]}function tE(n,e,t,r){let i=0;for(;i<r;i++)e[i]=n[i];for(;i<t;i++)e[i]=n[i]+e[i-r]&255}function nE(n,e,t,r){let i=0;if(t.length===0)for(;i<r;i++)e[i]=n[i];else for(;i<r;i++)e[i]=n[i]+t[i]&255}function rE(n,e,t,r,i){let s=0;if(t.length===0){for(;s<i;s++)e[s]=n[s];for(;s<r;s++)e[s]=n[s]+(e[s-i]>>1)&255}else{for(;s<i;s++)e[s]=n[s]+(t[s]>>1)&255;for(;s<r;s++)e[s]=n[s]+(e[s-i]+t[s]>>1)&255}}function iE(n,e,t,r,i){let s=0;if(t.length===0){for(;s<i;s++)e[s]=n[s];for(;s<r;s++)e[s]=n[s]+e[s-i]&255}else{for(;s<i;s++)e[s]=n[s]+t[s]&255;for(;s<r;s++)e[s]=n[s]+BD(e[s-i],t[s],t[s-i])&255}}function BD(n,e,t){const r=n+e-t,i=Math.abs(r-n),s=Math.abs(r-e),o=Math.abs(r-t);return i<=s&&i<=o?n:s<=o?e:t}function UD(n,e,t,r,i,s){switch(n){case 0:eE(e,t,i);break;case 1:tE(e,t,i,s);break;case 2:nE(e,t,r,i);break;case 3:rE(e,t,r,i,s);break;case 4:iE(e,t,r,i,s);break;default:throw new Error(`Unsupported filter: ${n}`)}}const jD=new Uint16Array([255]),qD=new Uint8Array(jD.buffer),zD=qD[0]===255;function $D(n){const{data:e,width:t,height:r,channels:i,depth:s}=n,o=[{x:0,y:0,xStep:8,yStep:8},{x:4,y:0,xStep:8,yStep:8},{x:0,y:4,xStep:4,yStep:8},{x:2,y:0,xStep:4,yStep:4},{x:0,y:2,xStep:2,yStep:4},{x:1,y:0,xStep:2,yStep:2},{x:0,y:1,xStep:1,yStep:2}],a=Math.ceil(s/8)*i,c=new Uint8Array(r*t*a);let u=0;for(let d=0;d<7;d++){const g=o[d],y=Math.ceil((t-g.x)/g.xStep),p=Math.ceil((r-g.y)/g.yStep);if(y<=0||p<=0)continue;const S=y*a,N=new Uint8Array(S);for(let C=0;C<p;C++){const k=e[u++],K=e.subarray(u,u+S);u+=S;const G=new Uint8Array(S);UD(k,K,G,N,S,a),N.set(G);for(let W=0;W<y;W++){const ne=g.x+W*g.xStep,de=g.y+C*g.yStep;if(!(ne>=t||de>=r))for(let B=0;B<a;B++)c[(de*t+ne)*a+B]=G[W*a+B]}}}if(s===16){const d=new Uint16Array(c.buffer);if(zD)for(let g=0;g<d.length;g++)d[g]=WD(d[g]);return d}else return c}function WD(n){return(n&255)<<8|n>>8&255}const HD=new Uint16Array([255]),GD=new Uint8Array(HD.buffer),KD=GD[0]===255,YD=new Uint8Array(0);function Pv(n){const{data:e,width:t,height:r,channels:i,depth:s}=n,o=Math.ceil(s/8)*i,a=Math.ceil(s/8*i*t),c=new Uint8Array(r*a);let u=YD,d=0,g,y;for(let p=0;p<r;p++){switch(g=e.subarray(d+1,d+1+a),y=c.subarray(p*a,(p+1)*a),e[d]){case 0:eE(g,y,a);break;case 1:tE(g,y,a,o);break;case 2:nE(g,y,u,a);break;case 3:rE(g,y,u,a,o);break;case 4:iE(g,y,u,a,o);break;default:throw new Error(`Unsupported filter: ${e[d]}`)}u=y,d+=a+1}if(s===16){const p=new Uint16Array(c.buffer);if(KD)for(let S=0;S<p.length;S++)p[S]=JD(p[S]);return p}else return c}function JD(n){return(n&255)<<8|n>>8&255}const uf=Uint8Array.of(137,80,78,71,13,10,26,10);function xv(n){if(!QD(n.readBytes(uf.length)))throw new Error("wrong PNG signature")}function QD(n){if(n.length<uf.length)return!1;for(let e=0;e<uf.length;e++)if(n[e]!==uf[e])return!1;return!0}const XD="tEXt",ZD=0,sE=new TextDecoder("latin1");function e8(n){if(n8(n),n.length===0||n.length>79)throw new Error("keyword length must be between 1 and 79")}const t8=/^[\u0000-\u00FF]*$/;function n8(n){if(!t8.test(n))throw new Error("invalid latin1 text")}function r8(n,e,t){const r=oE(e);n[r]=i8(e,t-r.length-1)}function oE(n){for(n.mark();n.readByte()!==ZD;);const e=n.offset;n.reset();const t=sE.decode(n.readBytes(e-n.offset-1));return n.skip(1),e8(t),t}function i8(n,e){return sE.decode(n.readBytes(e))}const Ai={UNKNOWN:-1,GREYSCALE:0,TRUECOLOUR:2,INDEXED_COLOUR:3,GREYSCALE_ALPHA:4,TRUECOLOUR_ALPHA:6},Dg={UNKNOWN:-1,DEFLATE:0},Rv={UNKNOWN:-1,ADAPTIVE:0},Og={UNKNOWN:-1,NO_INTERLACE:0,ADAM7:1},qd={NONE:0,BACKGROUND:1,PREVIOUS:2},Fg={SOURCE:0,OVER:1};class s8 extends U0{_checkCrc;_inflator;_png;_apng;_end;_hasPalette;_palette;_hasTransparency;_transparency;_compressionMethod;_filterMethod;_interlaceMethod;_colorType;_isAnimated;_numberOfFrames;_numberOfPlays;_frames;_writingDataChunks;constructor(e,t={}){super(e);const{checkCrc:r=!1}=t;this._checkCrc=r,this._inflator=new Ev,this._png={width:-1,height:-1,channels:-1,data:new Uint8Array(0),depth:1,text:{}},this._apng={width:-1,height:-1,channels:-1,depth:1,numberOfFrames:1,numberOfPlays:0,text:{},frames:[]},this._end=!1,this._hasPalette=!1,this._palette=[],this._hasTransparency=!1,this._transparency=new Uint16Array(0),this._compressionMethod=Dg.UNKNOWN,this._filterMethod=Rv.UNKNOWN,this._interlaceMethod=Og.UNKNOWN,this._colorType=Ai.UNKNOWN,this._isAnimated=!1,this._numberOfFrames=1,this._numberOfPlays=0,this._frames=[],this._writingDataChunks=!1,this.setBigEndian()}decode(){for(xv(this);!this._end;){const e=this.readUint32(),t=this.readChars(4);this.decodeChunk(e,t)}return this.decodeImage(),this._png}decodeApng(){for(xv(this);!this._end;){const e=this.readUint32(),t=this.readChars(4);this.decodeApngChunk(e,t)}return this.decodeApngImage(),this._apng}decodeChunk(e,t){const r=this.offset;switch(t){case"IHDR":this.decodeIHDR();break;case"PLTE":this.decodePLTE(e);break;case"IDAT":this.decodeIDAT(e);break;case"IEND":this._end=!0;break;case"tRNS":this.decodetRNS(e);break;case"iCCP":this.decodeiCCP(e);break;case XD:r8(this._png.text,this,e);break;case"pHYs":this.decodepHYs();break;default:this.skip(e);break}if(this.offset-r!==e)throw new Error(`Length mismatch while decoding chunk ${t}`);this._checkCrc?Sv(this,e+4,t):this.skip(4)}decodeApngChunk(e,t){const r=this.offset;switch(t!=="fdAT"&&t!=="IDAT"&&this._writingDataChunks&&this.pushDataToFrame(),t){case"acTL":this.decodeACTL();break;case"fcTL":this.decodeFCTL();break;case"fdAT":this.decodeFDAT(e);break;default:this.decodeChunk(e,t),this.offset=r+e;break}if(this.offset-r!==e)throw new Error(`Length mismatch while decoding chunk ${t}`);this._checkCrc?Sv(this,e+4,t):this.skip(4)}decodeIHDR(){const e=this._png;e.width=this.readUint32(),e.height=this.readUint32(),e.depth=o8(this.readUint8());const t=this.readUint8();this._colorType=t;let r;switch(t){case Ai.GREYSCALE:r=1;break;case Ai.TRUECOLOUR:r=3;break;case Ai.INDEXED_COLOUR:r=1;break;case Ai.GREYSCALE_ALPHA:r=2;break;case Ai.TRUECOLOUR_ALPHA:r=4;break;case Ai.UNKNOWN:default:throw new Error(`Unknown color type: ${t}`)}if(this._png.channels=r,this._compressionMethod=this.readUint8(),this._compressionMethod!==Dg.DEFLATE)throw new Error(`Unsupported compression method: ${this._compressionMethod}`);this._filterMethod=this.readUint8(),this._interlaceMethod=this.readUint8()}decodeACTL(){this._numberOfFrames=this.readUint32(),this._numberOfPlays=this.readUint32(),this._isAnimated=!0}decodeFCTL(){const e={sequenceNumber:this.readUint32(),width:this.readUint32(),height:this.readUint32(),xOffset:this.readUint32(),yOffset:this.readUint32(),delayNumber:this.readUint16(),delayDenominator:this.readUint16(),disposeOp:this.readUint8(),blendOp:this.readUint8(),data:new Uint8Array(0)};this._frames.push(e)}decodePLTE(e){if(e%3!==0)throw new RangeError(`PLTE field length must be a multiple of 3. Got ${e}`);const t=e/3;this._hasPalette=!0;const r=[];this._palette=r;for(let i=0;i<t;i++)r.push([this.readUint8(),this.readUint8(),this.readUint8()])}decodeIDAT(e){this._writingDataChunks=!0;const t=e,r=this.offset+this.byteOffset;if(this._inflator.push(new Uint8Array(this.buffer,r,t)),this._inflator.err)throw new Error(`Error while decompressing the data: ${this._inflator.err}`);this.skip(e)}decodeFDAT(e){this._writingDataChunks=!0;let t=e,r=this.offset+this.byteOffset;if(r+=4,t-=4,this._inflator.push(new Uint8Array(this.buffer,r,t)),this._inflator.err)throw new Error(`Error while decompressing the data: ${this._inflator.err}`);this.skip(e)}decodetRNS(e){switch(this._colorType){case Ai.GREYSCALE:case Ai.TRUECOLOUR:{if(e%2!==0)throw new RangeError(`tRNS chunk length must be a multiple of 2. Got ${e}`);if(e/2>this._png.width*this._png.height)throw new Error(`tRNS chunk contains more alpha values than there are pixels (${e/2} vs ${this._png.width*this._png.height})`);this._hasTransparency=!0,this._transparency=new Uint16Array(e/2);for(let t=0;t<e/2;t++)this._transparency[t]=this.readUint16();break}case Ai.INDEXED_COLOUR:{if(e>this._palette.length)throw new Error(`tRNS chunk contains more alpha values than there are palette colors (${e} vs ${this._palette.length})`);let t=0;for(;t<e;t++){const r=this.readByte();this._palette[t].push(r)}for(;t<this._palette.length;t++)this._palette[t].push(255);break}case Ai.UNKNOWN:case Ai.GREYSCALE_ALPHA:case Ai.TRUECOLOUR_ALPHA:default:throw new Error(`tRNS chunk is not supported for color type ${this._colorType}`)}}decodeiCCP(e){const t=oE(this),r=this.readUint8();if(r!==Dg.DEFLATE)throw new Error(`Unsupported iCCP compression method: ${r}`);const i=this.readBytes(e-t.length-2);this._png.iccEmbeddedProfile={name:t,profile:FD(i)}}decodepHYs(){const e=this.readUint32(),t=this.readUint32(),r=this.readByte();this._png.resolution={x:e,y:t,unit:r}}decodeApngImage(){this._apng.width=this._png.width,this._apng.height=this._png.height,this._apng.channels=this._png.channels,this._apng.depth=this._png.depth,this._apng.numberOfFrames=this._numberOfFrames,this._apng.numberOfPlays=this._numberOfPlays,this._apng.text=this._png.text,this._apng.resolution=this._png.resolution;for(let e=0;e<this._numberOfFrames;e++){const t={sequenceNumber:this._frames[e].sequenceNumber,delayNumber:this._frames[e].delayNumber,delayDenominator:this._frames[e].delayDenominator,data:this._apng.depth===8?new Uint8Array(this._apng.width*this._apng.height*this._apng.channels):new Uint16Array(this._apng.width*this._apng.height*this._apng.channels)},r=this._frames.at(e);if(r){if(r.data=Pv({data:r.data,width:r.width,height:r.height,channels:this._apng.channels,depth:this._apng.depth}),this._hasPalette&&(this._apng.palette=this._palette),this._hasTransparency&&(this._apng.transparency=this._transparency),e===0||r.xOffset===0&&r.yOffset===0&&r.width===this._png.width&&r.height===this._png.height)t.data=r.data;else{const i=this._apng.frames.at(e-1);this.disposeFrame(r,i,t),this.addFrameDataToCanvas(t,r)}this._apng.frames.push(t)}}return this._apng}disposeFrame(e,t,r){switch(e.disposeOp){case qd.NONE:break;case qd.BACKGROUND:for(let i=0;i<this._png.height;i++)for(let s=0;s<this._png.width;s++){const o=(i*e.width+s)*this._png.channels;for(let a=0;a<this._png.channels;a++)r.data[o+a]=0}break;case qd.PREVIOUS:r.data.set(t.data);break;default:throw new Error("Unknown disposeOp")}}addFrameDataToCanvas(e,t){const r=1<<this._png.depth,i=(s,o)=>{const a=((s+t.yOffset)*this._png.width+t.xOffset+o)*this._png.channels,c=(s*t.width+o)*this._png.channels;return{index:a,frameIndex:c}};switch(t.blendOp){case Fg.SOURCE:for(let s=0;s<t.height;s++)for(let o=0;o<t.width;o++){const{index:a,frameIndex:c}=i(s,o);for(let u=0;u<this._png.channels;u++)e.data[a+u]=t.data[c+u]}break;case Fg.OVER:for(let s=0;s<t.height;s++)for(let o=0;o<t.width;o++){const{index:a,frameIndex:c}=i(s,o);for(let u=0;u<this._png.channels;u++){const d=t.data[c+this._png.channels-1]/r,g=u%(this._png.channels-1)===0?1:t.data[c+u],y=Math.floor(d*g+(1-d)*e.data[a+u]);e.data[a+u]+=y}}break;default:throw new Error("Unknown blendOp")}}decodeImage(){if(this._inflator.err)throw new Error(`Error while decompressing the data: ${this._inflator.err}`);const e=this._isAnimated?(this._frames?.at(0)).data:this._inflator.result;if(this._filterMethod!==Rv.ADAPTIVE)throw new Error(`Filter method ${this._filterMethod} not supported`);if(this._interlaceMethod===Og.NO_INTERLACE)this._png.data=Pv({data:e,width:this._png.width,height:this._png.height,channels:this._png.channels,depth:this._png.depth});else if(this._interlaceMethod===Og.ADAM7)this._png.data=$D({data:e,width:this._png.width,height:this._png.height,channels:this._png.channels,depth:this._png.depth});else throw new Error(`Interlace method ${this._interlaceMethod} not supported`);this._hasPalette&&(this._png.palette=this._palette),this._hasTransparency&&(this._png.transparency=this._transparency)}pushDataToFrame(){const e=this._inflator.result,t=this._frames.at(-1);t?t.data=e:this._frames.push({sequenceNumber:0,width:this._png.width,height:this._png.height,xOffset:0,yOffset:0,delayNumber:0,delayDenominator:0,disposeOp:qd.NONE,blendOp:Fg.SOURCE,data:e}),this._inflator=new Ev,this._writingDataChunks=!1}}function o8(n){if(n!==1&&n!==2&&n!==4&&n!==8&&n!==16)throw new Error(`invalid bit depth: ${n}`);return n}var Nv;(function(n){n[n.UNKNOWN=0]="UNKNOWN",n[n.METRE=1]="METRE"})(Nv||(Nv={}));function a8(n,e){return new s8(n,e).decode()}var yt=(function(){return typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:this})();function Mg(){yt.console&&typeof yt.console.log=="function"&&yt.console.log.apply(yt.console,arguments)}var cn={log:Mg,warn:function(n){yt.console&&(typeof yt.console.warn=="function"?yt.console.warn.apply(yt.console,arguments):Mg.call(null,arguments))},error:function(n){yt.console&&(typeof yt.console.error=="function"?yt.console.error.apply(yt.console,arguments):Mg(n))}};function Vg(n,e,t){var r=new XMLHttpRequest;r.open("GET",n),r.responseType="blob",r.onload=function(){Xa(r.response,e,t)},r.onerror=function(){cn.error("could not download file")},r.send()}function kv(n){var e=new XMLHttpRequest;e.open("HEAD",n,!1);try{e.send()}catch{}return e.status>=200&&e.status<=299}function zd(n){try{n.dispatchEvent(new MouseEvent("click"))}catch{var e=document.createEvent("MouseEvents");e.initMouseEvent("click",!0,!0,window,0,0,0,80,20,!1,!1,!1,!1,0,null),n.dispatchEvent(e)}}var Xa=yt.saveAs||((typeof window>"u"?"undefined":Zt(window))!=="object"||window!==yt?function(){}:typeof HTMLAnchorElement<"u"&&"download"in HTMLAnchorElement.prototype?function(n,e,t){var r=yt.URL||yt.webkitURL,i=document.createElement("a");e=e||n.name||"download",i.download=e,i.rel="noopener",typeof n=="string"?(i.href=n,i.origin!==location.origin?kv(i.href)?Vg(n,e,t):zd(i,i.target="_blank"):zd(i)):(i.href=r.createObjectURL(n),setTimeout(function(){r.revokeObjectURL(i.href)},4e4),setTimeout(function(){zd(i)},0))}:"msSaveOrOpenBlob"in navigator?function(n,e,t){if(e=e||n.name||"download",typeof n=="string")if(kv(n))Vg(n,e,t);else{var r=document.createElement("a");r.href=n,r.target="_blank",setTimeout(function(){zd(r)})}else navigator.msSaveOrOpenBlob((function(i,s){return s===void 0?s={autoBom:!1}:Zt(s)!=="object"&&(cn.warn("Deprecated: Expected third argument to be a object"),s={autoBom:!s}),s.autoBom&&/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(i.type)?new Blob(["\uFEFF",i],{type:i.type}):i})(n,t),e)}:function(n,e,t,r){if((r=r||open("","_blank"))&&(r.document.title=r.document.body.innerText="downloading..."),typeof n=="string")return Vg(n,e,t);var i=n.type==="application/octet-stream",s=/constructor/i.test(yt.HTMLElement)||yt.safari,o=/CriOS\/[\d]+/.test(navigator.userAgent);if((o||i&&s)&&(typeof FileReader>"u"?"undefined":Zt(FileReader))==="object"){var a=new FileReader;a.onloadend=function(){var d=a.result;d=o?d:d.replace(/^data:[^;]*;/,"data:attachment/file;"),r?r.location.href=d:location=d,r=null},a.readAsDataURL(n)}else{var c=yt.URL||yt.webkitURL,u=c.createObjectURL(n);r?r.location=u:location.href=u,r=null,setTimeout(function(){c.revokeObjectURL(u)},4e4)}});function aE(n){var e;n=n||"",this.ok=!1,n.charAt(0)=="#"&&(n=n.substr(1,6)),n={aliceblue:"f0f8ff",antiquewhite:"faebd7",aqua:"00ffff",aquamarine:"7fffd4",azure:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"000000",blanchedalmond:"ffebcd",blue:"0000ff",blueviolet:"8a2be2",brown:"a52a2a",burlywood:"deb887",cadetblue:"5f9ea0",chartreuse:"7fff00",chocolate:"d2691e",coral:"ff7f50",cornflowerblue:"6495ed",cornsilk:"fff8dc",crimson:"dc143c",cyan:"00ffff",darkblue:"00008b",darkcyan:"008b8b",darkgoldenrod:"b8860b",darkgray:"a9a9a9",darkgreen:"006400",darkkhaki:"bdb76b",darkmagenta:"8b008b",darkolivegreen:"556b2f",darkorange:"ff8c00",darkorchid:"9932cc",darkred:"8b0000",darksalmon:"e9967a",darkseagreen:"8fbc8f",darkslateblue:"483d8b",darkslategray:"2f4f4f",darkturquoise:"00ced1",darkviolet:"9400d3",deeppink:"ff1493",deepskyblue:"00bfff",dimgray:"696969",dodgerblue:"1e90ff",feldspar:"d19275",firebrick:"b22222",floralwhite:"fffaf0",forestgreen:"228b22",fuchsia:"ff00ff",gainsboro:"dcdcdc",ghostwhite:"f8f8ff",gold:"ffd700",goldenrod:"daa520",gray:"808080",green:"008000",greenyellow:"adff2f",honeydew:"f0fff0",hotpink:"ff69b4",indianred:"cd5c5c",indigo:"4b0082",ivory:"fffff0",khaki:"f0e68c",lavender:"e6e6fa",lavenderblush:"fff0f5",lawngreen:"7cfc00",lemonchiffon:"fffacd",lightblue:"add8e6",lightcoral:"f08080",lightcyan:"e0ffff",lightgoldenrodyellow:"fafad2",lightgrey:"d3d3d3",lightgreen:"90ee90",lightpink:"ffb6c1",lightsalmon:"ffa07a",lightseagreen:"20b2aa",lightskyblue:"87cefa",lightslateblue:"8470ff",lightslategray:"778899",lightsteelblue:"b0c4de",lightyellow:"ffffe0",lime:"00ff00",limegreen:"32cd32",linen:"faf0e6",magenta:"ff00ff",maroon:"800000",mediumaquamarine:"66cdaa",mediumblue:"0000cd",mediumorchid:"ba55d3",mediumpurple:"9370d8",mediumseagreen:"3cb371",mediumslateblue:"7b68ee",mediumspringgreen:"00fa9a",mediumturquoise:"48d1cc",mediumvioletred:"c71585",midnightblue:"191970",mintcream:"f5fffa",mistyrose:"ffe4e1",moccasin:"ffe4b5",navajowhite:"ffdead",navy:"000080",oldlace:"fdf5e6",olive:"808000",olivedrab:"6b8e23",orange:"ffa500",orangered:"ff4500",orchid:"da70d6",palegoldenrod:"eee8aa",palegreen:"98fb98",paleturquoise:"afeeee",palevioletred:"d87093",papayawhip:"ffefd5",peachpuff:"ffdab9",peru:"cd853f",pink:"ffc0cb",plum:"dda0dd",powderblue:"b0e0e6",purple:"800080",red:"ff0000",rosybrown:"bc8f8f",royalblue:"4169e1",saddlebrown:"8b4513",salmon:"fa8072",sandybrown:"f4a460",seagreen:"2e8b57",seashell:"fff5ee",sienna:"a0522d",silver:"c0c0c0",skyblue:"87ceeb",slateblue:"6a5acd",slategray:"708090",snow:"fffafa",springgreen:"00ff7f",steelblue:"4682b4",tan:"d2b48c",teal:"008080",thistle:"d8bfd8",tomato:"ff6347",turquoise:"40e0d0",violet:"ee82ee",violetred:"d02090",wheat:"f5deb3",white:"ffffff",whitesmoke:"f5f5f5",yellow:"ffff00",yellowgreen:"9acd32"}[n=(n=n.replace(/ /g,"")).toLowerCase()]||n;for(var t=[{re:/^rgb\((\d{1,3}),\s*(\d{1,3}),\s*(\d{1,3})\)$/,example:["rgb(123, 234, 45)","rgb(255,234,245)"],process:function(a){return[parseInt(a[1]),parseInt(a[2]),parseInt(a[3])]}},{re:/^(\w{2})(\w{2})(\w{2})$/,example:["#00ff00","336699"],process:function(a){return[parseInt(a[1],16),parseInt(a[2],16),parseInt(a[3],16)]}},{re:/^(\w{1})(\w{1})(\w{1})$/,example:["#fb0","f0f"],process:function(a){return[parseInt(a[1]+a[1],16),parseInt(a[2]+a[2],16),parseInt(a[3]+a[3],16)]}}],r=0;r<t.length;r++){var i=t[r].re,s=t[r].process,o=i.exec(n);o&&(e=s(o),this.r=e[0],this.g=e[1],this.b=e[2],this.ok=!0)}this.r=this.r<0||isNaN(this.r)?0:this.r>255?255:this.r,this.g=this.g<0||isNaN(this.g)?0:this.g>255?255:this.g,this.b=this.b<0||isNaN(this.b)?0:this.b>255?255:this.b,this.toRGB=function(){return"rgb("+this.r+", "+this.g+", "+this.b+")"},this.toHex=function(){var a=this.r.toString(16),c=this.g.toString(16),u=this.b.toString(16);return a.length==1&&(a="0"+a),c.length==1&&(c="0"+c),u.length==1&&(u="0"+u),"#"+a+c+u}}var lf=yt.atob.bind(yt),Cv=yt.btoa.bind(yt);function Bg(n,e){var t=n[0],r=n[1],i=n[2],s=n[3];t=Tr(t,r,i,s,e[0],7,-680876936),s=Tr(s,t,r,i,e[1],12,-389564586),i=Tr(i,s,t,r,e[2],17,606105819),r=Tr(r,i,s,t,e[3],22,-1044525330),t=Tr(t,r,i,s,e[4],7,-176418897),s=Tr(s,t,r,i,e[5],12,1200080426),i=Tr(i,s,t,r,e[6],17,-1473231341),r=Tr(r,i,s,t,e[7],22,-45705983),t=Tr(t,r,i,s,e[8],7,1770035416),s=Tr(s,t,r,i,e[9],12,-1958414417),i=Tr(i,s,t,r,e[10],17,-42063),r=Tr(r,i,s,t,e[11],22,-1990404162),t=Tr(t,r,i,s,e[12],7,1804603682),s=Tr(s,t,r,i,e[13],12,-40341101),i=Tr(i,s,t,r,e[14],17,-1502002290),t=Sr(t,r=Tr(r,i,s,t,e[15],22,1236535329),i,s,e[1],5,-165796510),s=Sr(s,t,r,i,e[6],9,-1069501632),i=Sr(i,s,t,r,e[11],14,643717713),r=Sr(r,i,s,t,e[0],20,-373897302),t=Sr(t,r,i,s,e[5],5,-701558691),s=Sr(s,t,r,i,e[10],9,38016083),i=Sr(i,s,t,r,e[15],14,-660478335),r=Sr(r,i,s,t,e[4],20,-405537848),t=Sr(t,r,i,s,e[9],5,568446438),s=Sr(s,t,r,i,e[14],9,-1019803690),i=Sr(i,s,t,r,e[3],14,-187363961),r=Sr(r,i,s,t,e[8],20,1163531501),t=Sr(t,r,i,s,e[13],5,-1444681467),s=Sr(s,t,r,i,e[2],9,-51403784),i=Sr(i,s,t,r,e[7],14,1735328473),t=Pr(t,r=Sr(r,i,s,t,e[12],20,-1926607734),i,s,e[5],4,-378558),s=Pr(s,t,r,i,e[8],11,-2022574463),i=Pr(i,s,t,r,e[11],16,1839030562),r=Pr(r,i,s,t,e[14],23,-35309556),t=Pr(t,r,i,s,e[1],4,-1530992060),s=Pr(s,t,r,i,e[4],11,1272893353),i=Pr(i,s,t,r,e[7],16,-155497632),r=Pr(r,i,s,t,e[10],23,-1094730640),t=Pr(t,r,i,s,e[13],4,681279174),s=Pr(s,t,r,i,e[0],11,-358537222),i=Pr(i,s,t,r,e[3],16,-722521979),r=Pr(r,i,s,t,e[6],23,76029189),t=Pr(t,r,i,s,e[9],4,-640364487),s=Pr(s,t,r,i,e[12],11,-421815835),i=Pr(i,s,t,r,e[15],16,530742520),t=xr(t,r=Pr(r,i,s,t,e[2],23,-995338651),i,s,e[0],6,-198630844),s=xr(s,t,r,i,e[7],10,1126891415),i=xr(i,s,t,r,e[14],15,-1416354905),r=xr(r,i,s,t,e[5],21,-57434055),t=xr(t,r,i,s,e[12],6,1700485571),s=xr(s,t,r,i,e[3],10,-1894986606),i=xr(i,s,t,r,e[10],15,-1051523),r=xr(r,i,s,t,e[1],21,-2054922799),t=xr(t,r,i,s,e[8],6,1873313359),s=xr(s,t,r,i,e[15],10,-30611744),i=xr(i,s,t,r,e[6],15,-1560198380),r=xr(r,i,s,t,e[13],21,1309151649),t=xr(t,r,i,s,e[4],6,-145523070),s=xr(s,t,r,i,e[11],10,-1120210379),i=xr(i,s,t,r,e[2],15,718787259),r=xr(r,i,s,t,e[9],21,-343485551),n[0]=ca(t,n[0]),n[1]=ca(r,n[1]),n[2]=ca(i,n[2]),n[3]=ca(s,n[3])}function Op(n,e,t,r,i,s){return e=ca(ca(e,n),ca(r,s)),ca(e<<i|e>>>32-i,t)}function Tr(n,e,t,r,i,s,o){return Op(e&t|~e&r,n,e,i,s,o)}function Sr(n,e,t,r,i,s,o){return Op(e&r|t&~r,n,e,i,s,o)}function Pr(n,e,t,r,i,s,o){return Op(e^t^r,n,e,i,s,o)}function xr(n,e,t,r,i,s,o){return Op(t^(e|~r),n,e,i,s,o)}function cE(n){var e,t=n.length,r=[1732584193,-271733879,-1732584194,271733878];for(e=64;e<=n.length;e+=64)Bg(r,c8(n.substring(e-64,e)));n=n.substring(e-64);var i=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];for(e=0;e<n.length;e++)i[e>>2]|=n.charCodeAt(e)<<(e%4<<3);if(i[e>>2]|=128<<(e%4<<3),e>55)for(Bg(r,i),e=0;e<16;e++)i[e]=0;return i[14]=8*t,Bg(r,i),r}function c8(n){var e,t=[];for(e=0;e<64;e+=4)t[e>>2]=n.charCodeAt(e)+(n.charCodeAt(e+1)<<8)+(n.charCodeAt(e+2)<<16)+(n.charCodeAt(e+3)<<24);return t}var Lv="0123456789abcdef".split("");function u8(n){for(var e="",t=0;t<4;t++)e+=Lv[n>>8*t+4&15]+Lv[n>>8*t&15];return e}function l8(n){return String.fromCharCode(255&n,(65280&n)>>8,(16711680&n)>>16,(4278190080&n)>>24)}function zm(n){return cE(n).map(l8).join("")}var h8=(function(n){for(var e=0;e<n.length;e++)n[e]=u8(n[e]);return n.join("")})(cE("hello"))!="5d41402abc4b2a76b9719d911017c592";function ca(n,e){if(h8){var t=(65535&n)+(65535&e);return(n>>16)+(e>>16)+(t>>16)<<16|65535&t}return n+e&4294967295}function $m(n,e){var t,r,i,s;if(n!==t){for(var o=(i=n,s=1+(256/n.length|0),new Array(s+1).join(i)),a=[],c=0;c<256;c++)a[c]=c;var u=0;for(c=0;c<256;c++){var d=a[c];u=(u+d+o.charCodeAt(c))%256,a[c]=a[u],a[u]=d}t=n,r=a}else a=r;var g=e.length,y=0,p=0,S="";for(c=0;c<g;c++)p=(p+(d=a[y=(y+1)%256]))%256,a[y]=a[p],a[p]=d,o=a[(a[y]+a[p])%256],S+=String.fromCharCode(e.charCodeAt(c)^o);return S}var Dv={print:4,modify:8,copy:16,"annot-forms":32};function du(n,e,t,r){this.v=1,this.r=2;var i=192;n.forEach(function(a){if(Dv.perm!==void 0)throw new Error("Invalid permission: "+a);i+=Dv[a]}),this.padding="(N^NuAd\0NV\b..\0h>/\fdSiz";var s=(e+this.padding).substr(0,32),o=(t+this.padding).substr(0,32);this.O=this.processOwnerPassword(s,o),this.P=-(1+(255^i)),this.encryptionKey=zm(s+this.O+this.lsbFirstWord(this.P)+this.hexToBytes(r)).substr(0,5),this.U=$m(this.encryptionKey,this.padding)}function fu(n){if(/[^\u0000-\u00ff]/.test(n))throw new Error("Invalid PDF Name Object: "+n+", Only accept ASCII characters.");for(var e="",t=n.length,r=0;r<t;r++){var i=n.charCodeAt(r);e+=i<33||i===35||i===37||i===40||i===41||i===47||i===60||i===62||i===91||i===93||i===123||i===125||i>126?"#"+("0"+i.toString(16)).slice(-2):n[r]}return e}function Ov(n){if(Zt(n)!=="object")throw new Error("Invalid Context passed to initialize PubSub (jsPDF-module)");var e={};this.subscribe=function(t,r,i){if(i=i||!1,typeof t!="string"||typeof r!="function"||typeof i!="boolean")throw new Error("Invalid arguments passed to PubSub.subscribe (jsPDF-module)");e.hasOwnProperty(t)||(e[t]={});var s=Math.random().toString(35);return e[t][s]=[r,!!i],s},this.unsubscribe=function(t){for(var r in e)if(e[r][t])return delete e[r][t],Object.keys(e[r]).length===0&&delete e[r],!0;return!1},this.publish=function(t){if(e.hasOwnProperty(t)){var r=Array.prototype.slice.call(arguments,1),i=[];for(var s in e[t]){var o=e[t][s];try{o[0].apply(n,r)}catch(a){yt.console&&cn.error("jsPDF PubSub Error",a.message,a)}o[1]&&i.push(s)}i.length&&i.forEach(this.unsubscribe)}},this.getTopics=function(){return e}}function Wf(n){if(!(this instanceof Wf))return new Wf(n);var e="opacity,stroke-opacity".split(",");for(var t in n)n.hasOwnProperty(t)&&e.indexOf(t)>=0&&(this[t]=n[t]);this.id="",this.objectNumber=-1}function uE(n,e){this.gState=n,this.matrix=e,this.id="",this.objectNumber=-1}function ic(n,e,t,r,i){if(!(this instanceof ic))return new ic(n,e,t,r,i);this.type=n==="axial"?2:3,this.coords=e,this.colors=t,uE.call(this,r,i)}function mu(n,e,t,r,i){if(!(this instanceof mu))return new mu(n,e,t,r,i);this.boundingBox=n,this.xStep=e,this.yStep=t,this.stream="",this.cloneIndex=0,uE.call(this,r,i)}function rt(n){var e,t=typeof arguments[0]=="string"?arguments[0]:"p",r=arguments[1],i=arguments[2],s=arguments[3],o=[],a=1,c=16,u="S",d=null;Zt(n=n||{})==="object"&&(t=n.orientation,r=n.unit||r,i=n.format||i,s=n.compress||n.compressPdf||s,(d=n.encryption||null)!==null&&(d.userPassword=d.userPassword||"",d.ownerPassword=d.ownerPassword||"",d.userPermissions=d.userPermissions||[]),a=typeof n.userUnit=="number"?Math.abs(n.userUnit):1,n.precision!==void 0&&(e=n.precision),n.floatPrecision!==void 0&&(c=n.floatPrecision),u=n.defaultPathOperation||"S"),o=n.filters||(s===!0?["FlateEncode"]:o),r=r||"mm",t=(""+(t||"P")).toLowerCase();var g=n.putOnlyUsedFonts||!1,y={},p={internal:{},__private__:{}};p.__private__.PubSub=Ov;var S="1.3",N=p.__private__.getPdfVersion=function(){return S};p.__private__.setPdfVersion=function(m){S=m};var C={a0:[2383.94,3370.39],a1:[1683.78,2383.94],a2:[1190.55,1683.78],a3:[841.89,1190.55],a4:[595.28,841.89],a5:[419.53,595.28],a6:[297.64,419.53],a7:[209.76,297.64],a8:[147.4,209.76],a9:[104.88,147.4],a10:[73.7,104.88],b0:[2834.65,4008.19],b1:[2004.09,2834.65],b2:[1417.32,2004.09],b3:[1000.63,1417.32],b4:[708.66,1000.63],b5:[498.9,708.66],b6:[354.33,498.9],b7:[249.45,354.33],b8:[175.75,249.45],b9:[124.72,175.75],b10:[87.87,124.72],c0:[2599.37,3676.54],c1:[1836.85,2599.37],c2:[1298.27,1836.85],c3:[918.43,1298.27],c4:[649.13,918.43],c5:[459.21,649.13],c6:[323.15,459.21],c7:[229.61,323.15],c8:[161.57,229.61],c9:[113.39,161.57],c10:[79.37,113.39],dl:[311.81,623.62],letter:[612,792],"government-letter":[576,756],legal:[612,1008],"junior-legal":[576,360],ledger:[1224,792],tabloid:[792,1224],"credit-card":[153,243]};p.__private__.getPageFormats=function(){return C};var k=p.__private__.getPageFormat=function(m){return C[m]};i=i||"a4";var K="compat",G="advanced",W=K;function ne(){this.saveGraphicsState(),j(new dt(It,0,0,-It,0,Zi()*It).toString()+" cm"),this.setFontSize(this.getFontSize()/It),u="n",W=G}function de(){this.restoreGraphicsState(),u="S",W=K}var B=p.__private__.combineFontStyleAndFontWeight=function(m,P){if(m=="bold"&&P=="normal"||m=="bold"&&P==400||m=="normal"&&P=="italic"||m=="bold"&&P=="italic")throw new Error("Invalid Combination of fontweight and fontstyle");return P&&(m=P==400||P==="normal"?m==="italic"?"italic":"normal":P!=700&&P!=="bold"||m!=="normal"?(P==700?"bold":P)+""+m:"bold"),m};p.advancedAPI=function(m){var P=W===K;return P&&ne.call(this),typeof m!="function"||(m(this),P&&de.call(this)),this},p.compatAPI=function(m){var P=W===G;return P&&de.call(this),typeof m!="function"||(m(this),P&&ne.call(this)),this},p.isAdvancedAPI=function(){return W===G};var x,A=function(m){if(W!==G)throw new Error(m+" is only available in 'advanced' API mode. You need to call advancedAPI() first.")},F=p.roundToPrecision=p.__private__.roundToPrecision=function(m,P){var q=e||P;if(isNaN(m)||isNaN(q))throw new Error("Invalid argument passed to jsPDF.roundToPrecision");return m.toFixed(q).replace(/0+$/,"")};x=p.hpf=p.__private__.hpf=typeof c=="number"?function(m){if(isNaN(m))throw new Error("Invalid argument passed to jsPDF.hpf");return F(m,c)}:c==="smart"?function(m){if(isNaN(m))throw new Error("Invalid argument passed to jsPDF.hpf");return F(m,m>-1&&m<1?16:5)}:function(m){if(isNaN(m))throw new Error("Invalid argument passed to jsPDF.hpf");return F(m,16)};var b=p.f2=p.__private__.f2=function(m){if(isNaN(m))throw new Error("Invalid argument passed to jsPDF.f2");return F(m,2)},E=p.__private__.f3=function(m){if(isNaN(m))throw new Error("Invalid argument passed to jsPDF.f3");return F(m,3)},T=p.scale=p.__private__.scale=function(m){if(isNaN(m))throw new Error("Invalid argument passed to jsPDF.scale");return W===K?m*It:W===G?m:void 0},J=function(m){return T((function(P){return W===K?Zi()-P:W===G?P:void 0})(m))};p.__private__.setPrecision=p.setPrecision=function(m){typeof parseInt(m,10)=="number"&&(e=parseInt(m,10))};var fe,ye="00000000000000000000000000000000",_e=p.__private__.getFileId=function(){return ye},ce=p.__private__.setFileId=function(m){return ye=m!==void 0&&/^[a-fA-F0-9]{32}$/.test(m)?m.toUpperCase():ye.split("").map(function(){return"ABCDEF0123456789".charAt(Math.floor(16*Math.random()))}).join(""),d!==null&&(vn=new du(d.userPermissions,d.userPassword,d.ownerPassword,ye)),ye};p.setFileId=function(m){return ce(m),this},p.getFileId=function(){return _e()};var ve=p.__private__.convertDateToPDFDate=function(m){var P=m.getTimezoneOffset(),q=P<0?"+":"-",Q=Math.floor(Math.abs(P/60)),re=Math.abs(P%60),be=[q,Y(Q),"'",Y(re),"'"].join("");return["D:",m.getFullYear(),Y(m.getMonth()+1),Y(m.getDate()),Y(m.getHours()),Y(m.getMinutes()),Y(m.getSeconds()),be].join("")},Oe=p.__private__.convertPDFDateToDate=function(m){var P=parseInt(m.substr(2,4),10),q=parseInt(m.substr(6,2),10)-1,Q=parseInt(m.substr(8,2),10),re=parseInt(m.substr(10,2),10),be=parseInt(m.substr(12,2),10),Se=parseInt(m.substr(14,2),10);return new Date(P,q,Q,re,be,Se,0)},xe=p.__private__.setCreationDate=function(m){var P;if(m===void 0&&(m=new Date),m instanceof Date)P=ve(m);else{if(!/^D:(20[0-2][0-9]|203[0-7]|19[7-9][0-9])(0[0-9]|1[0-2])([0-2][0-9]|3[0-1])(0[0-9]|1[0-9]|2[0-3])(0[0-9]|[1-5][0-9])(0[0-9]|[1-5][0-9])(\+0[0-9]|\+1[0-4]|-0[0-9]|-1[0-1])'(0[0-9]|[1-5][0-9])'?$/.test(m))throw new Error("Invalid argument passed to jsPDF.setCreationDate");P=m}return fe=P},O=p.__private__.getCreationDate=function(m){var P=fe;return m==="jsDate"&&(P=Oe(fe)),P};p.setCreationDate=function(m){return xe(m),this},p.getCreationDate=function(m){return O(m)};var H,Y=p.__private__.padd2=function(m){return("0"+parseInt(m)).slice(-2)},X=p.__private__.padd2Hex=function(m){return("00"+(m=m.toString())).substr(m.length)},te=0,ae=[],ge=[],me=0,Ee=[],Le=[],je=!1,Ue=ge;p.__private__.setCustomOutputDestination=function(m){je=!0,Ue=m};var tt=function(m){je||(Ue=m)};p.__private__.resetCustomOutputDestination=function(){je=!1,Ue=ge};var j=p.__private__.out=function(m){return m=m.toString(),me+=m.length+1,Ue.push(m),Ue},Ve=p.__private__.write=function(m){return j(arguments.length===1?m.toString():Array.prototype.join.call(arguments," "))},bt=p.__private__.getArrayBuffer=function(m){for(var P=m.length,q=new ArrayBuffer(P),Q=new Uint8Array(q);P--;)Q[P]=m.charCodeAt(P);return q},at=[["Helvetica","helvetica","normal","WinAnsiEncoding"],["Helvetica-Bold","helvetica","bold","WinAnsiEncoding"],["Helvetica-Oblique","helvetica","italic","WinAnsiEncoding"],["Helvetica-BoldOblique","helvetica","bolditalic","WinAnsiEncoding"],["Courier","courier","normal","WinAnsiEncoding"],["Courier-Bold","courier","bold","WinAnsiEncoding"],["Courier-Oblique","courier","italic","WinAnsiEncoding"],["Courier-BoldOblique","courier","bolditalic","WinAnsiEncoding"],["Times-Roman","times","normal","WinAnsiEncoding"],["Times-Bold","times","bold","WinAnsiEncoding"],["Times-Italic","times","italic","WinAnsiEncoding"],["Times-BoldItalic","times","bolditalic","WinAnsiEncoding"],["ZapfDingbats","zapfdingbats","normal",null],["Symbol","symbol","normal",null]];p.__private__.getStandardFonts=function(){return at};var Te=n.fontSize||16;p.__private__.setFontSize=p.setFontSize=function(m){return Te=W===G?m/It:m,this};var $e,ze=p.__private__.getFontSize=p.getFontSize=function(){return W===K?Te:Te*It},ct=n.R2L||!1;p.__private__.setR2L=p.setR2L=function(m){return ct=m,this},p.__private__.getR2L=p.getR2L=function(){return ct};var it,$t=p.__private__.setZoomMode=function(m){if(/^(?:\d+\.\d*|\d*\.\d+|\d+)%$/.test(m))$e=m;else if(isNaN(m)){if([void 0,null,"fullwidth","fullheight","fullpage","original"].indexOf(m)===-1)throw new Error('zoom must be Integer (e.g. 2), a percentage Value (e.g. 300%) or fullwidth, fullheight, fullpage, original. "'+m+'" is not recognized.');$e=m}else $e=parseInt(m,10)};p.__private__.getZoomMode=function(){return $e};var Pt,_t=p.__private__.setPageMode=function(m){if([void 0,null,"UseNone","UseOutlines","UseThumbs","FullScreen"].indexOf(m)==-1)throw new Error('Page mode must be one of UseNone, UseOutlines, UseThumbs, or FullScreen. "'+m+'" is not recognized.');it=m};p.__private__.getPageMode=function(){return it};var Lt=p.__private__.setLayoutMode=function(m){if([void 0,null,"continuous","single","twoleft","tworight","two"].indexOf(m)==-1)throw new Error('Layout mode must be one of continuous, single, twoleft, tworight. "'+m+'" is not recognized.');Pt=m};p.__private__.getLayoutMode=function(){return Pt},p.__private__.setDisplayMode=p.setDisplayMode=function(m,P,q){return $t(m),Lt(P),_t(q),this};var kt={title:"",subject:"",author:"",keywords:"",creator:""};p.__private__.getDocumentProperty=function(m){if(Object.keys(kt).indexOf(m)===-1)throw new Error("Invalid argument passed to jsPDF.getDocumentProperty");return kt[m]},p.__private__.getDocumentProperties=function(){return kt},p.__private__.setDocumentProperties=p.setProperties=p.setDocumentProperties=function(m){for(var P in kt)kt.hasOwnProperty(P)&&m[P]&&(kt[P]=m[P]);return this},p.__private__.setDocumentProperty=function(m,P){if(Object.keys(kt).indexOf(m)===-1)throw new Error("Invalid arguments passed to jsPDF.setDocumentProperty");return kt[m]=P};var Je,It,Ze,An,Ct,Et={},Tt={},Wt=[],st={},Kt={},ht={},gt={},rn=null,ut=0,lt=[],Ft=new Ov(p),fi=n.hotfixes||[],ir={},Gi={},dr=[],dt=function m(P,q,Q,re,be,Se){if(!(this instanceof m))return new m(P,q,Q,re,be,Se);isNaN(P)&&(P=1),isNaN(q)&&(q=0),isNaN(Q)&&(Q=0),isNaN(re)&&(re=1),isNaN(be)&&(be=0),isNaN(Se)&&(Se=0),this._matrix=[P,q,Q,re,be,Se]};Object.defineProperty(dt.prototype,"sx",{get:function(){return this._matrix[0]},set:function(m){this._matrix[0]=m}}),Object.defineProperty(dt.prototype,"shy",{get:function(){return this._matrix[1]},set:function(m){this._matrix[1]=m}}),Object.defineProperty(dt.prototype,"shx",{get:function(){return this._matrix[2]},set:function(m){this._matrix[2]=m}}),Object.defineProperty(dt.prototype,"sy",{get:function(){return this._matrix[3]},set:function(m){this._matrix[3]=m}}),Object.defineProperty(dt.prototype,"tx",{get:function(){return this._matrix[4]},set:function(m){this._matrix[4]=m}}),Object.defineProperty(dt.prototype,"ty",{get:function(){return this._matrix[5]},set:function(m){this._matrix[5]=m}}),Object.defineProperty(dt.prototype,"a",{get:function(){return this._matrix[0]},set:function(m){this._matrix[0]=m}}),Object.defineProperty(dt.prototype,"b",{get:function(){return this._matrix[1]},set:function(m){this._matrix[1]=m}}),Object.defineProperty(dt.prototype,"c",{get:function(){return this._matrix[2]},set:function(m){this._matrix[2]=m}}),Object.defineProperty(dt.prototype,"d",{get:function(){return this._matrix[3]},set:function(m){this._matrix[3]=m}}),Object.defineProperty(dt.prototype,"e",{get:function(){return this._matrix[4]},set:function(m){this._matrix[4]=m}}),Object.defineProperty(dt.prototype,"f",{get:function(){return this._matrix[5]},set:function(m){this._matrix[5]=m}}),Object.defineProperty(dt.prototype,"rotation",{get:function(){return Math.atan2(this.shx,this.sx)}}),Object.defineProperty(dt.prototype,"scaleX",{get:function(){return this.decompose().scale.sx}}),Object.defineProperty(dt.prototype,"scaleY",{get:function(){return this.decompose().scale.sy}}),Object.defineProperty(dt.prototype,"isIdentity",{get:function(){return this.sx===1&&this.shy===0&&this.shx===0&&this.sy===1&&this.tx===0&&this.ty===0}}),dt.prototype.join=function(m){return[this.sx,this.shy,this.shx,this.sy,this.tx,this.ty].map(x).join(m)},dt.prototype.multiply=function(m){var P=m.sx*this.sx+m.shy*this.shx,q=m.sx*this.shy+m.shy*this.sy,Q=m.shx*this.sx+m.sy*this.shx,re=m.shx*this.shy+m.sy*this.sy,be=m.tx*this.sx+m.ty*this.shx+this.tx,Se=m.tx*this.shy+m.ty*this.sy+this.ty;return new dt(P,q,Q,re,be,Se)},dt.prototype.decompose=function(){var m=this.sx,P=this.shy,q=this.shx,Q=this.sy,re=this.tx,be=this.ty,Se=Math.sqrt(m*m+P*P),We=(m/=Se)*q+(P/=Se)*Q;q-=m*We,Q-=P*We;var Ye=Math.sqrt(q*q+Q*Q);return We/=Ye,m*(Q/=Ye)<P*(q/=Ye)&&(m=-m,P=-P,We=-We,Se=-Se),{scale:new dt(Se,0,0,Ye,0,0),translate:new dt(1,0,0,1,re,be),rotate:new dt(m,P,-P,m,0,0),skew:new dt(1,0,We,1,0,0)}},dt.prototype.toString=function(m){return this.join(" ")},dt.prototype.inversed=function(){var m=this.sx,P=this.shy,q=this.shx,Q=this.sy,re=this.tx,be=this.ty,Se=1/(m*Q-P*q),We=Q*Se,Ye=-P*Se,pt=-q*Se,ot=m*Se;return new dt(We,Ye,pt,ot,-We*re-pt*be,-Ye*re-ot*be)},dt.prototype.applyToPoint=function(m){var P=m.x*this.sx+m.y*this.shx+this.tx,q=m.x*this.shy+m.y*this.sy+this.ty;return new Br(P,q)},dt.prototype.applyToRectangle=function(m){var P=this.applyToPoint(m),q=this.applyToPoint(new Br(m.x+m.w,m.y+m.h));return new Fo(P.x,P.y,q.x-P.x,q.y-P.y)},dt.prototype.clone=function(){var m=this.sx,P=this.shy,q=this.shx,Q=this.sy,re=this.tx,be=this.ty;return new dt(m,P,q,Q,re,be)},p.Matrix=dt;var Ki=p.matrixMult=function(m,P){return P.multiply(m)},Jr=new dt(1,0,0,1,0,0);p.unitMatrix=p.identityMatrix=Jr;var Lr=function(m,P){if(!Kt[m]){var q=(P instanceof ic?"Sh":"P")+(Object.keys(st).length+1).toString(10);P.id=q,Kt[m]=q,st[q]=P,Ft.publish("addPattern",P)}};p.ShadingPattern=ic,p.TilingPattern=mu,p.addShadingPattern=function(m,P){return A("addShadingPattern()"),Lr(m,P),this},p.beginTilingPattern=function(m){A("beginTilingPattern()"),Is(m.boundingBox[0],m.boundingBox[1],m.boundingBox[2]-m.boundingBox[0],m.boundingBox[3]-m.boundingBox[1],m.matrix)},p.endTilingPattern=function(m,P){A("endTilingPattern()"),P.stream=Le[H].join(`
`),Lr(m,P),Ft.publish("endTilingPattern",P),dr.pop().restore()};var Dr,un=p.__private__.newObject=function(){var m=En();return Qn(m,!0),m},En=p.__private__.newObjectDeferred=function(){return te++,ae[te]=function(){return me},te},Qn=function(m,P){return P=typeof P=="boolean"&&P,ae[m]=me,P&&j(m+" 0 obj"),m},wr=p.__private__.newAdditionalObject=function(){var m={objId:En(),content:""};return Ee.push(m),m},Yi=En(),Qr=En(),Xr=p.__private__.decodeColorString=function(m){var P=m.split(" ");if(P.length!==2||P[1]!=="g"&&P[1]!=="G")P.length!==5||P[4]!=="k"&&P[4]!=="K"||(P=[(1-P[0])*(1-P[3]),(1-P[1])*(1-P[3]),(1-P[2])*(1-P[3]),"r"]);else{var q=parseFloat(P[0]);P=[q,q,q,"r"]}for(var Q="#",re=0;re<3;re++)Q+=("0"+Math.floor(255*parseFloat(P[re])).toString(16)).slice(-2);return Q},Or=p.__private__.encodeColorString=function(m){var P;typeof m=="string"&&(m={ch1:m});var q=m.ch1,Q=m.ch2,re=m.ch3,be=m.ch4,Se=m.pdfColorType==="draw"?["G","RG","K"]:["g","rg","k"];if(typeof q=="string"&&q.charAt(0)!=="#"){var We=new aE(q);if(We.ok)q=We.toHex();else if(!/^\d*\.?\d*$/.test(q))throw new Error('Invalid color "'+q+'" passed to jsPDF.encodeColorString.')}if(typeof q=="string"&&/^#[0-9A-Fa-f]{3}$/.test(q)&&(q="#"+q[1]+q[1]+q[2]+q[2]+q[3]+q[3]),typeof q=="string"&&/^#[0-9A-Fa-f]{6}$/.test(q)){var Ye=parseInt(q.substr(1),16);q=Ye>>16&255,Q=Ye>>8&255,re=255&Ye}if(Q===void 0||be===void 0&&q===Q&&Q===re)P=typeof q=="string"?q+" "+Se[0]:m.precision===2?b(q/255)+" "+Se[0]:E(q/255)+" "+Se[0];else if(be===void 0||Zt(be)==="object"){if(be&&!isNaN(be.a)&&be.a===0)return["1.","1.","1.",Se[1]].join(" ");P=typeof q=="string"?[q,Q,re,Se[1]].join(" "):m.precision===2?[b(q/255),b(Q/255),b(re/255),Se[1]].join(" "):[E(q/255),E(Q/255),E(re/255),Se[1]].join(" ")}else P=typeof q=="string"?[q,Q,re,be,Se[2]].join(" "):m.precision===2?[b(q),b(Q),b(re),b(be),Se[2]].join(" "):[E(q),E(Q),E(re),E(be),Se[2]].join(" ");return P},Zr=p.__private__.getFilters=function(){return o},ei=p.__private__.putStream=function(m){var P=(m=m||{}).data||"",q=m.filters||Zr(),Q=m.alreadyAppliedFilters||[],re=m.addLength1||!1,be=P.length,Se=m.objectId,We=function(v){return v};if(d!==null&&Se===void 0)throw new Error("ObjectId must be passed to putStream for file encryption");d!==null&&(We=vn.encryptor(Se,0));var Ye={};q===!0&&(q=["FlateEncode"]);var pt=m.additionalKeyValues||[],ot=(Ye=rt.API.processDataByFilters!==void 0?rt.API.processDataByFilters(P,q):{data:P,reverseChain:[]}).reverseChain+(Array.isArray(Q)?Q.join(" "):Q.toString());if(Ye.data.length!==0&&(pt.push({key:"Length",value:Ye.data.length}),re===!0&&pt.push({key:"Length1",value:be})),ot.length!=0)if(ot.split("/").length-1==1)pt.push({key:"Filter",value:ot});else{pt.push({key:"Filter",value:"["+ot+"]"});for(var Mt=0;Mt<pt.length;Mt+=1)if(pt[Mt].key==="DecodeParms"){for(var dn=[],sn=0;sn<Ye.reverseChain.split("/").length-1;sn+=1)dn.push("null");dn.push(pt[Mt].value),pt[Mt].value="["+dn.join(" ")+"]"}}j("<<");for(var h=0;h<pt.length;h++)j("/"+pt[h].key+" "+pt[h].value);j(">>"),Ye.data.length!==0&&(j("stream"),j(We(Ye.data)),j("endstream"))},gs=p.__private__.putPage=function(m){var P=m.number,q=m.data,Q=m.objId,re=m.contentsObjId;Qn(Q,!0),j("<</Type /Page"),j("/Parent "+m.rootDictionaryObjId+" 0 R"),j("/Resources "+m.resourceDictionaryObjId+" 0 R"),j("/MediaBox ["+parseFloat(x(m.mediaBox.bottomLeftX))+" "+parseFloat(x(m.mediaBox.bottomLeftY))+" "+x(m.mediaBox.topRightX)+" "+x(m.mediaBox.topRightY)+"]"),m.cropBox!==null&&j("/CropBox ["+x(m.cropBox.bottomLeftX)+" "+x(m.cropBox.bottomLeftY)+" "+x(m.cropBox.topRightX)+" "+x(m.cropBox.topRightY)+"]"),m.bleedBox!==null&&j("/BleedBox ["+x(m.bleedBox.bottomLeftX)+" "+x(m.bleedBox.bottomLeftY)+" "+x(m.bleedBox.topRightX)+" "+x(m.bleedBox.topRightY)+"]"),m.trimBox!==null&&j("/TrimBox ["+x(m.trimBox.bottomLeftX)+" "+x(m.trimBox.bottomLeftY)+" "+x(m.trimBox.topRightX)+" "+x(m.trimBox.topRightY)+"]"),m.artBox!==null&&j("/ArtBox ["+x(m.artBox.bottomLeftX)+" "+x(m.artBox.bottomLeftY)+" "+x(m.artBox.topRightX)+" "+x(m.artBox.topRightY)+"]"),typeof m.userUnit=="number"&&m.userUnit!==1&&j("/UserUnit "+m.userUnit),Ft.publish("putPage",{objId:Q,pageContext:lt[P],pageNumber:P,page:q}),j("/Contents "+re+" 0 R"),j(">>"),j("endobj");var be=q.join(`
`);return W===G&&(be+=`
Q`),Qn(re,!0),ei({data:be,filters:Zr(),objectId:re}),j("endobj"),Q},Ni=p.__private__.putPages=function(){var m,P,q=[];for(m=1;m<=ut;m++)lt[m].objId=En(),lt[m].contentsObjId=En();for(m=1;m<=ut;m++)q.push(gs({number:m,data:Le[m],objId:lt[m].objId,contentsObjId:lt[m].contentsObjId,mediaBox:lt[m].mediaBox,cropBox:lt[m].cropBox,bleedBox:lt[m].bleedBox,trimBox:lt[m].trimBox,artBox:lt[m].artBox,userUnit:lt[m].userUnit,rootDictionaryObjId:Yi,resourceDictionaryObjId:Qr}));Qn(Yi,!0),j("<</Type /Pages");var Q="/Kids [";for(P=0;P<ut;P++)Q+=q[P]+" 0 R ";j(Q+"]"),j("/Count "+ut),j(">>"),j("endobj"),Ft.publish("postPutPages")},ki=function(m){Ft.publish("putFont",{font:m,out:j,newObject:un,putStream:ei}),m.isAlreadyPutted!==!0&&(m.objectNumber=un(),j("<<"),j("/Type /Font"),j("/BaseFont /"+fu(m.postScriptName)),j("/Subtype /Type1"),typeof m.encoding=="string"&&j("/Encoding /"+m.encoding),j("/FirstChar 32"),j("/LastChar 255"),j(">>"),j("endobj"))},Ys=function(m){m.objectNumber=un();var P=[];P.push({key:"Type",value:"/XObject"}),P.push({key:"Subtype",value:"/Form"}),P.push({key:"BBox",value:"["+[x(m.x),x(m.y),x(m.x+m.width),x(m.y+m.height)].join(" ")+"]"}),P.push({key:"Matrix",value:"["+m.matrix.toString()+"]"});var q=m.pages[1].join(`
`);ei({data:q,additionalKeyValues:P,objectId:m.objectNumber}),j("endobj")},ms=function(m,P){P||(P=21);var q=un(),Q=(function(Se,We){var Ye,pt=[],ot=1/(We-1);for(Ye=0;Ye<1;Ye+=ot)pt.push(Ye);if(pt.push(1),Se[0].offset!=0){var Mt={offset:0,color:Se[0].color};Se.unshift(Mt)}if(Se[Se.length-1].offset!=1){var dn={offset:1,color:Se[Se.length-1].color};Se.push(dn)}for(var sn="",h=0,v=0;v<pt.length;v++){for(Ye=pt[v];Ye>Se[h+1].offset;)h++;var I=Se[h].offset,V=(Ye-I)/(Se[h+1].offset-I),ie=Se[h].color,he=Se[h+1].color;sn+=X(Math.round((1-V)*ie[0]+V*he[0]).toString(16))+X(Math.round((1-V)*ie[1]+V*he[1]).toString(16))+X(Math.round((1-V)*ie[2]+V*he[2]).toString(16))}return sn.trim()})(m.colors,P),re=[];re.push({key:"FunctionType",value:"0"}),re.push({key:"Domain",value:"[0.0 1.0]"}),re.push({key:"Size",value:"["+P+"]"}),re.push({key:"BitsPerSample",value:"8"}),re.push({key:"Range",value:"[0.0 1.0 0.0 1.0 0.0 1.0]"}),re.push({key:"Decode",value:"[0.0 1.0 0.0 1.0 0.0 1.0]"}),ei({data:Q,additionalKeyValues:re,alreadyAppliedFilters:["/ASCIIHexDecode"],objectId:q}),j("endobj"),m.objectNumber=un(),j("<< /ShadingType "+m.type),j("/ColorSpace /DeviceRGB");var be="/Coords ["+x(parseFloat(m.coords[0]))+" "+x(parseFloat(m.coords[1]))+" ";m.type===2?be+=x(parseFloat(m.coords[2]))+" "+x(parseFloat(m.coords[3])):be+=x(parseFloat(m.coords[2]))+" "+x(parseFloat(m.coords[3]))+" "+x(parseFloat(m.coords[4]))+" "+x(parseFloat(m.coords[5])),j(be+="]"),m.matrix&&j("/Matrix ["+m.matrix.toString()+"]"),j("/Function "+q+" 0 R"),j("/Extend [true true]"),j(">>"),j("endobj")},Ci=function(m,P){var q=En(),Q=un();P.push({resourcesOid:q,objectOid:Q}),m.objectNumber=Q;var re=[];re.push({key:"Type",value:"/Pattern"}),re.push({key:"PatternType",value:"1"}),re.push({key:"PaintType",value:"1"}),re.push({key:"TilingType",value:"1"}),re.push({key:"BBox",value:"["+m.boundingBox.map(x).join(" ")+"]"}),re.push({key:"XStep",value:x(m.xStep)}),re.push({key:"YStep",value:x(m.yStep)}),re.push({key:"Resources",value:q+" 0 R"}),m.matrix&&re.push({key:"Matrix",value:"["+m.matrix.toString()+"]"}),ei({data:m.stream,additionalKeyValues:re,objectId:m.objectNumber}),j("endobj")},Ji=function(m){for(var P in m.objectNumber=un(),j("<<"),m)switch(P){case"opacity":j("/ca "+b(m[P]));break;case"stroke-opacity":j("/CA "+b(m[P]))}j(">>"),j("endobj")},Js=function(m){Qn(m.resourcesOid,!0),j("<<"),j("/ProcSet [/PDF /Text /ImageB /ImageC /ImageI]"),(function(){for(var P in j("/Font <<"),Et)Et.hasOwnProperty(P)&&(g===!1||g===!0&&y.hasOwnProperty(P))&&j("/"+P+" "+Et[P].objectNumber+" 0 R");j(">>")})(),(function(){if(Object.keys(st).length>0){for(var P in j("/Shading <<"),st)st.hasOwnProperty(P)&&st[P]instanceof ic&&st[P].objectNumber>=0&&j("/"+P+" "+st[P].objectNumber+" 0 R");Ft.publish("putShadingPatternDict"),j(">>")}})(),(function(P){if(Object.keys(st).length>0){for(var q in j("/Pattern <<"),st)st.hasOwnProperty(q)&&st[q]instanceof p.TilingPattern&&st[q].objectNumber>=0&&st[q].objectNumber<P&&j("/"+q+" "+st[q].objectNumber+" 0 R");Ft.publish("putTilingPatternDict"),j(">>")}})(m.objectOid),(function(){if(Object.keys(ht).length>0){var P;for(P in j("/ExtGState <<"),ht)ht.hasOwnProperty(P)&&ht[P].objectNumber>=0&&j("/"+P+" "+ht[P].objectNumber+" 0 R");Ft.publish("putGStateDict"),j(">>")}})(),(function(){for(var P in j("/XObject <<"),ir)ir.hasOwnProperty(P)&&ir[P].objectNumber>=0&&j("/"+P+" "+ir[P].objectNumber+" 0 R");Ft.publish("putXobjectDict"),j(">>")})(),j(">>"),j("endobj")},Vc=function(m){Tt[m.fontName]=Tt[m.fontName]||{},Tt[m.fontName][m.fontStyle]=m.id},Da=function(m,P,q,Q,re){var be={id:"F"+(Object.keys(Et).length+1).toString(10),postScriptName:m,fontName:P,fontStyle:q,encoding:Q,isStandardFont:re||!1,metadata:{}};return Ft.publish("addFont",{font:be,instance:this}),Et[be.id]=be,Vc(be),be.id},Fr=p.__private__.pdfEscape=p.pdfEscape=function(m,P){return(function(q,Q){var re,be,Se,We,Ye,pt,ot,Mt,dn;if(Se=(Q=Q||{}).sourceEncoding||"Unicode",Ye=Q.outputEncoding,(Q.autoencode||Ye)&&Et[Je].metadata&&Et[Je].metadata[Se]&&Et[Je].metadata[Se].encoding&&(We=Et[Je].metadata[Se].encoding,!Ye&&Et[Je].encoding&&(Ye=Et[Je].encoding),!Ye&&We.codePages&&(Ye=We.codePages[0]),typeof Ye=="string"&&(Ye=We[Ye]),Ye)){for(ot=!1,pt=[],re=0,be=q.length;re<be;re++)(Mt=Ye[q.charCodeAt(re)])?pt.push(String.fromCharCode(Mt)):pt.push(q[re]),pt[re].charCodeAt(0)>>8&&(ot=!0);q=pt.join("")}for(re=q.length;ot===void 0&&re!==0;)q.charCodeAt(re-1)>>8&&(ot=!0),re--;if(!ot)return q;for(pt=Q.noBOM?[]:[254,255],re=0,be=q.length;re<be;re++){if((dn=(Mt=q.charCodeAt(re))>>8)>>8)throw new Error("Character at position "+re+" of string '"+q+"' exceeds 16bits. Cannot be encoded into UCS-2 BE");pt.push(dn),pt.push(Mt-(dn<<8))}return String.fromCharCode.apply(void 0,pt)})(m,P).replace(/\\/g,"\\\\").replace(/\(/g,"\\(").replace(/\)/g,"\\)")},Ro=p.__private__.beginPage=function(m){Le[++ut]=[],lt[ut]={objId:0,contentsObjId:0,userUnit:Number(a),artBox:null,bleedBox:null,cropBox:null,trimBox:null,mediaBox:{bottomLeftX:0,bottomLeftY:0,topRightX:Number(m[0]),topRightY:Number(m[1])}},Oa(ut),tt(Le[H])},No=function(m,P){var q,Q,re;switch(t=P||t,typeof m=="string"&&(q=k(m.toLowerCase()),Array.isArray(q)&&(Q=q[0],re=q[1])),Array.isArray(m)&&(Q=m[0]*It,re=m[1]*It),isNaN(Q)&&(Q=i[0],re=i[1]),(Q>14400||re>14400)&&(cn.warn("A page in a PDF can not be wider or taller than 14400 userUnit. jsPDF limits the width/height to 14400"),Q=Math.min(14400,Q),re=Math.min(14400,re)),i=[Q,re],t.substr(0,1)){case"l":re>Q&&(i=[re,Q]);break;case"p":Q>re&&(i=[re,Q])}Ro(i),mt(ii),j(Lo),si!==0&&j(si+" J"),Oo!==0&&j(Oo+" j"),Ft.publish("addPage",{pageNumber:ut})},Qs=function(m){m>0&&m<=ut&&(Le.splice(m,1),lt.splice(m,1),ut--,H>ut&&(H=ut),this.setPage(H))},Oa=function(m){m>0&&m<=ut&&(H=m)},Fa=p.__private__.getNumberOfPages=p.getNumberOfPages=function(){return Le.length-1},Ma=function(m,P,q){var Q,re=void 0;return q=q||{},m=m!==void 0?m:Et[Je].fontName,P=P!==void 0?P:Et[Je].fontStyle,Q=m.toLowerCase(),Tt[Q]!==void 0&&Tt[Q][P]!==void 0?re=Tt[Q][P]:Tt[m]!==void 0&&Tt[m][P]!==void 0?re=Tt[m][P]:q.disableWarning===!1&&cn.warn("Unable to look up font label for font '"+m+"', '"+P+"'. Refer to getFontList() for available fonts."),re||q.noFallback||(re=Tt.times[P])==null&&(re=Tt.times.normal),re},Li=p.__private__.putInfo=function(){var m=un(),P=function(Q){return Q};for(var q in d!==null&&(P=vn.encryptor(m,0)),j("<<"),j("/Producer ("+Fr(P("jsPDF "+rt.version))+")"),kt)kt.hasOwnProperty(q)&&kt[q]&&j("/"+q.substr(0,1).toUpperCase()+q.substr(1)+" ("+Fr(P(kt[q]))+")");j("/CreationDate ("+Fr(P(fe))+")"),j(">>"),j("endobj")},Mr=p.__private__.putCatalog=function(m){var P=(m=m||{}).rootDictionaryObjId||Yi;switch(un(),j("<<"),j("/Type /Catalog"),j("/Pages "+P+" 0 R"),$e||($e="fullwidth"),$e){case"fullwidth":j("/OpenAction [3 0 R /FitH null]");break;case"fullheight":j("/OpenAction [3 0 R /FitV null]");break;case"fullpage":j("/OpenAction [3 0 R /Fit]");break;case"original":j("/OpenAction [3 0 R /XYZ null null 1]");break;default:var q=""+$e;q.substr(q.length-1)==="%"&&($e=parseInt($e)/100),typeof $e=="number"&&j("/OpenAction [3 0 R /XYZ null null "+b($e)+"]")}switch(Pt||(Pt="continuous"),Pt){case"continuous":j("/PageLayout /OneColumn");break;case"single":j("/PageLayout /SinglePage");break;case"two":case"twoleft":j("/PageLayout /TwoColumnLeft");break;case"tworight":j("/PageLayout /TwoColumnRight")}it&&j("/PageMode /"+it),Ft.publish("putCatalog"),j(">>"),j("endobj")},ti=p.__private__.putTrailer=function(){j("trailer"),j("<<"),j("/Size "+(te+1)),j("/Root "+te+" 0 R"),j("/Info "+(te-1)+" 0 R"),d!==null&&j("/Encrypt "+vn.oid+" 0 R"),j("/ID [ <"+ye+"> <"+ye+"> ]"),j(">>")},ln=p.__private__.putHeader=function(){j("%PDF-"+S),j("%")},ys=p.__private__.putXRef=function(){var m="0000000000";j("xref"),j("0 "+(te+1)),j("0000000000 65535 f ");for(var P=1;P<=te;P++)typeof ae[P]=="function"?j((m+ae[P]()).slice(-10)+" 00000 n "):ae[P]!==void 0?j((m+ae[P]).slice(-10)+" 00000 n "):j("0000000000 00000 n ")},ni=p.__private__.buildDocument=function(){var m;te=0,me=0,ge=[],ae=[],Ee=[],Yi=En(),Qr=En(),tt(ge),Ft.publish("buildDocument"),ln(),Ni(),(function(){Ft.publish("putAdditionalObjects");for(var q=0;q<Ee.length;q++){var Q=Ee[q];Qn(Q.objId,!0),j(Q.content),j("endobj")}Ft.publish("postPutAdditionalObjects")})(),m=[],(function(){for(var q in Et)Et.hasOwnProperty(q)&&(g===!1||g===!0&&y.hasOwnProperty(q))&&ki(Et[q])})(),(function(){var q;for(q in ht)ht.hasOwnProperty(q)&&Ji(ht[q])})(),(function(){for(var q in ir)ir.hasOwnProperty(q)&&Ys(ir[q])})(),(function(q){var Q;for(Q in st)st.hasOwnProperty(Q)&&(st[Q]instanceof ic?ms(st[Q]):st[Q]instanceof mu&&Ci(st[Q],q))})(m),Ft.publish("putResources"),m.forEach(Js),Js({resourcesOid:Qr,objectOid:Number.MAX_SAFE_INTEGER}),Ft.publish("postPutResources"),d!==null&&(vn.oid=un(),j("<<"),j("/Filter /Standard"),j("/V "+vn.v),j("/R "+vn.r),j("/U <"+vn.toHexString(vn.U)+">"),j("/O <"+vn.toHexString(vn.O)+">"),j("/P "+vn.P),j(">>"),j("endobj")),Li(),Mr();var P=me;return ys(),ti(),j("startxref"),j(""+P),j("%%EOF"),tt(Le[H]),ge.join(`
`)},Ht=p.__private__.getBlob=function(m){return new Blob([bt(m)],{type:"application/pdf"})},Xs=p.output=p.__private__.output=(Dr=function(m,P){switch(typeof(P=P||{})=="string"?P={filename:P}:P.filename=P.filename||"generated.pdf",m){case void 0:return ni();case"save":p.save(P.filename);break;case"arraybuffer":return bt(ni());case"blob":return Ht(ni());case"bloburi":case"bloburl":if(yt.URL!==void 0&&typeof yt.URL.createObjectURL=="function")return yt.URL&&yt.URL.createObjectURL(Ht(ni()))||void 0;cn.warn("bloburl is not supported by your system, because URL.createObjectURL is not supported by your browser.");break;case"datauristring":case"dataurlstring":var q="",Q=ni();try{q=Cv(Q)}catch{q=Cv(unescape(encodeURIComponent(Q)))}return"data:application/pdf;filename="+P.filename+";base64,"+q;case"pdfobjectnewwindow":if(Object.prototype.toString.call(yt)==="[object Window]"){var re="https://cdnjs.cloudflare.com/ajax/libs/pdfobject/2.1.1/pdfobject.min.js",be=' integrity="sha512-4ze/a9/4jqu+tX9dfOqJYSvyYd5M6qum/3HpCLr+/Jqf0whc37VUbkpNGHR7/8pSnCFw47T1fmIpwBV7UySh3g==" crossorigin="anonymous"';P.pdfObjectUrl&&(re=P.pdfObjectUrl,be="");var Se='<html><style>html, body { padding: 0; margin: 0; } iframe { width: 100%; height: 100%; border: 0;}  </style><body><script src="'+re+'"'+be+'><\/script><script >PDFObject.embed("'+this.output("dataurlstring")+'", '+JSON.stringify(P)+");<\/script></body></html>",We=yt.open();return We!==null&&We.document.write(Se),We}throw new Error("The option pdfobjectnewwindow just works in a browser-environment.");case"pdfjsnewwindow":if(Object.prototype.toString.call(yt)==="[object Window]"){var Ye='<html><style>html, body { padding: 0; margin: 0; } iframe { width: 100%; height: 100%; border: 0;}  </style><body><iframe id="pdfViewer" src="'+(P.pdfJsUrl||"examples/PDF.js/web/viewer.html")+"?file=&downloadName="+P.filename+'" width="500px" height="400px" /></body></html>',pt=yt.open();if(pt!==null){pt.document.write(Ye);var ot=this;pt.document.documentElement.querySelector("#pdfViewer").onload=function(){pt.document.title=P.filename,pt.document.documentElement.querySelector("#pdfViewer").contentWindow.PDFViewerApplication.open(ot.output("bloburl"))}}return pt}throw new Error("The option pdfjsnewwindow just works in a browser-environment.");case"dataurlnewwindow":if(Object.prototype.toString.call(yt)!=="[object Window]")throw new Error("The option dataurlnewwindow just works in a browser-environment.");var Mt='<html><style>html, body { padding: 0; margin: 0; } iframe { width: 100%; height: 100%; border: 0;}  </style><body><iframe src="'+this.output("datauristring",P)+'"></iframe></body></html>',dn=yt.open();if(dn!==null&&(dn.document.write(Mt),dn.document.title=P.filename),dn||typeof safari>"u")return dn;break;case"datauri":case"dataurl":return yt.document.location.href=this.output("datauristring",P);default:return null}},Dr.foo=function(){try{return Dr.apply(this,arguments)}catch(q){var m=q.stack||"";~m.indexOf(" at ")&&(m=m.split(" at ")[1]);var P="Error in function "+m.split(`
`)[0].split("<")[0]+": "+q.message;if(!yt.console)throw new Error(P);yt.console.error(P,q),yt.alert&&alert(P)}},Dr.foo.bar=Dr,Dr.foo),sr=function(m){return Array.isArray(fi)===!0&&fi.indexOf(m)>-1};switch(r){case"pt":It=1;break;case"mm":It=72/25.4;break;case"cm":It=72/2.54;break;case"in":It=72;break;case"px":It=sr("px_scaling")==1?.75:96/72;break;case"pc":case"em":It=12;break;case"ex":It=6;break;default:if(typeof r!="number")throw new Error("Invalid unit: "+r);It=r}var vn=null;xe(),ce();var Qi=p.__private__.getPageInfo=p.getPageInfo=function(m){if(isNaN(m)||m%1!=0)throw new Error("Invalid argument passed to jsPDF.getPageInfo");return{objId:lt[m].objId,pageNumber:m,pageContext:lt[m]}},Va=p.__private__.getPageInfoByObjId=function(m){if(isNaN(m)||m%1!=0)throw new Error("Invalid argument passed to jsPDF.getPageInfoByObjId");for(var P in lt)if(lt[P].objId===m)break;return Qi(P)},fl=p.__private__.getCurrentPageInfo=p.getCurrentPageInfo=function(){return{objId:lt[H].objId,pageNumber:H,pageContext:lt[H]}};p.addPage=function(){return No.apply(this,arguments),this},p.setPage=function(){return Oa.apply(this,arguments),tt.call(this,Le[H]),this},p.insertPage=function(m){return this.addPage(),this.movePage(H,m),this},p.movePage=function(m,P){var q,Q;if(m>P){q=Le[m],Q=lt[m];for(var re=m;re>P;re--)Le[re]=Le[re-1],lt[re]=lt[re-1];Le[P]=q,lt[P]=Q,this.setPage(P)}else if(m<P){q=Le[m],Q=lt[m];for(var be=m;be<P;be++)Le[be]=Le[be+1],lt[be]=lt[be+1];Le[P]=q,lt[P]=Q,this.setPage(P)}return this},p.deletePage=function(){return Qs.apply(this,arguments),this},p.__private__.text=p.text=function(m,P,q,Q,re){var be,Se,We,Ye,pt,ot,Mt,dn,sn,h=(Q=Q||{}).scope||this;if(typeof m=="number"&&typeof P=="number"&&(typeof q=="string"||Array.isArray(q))){var v=q;q=P,P=m,m=v}if(arguments[3]instanceof dt==0?(We=arguments[4],Ye=arguments[5],Zt(Mt=arguments[3])==="object"&&Mt!==null||(typeof We=="string"&&(Ye=We,We=null),typeof Mt=="string"&&(Ye=Mt,Mt=null),typeof Mt=="number"&&(We=Mt,Mt=null),Q={flags:Mt,angle:We,align:Ye})):(A("The transform parameter of text() with a Matrix value"),sn=re),isNaN(P)||isNaN(q)||m==null)throw new Error("Invalid arguments passed to jsPDF.text");if(m.length===0)return h;var I,V="",ie=typeof Q.lineHeightFactor=="number"?Q.lineHeightFactor:Zs,he=h.internal.scaleFactor;function De(Yt){return Yt=Yt.split("	").join(Array(Q.TabLen||9).join(" ")),Fr(Yt,Mt)}function vt(Yt){for(var on,Bn=Yt.concat(),Xn=[],io=Bn.length;io--;)typeof(on=Bn.shift())=="string"?Xn.push(on):Array.isArray(Yt)&&(on.length===1||on[1]===void 0&&on[2]===void 0)?Xn.push(on[0]):Xn.push([on[0],on[1],on[2]]);return Xn}function fn(Yt,on){var Bn;if(typeof Yt=="string")Bn=on(Yt)[0];else if(Array.isArray(Yt)){for(var Xn,io,Tl=Yt.concat(),Yc=[],fd=Tl.length;fd--;)typeof(Xn=Tl.shift())=="string"?Yc.push(on(Xn)[0]):Array.isArray(Xn)&&typeof Xn[0]=="string"&&(io=on(Xn[0],Xn[1],Xn[2]),Yc.push([io[0],io[1],io[2]]));Bn=Yc}return Bn}var Vt=!1,pn=!0;if(typeof m=="string")Vt=!0;else if(Array.isArray(m)){var or=m.concat();Se=[];for(var br,gn=or.length;gn--;)(typeof(br=or.shift())!="string"||Array.isArray(br)&&typeof br[0]!="string")&&(pn=!1);Vt=pn}if(Vt===!1)throw new Error('Type of text must be string or Array. "'+m+'" is not recognized.');typeof m=="string"&&(m=m.match(/[\r?\n]/)?m.split(/\r\n|\r|\n/g):[m]);var Ir=Te/h.internal.scaleFactor,Vi=Ir*(ie-1);switch(Q.baseline){case"bottom":q-=Vi;break;case"top":q+=Ir-Vi;break;case"hanging":q+=Ir-2*Vi;break;case"middle":q+=Ir/2-Vi}if((ot=Q.maxWidth||0)>0&&(typeof m=="string"?m=h.splitTextToSize(m,ot):Object.prototype.toString.call(m)==="[object Array]"&&(m=m.reduce(function(Yt,on){return Yt.concat(h.splitTextToSize(on,ot))},[]))),be={text:m,x:P,y:q,options:Q,mutex:{pdfEscape:Fr,activeFontKey:Je,fonts:Et,activeFontSize:Te}},Ft.publish("preProcessText",be),m=be.text,We=(Q=be.options).angle,sn instanceof dt==0&&We&&typeof We=="number"){We*=Math.PI/180,Q.rotationDirection===0&&(We=-We),W===G&&(We=-We);var to=Math.cos(We),yl=Math.sin(We);sn=new dt(to,yl,-yl,to,0,0)}else We&&We instanceof dt&&(sn=We);W!==G||sn||(sn=Jr),(pt=Q.charSpace||Fi)!==void 0&&(V+=x(T(pt))+` Tc
`,this.setCharSpace(this.getCharSpace()||0)),(dn=Q.horizontalScale)!==void 0&&(V+=x(100*dn)+` Tz
`),Q.lang;var jr=-1,no=Q.renderingMode!==void 0?Q.renderingMode:Q.stroke,Gc=h.internal.getCurrentPageInfo().pageContext;switch(no){case 0:case!1:case"fill":jr=0;break;case 1:case!0:case"stroke":jr=1;break;case 2:case"fillThenStroke":jr=2;break;case 3:case"invisible":jr=3;break;case 4:case"fillAndAddForClipping":jr=4;break;case 5:case"strokeAndAddPathForClipping":jr=5;break;case 6:case"fillThenStrokeAndAddToPathForClipping":jr=6;break;case 7:case"addToPathForClipping":jr=7}var hd=Gc.usedRenderingMode!==void 0?Gc.usedRenderingMode:-1;jr!==-1?V+=jr+` Tr
`:hd!==-1&&(V+=`0 Tr
`),jr!==-1&&(Gc.usedRenderingMode=jr),Ye=Q.align||"left";var Bi,za=Te*ie,_l=h.internal.pageSize.getWidth(),vl=Et[Je];pt=Q.charSpace||Fi,ot=Q.maxWidth||0,Mt=Object.assign({autoencode:!0,noBOM:!0},Q.flags);var Vo=[],$a=function(Yt){return h.getStringUnitWidth(Yt,{font:vl,charSpace:pt,fontSize:Te,doKerning:!1})*Te/he};if(Object.prototype.toString.call(m)==="[object Array]"){var gi;Se=vt(m),Ye!=="left"&&(Bi=Se.map($a));var mi,Bo=0;if(Ye==="right"){P-=Bi[0],m=[],gn=Se.length;for(var ro=0;ro<gn;ro++)ro===0?(mi=Vr(P),gi=Oi(q)):(mi=T(Bo-Bi[ro]),gi=-za),m.push([Se[ro],mi,gi]),Bo=Bi[ro]}else if(Ye==="center"){P-=Bi[0]/2,m=[],gn=Se.length;for(var Uo=0;Uo<gn;Uo++)Uo===0?(mi=Vr(P),gi=Oi(q)):(mi=T((Bo-Bi[Uo])/2),gi=-za),m.push([Se[Uo],mi,gi]),Bo=Bi[Uo]}else if(Ye==="left"){m=[],gn=Se.length;for(var wl=0;wl<gn;wl++)m.push(Se[wl])}else if(Ye==="justify"&&vl.encoding==="Identity-H"){m=[],gn=Se.length,ot=ot!==0?ot:_l;for(var Kc=0,Vn=0;Vn<gn;Vn++)if(gi=Vn===0?Oi(q):-za,mi=Vn===0?Vr(P):Kc,Vn<gn-1){var dd=T((ot-Bi[Vn])/(Se[Vn].split(" ").length-1)),Ts=Se[Vn].split(" ");m.push([Ts[0]+" ",mi,gi]),Kc=0;for(var Ss=1;Ss<Ts.length;Ss++){var bl=($a(Ts[Ss-1]+" "+Ts[Ss])-$a(Ts[Ss]))*he+dd;Ss==Ts.length-1?m.push([Ts[Ss],bl,0]):m.push([Ts[Ss]+" ",bl,0]),Kc-=bl}}else m.push([Se[Vn],mi,gi]);m.push(["",Kc,0])}else{if(Ye!=="justify")throw new Error('Unrecognized alignment option, use "left", "center", "right" or "justify".');for(m=[],gn=Se.length,ot=ot!==0?ot:_l,Vn=0;Vn<gn;Vn++){gi=Vn===0?Oi(q):-za,mi=Vn===0?Vr(P):0;var Il=Se[Vn].split(" ").length-1,Al=Il>0?(ot-Bi[Vn])/Il:0;Vn<gn-1?Vo.push(x(T(Al))):Vo.push(0),m.push([Se[Vn],mi,gi])}}}(typeof Q.R2L=="boolean"?Q.R2L:ct)===!0&&(m=fn(m,function(Yt,on,Bn){return[Yt.split("").reverse().join(""),on,Bn]})),be={text:m,x:P,y:q,options:Q,mutex:{pdfEscape:Fr,activeFontKey:Je,fonts:Et,activeFontSize:Te}},Ft.publish("postProcessText",be),m=be.text,I=be.mutex.isHex||!1;var El=Et[Je].encoding;El!=="WinAnsiEncoding"&&El!=="StandardEncoding"||(m=fn(m,function(Yt,on,Bn){return[De(Yt),on,Bn]})),Se=vt(m),m=[];for(var jo,qo,zo,Wa=Array.isArray(Se[0])?1:0,$o="",Ha=function(Yt,on,Bn){var Xn="";return Bn instanceof dt?(Bn=typeof Q.angle=="number"?Ki(Bn,new dt(1,0,0,1,Yt,on)):Ki(new dt(1,0,0,1,Yt,on),Bn),W===G&&(Bn=Ki(new dt(1,0,0,-1,0,0),Bn)),Xn=Bn.join(" ")+` Tm
`):Xn=x(Yt)+" "+x(on)+` Td
`,Xn},Ui=0;Ui<Se.length;Ui++){switch($o="",Wa){case 1:zo=(I?"<":"(")+Se[Ui][0]+(I?">":")"),jo=parseFloat(Se[Ui][1]),qo=parseFloat(Se[Ui][2]);break;case 0:zo=(I?"<":"(")+Se[Ui]+(I?">":")"),jo=Vr(P),qo=Oi(q)}Vo!==void 0&&Vo[Ui]!==void 0&&($o=Vo[Ui]+` Tw
`),Ui===0?m.push($o+Ha(jo,qo,sn)+zo):Wa===0?m.push($o+zo):Wa===1&&m.push($o+Ha(jo,qo,sn)+zo)}m=Wa===0?m.join(` Tj
T* `):m.join(` Tj
`),m+=` Tj
`;var Ps=`BT
/`;return Ps+=Je+" "+Te+` Tf
`,Ps+=x(Te*ie)+` TL
`,Ps+=ws+`
`,Ps+=V,Ps+=m,j(Ps+="ET"),y[Je]=!0,h};var pl=p.__private__.clip=p.clip=function(m){return j(m==="evenodd"?"W*":"W"),this};p.clipEvenOdd=function(){return pl("evenodd")},p.__private__.discardPath=p.discardPath=function(){return j("n"),this};var Di=p.__private__.isValidStyle=function(m){var P=!1;return[void 0,null,"S","D","F","DF","FD","f","f*","B","B*","n"].indexOf(m)!==-1&&(P=!0),P};p.__private__.setDefaultPathOperation=p.setDefaultPathOperation=function(m){return Di(m)&&(u=m),this};var Bc=p.__private__.getStyle=p.getStyle=function(m){var P=u;switch(m){case"D":case"S":P="S";break;case"F":P="f";break;case"FD":case"DF":P="B";break;case"f":case"f*":case"B":case"B*":P=m}return P},_s=p.close=function(){return j("h"),this};p.stroke=function(){return j("S"),this},p.fill=function(m){return ri("f",m),this},p.fillEvenOdd=function(m){return ri("f*",m),this},p.fillStroke=function(m){return ri("B",m),this},p.fillStrokeEvenOdd=function(m){return ri("B*",m),this};var ri=function(m,P){Zt(P)==="object"?jc(P,m):j(m)},vs=function(m){m===null||W===G&&m===void 0||(m=Bc(m),j(m))};function Uc(m,P,q,Q,re){var be=new mu(P||this.boundingBox,q||this.xStep,Q||this.yStep,this.gState,re||this.matrix);be.stream=this.stream;var Se=m+"$$"+this.cloneIndex+++"$$";return Lr(Se,be),be}var jc=function(m,P){var q=Kt[m.key],Q=st[q];if(Q instanceof ic)j("q"),j(qc(P)),Q.gState&&p.setGState(Q.gState),j(m.matrix.toString()+" cm"),j("/"+q+" sh"),j("Q");else if(Q instanceof mu){var re=new dt(1,0,0,-1,0,Zi());m.matrix&&(re=re.multiply(m.matrix||Jr),q=Uc.call(Q,m.key,m.boundingBox,m.xStep,m.yStep,re).id),j("q"),j("/Pattern cs"),j("/"+q+" scn"),Q.gState&&p.setGState(Q.gState),j(P),j("Q")}},qc=function(m){switch(m){case"f":case"F":case"n":return"W n";case"f*":return"W* n";case"B":case"S":return"W S";case"B*":return"W* S"}},ko=p.moveTo=function(m,P){return j(x(T(m))+" "+x(J(P))+" m"),this},Xi=p.lineTo=function(m,P){return j(x(T(m))+" "+x(J(P))+" l"),this},pi=p.curveTo=function(m,P,q,Q,re,be){return j([x(T(m)),x(J(P)),x(T(q)),x(J(Q)),x(T(re)),x(J(be)),"c"].join(" ")),this};p.__private__.line=p.line=function(m,P,q,Q,re){if(isNaN(m)||isNaN(P)||isNaN(q)||isNaN(Q)||!Di(re))throw new Error("Invalid arguments passed to jsPDF.line");return W===K?this.lines([[q-m,Q-P]],m,P,[1,1],re||"S"):this.lines([[q-m,Q-P]],m,P,[1,1]).stroke()},p.__private__.lines=p.lines=function(m,P,q,Q,re,be){var Se,We,Ye,pt,ot,Mt,dn,sn,h,v,I,V;if(typeof m=="number"&&(V=q,q=P,P=m,m=V),Q=Q||[1,1],be=be||!1,isNaN(P)||isNaN(q)||!Array.isArray(m)||!Array.isArray(Q)||!Di(re)||typeof be!="boolean")throw new Error("Invalid arguments passed to jsPDF.lines");for(ko(P,q),Se=Q[0],We=Q[1],pt=m.length,v=P,I=q,Ye=0;Ye<pt;Ye++)(ot=m[Ye]).length===2?(v=ot[0]*Se+v,I=ot[1]*We+I,Xi(v,I)):(Mt=ot[0]*Se+v,dn=ot[1]*We+I,sn=ot[2]*Se+v,h=ot[3]*We+I,v=ot[4]*Se+v,I=ot[5]*We+I,pi(Mt,dn,sn,h,v,I));return be&&_s(),vs(re),this},p.path=function(m){for(var P=0;P<m.length;P++){var q=m[P],Q=q.c;switch(q.op){case"m":ko(Q[0],Q[1]);break;case"l":Xi(Q[0],Q[1]);break;case"c":pi.apply(this,Q);break;case"h":_s()}}return this},p.__private__.rect=p.rect=function(m,P,q,Q,re){if(isNaN(m)||isNaN(P)||isNaN(q)||isNaN(Q)||!Di(re))throw new Error("Invalid arguments passed to jsPDF.rect");return W===K&&(Q=-Q),j([x(T(m)),x(J(P)),x(T(q)),x(T(Q)),"re"].join(" ")),vs(re),this},p.__private__.triangle=p.triangle=function(m,P,q,Q,re,be,Se){if(isNaN(m)||isNaN(P)||isNaN(q)||isNaN(Q)||isNaN(re)||isNaN(be)||!Di(Se))throw new Error("Invalid arguments passed to jsPDF.triangle");return this.lines([[q-m,Q-P],[re-q,be-Q],[m-re,P-be]],m,P,[1,1],Se,!0),this},p.__private__.roundedRect=p.roundedRect=function(m,P,q,Q,re,be,Se){if(isNaN(m)||isNaN(P)||isNaN(q)||isNaN(Q)||isNaN(re)||isNaN(be)||!Di(Se))throw new Error("Invalid arguments passed to jsPDF.roundedRect");var We=4/3*(Math.SQRT2-1);return re=Math.min(re,.5*q),be=Math.min(be,.5*Q),this.lines([[q-2*re,0],[re*We,0,re,be-be*We,re,be],[0,Q-2*be],[0,be*We,-re*We,be,-re,be],[2*re-q,0],[-re*We,0,-re,-be*We,-re,-be],[0,2*be-Q],[0,-be*We,re*We,-be,re,-be]],m+re,P,[1,1],Se,!0),this},p.__private__.ellipse=p.ellipse=function(m,P,q,Q,re){if(isNaN(m)||isNaN(P)||isNaN(q)||isNaN(Q)||!Di(re))throw new Error("Invalid arguments passed to jsPDF.ellipse");var be=4/3*(Math.SQRT2-1)*q,Se=4/3*(Math.SQRT2-1)*Q;return ko(m+q,P),pi(m+q,P-Se,m+be,P-Q,m,P-Q),pi(m-be,P-Q,m-q,P-Se,m-q,P),pi(m-q,P+Se,m-be,P+Q,m,P+Q),pi(m+be,P+Q,m+q,P+Se,m+q,P),vs(re),this},p.__private__.circle=p.circle=function(m,P,q,Q){if(isNaN(m)||isNaN(P)||isNaN(q)||!Di(Q))throw new Error("Invalid arguments passed to jsPDF.circle");return this.ellipse(m,P,q,q,Q)},p.setFont=function(m,P,q){return q&&(P=B(P,q)),Je=Ma(m,P,{disableWarning:!1}),this};var gl=p.__private__.getFont=p.getFont=function(){return Et[Ma.apply(p,arguments)]};p.__private__.getFontList=p.getFontList=function(){var m,P,q={};for(m in Tt)if(Tt.hasOwnProperty(m))for(P in q[m]=[],Tt[m])Tt[m].hasOwnProperty(P)&&q[m].push(P);return q},p.addFont=function(m,P,q,Q,re){var be=["StandardEncoding","MacRomanEncoding","Identity-H","WinAnsiEncoding"];return arguments[3]&&be.indexOf(arguments[3])!==-1?re=arguments[3]:arguments[3]&&be.indexOf(arguments[3])==-1&&(q=B(q,Q)),Da.call(this,m,P,q,re=re||"Identity-H")};var Zs,ii=n.lineWidth||.200025,ml=p.__private__.getLineWidth=p.getLineWidth=function(){return ii},mt=p.__private__.setLineWidth=p.setLineWidth=function(m){return ii=m,j(x(T(m))+" w"),this};p.__private__.setLineDash=rt.API.setLineDash=rt.API.setLineDashPattern=function(m,P){if(m=m||[],P=P||0,isNaN(P)||!Array.isArray(m))throw new Error("Invalid arguments passed to jsPDF.setLineDash");return m=m.map(function(q){return x(T(q))}).join(" "),P=x(T(P)),j("["+m+"] "+P+" d"),this};var Co=p.__private__.getLineHeight=p.getLineHeight=function(){return Te*Zs};p.__private__.getLineHeight=p.getLineHeight=function(){return Te*Zs};var zc=p.__private__.setLineHeightFactor=p.setLineHeightFactor=function(m){return typeof(m=m||1.15)=="number"&&(Zs=m),this},eo=p.__private__.getLineHeightFactor=p.getLineHeightFactor=function(){return Zs};zc(n.lineHeight);var Vr=p.__private__.getHorizontalCoordinate=function(m){return T(m)},Oi=p.__private__.getVerticalCoordinate=function(m){return W===G?m:lt[H].mediaBox.topRightY-lt[H].mediaBox.bottomLeftY-T(m)},Ba=p.__private__.getHorizontalCoordinateString=p.getHorizontalCoordinateString=function(m){return x(Vr(m))},hn=p.__private__.getVerticalCoordinateString=p.getVerticalCoordinateString=function(m){return x(Oi(m))},Lo=n.strokeColor||"0 G";p.__private__.getStrokeColor=p.getDrawColor=function(){return Xr(Lo)},p.__private__.setStrokeColor=p.setDrawColor=function(m,P,q,Q){return Lo=Or({ch1:m,ch2:P,ch3:q,ch4:Q,pdfColorType:"draw",precision:2}),j(Lo),this};var Ua=n.fillColor||"0 g";p.__private__.getFillColor=p.getFillColor=function(){return Xr(Ua)},p.__private__.setFillColor=p.setFillColor=function(m,P,q,Q){return Ua=Or({ch1:m,ch2:P,ch3:q,ch4:Q,pdfColorType:"fill",precision:2}),j(Ua),this};var ws=n.textColor||"0 g",$c=p.__private__.getTextColor=p.getTextColor=function(){return Xr(ws)};p.__private__.setTextColor=p.setTextColor=function(m,P,q,Q){return ws=Or({ch1:m,ch2:P,ch3:q,ch4:Q,pdfColorType:"text",precision:3}),this};var Fi=n.charSpace,Do=p.__private__.getCharSpace=p.getCharSpace=function(){return parseFloat(Fi||0)};p.__private__.setCharSpace=p.setCharSpace=function(m){if(isNaN(m))throw new Error("Invalid argument passed to jsPDF.setCharSpace");return Fi=m,this};var si=0;p.CapJoinStyles={0:0,butt:0,but:0,miter:0,1:1,round:1,rounded:1,circle:1,2:2,projecting:2,project:2,square:2,bevel:2},p.__private__.setLineCap=p.setLineCap=function(m){var P=p.CapJoinStyles[m];if(P===void 0)throw new Error("Line cap style of '"+m+"' is not recognized. See or extend .CapJoinStyles property for valid styles");return si=P,j(P+" J"),this};var Oo=0;p.__private__.setLineJoin=p.setLineJoin=function(m){var P=p.CapJoinStyles[m];if(P===void 0)throw new Error("Line join style of '"+m+"' is not recognized. See or extend .CapJoinStyles property for valid styles");return Oo=P,j(P+" j"),this},p.__private__.setLineMiterLimit=p.__private__.setMiterLimit=p.setLineMiterLimit=p.setMiterLimit=function(m){if(m=m||0,isNaN(m))throw new Error("Invalid argument passed to jsPDF.setLineMiterLimit");return j(x(T(m))+" M"),this},p.GState=Wf,p.setGState=function(m){(m=typeof m=="string"?ht[gt[m]]:Wc(null,m)).equals(rn)||(j("/"+m.id+" gs"),rn=m)};var Wc=function(m,P){if(!m||!gt[m]){var q=!1;for(var Q in ht)if(ht.hasOwnProperty(Q)&&ht[Q].equals(P)){q=!0;break}if(q)P=ht[Q];else{var re="GS"+(Object.keys(ht).length+1).toString(10);ht[re]=P,P.id=re}return m&&(gt[m]=P.id),Ft.publish("addGState",P),P}};p.addGState=function(m,P){return Wc(m,P),this},p.saveGraphicsState=function(){return j("q"),Wt.push({key:Je,size:Te,color:ws}),this},p.restoreGraphicsState=function(){j("Q");var m=Wt.pop();return Je=m.key,Te=m.size,ws=m.color,rn=null,this},p.setCurrentTransformationMatrix=function(m){return j(m.toString()+" cm"),this},p.comment=function(m){return j("#"+m),this};var Br=function(m,P){var q=m||0;Object.defineProperty(this,"x",{enumerable:!0,get:function(){return q},set:function(be){isNaN(be)||(q=parseFloat(be))}});var Q=P||0;Object.defineProperty(this,"y",{enumerable:!0,get:function(){return Q},set:function(be){isNaN(be)||(Q=parseFloat(be))}});var re="pt";return Object.defineProperty(this,"type",{enumerable:!0,get:function(){return re},set:function(be){re=be.toString()}}),this},Fo=function(m,P,q,Q){Br.call(this,m,P),this.type="rect";var re=q||0;Object.defineProperty(this,"w",{enumerable:!0,get:function(){return re},set:function(Se){isNaN(Se)||(re=parseFloat(Se))}});var be=Q||0;return Object.defineProperty(this,"h",{enumerable:!0,get:function(){return be},set:function(Se){isNaN(Se)||(be=parseFloat(Se))}}),this},bs=function(){this.page=ut,this.currentPage=H,this.pages=Le.slice(0),this.pagesContext=lt.slice(0),this.x=Ze,this.y=An,this.matrix=Ct,this.width=Es(H),this.height=ja(H),this.outputDestination=Ue,this.id="",this.objectNumber=-1};bs.prototype.restore=function(){ut=this.page,H=this.currentPage,lt=this.pagesContext,Le=this.pages,Ze=this.x,An=this.y,Ct=this.matrix,Hc(H,this.width),Ur(H,this.height),Ue=this.outputDestination};var Is=function(m,P,q,Q,re){dr.push(new bs),ut=H=0,Le=[],Ze=m,An=P,Ct=re,Ro([q,Q])};for(var As in p.beginFormObject=function(m,P,q,Q,re){return Is(m,P,q,Q,re),this},p.endFormObject=function(m){return(function(P){if(Gi[P])dr.pop().restore();else{var q=new bs,Q="Xo"+(Object.keys(ir).length+1).toString(10);q.id=Q,Gi[P]=Q,ir[Q]=q,Ft.publish("addFormObject",q),dr.pop().restore()}})(m),this},p.doFormObject=function(m,P){var q=ir[Gi[m]];return j("q"),j(P.toString()+" cm"),j("/"+q.id+" Do"),j("Q"),this},p.getFormObject=function(m){var P=ir[Gi[m]];return{x:P.x,y:P.y,width:P.width,height:P.height,matrix:P.matrix}},p.save=function(m,P){return m=m||"generated.pdf",(P=P||{}).returnPromise=P.returnPromise||!1,P.returnPromise===!1?(Xa(Ht(ni()),m),typeof Xa.unload=="function"&&yt.setTimeout&&setTimeout(Xa.unload,911),this):new Promise(function(q,Q){try{var re=Xa(Ht(ni()),m);typeof Xa.unload=="function"&&yt.setTimeout&&setTimeout(Xa.unload,911),q(re)}catch(be){Q(be.message)}})},rt.API)rt.API.hasOwnProperty(As)&&(As==="events"&&rt.API.events.length?(function(m,P){var q,Q,re;for(re=P.length-1;re!==-1;re--)q=P[re][0],Q=P[re][1],m.subscribe.apply(m,[q].concat(typeof Q=="function"?[Q]:Q))})(Ft,rt.API.events):p[As]=rt.API[As]);function Es(m){return lt[m].mediaBox.topRightX-lt[m].mediaBox.bottomLeftX}function Hc(m,P){lt[m].mediaBox.topRightX=P+lt[m].mediaBox.bottomLeftX}function ja(m){return lt[m].mediaBox.topRightY-lt[m].mediaBox.bottomLeftY}function Ur(m,P){lt[m].mediaBox.topRightY=P+lt[m].mediaBox.bottomLeftY}var Mi=p.getPageWidth=function(m){return Es(m=m||H)/It},qa=p.setPageWidth=function(m,P){Hc(m,P*It)},Zi=p.getPageHeight=function(m){return ja(m=m||H)/It},Mo=p.setPageHeight=function(m,P){Ur(m,P*It)};return p.internal={pdfEscape:Fr,getStyle:Bc,getFont:gl,getFontSize:ze,getCharSpace:Do,getTextColor:$c,getLineHeight:Co,getLineHeightFactor:eo,getLineWidth:ml,write:Ve,getHorizontalCoordinate:Vr,getVerticalCoordinate:Oi,getCoordinateString:Ba,getVerticalCoordinateString:hn,collections:{},newObject:un,newAdditionalObject:wr,newObjectDeferred:En,newObjectDeferredBegin:Qn,getFilters:Zr,putStream:ei,events:Ft,scaleFactor:It,pageSize:{getWidth:function(){return Mi(H)},setWidth:function(m){qa(H,m)},getHeight:function(){return Zi(H)},setHeight:function(m){Mo(H,m)}},encryptionOptions:d,encryption:vn,getEncryptor:function(m){return d!==null?vn.encryptor(m,0):function(P){return P}},output:Xs,getNumberOfPages:Fa,get pages(){return Le},out:j,f2:b,f3:E,getPageInfo:Qi,getPageInfoByObjId:Va,getCurrentPageInfo:fl,getPDFVersion:N,Point:Br,Rectangle:Fo,Matrix:dt,hasHotfix:sr},Object.defineProperty(p.internal.pageSize,"width",{get:function(){return Mi(H)},set:function(m){qa(H,m)},enumerable:!0,configurable:!0}),Object.defineProperty(p.internal.pageSize,"height",{get:function(){return Zi(H)},set:function(m){Mo(H,m)},enumerable:!0,configurable:!0}),(function(m){for(var P=0,q=at.length;P<q;P++){var Q=Da.call(this,m[P][0],m[P][1],m[P][2],at[P][3],!0);g===!1&&(y[Q]=!0);var re=m[P][0].split("-");Vc({id:Q,fontName:re[0],fontStyle:re[1]||""})}Ft.publish("addFonts",{fonts:Et,dictionary:Tt})}).call(p,at),Je="F1",No(i,t),Ft.publish("initialized"),p}du.prototype.lsbFirstWord=function(n){return String.fromCharCode(255&n,n>>8&255,n>>16&255,n>>24&255)},du.prototype.toHexString=function(n){return n.split("").map(function(e){return("0"+(255&e.charCodeAt(0)).toString(16)).slice(-2)}).join("")},du.prototype.hexToBytes=function(n){for(var e=[],t=0;t<n.length;t+=2)e.push(String.fromCharCode(parseInt(n.substr(t,2),16)));return e.join("")},du.prototype.processOwnerPassword=function(n,e){return $m(zm(e).substr(0,5),n)},du.prototype.encryptor=function(n,e){var t=zm(this.encryptionKey+String.fromCharCode(255&n,n>>8&255,n>>16&255,255&e,e>>8&255)).substr(0,10);return function(r){return $m(t,r)}},Wf.prototype.equals=function(n){var e,t="id,objectNumber,equals";if(!n||Zt(n)!==Zt(this))return!1;var r=0;for(e in this)if(!(t.indexOf(e)>=0)){if(this.hasOwnProperty(e)&&!n.hasOwnProperty(e)||this[e]!==n[e])return!1;r++}for(e in n)n.hasOwnProperty(e)&&t.indexOf(e)<0&&r--;return r===0},rt.API={events:[]},rt.version="4.0.0";var Dn=rt.API,j0=1,Mc=function(n){return n.replace(/\\/g,"\\\\").replace(/\(/g,"\\(").replace(/\)/g,"\\)")},su=function(n){return n.replace(/\\\\/g,"\\").replace(/\\\(/g,"(").replace(/\\\)/g,")")},At=function(n){return n.toFixed(2)},ra=function(n){return n.toFixed(5)};Dn.__acroform__={};var di=function(n,e){n.prototype=Object.create(e.prototype),n.prototype.constructor=n},Fv=function(n){return n*j0},Rs=function(n){var e=new hE,t=Ge.internal.getHeight(n)||0,r=Ge.internal.getWidth(n)||0;return e.BBox=[0,0,Number(At(r)),Number(At(t))],e},d8=Dn.__acroform__.setBit=function(n,e){if(n=n||0,e=e||0,isNaN(n)||isNaN(e))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.setBit");return n|1<<e},f8=Dn.__acroform__.clearBit=function(n,e){if(n=n||0,e=e||0,isNaN(n)||isNaN(e))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.clearBit");return n&~(1<<e)},p8=Dn.__acroform__.getBit=function(n,e){if(isNaN(n)||isNaN(e))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.getBit");return n&1<<e?1:0},qn=Dn.__acroform__.getBitForPdf=function(n,e){if(isNaN(n)||isNaN(e))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.getBitForPdf");return p8(n,e-1)},zn=Dn.__acroform__.setBitForPdf=function(n,e){if(isNaN(n)||isNaN(e))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.setBitForPdf");return d8(n,e-1)},$n=Dn.__acroform__.clearBitForPdf=function(n,e){if(isNaN(n)||isNaN(e))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.clearBitForPdf");return f8(n,e-1)},g8=Dn.__acroform__.calculateCoordinates=function(n,e){var t=e.internal.getHorizontalCoordinate,r=e.internal.getVerticalCoordinate,i=n[0],s=n[1],o=n[2],a=n[3],c={};return c.lowerLeft_X=t(i)||0,c.lowerLeft_Y=r(s+a)||0,c.upperRight_X=t(i+o)||0,c.upperRight_Y=r(s)||0,[Number(At(c.lowerLeft_X)),Number(At(c.lowerLeft_Y)),Number(At(c.upperRight_X)),Number(At(c.upperRight_Y))]},m8=function(n){if(n.appearanceStreamContent)return n.appearanceStreamContent;if(n.V||n.DV){var e=[],t=n._V||n.DV,r=Wm(n,t),i=n.scope.internal.getFont(n.fontName,n.fontStyle).id;e.push("/Tx BMC"),e.push("q"),e.push("BT"),e.push(n.scope.__private__.encodeColorString(n.color)),e.push("/"+i+" "+At(r.fontSize)+" Tf"),e.push("1 0 0 1 0 0 Tm"),e.push(r.text),e.push("ET"),e.push("Q"),e.push("EMC");var s=Rs(n);return s.scope=n.scope,s.stream=e.join(`
`),s}},Wm=function(n,e){var t=n.fontSize===0?n.maxFontSize:n.fontSize,r={text:"",fontSize:""},i=(e=(e=e.substr(0,1)=="("?e.substr(1):e).substr(e.length-1)==")"?e.substr(0,e.length-1):e).split(" ");i=n.multiline?i.map(function(b){return b.split(`
`)}):i.map(function(b){return[b]});var s=t,o=Ge.internal.getHeight(n)||0;o=o<0?-o:o;var a=Ge.internal.getWidth(n)||0;a=a<0?-a:a;var c=function(b,E,T){if(b+1<i.length){var J=E+" "+i[b+1][0];return $d(J,n,T).width<=a-4}return!1};s++;e:for(;s>0;){e="",s--;var u,d,g=$d("3",n,s).height,y=n.multiline?o-s:(o-g)/2,p=y+=2,S=0,N=0,C=0;if(s<=0){e=`(...) Tj
`,e+="% Width of Text: "+$d(e,n,s=12).width+", FieldWidth:"+a+`
`;break}for(var k="",K=0,G=0;G<i.length;G++)if(i.hasOwnProperty(G)){var W=!1;if(i[G].length!==1&&C!==i[G].length-1){if((g+2)*(K+2)+2>o)continue e;k+=i[G][C],W=!0,N=G,G--}else{k=(k+=i[G][C]+" ").substr(k.length-1)==" "?k.substr(0,k.length-1):k;var ne=parseInt(G),de=c(ne,k,s),B=G>=i.length-1;if(de&&!B){k+=" ",C=0;continue}if(de||B){if(B)N=ne;else if(n.multiline&&(g+2)*(K+2)+2>o)continue e}else{if(!n.multiline||(g+2)*(K+2)+2>o)continue e;N=ne}}for(var x="",A=S;A<=N;A++){var F=i[A];if(n.multiline){if(A===N){x+=F[C]+" ",C=(C+1)%F.length;continue}if(A===S){x+=F[F.length-1]+" ";continue}}x+=F[0]+" "}switch(x=x.substr(x.length-1)==" "?x.substr(0,x.length-1):x,d=$d(x,n,s).width,n.textAlign){case"right":u=a-d-2;break;case"center":u=(a-d)/2;break;default:u=2}e+=At(u)+" "+At(p)+` Td
`,e+="("+Mc(x)+`) Tj
`,e+=-At(u)+` 0 Td
`,p=-(s+2),d=0,S=W?N:N+1,K++,k=""}break}return r.text=e,r.fontSize=s,r},$d=function(n,e,t){var r=e.scope.internal.getFont(e.fontName,e.fontStyle),i=e.scope.getStringUnitWidth(n,{font:r,fontSize:parseFloat(t),charSpace:0})*parseFloat(t);return{height:e.scope.getStringUnitWidth("3",{font:r,fontSize:parseFloat(t),charSpace:0})*parseFloat(t)*1.5,width:i}},y8={fields:[],xForms:[],acroFormDictionaryRoot:null,printedOut:!1,internal:null,isInitialized:!1},_8=function(n,e){var t={type:"reference",object:n};e.internal.getPageInfo(n.page).pageContext.annotations.find(function(r){return r.type===t.type&&r.object===t.object})===void 0&&e.internal.getPageInfo(n.page).pageContext.annotations.push(t)},v8=function(n,e){if(e.scope=n,n.internal!==void 0&&(n.internal.acroformPlugin===void 0||n.internal.acroformPlugin.isInitialized===!1)){if(fs.FieldNum=0,n.internal.acroformPlugin=JSON.parse(JSON.stringify(y8)),n.internal.acroformPlugin.acroFormDictionaryRoot)throw new Error("Exception while creating AcroformDictionary");j0=n.internal.scaleFactor,n.internal.acroformPlugin.acroFormDictionaryRoot=new dE,n.internal.acroformPlugin.acroFormDictionaryRoot.scope=n,n.internal.acroformPlugin.acroFormDictionaryRoot._eventID=n.internal.events.subscribe("postPutResources",function(){(function(t){t.internal.events.unsubscribe(t.internal.acroformPlugin.acroFormDictionaryRoot._eventID),delete t.internal.acroformPlugin.acroFormDictionaryRoot._eventID,t.internal.acroformPlugin.printedOut=!0})(n)}),n.internal.events.subscribe("buildDocument",function(){(function(t){t.internal.acroformPlugin.acroFormDictionaryRoot.objId=void 0;var r=t.internal.acroformPlugin.acroFormDictionaryRoot.Fields;for(var i in r)if(r.hasOwnProperty(i)){var s=r[i];s.objId=void 0,s.hasAnnotation&&_8(s,t)}})(n)}),n.internal.events.subscribe("putCatalog",function(){(function(t){if(t.internal.acroformPlugin.acroFormDictionaryRoot===void 0)throw new Error("putCatalogCallback: Root missing.");t.internal.write("/AcroForm "+t.internal.acroformPlugin.acroFormDictionaryRoot.objId+" 0 R")})(n)}),n.internal.events.subscribe("postPutPages",function(t){(function(r,i){var s=!r;for(var o in r||(i.internal.newObjectDeferredBegin(i.internal.acroformPlugin.acroFormDictionaryRoot.objId,!0),i.internal.acroformPlugin.acroFormDictionaryRoot.putStream()),r=r||i.internal.acroformPlugin.acroFormDictionaryRoot.Kids)if(r.hasOwnProperty(o)){var a=r[o],c=[],u=a.Rect;if(a.Rect&&(a.Rect=g8(a.Rect,i)),i.internal.newObjectDeferredBegin(a.objId,!0),a.DA=Ge.createDefaultAppearanceStream(a),Zt(a)==="object"&&typeof a.getKeyValueListForStream=="function"&&(c=a.getKeyValueListForStream()),a.Rect=u,a.hasAppearanceStream&&!a.appearanceStreamContent){var d=m8(a);c.push({key:"AP",value:"<</N "+d+">>"}),i.internal.acroformPlugin.xForms.push(d)}if(a.appearanceStreamContent){var g="";for(var y in a.appearanceStreamContent)if(a.appearanceStreamContent.hasOwnProperty(y)){var p=a.appearanceStreamContent[y];if(g+="/"+y+" ",g+="<<",Object.keys(p).length>=1||Array.isArray(p)){for(var o in p)if(p.hasOwnProperty(o)){var S=p[o];typeof S=="function"&&(S=S.call(i,a)),g+="/"+o+" "+S+" ",i.internal.acroformPlugin.xForms.indexOf(S)>=0||i.internal.acroformPlugin.xForms.push(S)}}else typeof(S=p)=="function"&&(S=S.call(i,a)),g+="/"+o+" "+S,i.internal.acroformPlugin.xForms.indexOf(S)>=0||i.internal.acroformPlugin.xForms.push(S);g+=">>"}c.push({key:"AP",value:`<<
`+g+">>"})}i.internal.putStream({additionalKeyValues:c,objectId:a.objId}),i.internal.out("endobj")}s&&(function(N,C){for(var k in N)if(N.hasOwnProperty(k)){var K=k,G=N[k];C.internal.newObjectDeferredBegin(G.objId,!0),Zt(G)==="object"&&typeof G.putStream=="function"&&G.putStream(),delete N[K]}})(i.internal.acroformPlugin.xForms,i)})(t,n)}),n.internal.acroformPlugin.isInitialized=!0}},lE=Dn.__acroform__.arrayToPdfArray=function(n,e,t){var r=function(o){return o};if(Array.isArray(n)){for(var i="[",s=0;s<n.length;s++)switch(s!==0&&(i+=" "),Zt(n[s])){case"boolean":case"number":case"object":i+=n[s].toString();break;case"string":n[s].substr(0,1)!=="/"?(e!==void 0&&t&&(r=t.internal.getEncryptor(e)),i+="("+Mc(r(n[s].toString()))+")"):i+=n[s].toString()}return i+"]"}throw new Error("Invalid argument passed to jsPDF.__acroform__.arrayToPdfArray")},Ug=function(n,e,t){var r=function(i){return i};return e!==void 0&&t&&(r=t.internal.getEncryptor(e)),(n=n||"").toString(),"("+Mc(r(n))+")"},Bs=function(){this._objId=void 0,this._scope=void 0,Object.defineProperty(this,"objId",{get:function(){if(this._objId===void 0){if(this.scope===void 0)return;this._objId=this.scope.internal.newObjectDeferred()}return this._objId},set:function(n){this._objId=n}}),Object.defineProperty(this,"scope",{value:this._scope,writable:!0})};Bs.prototype.toString=function(){return this.objId+" 0 R"},Bs.prototype.putStream=function(){var n=this.getKeyValueListForStream();this.scope.internal.putStream({data:this.stream,additionalKeyValues:n,objectId:this.objId}),this.scope.internal.out("endobj")},Bs.prototype.getKeyValueListForStream=function(){var n=[],e=Object.getOwnPropertyNames(this).filter(function(s){return s!="content"&&s!="appearanceStreamContent"&&s!="scope"&&s!="objId"&&s.substring(0,1)!="_"});for(var t in e)if(Object.getOwnPropertyDescriptor(this,e[t]).configurable===!1){var r=e[t],i=this[r];i&&(Array.isArray(i)?n.push({key:r,value:lE(i,this.objId,this.scope)}):i instanceof Bs?(i.scope=this.scope,n.push({key:r,value:i.objId+" 0 R"})):typeof i!="function"&&n.push({key:r,value:i}))}return n};var hE=function(){Bs.call(this),Object.defineProperty(this,"Type",{value:"/XObject",configurable:!1,writable:!0}),Object.defineProperty(this,"Subtype",{value:"/Form",configurable:!1,writable:!0}),Object.defineProperty(this,"FormType",{value:1,configurable:!1,writable:!0});var n,e=[];Object.defineProperty(this,"BBox",{configurable:!1,get:function(){return e},set:function(t){e=t}}),Object.defineProperty(this,"Resources",{value:"2 0 R",configurable:!1,writable:!0}),Object.defineProperty(this,"stream",{enumerable:!1,configurable:!0,set:function(t){n=t.trim()},get:function(){return n||null}})};di(hE,Bs);var dE=function(){Bs.call(this);var n,e=[];Object.defineProperty(this,"Kids",{enumerable:!1,configurable:!0,get:function(){return e.length>0?e:void 0}}),Object.defineProperty(this,"Fields",{enumerable:!1,configurable:!1,get:function(){return e}}),Object.defineProperty(this,"DA",{enumerable:!1,configurable:!1,get:function(){if(n){var t=function(r){return r};return this.scope&&(t=this.scope.internal.getEncryptor(this.objId)),"("+Mc(t(n))+")"}},set:function(t){n=t}})};di(dE,Bs);var fs=function n(){Bs.call(this);var e=4;Object.defineProperty(this,"F",{enumerable:!1,configurable:!1,get:function(){return e},set:function(k){if(isNaN(k))throw new Error('Invalid value "'+k+'" for attribute F supplied.');e=k}}),Object.defineProperty(this,"showWhenPrinted",{enumerable:!0,configurable:!0,get:function(){return!!qn(e,3)},set:function(k){k?this.F=zn(e,3):this.F=$n(e,3)}});var t=0;Object.defineProperty(this,"Ff",{enumerable:!1,configurable:!1,get:function(){return t},set:function(k){if(isNaN(k))throw new Error('Invalid value "'+k+'" for attribute Ff supplied.');t=k}});var r=[];Object.defineProperty(this,"Rect",{enumerable:!1,configurable:!1,get:function(){if(r.length!==0)return r},set:function(k){r=k!==void 0?k:[]}}),Object.defineProperty(this,"x",{enumerable:!0,configurable:!0,get:function(){return!r||isNaN(r[0])?0:r[0]},set:function(k){r[0]=k}}),Object.defineProperty(this,"y",{enumerable:!0,configurable:!0,get:function(){return!r||isNaN(r[1])?0:r[1]},set:function(k){r[1]=k}}),Object.defineProperty(this,"width",{enumerable:!0,configurable:!0,get:function(){return!r||isNaN(r[2])?0:r[2]},set:function(k){r[2]=k}}),Object.defineProperty(this,"height",{enumerable:!0,configurable:!0,get:function(){return!r||isNaN(r[3])?0:r[3]},set:function(k){r[3]=k}});var i="";Object.defineProperty(this,"FT",{enumerable:!0,configurable:!1,get:function(){return i},set:function(k){switch(k){case"/Btn":case"/Tx":case"/Ch":case"/Sig":i=k;break;default:throw new Error('Invalid value "'+k+'" for attribute FT supplied.')}}});var s=null;Object.defineProperty(this,"T",{enumerable:!0,configurable:!1,get:function(){if(!s||s.length<1){if(this instanceof Hf)return;s="FieldObject"+n.FieldNum++}var k=function(K){return K};return this.scope&&(k=this.scope.internal.getEncryptor(this.objId)),"("+Mc(k(s))+")"},set:function(k){s=k.toString()}}),Object.defineProperty(this,"fieldName",{configurable:!0,enumerable:!0,get:function(){return s},set:function(k){s=k}});var o="helvetica";Object.defineProperty(this,"fontName",{enumerable:!0,configurable:!0,get:function(){return o},set:function(k){o=k}});var a="normal";Object.defineProperty(this,"fontStyle",{enumerable:!0,configurable:!0,get:function(){return a},set:function(k){a=k}});var c=0;Object.defineProperty(this,"fontSize",{enumerable:!0,configurable:!0,get:function(){return c},set:function(k){c=k}});var u=void 0;Object.defineProperty(this,"maxFontSize",{enumerable:!0,configurable:!0,get:function(){return u===void 0?50/j0:u},set:function(k){u=k}});var d="black";Object.defineProperty(this,"color",{enumerable:!0,configurable:!0,get:function(){return d},set:function(k){d=k}});var g="/F1 0 Tf 0 g";Object.defineProperty(this,"DA",{enumerable:!0,configurable:!1,get:function(){if(!(!g||this instanceof Hf||this instanceof dc))return Ug(g,this.objId,this.scope)},set:function(k){k=k.toString(),g=k}});var y=null;Object.defineProperty(this,"DV",{enumerable:!1,configurable:!1,get:function(){if(y)return this instanceof ur==0?Ug(y,this.objId,this.scope):y},set:function(k){k=k.toString(),y=this instanceof ur==0?k.substr(0,1)==="("?su(k.substr(1,k.length-2)):su(k):k}}),Object.defineProperty(this,"defaultValue",{enumerable:!0,configurable:!0,get:function(){return this instanceof ur==1?su(y.substr(1,y.length-1)):y},set:function(k){k=k.toString(),y=this instanceof ur==1?"/"+k:k}});var p=null;Object.defineProperty(this,"_V",{enumerable:!1,configurable:!1,get:function(){if(p)return p},set:function(k){this.V=k}}),Object.defineProperty(this,"V",{enumerable:!1,configurable:!1,get:function(){if(p)return this instanceof ur==0?Ug(p,this.objId,this.scope):p},set:function(k){k=k.toString(),p=this instanceof ur==0?k.substr(0,1)==="("?su(k.substr(1,k.length-2)):su(k):k}}),Object.defineProperty(this,"value",{enumerable:!0,configurable:!0,get:function(){return this instanceof ur==1?su(p.substr(1,p.length-1)):p},set:function(k){k=k.toString(),p=this instanceof ur==1?"/"+k:k}}),Object.defineProperty(this,"hasAnnotation",{enumerable:!0,configurable:!0,get:function(){return this.Rect}}),Object.defineProperty(this,"Type",{enumerable:!0,configurable:!1,get:function(){return this.hasAnnotation?"/Annot":null}}),Object.defineProperty(this,"Subtype",{enumerable:!0,configurable:!1,get:function(){return this.hasAnnotation?"/Widget":null}});var S,N=!1;Object.defineProperty(this,"hasAppearanceStream",{enumerable:!0,configurable:!0,get:function(){return N},set:function(k){k=!!k,N=k}}),Object.defineProperty(this,"page",{enumerable:!0,configurable:!0,get:function(){if(S)return S},set:function(k){S=k}}),Object.defineProperty(this,"readOnly",{enumerable:!0,configurable:!0,get:function(){return!!qn(this.Ff,1)},set:function(k){k?this.Ff=zn(this.Ff,1):this.Ff=$n(this.Ff,1)}}),Object.defineProperty(this,"required",{enumerable:!0,configurable:!0,get:function(){return!!qn(this.Ff,2)},set:function(k){k?this.Ff=zn(this.Ff,2):this.Ff=$n(this.Ff,2)}}),Object.defineProperty(this,"noExport",{enumerable:!0,configurable:!0,get:function(){return!!qn(this.Ff,3)},set:function(k){k?this.Ff=zn(this.Ff,3):this.Ff=$n(this.Ff,3)}});var C=null;Object.defineProperty(this,"Q",{enumerable:!0,configurable:!1,get:function(){if(C!==null)return C},set:function(k){if([0,1,2].indexOf(k)===-1)throw new Error('Invalid value "'+k+'" for attribute Q supplied.');C=k}}),Object.defineProperty(this,"textAlign",{get:function(){var k;switch(C){case 0:default:k="left";break;case 1:k="center";break;case 2:k="right"}return k},configurable:!0,enumerable:!0,set:function(k){switch(k){case"right":case 2:C=2;break;case"center":case 1:C=1;break;default:C=0}}})};di(fs,Bs);var Eu=function(){fs.call(this),this.FT="/Ch",this.V="()",this.fontName="zapfdingbats";var n=0;Object.defineProperty(this,"TI",{enumerable:!0,configurable:!1,get:function(){return n},set:function(t){n=t}}),Object.defineProperty(this,"topIndex",{enumerable:!0,configurable:!0,get:function(){return n},set:function(t){n=t}});var e=[];Object.defineProperty(this,"Opt",{enumerable:!0,configurable:!1,get:function(){return lE(e,this.objId,this.scope)},set:function(t){var r,i;i=[],typeof(r=t)=="string"&&(i=(function(s,o,a){a||(a=1);for(var c,u=[];c=o.exec(s);)u.push(c[a]);return u})(r,/\((.*?)\)/g)),e=i}}),this.getOptions=function(){return e},this.setOptions=function(t){e=t,this.sort&&e.sort()},this.addOption=function(t){t=(t=t||"").toString(),e.push(t),this.sort&&e.sort()},this.removeOption=function(t,r){for(r=r||!1,t=(t=t||"").toString();e.indexOf(t)!==-1&&(e.splice(e.indexOf(t),1),r!==!1););},Object.defineProperty(this,"combo",{enumerable:!0,configurable:!0,get:function(){return!!qn(this.Ff,18)},set:function(t){t?this.Ff=zn(this.Ff,18):this.Ff=$n(this.Ff,18)}}),Object.defineProperty(this,"edit",{enumerable:!0,configurable:!0,get:function(){return!!qn(this.Ff,19)},set:function(t){this.combo===!0&&(t?this.Ff=zn(this.Ff,19):this.Ff=$n(this.Ff,19))}}),Object.defineProperty(this,"sort",{enumerable:!0,configurable:!0,get:function(){return!!qn(this.Ff,20)},set:function(t){t?(this.Ff=zn(this.Ff,20),e.sort()):this.Ff=$n(this.Ff,20)}}),Object.defineProperty(this,"multiSelect",{enumerable:!0,configurable:!0,get:function(){return!!qn(this.Ff,22)},set:function(t){t?this.Ff=zn(this.Ff,22):this.Ff=$n(this.Ff,22)}}),Object.defineProperty(this,"doNotSpellCheck",{enumerable:!0,configurable:!0,get:function(){return!!qn(this.Ff,23)},set:function(t){t?this.Ff=zn(this.Ff,23):this.Ff=$n(this.Ff,23)}}),Object.defineProperty(this,"commitOnSelChange",{enumerable:!0,configurable:!0,get:function(){return!!qn(this.Ff,27)},set:function(t){t?this.Ff=zn(this.Ff,27):this.Ff=$n(this.Ff,27)}}),this.hasAppearanceStream=!1};di(Eu,fs);var Tu=function(){Eu.call(this),this.fontName="helvetica",this.combo=!1};di(Tu,Eu);var Su=function(){Tu.call(this),this.combo=!0};di(Su,Tu);var hf=function(){Su.call(this),this.edit=!0};di(hf,Su);var ur=function(){fs.call(this),this.FT="/Btn",Object.defineProperty(this,"noToggleToOff",{enumerable:!0,configurable:!0,get:function(){return!!qn(this.Ff,15)},set:function(t){t?this.Ff=zn(this.Ff,15):this.Ff=$n(this.Ff,15)}}),Object.defineProperty(this,"radio",{enumerable:!0,configurable:!0,get:function(){return!!qn(this.Ff,16)},set:function(t){t?this.Ff=zn(this.Ff,16):this.Ff=$n(this.Ff,16)}}),Object.defineProperty(this,"pushButton",{enumerable:!0,configurable:!0,get:function(){return!!qn(this.Ff,17)},set:function(t){t?this.Ff=zn(this.Ff,17):this.Ff=$n(this.Ff,17)}}),Object.defineProperty(this,"radioIsUnison",{enumerable:!0,configurable:!0,get:function(){return!!qn(this.Ff,26)},set:function(t){t?this.Ff=zn(this.Ff,26):this.Ff=$n(this.Ff,26)}});var n,e={};Object.defineProperty(this,"MK",{enumerable:!1,configurable:!1,get:function(){var t=function(s){return s};if(this.scope&&(t=this.scope.internal.getEncryptor(this.objId)),Object.keys(e).length!==0){var r,i=[];for(r in i.push("<<"),e)i.push("/"+r+" ("+Mc(t(e[r]))+")");return i.push(">>"),i.join(`
`)}},set:function(t){Zt(t)==="object"&&(e=t)}}),Object.defineProperty(this,"caption",{enumerable:!0,configurable:!0,get:function(){return e.CA||""},set:function(t){typeof t=="string"&&(e.CA=t)}}),Object.defineProperty(this,"AS",{enumerable:!1,configurable:!1,get:function(){return n},set:function(t){n=t}}),Object.defineProperty(this,"appearanceState",{enumerable:!0,configurable:!0,get:function(){return n.substr(1,n.length-1)},set:function(t){n="/"+t}})};di(ur,fs);var df=function(){ur.call(this),this.pushButton=!0};di(df,ur);var Pu=function(){ur.call(this),this.radio=!0,this.pushButton=!1;var n=[];Object.defineProperty(this,"Kids",{enumerable:!0,configurable:!1,get:function(){return n},set:function(e){n=e!==void 0?e:[]}})};di(Pu,ur);var Hf=function(){var n,e;fs.call(this),Object.defineProperty(this,"Parent",{enumerable:!1,configurable:!1,get:function(){return n},set:function(i){n=i}}),Object.defineProperty(this,"optionName",{enumerable:!1,configurable:!0,get:function(){return e},set:function(i){e=i}});var t,r={};Object.defineProperty(this,"MK",{enumerable:!1,configurable:!1,get:function(){var i=function(a){return a};this.scope&&(i=this.scope.internal.getEncryptor(this.objId));var s,o=[];for(s in o.push("<<"),r)o.push("/"+s+" ("+Mc(i(r[s]))+")");return o.push(">>"),o.join(`
`)},set:function(i){Zt(i)==="object"&&(r=i)}}),Object.defineProperty(this,"caption",{enumerable:!0,configurable:!0,get:function(){return r.CA||""},set:function(i){typeof i=="string"&&(r.CA=i)}}),Object.defineProperty(this,"AS",{enumerable:!1,configurable:!1,get:function(){return t},set:function(i){t=i}}),Object.defineProperty(this,"appearanceState",{enumerable:!0,configurable:!0,get:function(){return t.substr(1,t.length-1)},set:function(i){t="/"+i}}),this.caption="l",this.appearanceState="Off",this._AppearanceType=Ge.RadioButton.Circle,this.appearanceStreamContent=this._AppearanceType.createAppearanceStream(this.optionName)};di(Hf,fs),Pu.prototype.setAppearance=function(n){if(!("createAppearanceStream"in n)||!("getCA"in n))throw new Error("Couldn't assign Appearance to RadioButton. Appearance was Invalid!");for(var e in this.Kids)if(this.Kids.hasOwnProperty(e)){var t=this.Kids[e];t.appearanceStreamContent=n.createAppearanceStream(t.optionName),t.caption=n.getCA()}},Pu.prototype.createOption=function(n){var e=new Hf;return e.Parent=this,e.optionName=n,this.Kids.push(e),w8.call(this.scope,e),e};var ff=function(){ur.call(this),this.fontName="zapfdingbats",this.caption="3",this.appearanceState="On",this.value="On",this.textAlign="center",this.appearanceStreamContent=Ge.CheckBox.createAppearanceStream()};di(ff,ur);var dc=function(){fs.call(this),this.FT="/Tx",Object.defineProperty(this,"multiline",{enumerable:!0,configurable:!0,get:function(){return!!qn(this.Ff,13)},set:function(e){e?this.Ff=zn(this.Ff,13):this.Ff=$n(this.Ff,13)}}),Object.defineProperty(this,"fileSelect",{enumerable:!0,configurable:!0,get:function(){return!!qn(this.Ff,21)},set:function(e){e?this.Ff=zn(this.Ff,21):this.Ff=$n(this.Ff,21)}}),Object.defineProperty(this,"doNotSpellCheck",{enumerable:!0,configurable:!0,get:function(){return!!qn(this.Ff,23)},set:function(e){e?this.Ff=zn(this.Ff,23):this.Ff=$n(this.Ff,23)}}),Object.defineProperty(this,"doNotScroll",{enumerable:!0,configurable:!0,get:function(){return!!qn(this.Ff,24)},set:function(e){e?this.Ff=zn(this.Ff,24):this.Ff=$n(this.Ff,24)}}),Object.defineProperty(this,"comb",{enumerable:!0,configurable:!0,get:function(){return!!qn(this.Ff,25)},set:function(e){e?this.Ff=zn(this.Ff,25):this.Ff=$n(this.Ff,25)}}),Object.defineProperty(this,"richText",{enumerable:!0,configurable:!0,get:function(){return!!qn(this.Ff,26)},set:function(e){e?this.Ff=zn(this.Ff,26):this.Ff=$n(this.Ff,26)}});var n=null;Object.defineProperty(this,"MaxLen",{enumerable:!0,configurable:!1,get:function(){return n},set:function(e){n=e}}),Object.defineProperty(this,"maxLength",{enumerable:!0,configurable:!0,get:function(){return n},set:function(e){Number.isInteger(e)&&(n=e)}}),Object.defineProperty(this,"hasAppearanceStream",{enumerable:!0,configurable:!0,get:function(){return this.V||this.DV}})};di(dc,fs);var pf=function(){dc.call(this),Object.defineProperty(this,"password",{enumerable:!0,configurable:!0,get:function(){return!!qn(this.Ff,14)},set:function(n){n?this.Ff=zn(this.Ff,14):this.Ff=$n(this.Ff,14)}}),this.password=!0};di(pf,dc);var Ge={CheckBox:{createAppearanceStream:function(){return{N:{On:Ge.CheckBox.YesNormal},D:{On:Ge.CheckBox.YesPushDown,Off:Ge.CheckBox.OffPushDown}}},YesPushDown:function(n){var e=Rs(n);e.scope=n.scope;var t=[],r=n.scope.internal.getFont(n.fontName,n.fontStyle).id,i=n.scope.__private__.encodeColorString(n.color),s=Wm(n,n.caption);return t.push("0.749023 g"),t.push("0 0 "+At(Ge.internal.getWidth(n))+" "+At(Ge.internal.getHeight(n))+" re"),t.push("f"),t.push("BMC"),t.push("q"),t.push("0 0 1 rg"),t.push("/"+r+" "+At(s.fontSize)+" Tf "+i),t.push("BT"),t.push(s.text),t.push("ET"),t.push("Q"),t.push("EMC"),e.stream=t.join(`
`),e},YesNormal:function(n){var e=Rs(n);e.scope=n.scope;var t=n.scope.internal.getFont(n.fontName,n.fontStyle).id,r=n.scope.__private__.encodeColorString(n.color),i=[],s=Ge.internal.getHeight(n),o=Ge.internal.getWidth(n),a=Wm(n,n.caption);return i.push("1 g"),i.push("0 0 "+At(o)+" "+At(s)+" re"),i.push("f"),i.push("q"),i.push("0 0 1 rg"),i.push("0 0 "+At(o-1)+" "+At(s-1)+" re"),i.push("W"),i.push("n"),i.push("0 g"),i.push("BT"),i.push("/"+t+" "+At(a.fontSize)+" Tf "+r),i.push(a.text),i.push("ET"),i.push("Q"),e.stream=i.join(`
`),e},OffPushDown:function(n){var e=Rs(n);e.scope=n.scope;var t=[];return t.push("0.749023 g"),t.push("0 0 "+At(Ge.internal.getWidth(n))+" "+At(Ge.internal.getHeight(n))+" re"),t.push("f"),e.stream=t.join(`
`),e}},RadioButton:{Circle:{createAppearanceStream:function(n){var e={D:{Off:Ge.RadioButton.Circle.OffPushDown},N:{}};return e.N[n]=Ge.RadioButton.Circle.YesNormal,e.D[n]=Ge.RadioButton.Circle.YesPushDown,e},getCA:function(){return"l"},YesNormal:function(n){var e=Rs(n);e.scope=n.scope;var t=[],r=Ge.internal.getWidth(n)<=Ge.internal.getHeight(n)?Ge.internal.getWidth(n)/4:Ge.internal.getHeight(n)/4;r=Number((.9*r).toFixed(5));var i=Ge.internal.Bezier_C,s=Number((r*i).toFixed(5));return t.push("q"),t.push("1 0 0 1 "+ra(Ge.internal.getWidth(n)/2)+" "+ra(Ge.internal.getHeight(n)/2)+" cm"),t.push(r+" 0 m"),t.push(r+" "+s+" "+s+" "+r+" 0 "+r+" c"),t.push("-"+s+" "+r+" -"+r+" "+s+" -"+r+" 0 c"),t.push("-"+r+" -"+s+" -"+s+" -"+r+" 0 -"+r+" c"),t.push(s+" -"+r+" "+r+" -"+s+" "+r+" 0 c"),t.push("f"),t.push("Q"),e.stream=t.join(`
`),e},YesPushDown:function(n){var e=Rs(n);e.scope=n.scope;var t=[],r=Ge.internal.getWidth(n)<=Ge.internal.getHeight(n)?Ge.internal.getWidth(n)/4:Ge.internal.getHeight(n)/4;r=Number((.9*r).toFixed(5));var i=Number((2*r).toFixed(5)),s=Number((i*Ge.internal.Bezier_C).toFixed(5)),o=Number((r*Ge.internal.Bezier_C).toFixed(5));return t.push("0.749023 g"),t.push("q"),t.push("1 0 0 1 "+ra(Ge.internal.getWidth(n)/2)+" "+ra(Ge.internal.getHeight(n)/2)+" cm"),t.push(i+" 0 m"),t.push(i+" "+s+" "+s+" "+i+" 0 "+i+" c"),t.push("-"+s+" "+i+" -"+i+" "+s+" -"+i+" 0 c"),t.push("-"+i+" -"+s+" -"+s+" -"+i+" 0 -"+i+" c"),t.push(s+" -"+i+" "+i+" -"+s+" "+i+" 0 c"),t.push("f"),t.push("Q"),t.push("0 g"),t.push("q"),t.push("1 0 0 1 "+ra(Ge.internal.getWidth(n)/2)+" "+ra(Ge.internal.getHeight(n)/2)+" cm"),t.push(r+" 0 m"),t.push(r+" "+o+" "+o+" "+r+" 0 "+r+" c"),t.push("-"+o+" "+r+" -"+r+" "+o+" -"+r+" 0 c"),t.push("-"+r+" -"+o+" -"+o+" -"+r+" 0 -"+r+" c"),t.push(o+" -"+r+" "+r+" -"+o+" "+r+" 0 c"),t.push("f"),t.push("Q"),e.stream=t.join(`
`),e},OffPushDown:function(n){var e=Rs(n);e.scope=n.scope;var t=[],r=Ge.internal.getWidth(n)<=Ge.internal.getHeight(n)?Ge.internal.getWidth(n)/4:Ge.internal.getHeight(n)/4;r=Number((.9*r).toFixed(5));var i=Number((2*r).toFixed(5)),s=Number((i*Ge.internal.Bezier_C).toFixed(5));return t.push("0.749023 g"),t.push("q"),t.push("1 0 0 1 "+ra(Ge.internal.getWidth(n)/2)+" "+ra(Ge.internal.getHeight(n)/2)+" cm"),t.push(i+" 0 m"),t.push(i+" "+s+" "+s+" "+i+" 0 "+i+" c"),t.push("-"+s+" "+i+" -"+i+" "+s+" -"+i+" 0 c"),t.push("-"+i+" -"+s+" -"+s+" -"+i+" 0 -"+i+" c"),t.push(s+" -"+i+" "+i+" -"+s+" "+i+" 0 c"),t.push("f"),t.push("Q"),e.stream=t.join(`
`),e}},Cross:{createAppearanceStream:function(n){var e={D:{Off:Ge.RadioButton.Cross.OffPushDown},N:{}};return e.N[n]=Ge.RadioButton.Cross.YesNormal,e.D[n]=Ge.RadioButton.Cross.YesPushDown,e},getCA:function(){return"8"},YesNormal:function(n){var e=Rs(n);e.scope=n.scope;var t=[],r=Ge.internal.calculateCross(n);return t.push("q"),t.push("1 1 "+At(Ge.internal.getWidth(n)-2)+" "+At(Ge.internal.getHeight(n)-2)+" re"),t.push("W"),t.push("n"),t.push(At(r.x1.x)+" "+At(r.x1.y)+" m"),t.push(At(r.x2.x)+" "+At(r.x2.y)+" l"),t.push(At(r.x4.x)+" "+At(r.x4.y)+" m"),t.push(At(r.x3.x)+" "+At(r.x3.y)+" l"),t.push("s"),t.push("Q"),e.stream=t.join(`
`),e},YesPushDown:function(n){var e=Rs(n);e.scope=n.scope;var t=Ge.internal.calculateCross(n),r=[];return r.push("0.749023 g"),r.push("0 0 "+At(Ge.internal.getWidth(n))+" "+At(Ge.internal.getHeight(n))+" re"),r.push("f"),r.push("q"),r.push("1 1 "+At(Ge.internal.getWidth(n)-2)+" "+At(Ge.internal.getHeight(n)-2)+" re"),r.push("W"),r.push("n"),r.push(At(t.x1.x)+" "+At(t.x1.y)+" m"),r.push(At(t.x2.x)+" "+At(t.x2.y)+" l"),r.push(At(t.x4.x)+" "+At(t.x4.y)+" m"),r.push(At(t.x3.x)+" "+At(t.x3.y)+" l"),r.push("s"),r.push("Q"),e.stream=r.join(`
`),e},OffPushDown:function(n){var e=Rs(n);e.scope=n.scope;var t=[];return t.push("0.749023 g"),t.push("0 0 "+At(Ge.internal.getWidth(n))+" "+At(Ge.internal.getHeight(n))+" re"),t.push("f"),e.stream=t.join(`
`),e}}},createDefaultAppearanceStream:function(n){var e=n.scope.internal.getFont(n.fontName,n.fontStyle).id,t=n.scope.__private__.encodeColorString(n.color);return"/"+e+" "+n.fontSize+" Tf "+t}};Ge.internal={Bezier_C:.551915024494,calculateCross:function(n){var e=Ge.internal.getWidth(n),t=Ge.internal.getHeight(n),r=Math.min(e,t);return{x1:{x:(e-r)/2,y:(t-r)/2+r},x2:{x:(e-r)/2+r,y:(t-r)/2},x3:{x:(e-r)/2,y:(t-r)/2},x4:{x:(e-r)/2+r,y:(t-r)/2+r}}}},Ge.internal.getWidth=function(n){var e=0;return Zt(n)==="object"&&(e=Fv(n.Rect[2])),e},Ge.internal.getHeight=function(n){var e=0;return Zt(n)==="object"&&(e=Fv(n.Rect[3])),e};var w8=Dn.addField=function(n){if(v8(this,n),!(n instanceof fs))throw new Error("Invalid argument passed to jsPDF.addField.");var e;return(e=n).scope.internal.acroformPlugin.printedOut&&(e.scope.internal.acroformPlugin.printedOut=!1,e.scope.internal.acroformPlugin.acroFormDictionaryRoot=null),e.scope.internal.acroformPlugin.acroFormDictionaryRoot.Fields.push(e),n.page=n.scope.internal.getCurrentPageInfo().pageNumber,this};Dn.AcroFormChoiceField=Eu,Dn.AcroFormListBox=Tu,Dn.AcroFormComboBox=Su,Dn.AcroFormEditBox=hf,Dn.AcroFormButton=ur,Dn.AcroFormPushButton=df,Dn.AcroFormRadioButton=Pu,Dn.AcroFormCheckBox=ff,Dn.AcroFormTextField=dc,Dn.AcroFormPasswordField=pf,Dn.AcroFormAppearance=Ge,Dn.AcroForm={ChoiceField:Eu,ListBox:Tu,ComboBox:Su,EditBox:hf,Button:ur,PushButton:df,RadioButton:Pu,CheckBox:ff,TextField:dc,PasswordField:pf,Appearance:Ge},rt.AcroForm={ChoiceField:Eu,ListBox:Tu,ComboBox:Su,EditBox:hf,Button:ur,PushButton:df,RadioButton:Pu,CheckBox:ff,TextField:dc,PasswordField:pf,Appearance:Ge};rt.AcroForm;function fE(n){return n.reduce(function(e,t,r){return e[t]=r,e},{})}(function(n){var e="addImage_";n.__addimage__={};var t="UNKNOWN",r={PNG:[[137,80,78,71]],TIFF:[[77,77,0,42],[73,73,42,0]],JPEG:[[255,216,255,224,void 0,void 0,74,70,73,70,0],[255,216,255,225,void 0,void 0,69,120,105,102,0,0],[255,216,255,219],[255,216,255,238]],JPEG2000:[[0,0,0,12,106,80,32,32]],GIF87a:[[71,73,70,56,55,97]],GIF89a:[[71,73,70,56,57,97]],WEBP:[[82,73,70,70,void 0,void 0,void 0,void 0,87,69,66,80]],BMP:[[66,77],[66,65],[67,73],[67,80],[73,67],[80,84]]},i=n.__addimage__.getImageFileTypeByImageData=function(b,E){var T,J,fe,ye,_e,ce=t;if((E=E||t)==="RGBA"||b.data!==void 0&&b.data instanceof Uint8ClampedArray&&"height"in b&&"width"in b)return"RGBA";if(de(b))for(_e in r)for(fe=r[_e],T=0;T<fe.length;T+=1){for(ye=!0,J=0;J<fe[T].length;J+=1)if(fe[T][J]!==void 0&&fe[T][J]!==b[J]){ye=!1;break}if(ye===!0){ce=_e;break}}else for(_e in r)for(fe=r[_e],T=0;T<fe.length;T+=1){for(ye=!0,J=0;J<fe[T].length;J+=1)if(fe[T][J]!==void 0&&fe[T][J]!==b.charCodeAt(J)){ye=!1;break}if(ye===!0){ce=_e;break}}return ce===t&&E!==t&&(ce=E),ce},s=function b(E){for(var T=this.internal.write,J=this.internal.putStream,fe=(0,this.internal.getFilters)();fe.indexOf("FlateEncode")!==-1;)fe.splice(fe.indexOf("FlateEncode"),1);E.objectId=this.internal.newObject();var ye=[];if(ye.push({key:"Type",value:"/XObject"}),ye.push({key:"Subtype",value:"/Image"}),ye.push({key:"Width",value:E.width}),ye.push({key:"Height",value:E.height}),E.colorSpace===k.INDEXED?ye.push({key:"ColorSpace",value:"[/Indexed /DeviceRGB "+(E.palette.length/3-1)+" "+("sMask"in E&&E.sMask!==void 0?E.objectId+2:E.objectId+1)+" 0 R]"}):(ye.push({key:"ColorSpace",value:"/"+E.colorSpace}),E.colorSpace===k.DEVICE_CMYK&&ye.push({key:"Decode",value:"[1 0 1 0 1 0 1 0]"})),ye.push({key:"BitsPerComponent",value:E.bitsPerComponent}),"decodeParameters"in E&&E.decodeParameters!==void 0&&ye.push({key:"DecodeParms",value:"<<"+E.decodeParameters+">>"}),"transparency"in E&&Array.isArray(E.transparency)&&E.transparency.length>0){for(var _e="",ce=0,ve=E.transparency.length;ce<ve;ce++)_e+=E.transparency[ce]+" "+E.transparency[ce]+" ";ye.push({key:"Mask",value:"["+_e+"]"})}E.sMask!==void 0&&ye.push({key:"SMask",value:E.objectId+1+" 0 R"});var Oe=E.filter!==void 0?["/"+E.filter]:void 0;if(J({data:E.data,additionalKeyValues:ye,alreadyAppliedFilters:Oe,objectId:E.objectId}),T("endobj"),"sMask"in E&&E.sMask!==void 0){var xe,O=(xe=E.sMaskBitsPerComponent)!==null&&xe!==void 0?xe:E.bitsPerComponent,H={width:E.width,height:E.height,colorSpace:"DeviceGray",bitsPerComponent:O,data:E.sMask};"filter"in E&&(H.decodeParameters="/Predictor ".concat(E.predictor," /Colors 1 /BitsPerComponent ").concat(O," /Columns ").concat(E.width),H.filter=E.filter),b.call(this,H)}if(E.colorSpace===k.INDEXED){var Y=this.internal.newObject();J({data:x(new Uint8Array(E.palette)),objectId:Y}),T("endobj")}},o=function(){var b=this.internal.collections[e+"images"];for(var E in b)s.call(this,b[E])},a=function(){var b,E=this.internal.collections[e+"images"],T=this.internal.write;for(var J in E)T("/I"+(b=E[J]).index,b.objectId,"0","R")},c=function(){this.internal.collections[e+"images"]||(this.internal.collections[e+"images"]={},this.internal.events.subscribe("putResources",o),this.internal.events.subscribe("putXobjectDict",a))},u=function(){var b=this.internal.collections[e+"images"];return c.call(this),b},d=function(){return Object.keys(this.internal.collections[e+"images"]).length},g=function(b){return typeof n["process"+b.toUpperCase()]=="function"},y=function(b){return Zt(b)==="object"&&b.nodeType===1},p=function(b,E){if(b.nodeName==="IMG"&&b.hasAttribute("src")){var T=""+b.getAttribute("src");if(T.indexOf("data:image/")===0)return lf(unescape(T).split("base64,").pop());var J=n.loadFile(T,!0);if(J!==void 0)return J}if(b.nodeName==="CANVAS"){if(b.width===0||b.height===0)throw new Error("Given canvas must have data. Canvas width: "+b.width+", height: "+b.height);var fe;switch(E){case"PNG":fe="image/png";break;case"WEBP":fe="image/webp";break;default:fe="image/jpeg"}return lf(b.toDataURL(fe,1).split("base64,").pop())}},S=function(b){var E=this.internal.collections[e+"images"];if(E){for(var T in E)if(b===E[T].alias)return E[T]}},N=function(b,E,T){return b||E||(b=-96,E=-96),b<0&&(b=-1*T.width*72/b/this.internal.scaleFactor),E<0&&(E=-1*T.height*72/E/this.internal.scaleFactor),b===0&&(b=E*T.width/T.height),E===0&&(E=b*T.height/T.width),[b,E]},C=function(b,E,T,J,fe,ye){var _e=N.call(this,T,J,fe),ce=this.internal.getCoordinateString,ve=this.internal.getVerticalCoordinateString,Oe=u.call(this);if(T=_e[0],J=_e[1],Oe[fe.index]=fe,ye){ye*=Math.PI/180;var xe=Math.cos(ye),O=Math.sin(ye),H=function(X){return X.toFixed(4)},Y=[H(xe),H(O),H(-1*O),H(xe),0,0,"cm"]}this.internal.write("q"),ye?(this.internal.write([1,"0","0",1,ce(b),ve(E+J),"cm"].join(" ")),this.internal.write(Y.join(" ")),this.internal.write([ce(T),"0","0",ce(J),"0","0","cm"].join(" "))):this.internal.write([ce(T),"0","0",ce(J),ce(b),ve(E+J),"cm"].join(" ")),this.isAdvancedAPI()&&this.internal.write([1,0,0,-1,0,0,"cm"].join(" ")),this.internal.write("/I"+fe.index+" Do"),this.internal.write("Q")},k=n.color_spaces={DEVICE_RGB:"DeviceRGB",DEVICE_GRAY:"DeviceGray",DEVICE_CMYK:"DeviceCMYK",CAL_GREY:"CalGray",CAL_RGB:"CalRGB",LAB:"Lab",ICC_BASED:"ICCBased",INDEXED:"Indexed",PATTERN:"Pattern",SEPARATION:"Separation",DEVICE_N:"DeviceN"};n.decode={DCT_DECODE:"DCTDecode",FLATE_DECODE:"FlateDecode",LZW_DECODE:"LZWDecode",JPX_DECODE:"JPXDecode",JBIG2_DECODE:"JBIG2Decode",ASCII85_DECODE:"ASCII85Decode",ASCII_HEX_DECODE:"ASCIIHexDecode",RUN_LENGTH_DECODE:"RunLengthDecode",CCITT_FAX_DECODE:"CCITTFaxDecode"};var K=n.image_compression={NONE:"NONE",FAST:"FAST",MEDIUM:"MEDIUM",SLOW:"SLOW"},G=n.__addimage__.sHashCode=function(b){var E,T,J=0;if(typeof b=="string")for(T=b.length,E=0;E<T;E++)J=(J<<5)-J+b.charCodeAt(E),J|=0;else if(de(b))for(T=b.byteLength/2,E=0;E<T;E++)J=(J<<5)-J+b[E],J|=0;return J},W=n.__addimage__.validateStringAsBase64=function(b){(b=b||"").toString().trim();var E=!0;return b.length===0&&(E=!1),b.length%4!=0&&(E=!1),/^[A-Za-z0-9+/]+$/.test(b.substr(0,b.length-2))===!1&&(E=!1),/^[A-Za-z0-9/][A-Za-z0-9+/]|[A-Za-z0-9+/]=|==$/.test(b.substr(-2))===!1&&(E=!1),E},ne=n.__addimage__.extractImageFromDataUrl=function(b){if(b==null||!(b=b.trim()).startsWith("data:"))return null;var E=b.indexOf(",");return E<0?null:b.substring(0,E).trim().endsWith("base64")?b.substring(E+1):null};n.__addimage__.isArrayBuffer=function(b){return b instanceof ArrayBuffer};var de=n.__addimage__.isArrayBufferView=function(b){return b instanceof Int8Array||b instanceof Uint8Array||b instanceof Uint8ClampedArray||b instanceof Int16Array||b instanceof Uint16Array||b instanceof Int32Array||b instanceof Uint32Array||b instanceof Float32Array||b instanceof Float64Array},B=n.__addimage__.binaryStringToUint8Array=function(b){for(var E=b.length,T=new Uint8Array(E),J=0;J<E;J++)T[J]=b.charCodeAt(J);return T},x=n.__addimage__.arrayBufferToBinaryString=function(b){for(var E="",T=de(b)?b:new Uint8Array(b),J=0;J<T.length;J+=8192)E+=String.fromCharCode.apply(null,T.subarray(J,J+8192));return E};n.addImage=function(){var b,E,T,J,fe,ye,_e,ce,ve;if(typeof arguments[1]=="number"?(E=t,T=arguments[1],J=arguments[2],fe=arguments[3],ye=arguments[4],_e=arguments[5],ce=arguments[6],ve=arguments[7]):(E=arguments[1],T=arguments[2],J=arguments[3],fe=arguments[4],ye=arguments[5],_e=arguments[6],ce=arguments[7],ve=arguments[8]),Zt(b=arguments[0])==="object"&&!y(b)&&"imageData"in b){var Oe=b;b=Oe.imageData,E=Oe.format||E||t,T=Oe.x||T||0,J=Oe.y||J||0,fe=Oe.w||Oe.width||fe,ye=Oe.h||Oe.height||ye,_e=Oe.alias||_e,ce=Oe.compression||ce,ve=Oe.rotation||Oe.angle||ve}var xe=this.internal.getFilters();if(ce===void 0&&xe.indexOf("FlateEncode")!==-1&&(ce="SLOW"),isNaN(T)||isNaN(J))throw new Error("Invalid coordinates passed to jsPDF.addImage");c.call(this);var O=A.call(this,b,E,_e,ce);return C.call(this,T,J,fe,ye,O,ve),this};var A=function(b,E,T,J){var fe,ye,_e;if(typeof b=="string"&&i(b)===t){b=unescape(b);var ce=F(b,!1);(ce!==""||(ce=n.loadFile(b,!0))!==void 0)&&(b=ce)}if(y(b)&&(b=p(b,E)),E=i(b,E),!g(E))throw new Error("addImage does not support files of type '"+E+"', please ensure that a plugin for '"+E+"' support is added.");if(((_e=T)==null||_e.length===0)&&(T=(function(ve){return typeof ve=="string"||de(ve)?G(ve):de(ve.data)?G(ve.data):null})(b)),(fe=S.call(this,T))||(b instanceof Uint8Array||E==="RGBA"||(ye=b,b=B(b)),fe=this["process"+E.toUpperCase()](b,d.call(this),T,(function(ve){return ve&&typeof ve=="string"&&(ve=ve.toUpperCase()),ve in n.image_compression?ve:K.NONE})(J),ye)),!fe)throw new Error("An unknown error occurred whilst processing the image.");return fe},F=n.__addimage__.convertBase64ToBinaryString=function(b,E){E=typeof E!="boolean"||E;var T,J="";if(typeof b=="string"){var fe;T=(fe=ne(b))!==null&&fe!==void 0?fe:b;try{J=lf(T)}catch(ye){if(E)throw W(T)?new Error("atob-Error in jsPDF.convertBase64ToBinaryString "+ye.message):new Error("Supplied Data is not a valid base64-String jsPDF.convertBase64ToBinaryString ")}}return J};n.getImageProperties=function(b){var E,T,J="";if(y(b)&&(b=p(b)),typeof b=="string"&&i(b)===t&&((J=F(b,!1))===""&&(J=n.loadFile(b)||""),b=J),T=i(b),!g(T))throw new Error("addImage does not support files of type '"+T+"', please ensure that a plugin for '"+T+"' support is added.");if(b instanceof Uint8Array||(b=B(b)),!(E=this["process"+T.toUpperCase()](b)))throw new Error("An unknown error occurred whilst processing the image");return E.fileType=T,E}})(rt.API),(function(n){var e=function(t){if(t!==void 0&&t!="")return!0};rt.API.events.push(["addPage",function(t){this.internal.getPageInfo(t.pageNumber).pageContext.annotations=[]}]),n.events.push(["putPage",function(t){for(var r,i,s,o=this.internal.getCoordinateString,a=this.internal.getVerticalCoordinateString,c=this.internal.getPageInfoByObjId(t.objId),u=t.pageContext.annotations,d=!1,g=0;g<u.length&&!d;g++)switch((r=u[g]).type){case"link":(e(r.options.url)||e(r.options.pageNumber))&&(d=!0);break;case"reference":case"text":case"freetext":d=!0}if(d!=0){this.internal.write("/Annots [");for(var y=0;y<u.length;y++){r=u[y];var p=this.internal.pdfEscape,S=this.internal.getEncryptor(t.objId);switch(r.type){case"reference":this.internal.write(" "+r.object.objId+" 0 R ");break;case"text":var N=this.internal.newAdditionalObject(),C=this.internal.newAdditionalObject(),k=this.internal.getEncryptor(N.objId),K=r.title||"Note";s="<</Type /Annot /Subtype /Text "+(i="/Rect ["+o(r.bounds.x)+" "+a(r.bounds.y+r.bounds.h)+" "+o(r.bounds.x+r.bounds.w)+" "+a(r.bounds.y)+"] ")+"/Contents ("+p(k(r.contents))+")",s+=" /Popup "+C.objId+" 0 R",s+=" /P "+c.objId+" 0 R",s+=" /T ("+p(k(K))+") >>",N.content=s;var G=N.objId+" 0 R";s="<</Type /Annot /Subtype /Popup "+(i="/Rect ["+o(r.bounds.x+30)+" "+a(r.bounds.y+r.bounds.h)+" "+o(r.bounds.x+r.bounds.w+30)+" "+a(r.bounds.y)+"] ")+" /Parent "+G,r.open&&(s+=" /Open true"),s+=" >>",C.content=s,this.internal.write(N.objId,"0 R",C.objId,"0 R");break;case"freetext":i="/Rect ["+o(r.bounds.x)+" "+a(r.bounds.y)+" "+o(r.bounds.x+r.bounds.w)+" "+a(r.bounds.y+r.bounds.h)+"] ";var W=r.color||"#000000";s="<</Type /Annot /Subtype /FreeText "+i+"/Contents ("+p(S(r.contents))+")",s+=" /DS(font: Helvetica,sans-serif 12.0pt; text-align:left; color:#"+W+")",s+=" /Border [0 0 0]",s+=" >>",this.internal.write(s);break;case"link":if(r.options.name){var ne=this.annotations._nameMap[r.options.name];r.options.pageNumber=ne.page,r.options.top=ne.y}else r.options.top||(r.options.top=0);if(i="/Rect ["+r.finalBounds.x+" "+r.finalBounds.y+" "+r.finalBounds.w+" "+r.finalBounds.h+"] ",s="",r.options.url)s="<</Type /Annot /Subtype /Link "+i+"/Border [0 0 0] /A <</S /URI /URI ("+p(S(r.options.url))+") >>";else if(r.options.pageNumber)switch(s="<</Type /Annot /Subtype /Link "+i+"/Border [0 0 0] /Dest ["+this.internal.getPageInfo(r.options.pageNumber).objId+" 0 R",r.options.magFactor=r.options.magFactor||"XYZ",r.options.magFactor){case"Fit":s+=" /Fit]";break;case"FitH":s+=" /FitH "+r.options.top+"]";break;case"FitV":r.options.left=r.options.left||0,s+=" /FitV "+r.options.left+"]";break;default:var de=a(r.options.top);r.options.left=r.options.left||0,r.options.zoom===void 0&&(r.options.zoom=0),s+=" /XYZ "+r.options.left+" "+de+" "+r.options.zoom+"]"}s!=""&&(s+=" >>",this.internal.write(s))}}this.internal.write("]")}}]),n.createAnnotation=function(t){var r=this.internal.getCurrentPageInfo();switch(t.type){case"link":this.link(t.bounds.x,t.bounds.y,t.bounds.w,t.bounds.h,t);break;case"text":case"freetext":r.pageContext.annotations.push(t)}},n.link=function(t,r,i,s,o){var a=this.internal.getCurrentPageInfo(),c=this.internal.getCoordinateString,u=this.internal.getVerticalCoordinateString;a.pageContext.annotations.push({finalBounds:{x:c(t),y:u(r),w:c(t+i),h:u(r+s)},options:o,type:"link"})},n.textWithLink=function(t,r,i,s){var o,a,c=this.getTextWidth(t),u=this.internal.getLineHeight()/this.internal.scaleFactor;if(s.maxWidth!==void 0){a=s.maxWidth;var d=this.splitTextToSize(t,a).length;o=Math.ceil(u*d)}else a=c,o=u;return this.text(t,r,i,s),i+=.2*u,s.align==="center"&&(r-=c/2),s.align==="right"&&(r-=c),this.link(r,i-u,a,o,s),c},n.getTextWidth=function(t){var r=this.internal.getFontSize();return this.getStringUnitWidth(t)*r/this.internal.scaleFactor}})(rt.API),(function(n){var e={1569:[65152],1570:[65153,65154],1571:[65155,65156],1572:[65157,65158],1573:[65159,65160],1574:[65161,65162,65163,65164],1575:[65165,65166],1576:[65167,65168,65169,65170],1577:[65171,65172],1578:[65173,65174,65175,65176],1579:[65177,65178,65179,65180],1580:[65181,65182,65183,65184],1581:[65185,65186,65187,65188],1582:[65189,65190,65191,65192],1583:[65193,65194],1584:[65195,65196],1585:[65197,65198],1586:[65199,65200],1587:[65201,65202,65203,65204],1588:[65205,65206,65207,65208],1589:[65209,65210,65211,65212],1590:[65213,65214,65215,65216],1591:[65217,65218,65219,65220],1592:[65221,65222,65223,65224],1593:[65225,65226,65227,65228],1594:[65229,65230,65231,65232],1601:[65233,65234,65235,65236],1602:[65237,65238,65239,65240],1603:[65241,65242,65243,65244],1604:[65245,65246,65247,65248],1605:[65249,65250,65251,65252],1606:[65253,65254,65255,65256],1607:[65257,65258,65259,65260],1608:[65261,65262],1609:[65263,65264,64488,64489],1610:[65265,65266,65267,65268],1649:[64336,64337],1655:[64477],1657:[64358,64359,64360,64361],1658:[64350,64351,64352,64353],1659:[64338,64339,64340,64341],1662:[64342,64343,64344,64345],1663:[64354,64355,64356,64357],1664:[64346,64347,64348,64349],1667:[64374,64375,64376,64377],1668:[64370,64371,64372,64373],1670:[64378,64379,64380,64381],1671:[64382,64383,64384,64385],1672:[64392,64393],1676:[64388,64389],1677:[64386,64387],1678:[64390,64391],1681:[64396,64397],1688:[64394,64395],1700:[64362,64363,64364,64365],1702:[64366,64367,64368,64369],1705:[64398,64399,64400,64401],1709:[64467,64468,64469,64470],1711:[64402,64403,64404,64405],1713:[64410,64411,64412,64413],1715:[64406,64407,64408,64409],1722:[64414,64415],1723:[64416,64417,64418,64419],1726:[64426,64427,64428,64429],1728:[64420,64421],1729:[64422,64423,64424,64425],1733:[64480,64481],1734:[64473,64474],1735:[64471,64472],1736:[64475,64476],1737:[64482,64483],1739:[64478,64479],1740:[64508,64509,64510,64511],1744:[64484,64485,64486,64487],1746:[64430,64431],1747:[64432,64433]},t={65247:{65154:65269,65156:65271,65160:65273,65166:65275},65248:{65154:65270,65156:65272,65160:65274,65166:65276},65165:{65247:{65248:{65258:65010}}},1617:{1612:64606,1613:64607,1614:64608,1615:64609,1616:64610}},r={1612:64606,1613:64607,1614:64608,1615:64609,1616:64610},i=[1570,1571,1573,1575];n.__arabicParser__={};var s=n.__arabicParser__.isInArabicSubstitutionA=function(N){return e[N.charCodeAt(0)]!==void 0},o=n.__arabicParser__.isArabicLetter=function(N){return typeof N=="string"&&/^[\u0600-\u06FF\u0750-\u077F\u08A0-\u08FF\uFB50-\uFDFF\uFE70-\uFEFF]+$/.test(N)},a=n.__arabicParser__.isArabicEndLetter=function(N){return o(N)&&s(N)&&e[N.charCodeAt(0)].length<=2},c=n.__arabicParser__.isArabicAlfLetter=function(N){return o(N)&&i.indexOf(N.charCodeAt(0))>=0};n.__arabicParser__.arabicLetterHasIsolatedForm=function(N){return o(N)&&s(N)&&e[N.charCodeAt(0)].length>=1};var u=n.__arabicParser__.arabicLetterHasFinalForm=function(N){return o(N)&&s(N)&&e[N.charCodeAt(0)].length>=2};n.__arabicParser__.arabicLetterHasInitialForm=function(N){return o(N)&&s(N)&&e[N.charCodeAt(0)].length>=3};var d=n.__arabicParser__.arabicLetterHasMedialForm=function(N){return o(N)&&s(N)&&e[N.charCodeAt(0)].length==4},g=n.__arabicParser__.resolveLigatures=function(N){var C=0,k=t,K="",G=0;for(C=0;C<N.length;C+=1)k[N.charCodeAt(C)]!==void 0?(G++,typeof(k=k[N.charCodeAt(C)])=="number"&&(K+=String.fromCharCode(k),k=t,G=0),C===N.length-1&&(k=t,K+=N.charAt(C-(G-1)),C-=G-1,G=0)):(k=t,K+=N.charAt(C-G),C-=G,G=0);return K};n.__arabicParser__.isArabicDiacritic=function(N){return N!==void 0&&r[N.charCodeAt(0)]!==void 0};var y=n.__arabicParser__.getCorrectForm=function(N,C,k){return o(N)?s(N)===!1?-1:!u(N)||!o(C)&&!o(k)||!o(k)&&a(C)||a(N)&&!o(C)||a(N)&&c(C)||a(N)&&a(C)?0:d(N)&&o(C)&&!a(C)&&o(k)&&u(k)?3:a(N)||!o(k)?1:2:-1},p=function(N){var C=0,k=0,K=0,G="",W="",ne="",de=(N=N||"").split("\\s+"),B=[];for(C=0;C<de.length;C+=1){for(B.push(""),k=0;k<de[C].length;k+=1)G=de[C][k],W=de[C][k-1],ne=de[C][k+1],o(G)?(K=y(G,W,ne),B[C]+=K!==-1?String.fromCharCode(e[G.charCodeAt(0)][K]):G):B[C]+=G;B[C]=g(B[C])}return B.join(" ")},S=n.__arabicParser__.processArabic=n.processArabic=function(){var N,C=typeof arguments[0]=="string"?arguments[0]:arguments[0].text,k=[];if(Array.isArray(C)){var K=0;for(k=[],K=0;K<C.length;K+=1)Array.isArray(C[K])?k.push([p(C[K][0]),C[K][1],C[K][2]]):k.push([p(C[K])]);N=k}else N=p(C);return typeof arguments[0]=="string"?N:(arguments[0].text=N,arguments[0])};n.events.push(["preProcessText",S])})(rt.API),rt.API.autoPrint=function(n){var e;return(n=n||{}).variant=n.variant||"non-conform",n.variant==="javascript"?this.addJS("print({});"):(this.internal.events.subscribe("postPutResources",function(){e=this.internal.newObject(),this.internal.out("<<"),this.internal.out("/S /Named"),this.internal.out("/Type /Action"),this.internal.out("/N /Print"),this.internal.out(">>"),this.internal.out("endobj")}),this.internal.events.subscribe("putCatalog",function(){this.internal.out("/OpenAction "+e+" 0 R")})),this},(function(n){var e=function(){var t=void 0;Object.defineProperty(this,"pdf",{get:function(){return t},set:function(a){t=a}});var r=150;Object.defineProperty(this,"width",{get:function(){return r},set:function(a){r=isNaN(a)||Number.isInteger(a)===!1||a<0?150:a,this.getContext("2d").pageWrapXEnabled&&(this.getContext("2d").pageWrapX=r+1)}});var i=300;Object.defineProperty(this,"height",{get:function(){return i},set:function(a){i=isNaN(a)||Number.isInteger(a)===!1||a<0?300:a,this.getContext("2d").pageWrapYEnabled&&(this.getContext("2d").pageWrapY=i+1)}});var s=[];Object.defineProperty(this,"childNodes",{get:function(){return s},set:function(a){s=a}});var o={};Object.defineProperty(this,"style",{get:function(){return o},set:function(a){o=a}}),Object.defineProperty(this,"parentNode",{})};e.prototype.getContext=function(t,r){var i;if((t=t||"2d")!=="2d")return null;for(i in r)this.pdf.context2d.hasOwnProperty(i)&&(this.pdf.context2d[i]=r[i]);return this.pdf.context2d._canvas=this,this.pdf.context2d},e.prototype.toDataURL=function(){throw new Error("toDataURL is not implemented.")},n.events.push(["initialized",function(){this.canvas=new e,this.canvas.pdf=this}])})(rt.API),(function(n){var e={left:0,top:0,bottom:0,right:0},t=!1,r=function(){this.internal.__cell__===void 0&&(this.internal.__cell__={},this.internal.__cell__.padding=3,this.internal.__cell__.headerFunction=void 0,this.internal.__cell__.margins=Object.assign({},e),this.internal.__cell__.margins.width=this.getPageWidth(),i.call(this))},i=function(){this.internal.__cell__.lastCell=new s,this.internal.__cell__.pages=1},s=function(){var c=arguments[0];Object.defineProperty(this,"x",{enumerable:!0,get:function(){return c},set:function(N){c=N}});var u=arguments[1];Object.defineProperty(this,"y",{enumerable:!0,get:function(){return u},set:function(N){u=N}});var d=arguments[2];Object.defineProperty(this,"width",{enumerable:!0,get:function(){return d},set:function(N){d=N}});var g=arguments[3];Object.defineProperty(this,"height",{enumerable:!0,get:function(){return g},set:function(N){g=N}});var y=arguments[4];Object.defineProperty(this,"text",{enumerable:!0,get:function(){return y},set:function(N){y=N}});var p=arguments[5];Object.defineProperty(this,"lineNumber",{enumerable:!0,get:function(){return p},set:function(N){p=N}});var S=arguments[6];return Object.defineProperty(this,"align",{enumerable:!0,get:function(){return S},set:function(N){S=N}}),this};s.prototype.clone=function(){return new s(this.x,this.y,this.width,this.height,this.text,this.lineNumber,this.align)},s.prototype.toArray=function(){return[this.x,this.y,this.width,this.height,this.text,this.lineNumber,this.align]},n.setHeaderFunction=function(c){return r.call(this),this.internal.__cell__.headerFunction=typeof c=="function"?c:void 0,this},n.getTextDimensions=function(c,u){r.call(this);var d=(u=u||{}).fontSize||this.getFontSize(),g=u.font||this.getFont(),y=u.scaleFactor||this.internal.scaleFactor,p=0,S=0,N=0,C=this;if(!Array.isArray(c)&&typeof c!="string"){if(typeof c!="number")throw new Error("getTextDimensions expects text-parameter to be of type String or type Number or an Array of Strings.");c=String(c)}var k=u.maxWidth;k>0?typeof c=="string"?c=this.splitTextToSize(c,k):Object.prototype.toString.call(c)==="[object Array]"&&(c=c.reduce(function(G,W){return G.concat(C.splitTextToSize(W,k))},[])):c=Array.isArray(c)?c:[c];for(var K=0;K<c.length;K++)p<(N=this.getStringUnitWidth(c[K],{font:g})*d)&&(p=N);return p!==0&&(S=c.length),{w:p/=y,h:Math.max((S*d*this.getLineHeightFactor()-d*(this.getLineHeightFactor()-1))/y,0)}},n.cellAddPage=function(){r.call(this),this.addPage();var c=this.internal.__cell__.margins||e;return this.internal.__cell__.lastCell=new s(c.left,c.top,void 0,void 0),this.internal.__cell__.pages+=1,this};var o=n.cell=function(){var c;c=arguments[0]instanceof s?arguments[0]:new s(arguments[0],arguments[1],arguments[2],arguments[3],arguments[4],arguments[5],arguments[6]),r.call(this);var u=this.internal.__cell__.lastCell,d=this.internal.__cell__.padding,g=this.internal.__cell__.margins||e,y=this.internal.__cell__.tableHeaderRow,p=this.internal.__cell__.printHeaders;return u.lineNumber!==void 0&&(u.lineNumber===c.lineNumber?(c.x=(u.x||0)+(u.width||0),c.y=u.y||0):u.y+u.height+c.height+g.bottom>this.getPageHeight()?(this.cellAddPage(),c.y=g.top,p&&y&&(this.printHeaderRow(c.lineNumber,!0),c.y+=y[0].height)):c.y=u.y+u.height||c.y),c.text[0]!==void 0&&(this.rect(c.x,c.y,c.width,c.height,t===!0?"FD":void 0),c.align==="right"?this.text(c.text,c.x+c.width-d,c.y+d,{align:"right",baseline:"top"}):c.align==="center"?this.text(c.text,c.x+c.width/2,c.y+d,{align:"center",baseline:"top",maxWidth:c.width-d-d}):this.text(c.text,c.x+d,c.y+d,{align:"left",baseline:"top",maxWidth:c.width-d-d})),this.internal.__cell__.lastCell=c,this};n.table=function(c,u,d,g,y){if(r.call(this),!d)throw new Error("No data for PDF table.");var p,S,N,C,k=[],K=[],G=[],W={},ne={},de=[],B=[],x=(y=y||{}).autoSize||!1,A=y.printHeaders!==!1,F=y.css&&y.css["font-size"]!==void 0?16*y.css["font-size"]:y.fontSize||12,b=y.margins||Object.assign({width:this.getPageWidth()},e),E=typeof y.padding=="number"?y.padding:3,T=y.headerBackgroundColor||"#c8c8c8",J=y.headerTextColor||"#000";if(i.call(this),this.internal.__cell__.printHeaders=A,this.internal.__cell__.margins=b,this.internal.__cell__.table_font_size=F,this.internal.__cell__.padding=E,this.internal.__cell__.headerBackgroundColor=T,this.internal.__cell__.headerTextColor=J,this.setFontSize(F),g==null)K=k=Object.keys(d[0]),G=k.map(function(){return"left"});else if(Array.isArray(g)&&Zt(g[0])==="object")for(k=g.map(function(Oe){return Oe.name}),K=g.map(function(Oe){return Oe.prompt||Oe.name||""}),G=g.map(function(Oe){return Oe.align||"left"}),p=0;p<g.length;p+=1)ne[g[p].name]=.7499990551181103*g[p].width;else Array.isArray(g)&&typeof g[0]=="string"&&(K=k=g,G=k.map(function(){return"left"}));if(x||Array.isArray(g)&&typeof g[0]=="string")for(p=0;p<k.length;p+=1){for(W[C=k[p]]=d.map(function(Oe){return Oe[C]}),this.setFont(void 0,"bold"),de.push(this.getTextDimensions(K[p],{fontSize:this.internal.__cell__.table_font_size,scaleFactor:this.internal.scaleFactor}).w),S=W[C],this.setFont(void 0,"normal"),N=0;N<S.length;N+=1)de.push(this.getTextDimensions(S[N],{fontSize:this.internal.__cell__.table_font_size,scaleFactor:this.internal.scaleFactor}).w);ne[C]=Math.max.apply(null,de)+E+E,de=[]}if(A){var fe={};for(p=0;p<k.length;p+=1)fe[k[p]]={},fe[k[p]].text=K[p],fe[k[p]].align=G[p];var ye=a.call(this,fe,ne);B=k.map(function(Oe){return new s(c,u,ne[Oe],ye,fe[Oe].text,void 0,fe[Oe].align)}),this.setTableHeaderRow(B),this.printHeaderRow(1,!1)}var _e=g.reduce(function(Oe,xe){return Oe[xe.name]=xe.align,Oe},{});for(p=0;p<d.length;p+=1){"rowStart"in y&&y.rowStart instanceof Function&&y.rowStart({row:p,data:d[p]},this);var ce=a.call(this,d[p],ne);for(N=0;N<k.length;N+=1){var ve=d[p][k[N]];"cellStart"in y&&y.cellStart instanceof Function&&y.cellStart({row:p,col:N,data:ve},this),o.call(this,new s(c,u,ne[k[N]],ce,ve,p+2,_e[k[N]]))}}return this.internal.__cell__.table_x=c,this.internal.__cell__.table_y=u,this};var a=function(c,u){var d=this.internal.__cell__.padding,g=this.internal.__cell__.table_font_size,y=this.internal.scaleFactor;return Object.keys(c).map(function(p){var S=c[p];return this.splitTextToSize(S.hasOwnProperty("text")?S.text:S,u[p]-d-d)},this).map(function(p){return this.getLineHeightFactor()*p.length*g/y+d+d},this).reduce(function(p,S){return Math.max(p,S)},0)};n.setTableHeaderRow=function(c){r.call(this),this.internal.__cell__.tableHeaderRow=c},n.printHeaderRow=function(c,u){if(r.call(this),!this.internal.__cell__.tableHeaderRow)throw new Error("Property tableHeaderRow does not exist.");var d;if(t=!0,typeof this.internal.__cell__.headerFunction=="function"){var g=this.internal.__cell__.headerFunction(this,this.internal.__cell__.pages);this.internal.__cell__.lastCell=new s(g[0],g[1],g[2],g[3],void 0,-1)}this.setFont(void 0,"bold");for(var y=[],p=0;p<this.internal.__cell__.tableHeaderRow.length;p+=1){d=this.internal.__cell__.tableHeaderRow[p].clone(),u&&(d.y=this.internal.__cell__.margins.top||0,y.push(d)),d.lineNumber=c;var S=this.getTextColor();this.setTextColor(this.internal.__cell__.headerTextColor),this.setFillColor(this.internal.__cell__.headerBackgroundColor),o.call(this,d),this.setTextColor(S)}y.length>0&&this.setTableHeaderRow(y),this.setFont(void 0,"normal"),t=!1}})(rt.API);var pE={italic:["italic","oblique","normal"],oblique:["oblique","italic","normal"],normal:["normal","oblique","italic"]},gE=["ultra-condensed","extra-condensed","condensed","semi-condensed","normal","semi-expanded","expanded","extra-expanded","ultra-expanded"],Hm=fE(gE),mE=[100,200,300,400,500,600,700,800,900],b8=fE(mE);function jg(n){var e=n.family.replace(/"|'/g,"").toLowerCase(),t=(function(s){return pE[s=s||"normal"]?s:"normal"})(n.style),r=(function(s){return s?typeof s=="number"?s>=100&&s<=900&&s%100==0?s:400:/^\d00$/.test(s)?parseInt(s):s==="bold"?700:400:400})(n.weight),i=(function(s){return typeof Hm[s=s||"normal"]=="number"?s:"normal"})(n.stretch);return{family:e,style:t,weight:r,stretch:i,src:n.src||[],ref:n.ref||{name:e,style:[i,t,r].join(" ")}}}function Mv(n,e,t,r){var i;for(i=t;i>=0&&i<e.length;i+=r)if(n[e[i]])return n[e[i]];for(i=t;i>=0&&i<e.length;i-=r)if(n[e[i]])return n[e[i]]}var I8={"sans-serif":"helvetica",fixed:"courier",monospace:"courier",terminal:"courier",cursive:"times",fantasy:"times",serif:"times"},Vv={caption:"times",icon:"times",menu:"times","message-box":"times","small-caption":"times","status-bar":"times"};function Bv(n){return[n.stretch,n.style,n.weight,n.family].join(" ")}function Uv(n){return n.trimLeft()}function A8(n,e){for(var t=0;t<n.length;){if(n.charAt(t)===e)return[n.substring(0,t),n.substring(t+1)];t+=1}return null}function E8(n){var e=n.match(/^(-[a-z_]|[a-z_])[a-z0-9_-]*/i);return e===null?null:[e[0],n.substring(e[0].length)]}var Wd,jv,qv,ou,Hd,zv,$v,Wv,qg=["times"];function Hv(n,e,t,r,i){var s=4,o=Kv;switch(i){case rt.API.image_compression.FAST:s=1,o=Gv;break;case rt.API.image_compression.MEDIUM:s=6,o=Yv;break;case rt.API.image_compression.SLOW:s=9,o=Jv}n=(function(c,u,d,g){for(var y,p=c.length/u,S=new Uint8Array(c.length+p),N=[T8,Gv,Kv,Yv,Jv],C=0;C<p;C+=1){var k=C*u,K=c.subarray(k,k+u);if(g)S.set(g(K,d,y),k+C);else{for(var G=N.length,W=[],ne=0;ne<G;ne+=1)W[ne]=N[ne](K,d,y);var de=P8(W.concat());S.set(W[de],k+C)}y=K}return S})(n,e,Math.ceil(t*r/8),o);var a=Bm(n,{level:s});return rt.API.__addimage__.arrayBufferToBinaryString(a)}function T8(n){var e=Array.apply([],n);return e.unshift(0),e}function Gv(n,e){var t=n.length,r=[];r[0]=1;for(var i=0;i<t;i+=1){var s=n[i-e]||0;r[i+1]=n[i]-s+256&255}return r}function Kv(n,e,t){var r=n.length,i=[];i[0]=2;for(var s=0;s<r;s+=1){var o=t&&t[s]||0;i[s+1]=n[s]-o+256&255}return i}function Yv(n,e,t){var r=n.length,i=[];i[0]=3;for(var s=0;s<r;s+=1){var o=n[s-e]||0,a=t&&t[s]||0;i[s+1]=n[s]+256-(o+a>>>1)&255}return i}function Jv(n,e,t){var r=n.length,i=[];i[0]=4;for(var s=0;s<r;s+=1){var o=S8(n[s-e]||0,t&&t[s]||0,t&&t[s-e]||0);i[s+1]=n[s]-o+256&255}return i}function S8(n,e,t){if(n===e&&e===t)return n;var r=Math.abs(e-t),i=Math.abs(n-t),s=Math.abs(n+e-t-t);return r<=i&&r<=s?n:i<=s?e:t}function P8(n){var e=n.map(function(t){return t.reduce(function(r,i){return r+Math.abs(i)},0)});return e.indexOf(Math.min.apply(null,e))}function zg(n,e,t){var r=e*t,i=Math.floor(r/8),s=16-(r-8*i+t),o=(1<<t)-1;return yE(n,i)>>s&o}function Qv(n,e,t,r){var i=t*r,s=Math.floor(i/8),o=16-(i-8*s+r),a=(1<<r)-1,c=(e&a)<<o;(function(u,d,g){if(d+1<u.byteLength)u.setUint16(d,g,!1);else{var y=g>>8&255;u.setUint8(d,y)}})(n,s,yE(n,s)&~(a<<o)&65535|c)}function yE(n,e){return e+1<n.byteLength?n.getUint16(e,!1):n.getUint8(e)<<8}function x8(n){var e=0;if(n[e++]!==71||n[e++]!==73||n[e++]!==70||n[e++]!==56||(n[e++]+1&253)!=56||n[e++]!==97)throw new Error("Invalid GIF 87a/89a header.");var t=n[e++]|n[e++]<<8,r=n[e++]|n[e++]<<8,i=n[e++],s=i>>7,o=1<<1+(7&i);n[e++],n[e++];var a=null,c=null;s&&(a=e,c=o,e+=3*o);var u=!0,d=[],g=0,y=null,p=0,S=null;for(this.width=t,this.height=r;u&&e<n.length;)switch(n[e++]){case 33:switch(n[e++]){case 255:if(n[e]!==11||n[e+1]==78&&n[e+2]==69&&n[e+3]==84&&n[e+4]==83&&n[e+5]==67&&n[e+6]==65&&n[e+7]==80&&n[e+8]==69&&n[e+9]==50&&n[e+10]==46&&n[e+11]==48&&n[e+12]==3&&n[e+13]==1&&n[e+16]==0)e+=14,S=n[e++]|n[e++]<<8,e++;else for(e+=12;;){if(!((b=n[e++])>=0))throw Error("Invalid block size");if(b===0)break;e+=b}break;case 249:if(n[e++]!==4||n[e+4]!==0)throw new Error("Invalid graphics extension block.");var N=n[e++];g=n[e++]|n[e++]<<8,y=n[e++],1&N||(y=null),p=N>>2&7,e++;break;case 254:for(;;){if(!((b=n[e++])>=0))throw Error("Invalid block size");if(b===0)break;e+=b}break;default:throw new Error("Unknown graphic control label: 0x"+n[e-1].toString(16))}break;case 44:var C=n[e++]|n[e++]<<8,k=n[e++]|n[e++]<<8,K=n[e++]|n[e++]<<8,G=n[e++]|n[e++]<<8,W=n[e++],ne=W>>6&1,de=1<<1+(7&W),B=a,x=c,A=!1;W>>7&&(A=!0,B=e,x=de,e+=3*de);var F=e;for(e++;;){var b;if(!((b=n[e++])>=0))throw Error("Invalid block size");if(b===0)break;e+=b}d.push({x:C,y:k,width:K,height:G,has_local_palette:A,palette_offset:B,palette_size:x,data_offset:F,data_length:e-F,transparent_index:y,interlaced:!!ne,delay:g,disposal:p});break;case 59:u=!1;break;default:throw new Error("Unknown gif block: 0x"+n[e-1].toString(16))}this.numFrames=function(){return d.length},this.loopCount=function(){return S},this.frameInfo=function(E){if(E<0||E>=d.length)throw new Error("Frame index out of range.");return d[E]},this.decodeAndBlitFrameBGRA=function(E,T){var J=this.frameInfo(E),fe=J.width*J.height,ye=new Uint8Array(fe);Xv(n,J.data_offset,ye,fe);var _e=J.palette_offset,ce=J.transparent_index;ce===null&&(ce=256);var ve=J.width,Oe=t-ve,xe=ve,O=4*(J.y*t+J.x),H=4*((J.y+J.height)*t+J.x),Y=O,X=4*Oe;J.interlaced===!0&&(X+=4*t*7);for(var te=8,ae=0,ge=ye.length;ae<ge;++ae){var me=ye[ae];if(xe===0&&(xe=ve,(Y+=X)>=H&&(X=4*Oe+4*t*(te-1),Y=O+(ve+Oe)*(te<<1),te>>=1)),me===ce)Y+=4;else{var Ee=n[_e+3*me],Le=n[_e+3*me+1],je=n[_e+3*me+2];T[Y++]=je,T[Y++]=Le,T[Y++]=Ee,T[Y++]=255}--xe}},this.decodeAndBlitFrameRGBA=function(E,T){var J=this.frameInfo(E),fe=J.width*J.height,ye=new Uint8Array(fe);Xv(n,J.data_offset,ye,fe);var _e=J.palette_offset,ce=J.transparent_index;ce===null&&(ce=256);var ve=J.width,Oe=t-ve,xe=ve,O=4*(J.y*t+J.x),H=4*((J.y+J.height)*t+J.x),Y=O,X=4*Oe;J.interlaced===!0&&(X+=4*t*7);for(var te=8,ae=0,ge=ye.length;ae<ge;++ae){var me=ye[ae];if(xe===0&&(xe=ve,(Y+=X)>=H&&(X=4*Oe+4*t*(te-1),Y=O+(ve+Oe)*(te<<1),te>>=1)),me===ce)Y+=4;else{var Ee=n[_e+3*me],Le=n[_e+3*me+1],je=n[_e+3*me+2];T[Y++]=Ee,T[Y++]=Le,T[Y++]=je,T[Y++]=255}--xe}}}function Xv(n,e,t,r){for(var i=n[e++],s=1<<i,o=s+1,a=o+1,c=i+1,u=(1<<c)-1,d=0,g=0,y=0,p=n[e++],S=new Int32Array(4096),N=null;;){for(;d<16&&p!==0;)g|=n[e++]<<d,d+=8,p===1?p=n[e++]:--p;if(d<c)break;var C=g&u;if(g>>=c,d-=c,C!==s){if(C===o)break;for(var k=C<a?C:N,K=0,G=k;G>s;)G=S[G]>>8,++K;var W=G;if(y+K+(k!==C?1:0)>r)return void cn.log("Warning, gif stream longer than expected.");t[y++]=W;var ne=y+=K;for(k!==C&&(t[y++]=W),G=k;K--;)G=S[G],t[--ne]=255&G,G>>=8;N!==null&&a<4096&&(S[a++]=N<<8|W,a>=u+1&&c<12&&(++c,u=u<<1|1)),N=C}else a=o+1,u=(1<<(c=i+1))-1,N=null}return y!==r&&cn.log("Warning, gif stream shorter than expected."),t}function $g(n){var e,t,r,i,s,o=Math.floor,a=new Array(64),c=new Array(64),u=new Array(64),d=new Array(64),g=new Array(65535),y=new Array(65535),p=new Array(64),S=new Array(64),N=[],C=0,k=7,K=new Array(64),G=new Array(64),W=new Array(64),ne=new Array(256),de=new Array(2048),B=[0,1,5,6,14,15,27,28,2,4,7,13,16,26,29,42,3,8,12,17,25,30,41,43,9,11,18,24,31,40,44,53,10,19,23,32,39,45,52,54,20,22,33,38,46,51,55,60,21,34,37,47,50,56,59,61,35,36,48,49,57,58,62,63],x=[0,0,1,5,1,1,1,1,1,1,0,0,0,0,0,0,0],A=[0,1,2,3,4,5,6,7,8,9,10,11],F=[0,0,2,1,3,3,2,4,3,5,5,4,4,0,0,1,125],b=[1,2,3,0,4,17,5,18,33,49,65,6,19,81,97,7,34,113,20,50,129,145,161,8,35,66,177,193,21,82,209,240,36,51,98,114,130,9,10,22,23,24,25,26,37,38,39,40,41,42,52,53,54,55,56,57,58,67,68,69,70,71,72,73,74,83,84,85,86,87,88,89,90,99,100,101,102,103,104,105,106,115,116,117,118,119,120,121,122,131,132,133,134,135,136,137,138,146,147,148,149,150,151,152,153,154,162,163,164,165,166,167,168,169,170,178,179,180,181,182,183,184,185,186,194,195,196,197,198,199,200,201,202,210,211,212,213,214,215,216,217,218,225,226,227,228,229,230,231,232,233,234,241,242,243,244,245,246,247,248,249,250],E=[0,0,3,1,1,1,1,1,1,1,1,1,0,0,0,0,0],T=[0,1,2,3,4,5,6,7,8,9,10,11],J=[0,0,2,1,2,4,4,3,4,7,5,4,4,0,1,2,119],fe=[0,1,2,3,17,4,5,33,49,6,18,65,81,7,97,113,19,34,50,129,8,20,66,145,161,177,193,9,35,51,82,240,21,98,114,209,10,22,36,52,225,37,241,23,24,25,26,38,39,40,41,42,53,54,55,56,57,58,67,68,69,70,71,72,73,74,83,84,85,86,87,88,89,90,99,100,101,102,103,104,105,106,115,116,117,118,119,120,121,122,130,131,132,133,134,135,136,137,138,146,147,148,149,150,151,152,153,154,162,163,164,165,166,167,168,169,170,178,179,180,181,182,183,184,185,186,194,195,196,197,198,199,200,201,202,210,211,212,213,214,215,216,217,218,226,227,228,229,230,231,232,233,234,242,243,244,245,246,247,248,249,250];function ye(O,H){for(var Y=0,X=0,te=new Array,ae=1;ae<=16;ae++){for(var ge=1;ge<=O[ae];ge++)te[H[X]]=[],te[H[X]][0]=Y,te[H[X]][1]=ae,X++,Y++;Y*=2}return te}function _e(O){for(var H=O[0],Y=O[1]-1;Y>=0;)H&1<<Y&&(C|=1<<k),Y--,--k<0&&(C==255?(ce(255),ce(0)):ce(C),k=7,C=0)}function ce(O){N.push(O)}function ve(O){ce(O>>8&255),ce(255&O)}function Oe(O,H,Y,X,te){for(var ae,ge=te[0],me=te[240],Ee=(function(Te,$e){var ze,ct,it,$t,Pt,_t,Lt,kt,Je,It,Ze=0;for(Je=0;Je<8;++Je){ze=Te[Ze],ct=Te[Ze+1],it=Te[Ze+2],$t=Te[Ze+3],Pt=Te[Ze+4],_t=Te[Ze+5],Lt=Te[Ze+6];var An=ze+(kt=Te[Ze+7]),Ct=ze-kt,Et=ct+Lt,Tt=ct-Lt,Wt=it+_t,st=it-_t,Kt=$t+Pt,ht=$t-Pt,gt=An+Kt,rn=An-Kt,ut=Et+Wt,lt=Et-Wt;Te[Ze]=gt+ut,Te[Ze+4]=gt-ut;var Ft=.707106781*(lt+rn);Te[Ze+2]=rn+Ft,Te[Ze+6]=rn-Ft;var fi=.382683433*((gt=ht+st)-(lt=Tt+Ct)),ir=.5411961*gt+fi,Gi=1.306562965*lt+fi,dr=.707106781*(ut=st+Tt),dt=Ct+dr,Ki=Ct-dr;Te[Ze+5]=Ki+ir,Te[Ze+3]=Ki-ir,Te[Ze+1]=dt+Gi,Te[Ze+7]=dt-Gi,Ze+=8}for(Ze=0,Je=0;Je<8;++Je){ze=Te[Ze],ct=Te[Ze+8],it=Te[Ze+16],$t=Te[Ze+24],Pt=Te[Ze+32],_t=Te[Ze+40],Lt=Te[Ze+48];var Jr=ze+(kt=Te[Ze+56]),Lr=ze-kt,Dr=ct+Lt,un=ct-Lt,En=it+_t,Qn=it-_t,wr=$t+Pt,Yi=$t-Pt,Qr=Jr+wr,Xr=Jr-wr,Or=Dr+En,Zr=Dr-En;Te[Ze]=Qr+Or,Te[Ze+32]=Qr-Or;var ei=.707106781*(Zr+Xr);Te[Ze+16]=Xr+ei,Te[Ze+48]=Xr-ei;var gs=.382683433*((Qr=Yi+Qn)-(Zr=un+Lr)),Ni=.5411961*Qr+gs,ki=1.306562965*Zr+gs,Ys=.707106781*(Or=Qn+un),ms=Lr+Ys,Ci=Lr-Ys;Te[Ze+40]=Ci+Ni,Te[Ze+24]=Ci-Ni,Te[Ze+8]=ms+ki,Te[Ze+56]=ms-ki,Ze++}for(Je=0;Je<64;++Je)It=Te[Je]*$e[Je],p[Je]=It>0?It+.5|0:It-.5|0;return p})(O,H),Le=0;Le<64;++Le)S[B[Le]]=Ee[Le];var je=S[0]-Y;Y=S[0],je==0?_e(X[0]):(_e(X[y[ae=32767+je]]),_e(g[ae]));for(var Ue=63;Ue>0&&S[Ue]==0;)Ue--;if(Ue==0)return _e(ge),Y;for(var tt,j=1;j<=Ue;){for(var Ve=j;S[j]==0&&j<=Ue;)++j;var bt=j-Ve;if(bt>=16){tt=bt>>4;for(var at=1;at<=tt;++at)_e(me);bt&=15}ae=32767+S[j],_e(te[(bt<<4)+y[ae]]),_e(g[ae]),j++}return Ue!=63&&_e(ge),Y}function xe(O){O=Math.min(Math.max(O,1),100),s!=O&&((function(H){for(var Y=[16,11,10,16,24,40,51,61,12,12,14,19,26,58,60,55,14,13,16,24,40,57,69,56,14,17,22,29,51,87,80,62,18,22,37,56,68,109,103,77,24,35,55,64,81,104,113,92,49,64,78,87,103,121,120,101,72,92,95,98,112,100,103,99],X=0;X<64;X++){var te=o((Y[X]*H+50)/100);te=Math.min(Math.max(te,1),255),a[B[X]]=te}for(var ae=[17,18,24,47,99,99,99,99,18,21,26,66,99,99,99,99,24,26,56,99,99,99,99,99,47,66,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99],ge=0;ge<64;ge++){var me=o((ae[ge]*H+50)/100);me=Math.min(Math.max(me,1),255),c[B[ge]]=me}for(var Ee=[1,1.387039845,1.306562965,1.175875602,1,.785694958,.5411961,.275899379],Le=0,je=0;je<8;je++)for(var Ue=0;Ue<8;Ue++)u[Le]=1/(a[B[Le]]*Ee[je]*Ee[Ue]*8),d[Le]=1/(c[B[Le]]*Ee[je]*Ee[Ue]*8),Le++})(O<50?Math.floor(5e3/O):Math.floor(200-2*O)),s=O)}this.encode=function(O,H){H&&xe(H),N=new Array,C=0,k=7,ve(65496),ve(65504),ve(16),ce(74),ce(70),ce(73),ce(70),ce(0),ce(1),ce(1),ce(0),ve(1),ve(1),ce(0),ce(0),(function(){ve(65499),ve(132),ce(0);for(var ct=0;ct<64;ct++)ce(a[ct]);ce(1);for(var it=0;it<64;it++)ce(c[it])})(),(function(ct,it){ve(65472),ve(17),ce(8),ve(it),ve(ct),ce(3),ce(1),ce(17),ce(0),ce(2),ce(17),ce(1),ce(3),ce(17),ce(1)})(O.width,O.height),(function(){ve(65476),ve(418),ce(0);for(var ct=0;ct<16;ct++)ce(x[ct+1]);for(var it=0;it<=11;it++)ce(A[it]);ce(16);for(var $t=0;$t<16;$t++)ce(F[$t+1]);for(var Pt=0;Pt<=161;Pt++)ce(b[Pt]);ce(1);for(var _t=0;_t<16;_t++)ce(E[_t+1]);for(var Lt=0;Lt<=11;Lt++)ce(T[Lt]);ce(17);for(var kt=0;kt<16;kt++)ce(J[kt+1]);for(var Je=0;Je<=161;Je++)ce(fe[Je])})(),ve(65498),ve(12),ce(3),ce(1),ce(0),ce(2),ce(17),ce(3),ce(17),ce(0),ce(63),ce(0);var Y=0,X=0,te=0;C=0,k=7,this.encode.displayName="_encode_";for(var ae,ge,me,Ee,Le,je,Ue,tt,j,Ve=O.data,bt=O.width,at=O.height,Te=4*bt,$e=0;$e<at;){for(ae=0;ae<Te;){for(Le=Te*$e+ae,Ue=-1,tt=0,j=0;j<64;j++)je=Le+(tt=j>>3)*Te+(Ue=4*(7&j)),$e+tt>=at&&(je-=Te*($e+1+tt-at)),ae+Ue>=Te&&(je-=ae+Ue-Te+4),ge=Ve[je++],me=Ve[je++],Ee=Ve[je++],K[j]=(de[ge]+de[me+256|0]+de[Ee+512|0]>>16)-128,G[j]=(de[ge+768|0]+de[me+1024|0]+de[Ee+1280|0]>>16)-128,W[j]=(de[ge+1280|0]+de[me+1536|0]+de[Ee+1792|0]>>16)-128;Y=Oe(K,u,Y,e,r),X=Oe(G,d,X,t,i),te=Oe(W,d,te,t,i),ae+=32}$e+=8}if(k>=0){var ze=[];ze[1]=k+1,ze[0]=(1<<k+1)-1,_e(ze)}return ve(65497),new Uint8Array(N)},n=n||50,(function(){for(var O=String.fromCharCode,H=0;H<256;H++)ne[H]=O(H)})(),e=ye(x,A),t=ye(E,T),r=ye(F,b),i=ye(J,fe),(function(){for(var O=1,H=2,Y=1;Y<=15;Y++){for(var X=O;X<H;X++)y[32767+X]=Y,g[32767+X]=[],g[32767+X][1]=Y,g[32767+X][0]=X;for(var te=-(H-1);te<=-O;te++)y[32767+te]=Y,g[32767+te]=[],g[32767+te][1]=Y,g[32767+te][0]=H-1+te;O<<=1,H<<=1}})(),(function(){for(var O=0;O<256;O++)de[O]=19595*O,de[O+256|0]=38470*O,de[O+512|0]=7471*O+32768,de[O+768|0]=-11059*O,de[O+1024|0]=-21709*O,de[O+1280|0]=32768*O+8421375,de[O+1536|0]=-27439*O,de[O+1792|0]=-5329*O})(),xe(n)}function rs(n,e){if(this.pos=0,this.buffer=n,this.datav=new DataView(n.buffer),this.is_with_alpha=!!e,this.bottom_up=!0,this.flag=String.fromCharCode(this.buffer[0])+String.fromCharCode(this.buffer[1]),this.pos+=2,["BM","BA","CI","CP","IC","PT"].indexOf(this.flag)===-1)throw new Error("Invalid BMP File");this.parseHeader(),this.parseBGR()}function Zv(n){function e(A){if(!A)throw Error("assert :P")}function t(A,F,b){for(var E=0;4>E;E++)if(A[F+E]!=b.charCodeAt(E))return!0;return!1}function r(A,F,b,E,T){for(var J=0;J<T;J++)A[F+J]=b[E+J]}function i(A,F,b,E){for(var T=0;T<E;T++)A[F+T]=b}function s(A){return new Int32Array(A)}function o(A,F){for(var b=[],E=0;E<A;E++)b.push(new F);return b}function a(A,F){var b=[];return(function E(T,J,fe){for(var ye=fe[J],_e=0;_e<ye&&(T.push(fe.length>J+1?[]:new F),!(fe.length<J+1));_e++)E(T[_e],J+1,fe)})(b,0,A),b}var c=function(){var A=this;function F(l,f){for(var _=1<<f-1>>>0;l&_;)_>>>=1;return _?(l&_-1)+_:l}function b(l,f,_,w,R){e(!(w%_));do l[f+(w-=_)]=R;while(0<w)}function E(l,f,_,w,R){if(e(2328>=R),512>=R)var L=s(512);else if((L=s(R))==null)return 0;return(function(D,M,U,z,Z,le){var $,ee,se=M,we=1<<U,ue=s(16),Ie=s(16);for(e(Z!=0),e(z!=null),e(D!=null),e(0<U),ee=0;ee<Z;++ee){if(15<z[ee])return 0;++ue[z[ee]]}if(ue[0]==Z)return 0;for(Ie[1]=0,$=1;15>$;++$){if(ue[$]>1<<$)return 0;Ie[$+1]=Ie[$]+ue[$]}for(ee=0;ee<Z;++ee)$=z[ee],0<z[ee]&&(le[Ie[$]++]=ee);if(Ie[15]==1)return(z=new T).g=0,z.value=le[0],b(D,se,1,we,z),we;var Ae,ke=-1,Re=we-1,nt=0,He=1,Rt=1,Qe=1<<U;for(ee=0,$=1,Z=2;$<=U;++$,Z<<=1){if(He+=Rt<<=1,0>(Rt-=ue[$]))return 0;for(;0<ue[$];--ue[$])(z=new T).g=$,z.value=le[ee++],b(D,se+nt,Z,Qe,z),nt=F(nt,$)}for($=U+1,Z=2;15>=$;++$,Z<<=1){if(He+=Rt<<=1,0>(Rt-=ue[$]))return 0;for(;0<ue[$];--ue[$]){if(z=new T,(nt&Re)!=ke){for(se+=Qe,Ae=1<<(ke=$)-U;15>ke&&!(0>=(Ae-=ue[ke]));)++ke,Ae<<=1;we+=Qe=1<<(Ae=ke-U),D[M+(ke=nt&Re)].g=Ae+U,D[M+ke].value=se-M-ke}z.g=$-U,z.value=le[ee++],b(D,se+(nt>>U),Z,Qe,z),nt=F(nt,$)}}return He!=2*Ie[15]-1?0:we})(l,f,_,w,R,L)}function T(){this.value=this.g=0}function J(){this.value=this.g=0}function fe(){this.G=o(5,T),this.H=s(5),this.jc=this.Qb=this.qb=this.nd=0,this.pd=o($a,J)}function ye(l,f,_,w){e(l!=null),e(f!=null),e(2147483648>w),l.Ca=254,l.I=0,l.b=-8,l.Ka=0,l.oa=f,l.pa=_,l.Jd=f,l.Yc=_+w,l.Zc=4<=w?_+w-4+1:_,ge(l)}function _e(l,f){for(var _=0;0<f--;)_|=Ee(l,128)<<f;return _}function ce(l,f){var _=_e(l,f);return me(l)?-_:_}function ve(l,f,_,w){var R,L=0;for(e(l!=null),e(f!=null),e(4294967288>w),l.Sb=w,l.Ra=0,l.u=0,l.h=0,4<w&&(w=4),R=0;R<w;++R)L+=f[_+R]<<8*R;l.Ra=L,l.bb=w,l.oa=f,l.pa=_}function Oe(l){for(;8<=l.u&&l.bb<l.Sb;)l.Ra>>>=8,l.Ra+=l.oa[l.pa+l.bb]<<Bo-8>>>0,++l.bb,l.u-=8;X(l)&&(l.h=1,l.u=0)}function xe(l,f){if(e(0<=f),!l.h&&f<=mi){var _=Y(l)&gi[f];return l.u+=f,Oe(l),_}return l.h=1,l.u=0}function O(){this.b=this.Ca=this.I=0,this.oa=[],this.pa=0,this.Jd=[],this.Yc=0,this.Zc=[],this.Ka=0}function H(){this.Ra=0,this.oa=[],this.h=this.u=this.bb=this.Sb=this.pa=0}function Y(l){return l.Ra>>>(l.u&Bo-1)>>>0}function X(l){return e(l.bb<=l.Sb),l.h||l.bb==l.Sb&&l.u>Bo}function te(l,f){l.u=f,l.h=X(l)}function ae(l){l.u>=ro&&(e(l.u>=ro),Oe(l))}function ge(l){e(l!=null&&l.oa!=null),l.pa<l.Zc?(l.I=(l.oa[l.pa++]|l.I<<8)>>>0,l.b+=8):(e(l!=null&&l.oa!=null),l.pa<l.Yc?(l.b+=8,l.I=l.oa[l.pa++]|l.I<<8):l.Ka?l.b=0:(l.I<<=8,l.b+=8,l.Ka=1))}function me(l){return _e(l,1)}function Ee(l,f){var _=l.Ca;0>l.b&&ge(l);var w=l.b,R=_*f>>>8,L=(l.I>>>w>R)+0;for(L?(_-=R,l.I-=R+1<<w>>>0):_=R+1,w=_,R=0;256<=w;)R+=8,w>>=8;return w=7^R+Uo[w],l.b-=w,l.Ca=(_<<w)-1,L}function Le(l,f,_){l[f+0]=_>>24&255,l[f+1]=_>>16&255,l[f+2]=_>>8&255,l[f+3]=255&_}function je(l,f){return l[f+0]|l[f+1]<<8}function Ue(l,f){return je(l,f)|l[f+2]<<16}function tt(l,f){return je(l,f)|je(l,f+2)<<16}function j(l,f){var _=1<<f;return e(l!=null),e(0<f),l.X=s(_),l.X==null?0:(l.Mb=32-f,l.Xa=f,1)}function Ve(l,f){e(l!=null),e(f!=null),e(l.Xa==f.Xa),r(f.X,0,l.X,0,1<<f.Xa)}function bt(){this.X=[],this.Xa=this.Mb=0}function at(l,f,_,w){e(_!=null),e(w!=null);var R=_[0],L=w[0];return R==0&&(R=(l*L+f/2)/f),L==0&&(L=(f*R+l/2)/l),0>=R||0>=L?0:(_[0]=R,w[0]=L,1)}function Te(l,f){return l+(1<<f)-1>>>f}function $e(l,f){return((4278255360&l)+(4278255360&f)>>>0&4278255360)+((16711935&l)+(16711935&f)>>>0&16711935)>>>0}function ze(l,f){A[f]=function(_,w,R,L,D,M,U){var z;for(z=0;z<D;++z){var Z=A[l](M[U+z-1],R,L+z);M[U+z]=$e(_[w+z],Z)}}}function ct(){this.ud=this.hd=this.jd=0}function it(l,f){return((4278124286&(l^f))>>>1)+(l&f)>>>0}function $t(l){return 0<=l&&256>l?l:0>l?0:255<l?255:void 0}function Pt(l,f){return $t(l+(l-f+.5>>1))}function _t(l,f,_){return Math.abs(f-_)-Math.abs(l-_)}function Lt(l,f,_,w,R,L,D){for(w=L[D-1],_=0;_<R;++_)L[D+_]=w=$e(l[f+_],w)}function kt(l,f,_,w,R){var L;for(L=0;L<_;++L){var D=l[f+L],M=D>>8&255,U=16711935&(U=(U=16711935&D)+((M<<16)+M));w[R+L]=(4278255360&D)+U>>>0}}function Je(l,f){f.jd=255&l,f.hd=l>>8&255,f.ud=l>>16&255}function It(l,f,_,w,R,L){var D;for(D=0;D<w;++D){var M=f[_+D],U=M>>>8,z=M,Z=255&(Z=(Z=M>>>16)+((l.jd<<24>>24)*(U<<24>>24)>>>5));z=255&(z=(z+=(l.hd<<24>>24)*(U<<24>>24)>>>5)+((l.ud<<24>>24)*(Z<<24>>24)>>>5)),R[L+D]=(4278255360&M)+(Z<<16)+z}}function Ze(l,f,_,w,R){A[f]=function(L,D,M,U,z,Z,le,$,ee){for(U=le;U<$;++U)for(le=0;le<ee;++le)z[Z++]=R(M[w(L[D++])])},A[l]=function(L,D,M,U,z,Z,le){var $=8>>L.b,ee=L.Ea,se=L.K[0],we=L.w;if(8>$)for(L=(1<<L.b)-1,we=(1<<$)-1;D<M;++D){var ue,Ie=0;for(ue=0;ue<ee;++ue)ue&L||(Ie=w(U[z++])),Z[le++]=R(se[Ie&we]),Ie>>=$}else A["VP8LMapColor"+_](U,z,se,we,Z,le,D,M,ee)}}function An(l,f,_,w,R){for(_=f+_;f<_;){var L=l[f++];w[R++]=L>>16&255,w[R++]=L>>8&255,w[R++]=255&L}}function Ct(l,f,_,w,R){for(_=f+_;f<_;){var L=l[f++];w[R++]=L>>16&255,w[R++]=L>>8&255,w[R++]=255&L,w[R++]=L>>24&255}}function Et(l,f,_,w,R){for(_=f+_;f<_;){var L=(D=l[f++])>>16&240|D>>12&15,D=240&D|D>>28&15;w[R++]=L,w[R++]=D}}function Tt(l,f,_,w,R){for(_=f+_;f<_;){var L=(D=l[f++])>>16&248|D>>13&7,D=D>>5&224|D>>3&31;w[R++]=L,w[R++]=D}}function Wt(l,f,_,w,R){for(_=f+_;f<_;){var L=l[f++];w[R++]=255&L,w[R++]=L>>8&255,w[R++]=L>>16&255}}function st(l,f,_,w,R,L){if(L==0)for(_=f+_;f<_;)Le(w,((L=l[f++])[0]>>24|L[1]>>8&65280|L[2]<<8&16711680|L[3]<<24)>>>0),R+=32;else r(w,R,l,f,_)}function Kt(l,f){A[f][0]=A[l+"0"],A[f][1]=A[l+"1"],A[f][2]=A[l+"2"],A[f][3]=A[l+"3"],A[f][4]=A[l+"4"],A[f][5]=A[l+"5"],A[f][6]=A[l+"6"],A[f][7]=A[l+"7"],A[f][8]=A[l+"8"],A[f][9]=A[l+"9"],A[f][10]=A[l+"10"],A[f][11]=A[l+"11"],A[f][12]=A[l+"12"],A[f][13]=A[l+"13"],A[f][14]=A[l+"0"],A[f][15]=A[l+"0"]}function ht(l){return l==zp||l==$p||l==vd||l==Wp}function gt(){this.eb=[],this.size=this.A=this.fb=0}function rn(){this.y=[],this.f=[],this.ea=[],this.F=[],this.Tc=this.Ed=this.Cd=this.Fd=this.lb=this.Db=this.Ab=this.fa=this.J=this.W=this.N=this.O=0}function ut(){this.Rd=this.height=this.width=this.S=0,this.f={},this.f.RGBA=new gt,this.f.kb=new rn,this.sd=null}function lt(){this.width=[0],this.height=[0],this.Pd=[0],this.Qd=[0],this.format=[0]}function Ft(){this.Id=this.fd=this.Md=this.hb=this.ib=this.da=this.bd=this.cd=this.j=this.v=this.Da=this.Sd=this.ob=0}function fi(l){return alert("todo:WebPSamplerProcessPlane"),l.T}function ir(l,f){var _=l.T,w=f.ba.f.RGBA,R=w.eb,L=w.fb+l.ka*w.A,D=qi[f.ba.S],M=l.y,U=l.O,z=l.f,Z=l.N,le=l.ea,$=l.W,ee=f.cc,se=f.dc,we=f.Mc,ue=f.Nc,Ie=l.ka,Ae=l.ka+l.T,ke=l.U,Re=ke+1>>1;for(Ie==0?D(M,U,null,null,z,Z,le,$,z,Z,le,$,R,L,null,null,ke):(D(f.ec,f.fc,M,U,ee,se,we,ue,z,Z,le,$,R,L-w.A,R,L,ke),++_);Ie+2<Ae;Ie+=2)ee=z,se=Z,we=le,ue=$,Z+=l.Rc,$+=l.Rc,L+=2*w.A,D(M,(U+=2*l.fa)-l.fa,M,U,ee,se,we,ue,z,Z,le,$,R,L-w.A,R,L,ke);return U+=l.fa,l.j+Ae<l.o?(r(f.ec,f.fc,M,U,ke),r(f.cc,f.dc,z,Z,Re),r(f.Mc,f.Nc,le,$,Re),_--):1&Ae||D(M,U,null,null,z,Z,le,$,z,Z,le,$,R,L+w.A,null,null,ke),_}function Gi(l,f,_){var w=l.F,R=[l.J];if(w!=null){var L=l.U,D=f.ba.S,M=D==_d||D==vd;f=f.ba.f.RGBA;var U=[0],z=l.ka;U[0]=l.T,l.Kb&&(z==0?--U[0]:(--z,R[0]-=l.width),l.j+l.ka+l.T==l.o&&(U[0]=l.o-l.j-z));var Z=f.eb;z=f.fb+z*f.A,l=ty(w,R[0],l.width,L,U,Z,z+(M?0:3),f.A),e(_==U),l&&ht(D)&&Sl(Z,z,M,L,U,f.A)}return 0}function dr(l){var f=l.ma,_=f.ba.S,w=11>_,R=_==md||_==yd||_==_d||_==qp||_==12||ht(_);if(f.memory=null,f.Ib=null,f.Jb=null,f.Nd=null,!_l(f.Oa,l,R?11:12))return 0;if(R&&ht(_)&&vt(),l.da)alert("todo:use_scaling");else{if(w){if(f.Ib=fi,l.Kb){if(_=l.U+1>>1,f.memory=s(l.U+2*_),f.memory==null)return 0;f.ec=f.memory,f.fc=0,f.cc=f.ec,f.dc=f.fc+l.U,f.Mc=f.cc,f.Nc=f.dc+_,f.Ib=ir,vt()}}else alert("todo:EmitYUV");R&&(f.Jb=Gi,w&&he())}if(w&&!yy){for(l=0;256>l;++l)uT[l]=89858*(l-128)+bd>>wd,dT[l]=-22014*(l-128)+bd,hT[l]=-45773*(l-128),lT[l]=113618*(l-128)+bd>>wd;for(l=xl;l<Kp;++l)f=76283*(l-16)+bd>>wd,fT[l-xl]=Li(f,255),pT[l-xl]=Li(f+8>>4,15);yy=1}return 1}function dt(l){var f=l.ma,_=l.U,w=l.T;return e(!(1&l.ka)),0>=_||0>=w?0:(_=f.Ib(l,f),f.Jb!=null&&f.Jb(l,f,_),f.Dc+=_,1)}function Ki(l){l.ma.memory=null}function Jr(l,f,_,w){return xe(l,8)!=47?0:(f[0]=xe(l,14)+1,_[0]=xe(l,14)+1,w[0]=xe(l,1),xe(l,3)!=0?0:!l.h)}function Lr(l,f){if(4>l)return l+1;var _=l-2>>1;return(2+(1&l)<<_)+xe(f,_)+1}function Dr(l,f){return 120<f?f-120:1<=(_=((_=YE[f-1])>>4)*l+(8-(15&_)))?_:1;var _}function un(l,f,_){var w=Y(_),R=l[f+=255&w].g-8;return 0<R&&(te(_,_.u+8),w=Y(_),f+=l[f].value,f+=w&(1<<R)-1),te(_,_.u+l[f].g),l[f].value}function En(l,f,_){return _.g+=l.g,_.value+=l.value<<f>>>0,e(8>=_.g),l.g}function Qn(l,f,_){var w=l.xc;return e((f=w==0?0:l.vc[l.md*(_>>w)+(f>>w)])<l.Wb),l.Ya[f]}function wr(l,f,_,w){var R=l.ab,L=l.c*f,D=l.C;f=D+f;var M=_,U=w;for(w=l.Ta,_=l.Ua;0<R--;){var z=l.gc[R],Z=D,le=f,$=M,ee=U,se=(U=w,M=_,z.Ea);switch(e(Z<le),e(le<=z.nc),z.hc){case 2:Vn($,ee,(le-Z)*se,U,M);break;case 0:var we=Z,ue=le,Ie=U,Ae=M,ke=(Qe=z).Ea;we==0&&(wl($,ee,null,null,1,Ie,Ae),Lt($,ee+1,0,0,ke-1,Ie,Ae+1),ee+=ke,Ae+=ke,++we);for(var Re=1<<Qe.b,nt=Re-1,He=Te(ke,Qe.b),Rt=Qe.K,Qe=Qe.w+(we>>Qe.b)*He;we<ue;){var Ut=Rt,Zn=Qe,Nt=1;for(Kc($,ee,Ie,Ae-ke,1,Ie,Ae);Nt<ke;){var Xe=(Nt&~nt)+Re;Xe>ke&&(Xe=ke),(0,Il[Ut[Zn++]>>8&15])($,ee+ +Nt,Ie,Ae+Nt-ke,Xe-Nt,Ie,Ae+Nt),Nt=Xe}ee+=ke,Ae+=ke,++we&nt||(Qe+=He)}le!=z.nc&&r(U,M-se,U,M+(le-Z-1)*se,se);break;case 1:for(se=$,ue=ee,ke=($=z.Ea)-(Ae=$&~(Ie=(ee=1<<z.b)-1)),we=Te($,z.b),Re=z.K,z=z.w+(Z>>z.b)*we;Z<le;){for(nt=Re,He=z,Rt=new ct,Qe=ue+Ae,Ut=ue+$;ue<Qe;)Je(nt[He++],Rt),Al(Rt,se,ue,ee,U,M),ue+=ee,M+=ee;ue<Ut&&(Je(nt[He++],Rt),Al(Rt,se,ue,ke,U,M),ue+=ke,M+=ke),++Z&Ie||(z+=we)}break;case 3:if($==U&&ee==M&&0<z.b){for(ue=U,$=se=M+(le-Z)*se-(Ae=(le-Z)*Te(z.Ea,z.b)),ee=U,Ie=M,we=[],Ae=(ke=Ae)-1;0<=Ae;--Ae)we[Ae]=ee[Ie+Ae];for(Ae=ke-1;0<=Ae;--Ae)ue[$+Ae]=we[Ae];dd(z,Z,le,U,se,U,M)}else dd(z,Z,le,$,ee,U,M)}M=w,U=_}U!=_&&r(w,_,M,U,L)}function Yi(l,f){var _=l.V,w=l.Ba+l.c*l.C,R=f-l.C;if(e(f<=l.l.o),e(16>=R),0<R){var L=l.l,D=l.Ta,M=l.Ua,U=L.width;if(wr(l,R,_,w),R=M=[M],e((_=l.C)<(w=f)),e(L.v<L.va),w>L.o&&(w=L.o),_<L.j){var z=L.j-_;_=L.j,R[0]+=z*U}if(_>=w?_=0:(R[0]+=4*L.v,L.ka=_-L.j,L.U=L.va-L.v,L.T=w-_,_=1),_){if(M=M[0],11>(_=l.ca).S){var Z=_.f.RGBA,le=(w=_.S,R=L.U,L=L.T,z=Z.eb,Z.A),$=L;for(Z=Z.fb+l.Ma*Z.A;0<$--;){var ee=D,se=M,we=R,ue=z,Ie=Z;switch(w){case gd:El(ee,se,we,ue,Ie);break;case md:jo(ee,se,we,ue,Ie);break;case zp:jo(ee,se,we,ue,Ie),Sl(ue,Ie,0,we,1,0);break;case cy:Wa(ee,se,we,ue,Ie);break;case yd:st(ee,se,we,ue,Ie,1);break;case $p:st(ee,se,we,ue,Ie,1),Sl(ue,Ie,0,we,1,0);break;case _d:st(ee,se,we,ue,Ie,0);break;case vd:st(ee,se,we,ue,Ie,0),Sl(ue,Ie,1,we,1,0);break;case qp:qo(ee,se,we,ue,Ie);break;case Wp:qo(ee,se,we,ue,Ie),ey(ue,Ie,we,1,0);break;case uy:zo(ee,se,we,ue,Ie);break;default:e(0)}M+=U,Z+=le}l.Ma+=L}else alert("todo:EmitRescaledRowsYUVA");e(l.Ma<=_.height)}}l.C=f,e(l.C<=l.i)}function Qr(l){var f;if(0<l.ua)return 0;for(f=0;f<l.Wb;++f){var _=l.Ya[f].G,w=l.Ya[f].H;if(0<_[1][w[1]+0].g||0<_[2][w[2]+0].g||0<_[3][w[3]+0].g)return 0}return 1}function Xr(l,f,_,w,R,L){if(l.Z!=0){var D=l.qd,M=l.rd;for(e(Ho[l.Z]!=null);f<_;++f)Ho[l.Z](D,M,w,R,w,R,L),D=w,M=R,R+=L;l.qd=D,l.rd=M}}function Or(l,f){var _=l.l.ma,w=_.Z==0||_.Z==1?l.l.j:l.C;if(w=l.C<w?w:l.C,e(f<=l.l.o),f>w){var R=l.l.width,L=_.ca,D=_.tb+R*w,M=l.V,U=l.Ba+l.c*w,z=l.gc;e(l.ab==1),e(z[0].hc==3),Ss(z[0],w,f,M,U,L,D),Xr(_,w,f,L,D,R)}l.C=l.Ma=f}function Zr(l,f,_,w,R,L,D){var M=l.$/w,U=l.$%w,z=l.m,Z=l.s,le=_+l.$,$=le;R=_+w*R;var ee=_+w*L,se=280+Z.ua,we=l.Pb?M:16777216,ue=0<Z.ua?Z.Wa:null,Ie=Z.wc,Ae=le<ee?Qn(Z,U,M):null;e(l.C<L),e(ee<=R);var ke=!1;e:for(;;){for(;ke||le<ee;){var Re=0;if(M>=we){var nt=le-_;e((we=l).Pb),we.wd=we.m,we.xd=nt,0<we.s.ua&&Ve(we.s.Wa,we.s.vb),we=M+QE}if(U&Ie||(Ae=Qn(Z,U,M)),e(Ae!=null),Ae.Qb&&(f[le]=Ae.qb,ke=!0),!ke)if(ae(z),Ae.jc){Re=z,nt=f;var He=le,Rt=Ae.pd[Y(Re)&$a-1];e(Ae.jc),256>Rt.g?(te(Re,Re.u+Rt.g),nt[He]=Rt.value,Re=0):(te(Re,Re.u+Rt.g-256),e(256<=Rt.value),Re=Rt.value),Re==0&&(ke=!0)}else Re=un(Ae.G[0],Ae.H[0],z);if(z.h)break;if(ke||256>Re){if(!ke)if(Ae.nd)f[le]=(Ae.qb|Re<<8)>>>0;else{if(ae(z),ke=un(Ae.G[1],Ae.H[1],z),ae(z),nt=un(Ae.G[2],Ae.H[2],z),He=un(Ae.G[3],Ae.H[3],z),z.h)break;f[le]=(He<<24|ke<<16|Re<<8|nt)>>>0}if(ke=!1,++le,++U>=w&&(U=0,++M,D!=null&&M<=L&&!(M%16)&&D(l,M),ue!=null))for(;$<le;)Re=f[$++],ue.X[(506832829*Re&4294967295)>>>ue.Mb]=Re}else if(280>Re){if(Re=Lr(Re-256,z),nt=un(Ae.G[4],Ae.H[4],z),ae(z),nt=Dr(w,nt=Lr(nt,z)),z.h)break;if(le-_<nt||R-le<Re)break e;for(He=0;He<Re;++He)f[le+He]=f[le+He-nt];for(le+=Re,U+=Re;U>=w;)U-=w,++M,D!=null&&M<=L&&!(M%16)&&D(l,M);if(e(le<=R),U&Ie&&(Ae=Qn(Z,U,M)),ue!=null)for(;$<le;)Re=f[$++],ue.X[(506832829*Re&4294967295)>>>ue.Mb]=Re}else{if(!(Re<se))break e;for(ke=Re-280,e(ue!=null);$<le;)Re=f[$++],ue.X[(506832829*Re&4294967295)>>>ue.Mb]=Re;Re=le,e(!(ke>>>(nt=ue).Xa)),f[Re]=nt.X[ke],ke=!0}ke||e(z.h==X(z))}if(l.Pb&&z.h&&le<R)e(l.m.h),l.a=5,l.m=l.wd,l.$=l.xd,0<l.s.ua&&Ve(l.s.vb,l.s.Wa);else{if(z.h)break e;D?.(l,M>L?L:M),l.a=0,l.$=le-_}return 1}return l.a=3,0}function ei(l){e(l!=null),l.vc=null,l.yc=null,l.Ya=null;var f=l.Wa;f!=null&&(f.X=null),l.vb=null,e(l!=null)}function gs(){var l=new pt;return l==null?null:(l.a=0,l.xb=dy,Kt("Predictor","VP8LPredictors"),Kt("Predictor","VP8LPredictors_C"),Kt("PredictorAdd","VP8LPredictorsAdd"),Kt("PredictorAdd","VP8LPredictorsAdd_C"),Vn=kt,Al=It,El=An,jo=Ct,qo=Et,zo=Tt,Wa=Wt,A.VP8LMapColor32b=Ts,A.VP8LMapColor8b=bl,l)}function Ni(l,f,_,w,R){var L=1,D=[l],M=[f],U=w.m,z=w.s,Z=null,le=0;e:for(;;){if(_)for(;L&&xe(U,1);){var $=D,ee=M,se=w,we=1,ue=se.m,Ie=se.gc[se.ab],Ae=xe(ue,2);if(se.Oc&1<<Ae)L=0;else{switch(se.Oc|=1<<Ae,Ie.hc=Ae,Ie.Ea=$[0],Ie.nc=ee[0],Ie.K=[null],++se.ab,e(4>=se.ab),Ae){case 0:case 1:Ie.b=xe(ue,3)+2,we=Ni(Te(Ie.Ea,Ie.b),Te(Ie.nc,Ie.b),0,se,Ie.K),Ie.K=Ie.K[0];break;case 3:var ke,Re=xe(ue,8)+1,nt=16<Re?0:4<Re?1:2<Re?2:3;if($[0]=Te(Ie.Ea,nt),Ie.b=nt,ke=we=Ni(Re,1,0,se,Ie.K)){var He,Rt=Re,Qe=Ie,Ut=1<<(8>>Qe.b),Zn=s(Ut);if(Zn==null)ke=0;else{var Nt=Qe.K[0],Xe=Qe.w;for(Zn[0]=Qe.K[0][0],He=1;He<1*Rt;++He)Zn[He]=$e(Nt[Xe+He],Zn[He-1]);for(;He<4*Ut;++He)Zn[He]=0;Qe.K[0]=null,Qe.K[0]=Zn,ke=1}}we=ke;break;case 2:break;default:e(0)}L=we}}if(D=D[0],M=M[0],L&&xe(U,1)&&!(L=1<=(le=xe(U,4))&&11>=le)){w.a=3;break e}var Me;if(Me=L)t:{var Un,St,jt,wn=w,fr=D,qr=M,Cn=le,Ar=_,zr=wn.m,er=wn.s,zt=[null],Qt=1,Ln=0,Xt=JE[Cn];n:for(;;){if(Ar&&xe(zr,1)){var pr=xe(zr,3)+2,ts=Te(fr,pr),jn=Te(qr,pr),oi=ts*jn;if(!Ni(ts,jn,0,wn,zt))break n;for(zt=zt[0],er.xc=pr,Un=0;Un<oi;++Un){var an=zt[Un]>>8&65535;zt[Un]=an,an>=Qt&&(Qt=an+1)}}if(zr.h)break n;for(St=0;5>St;++St){var tr=ly[St];!St&&0<Cn&&(tr+=1<<Cn),Ln<tr&&(Ln=tr)}var _i=o(Qt*Xt,T),$r=Qt,vi=o($r,fe);if(vi==null)var wi=null;else e(65536>=$r),wi=vi;var ai=s(Ln);if(wi==null||ai==null||_i==null){wn.a=1;break n}var bi=_i;for(Un=jt=0;Un<Qt;++Un){var mn=wi[Un],Ii=mn.G,ns=mn.H,Ga=0,oo=1,gr=0;for(St=0;5>St;++St){tr=ly[St],Ii[St]=bi,ns[St]=jt,!St&&0<Cn&&(tr+=1<<Cn);i:{var Ad,Yp=tr,Ed=wn,Rl=ai,yT=bi,_T=jt,Jp=0,Go=Ed.m,vT=xe(Go,1);if(i(Rl,0,0,Yp),vT){var wT=xe(Go,1)+1,bT=xe(Go,1),wy=xe(Go,bT==0?1:8);Rl[wy]=1,wT==2&&(Rl[wy=xe(Go,8)]=1);var Td=1}else{var by=s(19),Iy=xe(Go,4)+4;if(19<Iy){Ed.a=3;var Sd=0;break i}for(Ad=0;Ad<Iy;++Ad)by[KE[Ad]]=xe(Go,3);var Qp=void 0,Nl=void 0,Ay=Ed,IT=by,Pd=Yp,Ey=Rl,Xp=0,Ko=Ay.m,Ty=8,Sy=o(128,T);r:for(;E(Sy,0,7,IT,19);){if(xe(Ko,1)){var AT=2+2*xe(Ko,3);if((Qp=2+xe(Ko,AT))>Pd)break r}else Qp=Pd;for(Nl=0;Nl<Pd&&Qp--;){ae(Ko);var Py=Sy[0+(127&Y(Ko))];te(Ko,Ko.u+Py.g);var Jc=Py.value;if(16>Jc)Ey[Nl++]=Jc,Jc!=0&&(Ty=Jc);else{var ET=Jc==16,xy=Jc-16,TT=HE[xy],Ry=xe(Ko,WE[xy])+TT;if(Nl+Ry>Pd)break r;for(var ST=ET?Ty:0;0<Ry--;)Ey[Nl++]=ST}}Xp=1;break r}Xp||(Ay.a=3),Td=Xp}(Td=Td&&!Go.h)&&(Jp=E(yT,_T,8,Rl,Yp)),Td&&Jp!=0?Sd=Jp:(Ed.a=3,Sd=0)}if(Sd==0)break n;if(oo&&GE[St]==1&&(oo=bi[jt].g==0),Ga+=bi[jt].g,jt+=Sd,3>=St){var kl,Zp=ai[0];for(kl=1;kl<tr;++kl)ai[kl]>Zp&&(Zp=ai[kl]);gr+=Zp}}if(mn.nd=oo,mn.Qb=0,oo&&(mn.qb=(Ii[3][ns[3]+0].value<<24|Ii[1][ns[1]+0].value<<16|Ii[2][ns[2]+0].value)>>>0,Ga==0&&256>Ii[0][ns[0]+0].value&&(mn.Qb=1,mn.qb+=Ii[0][ns[0]+0].value<<8)),mn.jc=!mn.Qb&&6>gr,mn.jc){var xd,ao=mn;for(xd=0;xd<$a;++xd){var Yo=xd,Jo=ao.pd[Yo],Rd=ao.G[0][ao.H[0]+Yo];256<=Rd.value?(Jo.g=Rd.g+256,Jo.value=Rd.value):(Jo.g=0,Jo.value=0,Yo>>=En(Rd,8,Jo),Yo>>=En(ao.G[1][ao.H[1]+Yo],16,Jo),Yo>>=En(ao.G[2][ao.H[2]+Yo],0,Jo),En(ao.G[3][ao.H[3]+Yo],24,Jo))}}}er.vc=zt,er.Wb=Qt,er.Ya=wi,er.yc=_i,Me=1;break t}Me=0}if(!(L=Me)){w.a=3;break e}if(0<le){if(z.ua=1<<le,!j(z.Wa,le)){w.a=1,L=0;break e}}else z.ua=0;var eg=w,Ny=D,PT=M,tg=eg.s,ng=tg.xc;if(eg.c=Ny,eg.i=PT,tg.md=Te(Ny,ng),tg.wc=ng==0?-1:(1<<ng)-1,_){w.xb=iT;break e}if((Z=s(D*M))==null){w.a=1,L=0;break e}L=(L=Zr(w,Z,0,D,M,M,null))&&!U.h;break e}return L?(R!=null?R[0]=Z:(e(Z==null),e(_)),w.$=0,_||ei(z)):ei(z),L}function ki(l,f){var _=l.c*l.i,w=_+f+16*f;return e(l.c<=f),l.V=s(w),l.V==null?(l.Ta=null,l.Ua=0,l.a=1,0):(l.Ta=l.V,l.Ua=l.Ba+_+f,1)}function Ys(l,f){var _=l.C,w=f-_,R=l.V,L=l.Ba+l.c*_;for(e(f<=l.l.o);0<w;){var D=16<w?16:w,M=l.l.ma,U=l.l.width,z=U*D,Z=M.ca,le=M.tb+U*_,$=l.Ta,ee=l.Ua;wr(l,D,R,L),ny($,ee,Z,le,z),Xr(M,_,_+D,Z,le,U),w-=D,R+=D*l.c,_+=D}e(_==f),l.C=l.Ma=f}function ms(){this.ub=this.yd=this.td=this.Rb=0}function Ci(){this.Kd=this.Ld=this.Ud=this.Td=this.i=this.c=0}function Ji(){this.Fb=this.Bb=this.Cb=0,this.Zb=s(4),this.Lb=s(4)}function Js(){this.Yb=(function(){var l=[];return(function f(_,w,R){for(var L=R[w],D=0;D<L&&(_.push(R.length>w+1?[]:0),!(R.length<w+1));D++)f(_[D],w+1,R)})(l,0,[3,11]),l})()}function Vc(){this.jb=s(3),this.Wc=a([4,8],Js),this.Xc=a([4,17],Js)}function Da(){this.Pc=this.wb=this.Tb=this.zd=0,this.vd=new s(4),this.od=new s(4)}function Fr(){this.ld=this.La=this.dd=this.tc=0}function Ro(){this.Na=this.la=0}function No(){this.Sc=[0,0],this.Eb=[0,0],this.Qc=[0,0],this.ia=this.lc=0}function Qs(){this.ad=s(384),this.Za=0,this.Ob=s(16),this.$b=this.Ad=this.ia=this.Gc=this.Hc=this.Dd=0}function Oa(){this.uc=this.M=this.Nb=0,this.wa=Array(new Fr),this.Y=0,this.ya=Array(new Qs),this.aa=0,this.l=new Mr}function Fa(){this.y=s(16),this.f=s(8),this.ea=s(8)}function Ma(){this.cb=this.a=0,this.sc="",this.m=new O,this.Od=new ms,this.Kc=new Ci,this.ed=new Da,this.Qa=new Ji,this.Ic=this.$c=this.Aa=0,this.D=new Oa,this.Xb=this.Va=this.Hb=this.zb=this.yb=this.Ub=this.za=0,this.Jc=o(8,O),this.ia=0,this.pb=o(4,No),this.Pa=new Vc,this.Bd=this.kc=0,this.Ac=[],this.Bc=0,this.zc=[0,0,0,0],this.Gd=Array(new Fa),this.Hd=0,this.rb=Array(new Ro),this.sb=0,this.wa=Array(new Fr),this.Y=0,this.oc=[],this.pc=0,this.sa=[],this.ta=0,this.qa=[],this.ra=0,this.Ha=[],this.B=this.R=this.Ia=0,this.Ec=[],this.M=this.ja=this.Vb=this.Fc=0,this.ya=Array(new Qs),this.L=this.aa=0,this.gd=a([4,2],Fr),this.ga=null,this.Fa=[],this.Cc=this.qc=this.P=0,this.Gb=[],this.Uc=0,this.mb=[],this.nb=0,this.rc=[],this.Ga=this.Vc=0}function Li(l,f){return 0>l?0:l>f?f:l}function Mr(){this.T=this.U=this.ka=this.height=this.width=0,this.y=[],this.f=[],this.ea=[],this.Rc=this.fa=this.W=this.N=this.O=0,this.ma="void",this.put="VP8IoPutHook",this.ac="VP8IoSetupHook",this.bc="VP8IoTeardownHook",this.ha=this.Kb=0,this.data=[],this.hb=this.ib=this.da=this.o=this.j=this.va=this.v=this.Da=this.ob=this.w=0,this.F=[],this.J=0}function ti(){var l=new Ma;return l!=null&&(l.a=0,l.sc="OK",l.cb=0,l.Xb=0,Pl||(Pl=Ht)),l}function ln(l,f,_){return l.a==0&&(l.a=f,l.sc=_,l.cb=0),0}function ys(l,f,_){return 3<=_&&l[f+0]==157&&l[f+1]==1&&l[f+2]==42}function ni(l,f){if(l==null)return 0;if(l.a=0,l.sc="OK",f==null)return ln(l,2,"null VP8Io passed to VP8GetHeaders()");var _=f.data,w=f.w,R=f.ha;if(4>R)return ln(l,7,"Truncated header.");var L=_[w+0]|_[w+1]<<8|_[w+2]<<16,D=l.Od;if(D.Rb=!(1&L),D.td=L>>1&7,D.yd=L>>4&1,D.ub=L>>5,3<D.td)return ln(l,3,"Incorrect keyframe parameters.");if(!D.yd)return ln(l,4,"Frame not displayable.");w+=3,R-=3;var M=l.Kc;if(D.Rb){if(7>R)return ln(l,7,"cannot parse picture header");if(!ys(_,w,R))return ln(l,3,"Bad code word");M.c=16383&(_[w+4]<<8|_[w+3]),M.Td=_[w+4]>>6,M.i=16383&(_[w+6]<<8|_[w+5]),M.Ud=_[w+6]>>6,w+=7,R-=7,l.za=M.c+15>>4,l.Ub=M.i+15>>4,f.width=M.c,f.height=M.i,f.Da=0,f.j=0,f.v=0,f.va=f.width,f.o=f.height,f.da=0,f.ib=f.width,f.hb=f.height,f.U=f.width,f.T=f.height,i((L=l.Pa).jb,0,255,L.jb.length),e((L=l.Qa)!=null),L.Cb=0,L.Bb=0,L.Fb=1,i(L.Zb,0,0,L.Zb.length),i(L.Lb,0,0,L.Lb)}if(D.ub>R)return ln(l,7,"bad partition length");ye(L=l.m,_,w,D.ub),w+=D.ub,R-=D.ub,D.Rb&&(M.Ld=me(L),M.Kd=me(L)),M=l.Qa;var U,z=l.Pa;if(e(L!=null),e(M!=null),M.Cb=me(L),M.Cb){if(M.Bb=me(L),me(L)){for(M.Fb=me(L),U=0;4>U;++U)M.Zb[U]=me(L)?ce(L,7):0;for(U=0;4>U;++U)M.Lb[U]=me(L)?ce(L,6):0}if(M.Bb)for(U=0;3>U;++U)z.jb[U]=me(L)?_e(L,8):255}else M.Bb=0;if(L.Ka)return ln(l,3,"cannot parse segment header");if((M=l.ed).zd=me(L),M.Tb=_e(L,6),M.wb=_e(L,3),M.Pc=me(L),M.Pc&&me(L)){for(z=0;4>z;++z)me(L)&&(M.vd[z]=ce(L,6));for(z=0;4>z;++z)me(L)&&(M.od[z]=ce(L,6))}if(l.L=M.Tb==0?0:M.zd?1:2,L.Ka)return ln(l,3,"cannot parse filter header");var Z=R;if(R=U=w,w=U+Z,M=Z,l.Xb=(1<<_e(l.m,2))-1,Z<3*(z=l.Xb))_=7;else{for(U+=3*z,M-=3*z,Z=0;Z<z;++Z){var le=_[R+0]|_[R+1]<<8|_[R+2]<<16;le>M&&(le=M),ye(l.Jc[+Z],_,U,le),U+=le,M-=le,R+=3}ye(l.Jc[+z],_,U,M),_=U<w?0:5}if(_!=0)return ln(l,_,"cannot parse partitions");for(_=_e(U=l.m,7),R=me(U)?ce(U,4):0,w=me(U)?ce(U,4):0,M=me(U)?ce(U,4):0,z=me(U)?ce(U,4):0,U=me(U)?ce(U,4):0,Z=l.Qa,le=0;4>le;++le){if(Z.Cb){var $=Z.Zb[le];Z.Fb||($+=_)}else{if(0<le){l.pb[le]=l.pb[0];continue}$=_}var ee=l.pb[le];ee.Sc[0]=Hp[Li($+R,127)],ee.Sc[1]=Gp[Li($+0,127)],ee.Eb[0]=2*Hp[Li($+w,127)],ee.Eb[1]=101581*Gp[Li($+M,127)]>>16,8>ee.Eb[1]&&(ee.Eb[1]=8),ee.Qc[0]=Hp[Li($+z,117)],ee.Qc[1]=Gp[Li($+U,127)],ee.lc=$+U}if(!D.Rb)return ln(l,4,"Not a key frame.");for(me(L),D=l.Pa,_=0;4>_;++_){for(R=0;8>R;++R)for(w=0;3>w;++w)for(M=0;11>M;++M)z=Ee(L,nT[_][R][w][M])?_e(L,8):eT[_][R][w][M],D.Wc[_][R].Yb[w][M]=z;for(R=0;17>R;++R)D.Xc[_][R]=D.Wc[_][rT[R]]}return l.kc=me(L),l.kc&&(l.Bd=_e(L,8)),l.cb=1}function Ht(l,f,_,w,R,L,D){var M=f[R].Yb[_];for(_=0;16>R;++R){if(!Ee(l,M[_+0]))return R;for(;!Ee(l,M[_+1]);)if(M=f[++R].Yb[0],_=0,R==16)return 16;var U=f[R+1].Yb;if(Ee(l,M[_+2])){var z=l,Z=0;if(Ee(z,($=M)[(le=_)+3]))if(Ee(z,$[le+6])){for(M=0,le=2*(Z=Ee(z,$[le+8]))+($=Ee(z,$[le+9+Z])),Z=0,$=XE[le];$[M];++M)Z+=Z+Ee(z,$[M]);Z+=3+(8<<le)}else Ee(z,$[le+7])?(Z=7+2*Ee(z,165),Z+=Ee(z,145)):Z=5+Ee(z,159);else Z=Ee(z,$[le+4])?3+Ee(z,$[le+5]):2;M=U[2]}else Z=1,M=U[1];U=D+ZE[R],0>(z=l).b&&ge(z);var le,$=z.b,ee=(le=z.Ca>>1)-(z.I>>$)>>31;--z.b,z.Ca+=ee,z.Ca|=1,z.I-=(le+1&ee)<<$,L[U]=((Z^ee)-ee)*w[(0<R)+0]}return 16}function Xs(l){var f=l.rb[l.sb-1];f.la=0,f.Na=0,i(l.zc,0,0,l.zc.length),l.ja=0}function sr(l,f,_,w,R){R=l[f+_+32*w]+(R>>3),l[f+_+32*w]=-256&R?0>R?0:255:R}function vn(l,f,_,w,R,L){sr(l,f,0,_,w+R),sr(l,f,1,_,w+L),sr(l,f,2,_,w-L),sr(l,f,3,_,w-R)}function Qi(l){return(20091*l>>16)+l}function Va(l,f,_,w){var R,L=0,D=s(16);for(R=0;4>R;++R){var M=l[f+0]+l[f+8],U=l[f+0]-l[f+8],z=(35468*l[f+4]>>16)-Qi(l[f+12]),Z=Qi(l[f+4])+(35468*l[f+12]>>16);D[L+0]=M+Z,D[L+1]=U+z,D[L+2]=U-z,D[L+3]=M-Z,L+=4,f++}for(R=L=0;4>R;++R)M=(l=D[L+0]+4)+D[L+8],U=l-D[L+8],z=(35468*D[L+4]>>16)-Qi(D[L+12]),sr(_,w,0,0,M+(Z=Qi(D[L+4])+(35468*D[L+12]>>16))),sr(_,w,1,0,U+z),sr(_,w,2,0,U-z),sr(_,w,3,0,M-Z),L++,w+=32}function fl(l,f,_,w){var R=l[f+0]+4,L=35468*l[f+4]>>16,D=Qi(l[f+4]),M=35468*l[f+1]>>16;vn(_,w,0,R+D,l=Qi(l[f+1]),M),vn(_,w,1,R+L,l,M),vn(_,w,2,R-L,l,M),vn(_,w,3,R-D,l,M)}function pl(l,f,_,w,R){Va(l,f,_,w),R&&Va(l,f+16,_,w+4)}function Di(l,f,_,w){Ha(l,f+0,_,w,1),Ha(l,f+32,_,w+128,1)}function Bc(l,f,_,w){var R;for(l=l[f+0]+4,R=0;4>R;++R)for(f=0;4>f;++f)sr(_,w,f,R,l)}function _s(l,f,_,w){l[f+0]&&Yt(l,f+0,_,w),l[f+16]&&Yt(l,f+16,_,w+4),l[f+32]&&Yt(l,f+32,_,w+128),l[f+48]&&Yt(l,f+48,_,w+128+4)}function ri(l,f,_,w){var R,L=s(16);for(R=0;4>R;++R){var D=l[f+0+R]+l[f+12+R],M=l[f+4+R]+l[f+8+R],U=l[f+4+R]-l[f+8+R],z=l[f+0+R]-l[f+12+R];L[0+R]=D+M,L[8+R]=D-M,L[4+R]=z+U,L[12+R]=z-U}for(R=0;4>R;++R)D=(l=L[0+4*R]+3)+L[3+4*R],M=L[1+4*R]+L[2+4*R],U=L[1+4*R]-L[2+4*R],z=l-L[3+4*R],_[w+0]=D+M>>3,_[w+16]=z+U>>3,_[w+32]=D-M>>3,_[w+48]=z-U>>3,w+=64}function vs(l,f,_){var w,R=f-32,L=yi,D=255-l[R-1];for(w=0;w<_;++w){var M,U=L,z=D+l[f-1];for(M=0;M<_;++M)l[f+M]=U[z+l[R+M]];f+=32}}function Uc(l,f){vs(l,f,4)}function jc(l,f){vs(l,f,8)}function qc(l,f){vs(l,f,16)}function ko(l,f){var _;for(_=0;16>_;++_)r(l,f+32*_,l,f-32,16)}function Xi(l,f){var _;for(_=16;0<_;--_)i(l,f,l[f-1],16),f+=32}function pi(l,f,_){var w;for(w=0;16>w;++w)i(f,_+32*w,l,16)}function gl(l,f){var _,w=16;for(_=0;16>_;++_)w+=l[f-1+32*_]+l[f+_-32];pi(w>>5,l,f)}function Zs(l,f){var _,w=8;for(_=0;16>_;++_)w+=l[f-1+32*_];pi(w>>4,l,f)}function ii(l,f){var _,w=8;for(_=0;16>_;++_)w+=l[f+_-32];pi(w>>4,l,f)}function ml(l,f){pi(128,l,f)}function mt(l,f,_){return l+2*f+_+2>>2}function Co(l,f){var _,w=f-32;for(w=new Uint8Array([mt(l[w-1],l[w+0],l[w+1]),mt(l[w+0],l[w+1],l[w+2]),mt(l[w+1],l[w+2],l[w+3]),mt(l[w+2],l[w+3],l[w+4])]),_=0;4>_;++_)r(l,f+32*_,w,0,w.length)}function zc(l,f){var _=l[f-1],w=l[f-1+32],R=l[f-1+64],L=l[f-1+96];Le(l,f+0,16843009*mt(l[f-1-32],_,w)),Le(l,f+32,16843009*mt(_,w,R)),Le(l,f+64,16843009*mt(w,R,L)),Le(l,f+96,16843009*mt(R,L,L))}function eo(l,f){var _,w=4;for(_=0;4>_;++_)w+=l[f+_-32]+l[f-1+32*_];for(w>>=3,_=0;4>_;++_)i(l,f+32*_,w,4)}function Vr(l,f){var _=l[f-1+0],w=l[f-1+32],R=l[f-1+64],L=l[f-1-32],D=l[f+0-32],M=l[f+1-32],U=l[f+2-32],z=l[f+3-32];l[f+0+96]=mt(w,R,l[f-1+96]),l[f+1+96]=l[f+0+64]=mt(_,w,R),l[f+2+96]=l[f+1+64]=l[f+0+32]=mt(L,_,w),l[f+3+96]=l[f+2+64]=l[f+1+32]=l[f+0+0]=mt(D,L,_),l[f+3+64]=l[f+2+32]=l[f+1+0]=mt(M,D,L),l[f+3+32]=l[f+2+0]=mt(U,M,D),l[f+3+0]=mt(z,U,M)}function Oi(l,f){var _=l[f+1-32],w=l[f+2-32],R=l[f+3-32],L=l[f+4-32],D=l[f+5-32],M=l[f+6-32],U=l[f+7-32];l[f+0+0]=mt(l[f+0-32],_,w),l[f+1+0]=l[f+0+32]=mt(_,w,R),l[f+2+0]=l[f+1+32]=l[f+0+64]=mt(w,R,L),l[f+3+0]=l[f+2+32]=l[f+1+64]=l[f+0+96]=mt(R,L,D),l[f+3+32]=l[f+2+64]=l[f+1+96]=mt(L,D,M),l[f+3+64]=l[f+2+96]=mt(D,M,U),l[f+3+96]=mt(M,U,U)}function Ba(l,f){var _=l[f-1+0],w=l[f-1+32],R=l[f-1+64],L=l[f-1-32],D=l[f+0-32],M=l[f+1-32],U=l[f+2-32],z=l[f+3-32];l[f+0+0]=l[f+1+64]=L+D+1>>1,l[f+1+0]=l[f+2+64]=D+M+1>>1,l[f+2+0]=l[f+3+64]=M+U+1>>1,l[f+3+0]=U+z+1>>1,l[f+0+96]=mt(R,w,_),l[f+0+64]=mt(w,_,L),l[f+0+32]=l[f+1+96]=mt(_,L,D),l[f+1+32]=l[f+2+96]=mt(L,D,M),l[f+2+32]=l[f+3+96]=mt(D,M,U),l[f+3+32]=mt(M,U,z)}function hn(l,f){var _=l[f+0-32],w=l[f+1-32],R=l[f+2-32],L=l[f+3-32],D=l[f+4-32],M=l[f+5-32],U=l[f+6-32],z=l[f+7-32];l[f+0+0]=_+w+1>>1,l[f+1+0]=l[f+0+64]=w+R+1>>1,l[f+2+0]=l[f+1+64]=R+L+1>>1,l[f+3+0]=l[f+2+64]=L+D+1>>1,l[f+0+32]=mt(_,w,R),l[f+1+32]=l[f+0+96]=mt(w,R,L),l[f+2+32]=l[f+1+96]=mt(R,L,D),l[f+3+32]=l[f+2+96]=mt(L,D,M),l[f+3+64]=mt(D,M,U),l[f+3+96]=mt(M,U,z)}function Lo(l,f){var _=l[f-1+0],w=l[f-1+32],R=l[f-1+64],L=l[f-1+96];l[f+0+0]=_+w+1>>1,l[f+2+0]=l[f+0+32]=w+R+1>>1,l[f+2+32]=l[f+0+64]=R+L+1>>1,l[f+1+0]=mt(_,w,R),l[f+3+0]=l[f+1+32]=mt(w,R,L),l[f+3+32]=l[f+1+64]=mt(R,L,L),l[f+3+64]=l[f+2+64]=l[f+0+96]=l[f+1+96]=l[f+2+96]=l[f+3+96]=L}function Ua(l,f){var _=l[f-1+0],w=l[f-1+32],R=l[f-1+64],L=l[f-1+96],D=l[f-1-32],M=l[f+0-32],U=l[f+1-32],z=l[f+2-32];l[f+0+0]=l[f+2+32]=_+D+1>>1,l[f+0+32]=l[f+2+64]=w+_+1>>1,l[f+0+64]=l[f+2+96]=R+w+1>>1,l[f+0+96]=L+R+1>>1,l[f+3+0]=mt(M,U,z),l[f+2+0]=mt(D,M,U),l[f+1+0]=l[f+3+32]=mt(_,D,M),l[f+1+32]=l[f+3+64]=mt(w,_,D),l[f+1+64]=l[f+3+96]=mt(R,w,_),l[f+1+96]=mt(L,R,w)}function ws(l,f){var _;for(_=0;8>_;++_)r(l,f+32*_,l,f-32,8)}function $c(l,f){var _;for(_=0;8>_;++_)i(l,f,l[f-1],8),f+=32}function Fi(l,f,_){var w;for(w=0;8>w;++w)i(f,_+32*w,l,8)}function Do(l,f){var _,w=8;for(_=0;8>_;++_)w+=l[f+_-32]+l[f-1+32*_];Fi(w>>4,l,f)}function si(l,f){var _,w=4;for(_=0;8>_;++_)w+=l[f+_-32];Fi(w>>3,l,f)}function Oo(l,f){var _,w=4;for(_=0;8>_;++_)w+=l[f-1+32*_];Fi(w>>3,l,f)}function Wc(l,f){Fi(128,l,f)}function Br(l,f,_){var w=l[f-_],R=l[f+0],L=3*(R-w)+jp[1020+l[f-2*_]-l[f+_]],D=pd[112+(L+4>>3)];l[f-_]=yi[255+w+pd[112+(L+3>>3)]],l[f+0]=yi[255+R-D]}function Fo(l,f,_,w){var R=l[f+0],L=l[f+_];return ji[255+l[f-2*_]-l[f-_]]>w||ji[255+L-R]>w}function bs(l,f,_,w){return 4*ji[255+l[f-_]-l[f+0]]+ji[255+l[f-2*_]-l[f+_]]<=w}function Is(l,f,_,w,R){var L=l[f-3*_],D=l[f-2*_],M=l[f-_],U=l[f+0],z=l[f+_],Z=l[f+2*_],le=l[f+3*_];return 4*ji[255+M-U]+ji[255+D-z]>w?0:ji[255+l[f-4*_]-L]<=R&&ji[255+L-D]<=R&&ji[255+D-M]<=R&&ji[255+le-Z]<=R&&ji[255+Z-z]<=R&&ji[255+z-U]<=R}function As(l,f,_,w){var R=2*w+1;for(w=0;16>w;++w)bs(l,f+w,_,R)&&Br(l,f+w,_)}function Es(l,f,_,w){var R=2*w+1;for(w=0;16>w;++w)bs(l,f+w*_,1,R)&&Br(l,f+w*_,1)}function Hc(l,f,_,w){var R;for(R=3;0<R;--R)As(l,f+=4*_,_,w)}function ja(l,f,_,w){var R;for(R=3;0<R;--R)Es(l,f+=4,_,w)}function Ur(l,f,_,w,R,L,D,M){for(L=2*L+1;0<R--;){if(Is(l,f,_,L,D))if(Fo(l,f,_,M))Br(l,f,_);else{var U=l,z=f,Z=_,le=U[z-2*Z],$=U[z-Z],ee=U[z+0],se=U[z+Z],we=U[z+2*Z],ue=27*(Ae=jp[1020+3*(ee-$)+jp[1020+le-se]])+63>>7,Ie=18*Ae+63>>7,Ae=9*Ae+63>>7;U[z-3*Z]=yi[255+U[z-3*Z]+Ae],U[z-2*Z]=yi[255+le+Ie],U[z-Z]=yi[255+$+ue],U[z+0]=yi[255+ee-ue],U[z+Z]=yi[255+se-Ie],U[z+2*Z]=yi[255+we-Ae]}f+=w}}function Mi(l,f,_,w,R,L,D,M){for(L=2*L+1;0<R--;){if(Is(l,f,_,L,D))if(Fo(l,f,_,M))Br(l,f,_);else{var U=l,z=f,Z=_,le=U[z-Z],$=U[z+0],ee=U[z+Z],se=pd[112+(4+(we=3*($-le))>>3)],we=pd[112+(we+3>>3)],ue=se+1>>1;U[z-2*Z]=yi[255+U[z-2*Z]+ue],U[z-Z]=yi[255+le+we],U[z+0]=yi[255+$-se],U[z+Z]=yi[255+ee-ue]}f+=w}}function qa(l,f,_,w,R,L){Ur(l,f,_,1,16,w,R,L)}function Zi(l,f,_,w,R,L){Ur(l,f,1,_,16,w,R,L)}function Mo(l,f,_,w,R,L){var D;for(D=3;0<D;--D)Mi(l,f+=4*_,_,1,16,w,R,L)}function m(l,f,_,w,R,L){var D;for(D=3;0<D;--D)Mi(l,f+=4,1,_,16,w,R,L)}function P(l,f,_,w,R,L,D,M){Ur(l,f,R,1,8,L,D,M),Ur(_,w,R,1,8,L,D,M)}function q(l,f,_,w,R,L,D,M){Ur(l,f,1,R,8,L,D,M),Ur(_,w,1,R,8,L,D,M)}function Q(l,f,_,w,R,L,D,M){Mi(l,f+4*R,R,1,8,L,D,M),Mi(_,w+4*R,R,1,8,L,D,M)}function re(l,f,_,w,R,L,D,M){Mi(l,f+4,1,R,8,L,D,M),Mi(_,w+4,1,R,8,L,D,M)}function be(){this.ba=new ut,this.ec=[],this.cc=[],this.Mc=[],this.Dc=this.Nc=this.dc=this.fc=0,this.Oa=new Ft,this.memory=0,this.Ib="OutputFunc",this.Jb="OutputAlphaFunc",this.Nd="OutputRowFunc"}function Se(){this.data=[],this.offset=this.kd=this.ha=this.w=0,this.na=[],this.xa=this.gb=this.Ja=this.Sa=this.P=0}function We(){this.nc=this.Ea=this.b=this.hc=0,this.K=[],this.w=0}function Ye(){this.ua=0,this.Wa=new bt,this.vb=new bt,this.md=this.xc=this.wc=0,this.vc=[],this.Wb=0,this.Ya=new fe,this.yc=new T}function pt(){this.xb=this.a=0,this.l=new Mr,this.ca=new ut,this.V=[],this.Ba=0,this.Ta=[],this.Ua=0,this.m=new H,this.Pb=0,this.wd=new H,this.Ma=this.$=this.C=this.i=this.c=this.xd=0,this.s=new Ye,this.ab=0,this.gc=o(4,We),this.Oc=0}function ot(){this.Lc=this.Z=this.$a=this.i=this.c=0,this.l=new Mr,this.ic=0,this.ca=[],this.tb=0,this.qd=null,this.rd=0}function Mt(l,f,_,w,R,L,D){for(l=l==null?0:l[f+0],f=0;f<D;++f)R[L+f]=l+_[w+f]&255,l=R[L+f]}function dn(l,f,_,w,R,L,D){var M;if(l==null)Mt(null,null,_,w,R,L,D);else for(M=0;M<D;++M)R[L+M]=l[f+M]+_[w+M]&255}function sn(l,f,_,w,R,L,D){if(l==null)Mt(null,null,_,w,R,L,D);else{var M,U=l[f+0],z=U,Z=U;for(M=0;M<D;++M)z=Z+(U=l[f+M])-z,Z=_[w+M]+(-256&z?0>z?0:255:z)&255,z=U,R[L+M]=Z}}function h(l,f,_,w){var R=f.width,L=f.o;if(e(l!=null&&f!=null),0>_||0>=w||_+w>L)return null;if(!l.Cc){if(l.ga==null){var D;if(l.ga=new ot,(D=l.ga==null)||(D=f.width*f.o,e(l.Gb.length==0),l.Gb=s(D),l.Uc=0,l.Gb==null?D=0:(l.mb=l.Gb,l.nb=l.Uc,l.rc=null,D=1),D=!D),!D){D=l.ga;var M=l.Fa,U=l.P,z=l.qc,Z=l.mb,le=l.nb,$=U+1,ee=z-1,se=D.l;if(e(M!=null&&Z!=null&&f!=null),Ho[0]=null,Ho[1]=Mt,Ho[2]=dn,Ho[3]=sn,D.ca=Z,D.tb=le,D.c=f.width,D.i=f.height,e(0<D.c&&0<D.i),1>=z)f=0;else if(D.$a=3&M[U+0],D.Z=M[U+0]>>2&3,D.Lc=M[U+0]>>4&3,U=M[U+0]>>6&3,0>D.$a||1<D.$a||4<=D.Z||1<D.Lc||U)f=0;else if(se.put=dt,se.ac=dr,se.bc=Ki,se.ma=D,se.width=f.width,se.height=f.height,se.Da=f.Da,se.v=f.v,se.va=f.va,se.j=f.j,se.o=f.o,D.$a)e:{e(D.$a==1),f=gs();t:for(;;){if(f==null){f=0;break e}if(e(D!=null),D.mc=f,f.c=D.c,f.i=D.i,f.l=D.l,f.l.ma=D,f.l.width=D.c,f.l.height=D.i,f.a=0,ve(f.m,M,$,ee),!Ni(D.c,D.i,1,f,null)||(f.ab==1&&f.gc[0].hc==3&&Qr(f.s)?(D.ic=1,M=f.c*f.i,f.Ta=null,f.Ua=0,f.V=s(M),f.Ba=0,f.V==null?(f.a=1,f=0):f=1):(D.ic=0,f=ki(f,D.c)),!f))break t;f=1;break e}D.mc=null,f=0}else f=ee>=D.c*D.i;D=!f}if(D)return null;l.ga.Lc!=1?l.Ga=0:w=L-_}e(l.ga!=null),e(_+w<=L);e:{if(f=(M=l.ga).c,L=M.l.o,M.$a==0){if($=l.rc,ee=l.Vc,se=l.Fa,U=l.P+1+_*f,z=l.mb,Z=l.nb+_*f,e(U<=l.P+l.qc),M.Z!=0)for(e(Ho[M.Z]!=null),D=0;D<w;++D)Ho[M.Z]($,ee,se,U,z,Z,f),$=z,ee=Z,Z+=f,U+=f;else for(D=0;D<w;++D)r(z,Z,se,U,f),$=z,ee=Z,Z+=f,U+=f;l.rc=$,l.Vc=ee}else{if(e(M.mc!=null),f=_+w,e((D=M.mc)!=null),e(f<=D.i),D.C>=f)f=1;else if(M.ic||he(),M.ic){M=D.V,$=D.Ba,ee=D.c;var we=D.i,ue=(se=1,U=D.$/ee,z=D.$%ee,Z=D.m,le=D.s,D.$),Ie=ee*we,Ae=ee*f,ke=le.wc,Re=ue<Ae?Qn(le,z,U):null;e(ue<=Ie),e(f<=we),e(Qr(le));t:for(;;){for(;!Z.h&&ue<Ae;){if(z&ke||(Re=Qn(le,z,U)),e(Re!=null),ae(Z),256>(we=un(Re.G[0],Re.H[0],Z)))M[$+ue]=we,++ue,++z>=ee&&(z=0,++U<=f&&!(U%16)&&Or(D,U));else{if(!(280>we)){se=0;break t}we=Lr(we-256,Z);var nt,He=un(Re.G[4],Re.H[4],Z);if(ae(Z),!(ue>=(He=Dr(ee,He=Lr(He,Z)))&&Ie-ue>=we)){se=0;break t}for(nt=0;nt<we;++nt)M[$+ue+nt]=M[$+ue+nt-He];for(ue+=we,z+=we;z>=ee;)z-=ee,++U<=f&&!(U%16)&&Or(D,U);ue<Ae&&z&ke&&(Re=Qn(le,z,U))}e(Z.h==X(Z))}Or(D,U>f?f:U);break t}!se||Z.h&&ue<Ie?(se=0,D.a=Z.h?5:3):D.$=ue,f=se}else f=Zr(D,D.V,D.Ba,D.c,D.i,f,Ys);if(!f){w=0;break e}}_+w>=L&&(l.Cc=1),w=1}if(!w)return null;if(l.Cc&&((w=l.ga)!=null&&(w.mc=null),l.ga=null,0<l.Ga))return alert("todo:WebPDequantizeLevels"),null}return l.nb+_*R}function v(l,f,_,w,R,L){for(;0<R--;){var D,M=l,U=f+(_?1:0),z=l,Z=f+(_?0:3);for(D=0;D<w;++D){var le=z[Z+4*D];le!=255&&(le*=32897,M[U+4*D+0]=M[U+4*D+0]*le>>23,M[U+4*D+1]=M[U+4*D+1]*le>>23,M[U+4*D+2]=M[U+4*D+2]*le>>23)}f+=L}}function I(l,f,_,w,R){for(;0<w--;){var L;for(L=0;L<_;++L){var D=l[f+2*L+0],M=15&(z=l[f+2*L+1]),U=4369*M,z=(240&z|z>>4)*U>>16;l[f+2*L+0]=(240&D|D>>4)*U>>16&240|(15&D|D<<4)*U>>16>>4&15,l[f+2*L+1]=240&z|M}f+=R}}function V(l,f,_,w,R,L,D,M){var U,z,Z=255;for(z=0;z<R;++z){for(U=0;U<w;++U){var le=l[f+U];L[D+4*U]=le,Z&=le}f+=_,D+=M}return Z!=255}function ie(l,f,_,w,R){var L;for(L=0;L<R;++L)_[w+L]=l[f+L]>>8}function he(){Sl=v,ey=I,ty=V,ny=ie}function De(l,f,_){A[l]=function(w,R,L,D,M,U,z,Z,le,$,ee,se,we,ue,Ie,Ae,ke){var Re,nt=ke-1>>1,He=M[U+0]|z[Z+0]<<16,Rt=le[$+0]|ee[se+0]<<16;e(w!=null);var Qe=3*He+Rt+131074>>2;for(f(w[R+0],255&Qe,Qe>>16,we,ue),L!=null&&(Qe=3*Rt+He+131074>>2,f(L[D+0],255&Qe,Qe>>16,Ie,Ae)),Re=1;Re<=nt;++Re){var Ut=M[U+Re]|z[Z+Re]<<16,Zn=le[$+Re]|ee[se+Re]<<16,Nt=He+Ut+Rt+Zn+524296,Xe=Nt+2*(Ut+Rt)>>3;Qe=Xe+He>>1,He=(Nt=Nt+2*(He+Zn)>>3)+Ut>>1,f(w[R+2*Re-1],255&Qe,Qe>>16,we,ue+(2*Re-1)*_),f(w[R+2*Re-0],255&He,He>>16,we,ue+(2*Re-0)*_),L!=null&&(Qe=Nt+Rt>>1,He=Xe+Zn>>1,f(L[D+2*Re-1],255&Qe,Qe>>16,Ie,Ae+(2*Re-1)*_),f(L[D+2*Re+0],255&He,He>>16,Ie,Ae+(2*Re+0)*_)),He=Ut,Rt=Zn}1&ke||(Qe=3*He+Rt+131074>>2,f(w[R+ke-1],255&Qe,Qe>>16,we,ue+(ke-1)*_),L!=null&&(Qe=3*Rt+He+131074>>2,f(L[D+ke-1],255&Qe,Qe>>16,Ie,Ae+(ke-1)*_)))}}function vt(){qi[gd]=sT,qi[md]=fy,qi[cy]=oT,qi[yd]=py,qi[_d]=gy,qi[qp]=my,qi[uy]=aT,qi[zp]=fy,qi[$p]=py,qi[vd]=gy,qi[Wp]=my}function fn(l){return l&-16384?0>l?0:255:l>>cT}function Vt(l,f){return fn((19077*l>>8)+(26149*f>>8)-14234)}function pn(l,f,_){return fn((19077*l>>8)-(6419*f>>8)-(13320*_>>8)+8708)}function or(l,f){return fn((19077*l>>8)+(33050*f>>8)-17685)}function br(l,f,_,w,R){w[R+0]=Vt(l,_),w[R+1]=pn(l,f,_),w[R+2]=or(l,f)}function gn(l,f,_,w,R){w[R+0]=or(l,f),w[R+1]=pn(l,f,_),w[R+2]=Vt(l,_)}function Ir(l,f,_,w,R){var L=pn(l,f,_);f=L<<3&224|or(l,f)>>3,w[R+0]=248&Vt(l,_)|L>>5,w[R+1]=f}function Vi(l,f,_,w,R){var L=240&or(l,f)|15;w[R+0]=240&Vt(l,_)|pn(l,f,_)>>4,w[R+1]=L}function to(l,f,_,w,R){w[R+0]=255,br(l,f,_,w,R+1)}function yl(l,f,_,w,R){gn(l,f,_,w,R),w[R+3]=255}function jr(l,f,_,w,R){br(l,f,_,w,R),w[R+3]=255}function no(l,f,_){A[l]=function(w,R,L,D,M,U,z,Z,le){for(var $=Z+(-2&le)*_;Z!=$;)f(w[R+0],L[D+0],M[U+0],z,Z),f(w[R+1],L[D+0],M[U+0],z,Z+_),R+=2,++D,++U,Z+=2*_;1&le&&f(w[R+0],L[D+0],M[U+0],z,Z)}}function Gc(l,f,_){return _==0?l==0?f==0?6:5:f==0?4:0:_}function hd(l,f,_,w,R){switch(l>>>30){case 3:Ha(f,_,w,R,0);break;case 2:Ui(f,_,w,R);break;case 1:Yt(f,_,w,R)}}function Bi(l,f){var _,w,R=f.M,L=f.Nb,D=l.oc,M=l.pc+40,U=l.oc,z=l.pc+584,Z=l.oc,le=l.pc+600;for(_=0;16>_;++_)D[M+32*_-1]=129;for(_=0;8>_;++_)U[z+32*_-1]=129,Z[le+32*_-1]=129;for(0<R?D[M-1-32]=U[z-1-32]=Z[le-1-32]=129:(i(D,M-32-1,127,21),i(U,z-32-1,127,9),i(Z,le-32-1,127,9)),w=0;w<l.za;++w){var $=f.ya[f.aa+w];if(0<w){for(_=-1;16>_;++_)r(D,M+32*_-4,D,M+32*_+12,4);for(_=-1;8>_;++_)r(U,z+32*_-4,U,z+32*_+4,4),r(Z,le+32*_-4,Z,le+32*_+4,4)}var ee=l.Gd,se=l.Hd+w,we=$.ad,ue=$.Hc;if(0<R&&(r(D,M-32,ee[se].y,0,16),r(U,z-32,ee[se].f,0,8),r(Z,le-32,ee[se].ea,0,8)),$.Za){var Ie=D,Ae=M-32+16;for(0<R&&(w>=l.za-1?i(Ie,Ae,ee[se].y[15],4):r(Ie,Ae,ee[se+1].y,0,4)),_=0;4>_;_++)Ie[Ae+128+_]=Ie[Ae+256+_]=Ie[Ae+384+_]=Ie[Ae+0+_];for(_=0;16>_;++_,ue<<=2)Ie=D,Ae=M+_y[_],es[$.Ob[_]](Ie,Ae),hd(ue,we,16*+_,Ie,Ae)}else if(Ie=Gc(w,R,$.Ob[0]),Wo[Ie](D,M),ue!=0)for(_=0;16>_;++_,ue<<=2)hd(ue,we,16*+_,D,M+_y[_]);for(_=$.Gc,Ie=Gc(w,R,$.Dd),so[Ie](U,z),so[Ie](Z,le),ue=we,Ie=U,Ae=z,255&($=0|_)&&(170&$?Ps(ue,256,Ie,Ae):on(ue,256,Ie,Ae)),$=Z,ue=le,255&(_>>=8)&&(170&_?Ps(we,320,$,ue):on(we,320,$,ue)),R<l.Ub-1&&(r(ee[se].y,0,D,M+480,16),r(ee[se].f,0,U,z+224,8),r(ee[se].ea,0,Z,le+224,8)),_=8*L*l.B,ee=l.sa,se=l.ta+16*w+16*L*l.R,we=l.qa,$=l.ra+8*w+_,ue=l.Ha,Ie=l.Ia+8*w+_,_=0;16>_;++_)r(ee,se+_*l.R,D,M+32*_,16);for(_=0;8>_;++_)r(we,$+_*l.B,U,z+32*_,8),r(ue,Ie+_*l.B,Z,le+32*_,8)}}function za(l,f,_,w,R,L,D,M,U){var z=[0],Z=[0],le=0,$=U!=null?U.kd:0,ee=U??new Se;if(l==null||12>_)return 7;ee.data=l,ee.w=f,ee.ha=_,f=[f],_=[_],ee.gb=[ee.gb];e:{var se=f,we=_,ue=ee.gb;if(e(l!=null),e(we!=null),e(ue!=null),ue[0]=0,12<=we[0]&&!t(l,se[0],"RIFF")){if(t(l,se[0]+8,"WEBP")){ue=3;break e}var Ie=tt(l,se[0]+4);if(12>Ie||4294967286<Ie){ue=3;break e}if($&&Ie>we[0]-8){ue=7;break e}ue[0]=Ie,se[0]+=12,we[0]-=12}ue=0}if(ue!=0)return ue;for(Ie=0<ee.gb[0],_=_[0];;){e:{var Ae=l;we=f,ue=_;var ke=z,Re=Z,nt=se=[0];if((Qe=le=[le])[0]=0,8>ue[0])ue=7;else{if(!t(Ae,we[0],"VP8X")){if(tt(Ae,we[0]+4)!=10){ue=3;break e}if(18>ue[0]){ue=7;break e}var He=tt(Ae,we[0]+8),Rt=1+Ue(Ae,we[0]+12);if(2147483648<=Rt*(Ae=1+Ue(Ae,we[0]+15))){ue=3;break e}nt!=null&&(nt[0]=He),ke!=null&&(ke[0]=Rt),Re!=null&&(Re[0]=Ae),we[0]+=18,ue[0]-=18,Qe[0]=1}ue=0}}if(le=le[0],se=se[0],ue!=0)return ue;if(we=!!(2&se),!Ie&&le)return 3;if(L!=null&&(L[0]=!!(16&se)),D!=null&&(D[0]=we),M!=null&&(M[0]=0),D=z[0],se=Z[0],le&&we&&U==null){ue=0;break}if(4>_){ue=7;break}if(Ie&&le||!Ie&&!le&&!t(l,f[0],"ALPH")){_=[_],ee.na=[ee.na],ee.P=[ee.P],ee.Sa=[ee.Sa];e:{He=l,ue=f,Ie=_;var Qe=ee.gb;ke=ee.na,Re=ee.P,nt=ee.Sa,Rt=22,e(He!=null),e(Ie!=null),Ae=ue[0];var Ut=Ie[0];for(e(ke!=null),e(nt!=null),ke[0]=null,Re[0]=null,nt[0]=0;;){if(ue[0]=Ae,Ie[0]=Ut,8>Ut){ue=7;break e}var Zn=tt(He,Ae+4);if(4294967286<Zn){ue=3;break e}var Nt=8+Zn+1&-2;if(Rt+=Nt,0<Qe&&Rt>Qe){ue=3;break e}if(!t(He,Ae,"VP8 ")||!t(He,Ae,"VP8L")){ue=0;break e}if(Ut[0]<Nt){ue=7;break e}t(He,Ae,"ALPH")||(ke[0]=He,Re[0]=Ae+8,nt[0]=Zn),Ae+=Nt,Ut-=Nt}}if(_=_[0],ee.na=ee.na[0],ee.P=ee.P[0],ee.Sa=ee.Sa[0],ue!=0)break}_=[_],ee.Ja=[ee.Ja],ee.xa=[ee.xa];e:if(Qe=l,ue=f,Ie=_,ke=ee.gb[0],Re=ee.Ja,nt=ee.xa,He=ue[0],Ae=!t(Qe,He,"VP8 "),Rt=!t(Qe,He,"VP8L"),e(Qe!=null),e(Ie!=null),e(Re!=null),e(nt!=null),8>Ie[0])ue=7;else{if(Ae||Rt){if(Qe=tt(Qe,He+4),12<=ke&&Qe>ke-12){ue=3;break e}if($&&Qe>Ie[0]-8){ue=7;break e}Re[0]=Qe,ue[0]+=8,Ie[0]-=8,nt[0]=Rt}else nt[0]=5<=Ie[0]&&Qe[He+0]==47&&!(Qe[He+4]>>5),Re[0]=Ie[0];ue=0}if(_=_[0],ee.Ja=ee.Ja[0],ee.xa=ee.xa[0],f=f[0],ue!=0)break;if(4294967286<ee.Ja)return 3;if(M==null||we||(M[0]=ee.xa?2:1),D=[D],se=[se],ee.xa){if(5>_){ue=7;break}M=D,$=se,we=L,l==null||5>_?l=0:5<=_&&l[f+0]==47&&!(l[f+4]>>5)?(Ie=[0],Qe=[0],ke=[0],ve(Re=new H,l,f,_),Jr(Re,Ie,Qe,ke)?(M!=null&&(M[0]=Ie[0]),$!=null&&($[0]=Qe[0]),we!=null&&(we[0]=ke[0]),l=1):l=0):l=0}else{if(10>_){ue=7;break}M=se,l==null||10>_||!ys(l,f+3,_-3)?l=0:($=l[f+0]|l[f+1]<<8|l[f+2]<<16,we=16383&(l[f+7]<<8|l[f+6]),l=16383&(l[f+9]<<8|l[f+8]),1&$||3<($>>1&7)||!($>>4&1)||$>>5>=ee.Ja||!we||!l?l=0:(D&&(D[0]=we),M&&(M[0]=l),l=1))}if(!l||(D=D[0],se=se[0],le&&(z[0]!=D||Z[0]!=se)))return 3;U!=null&&(U[0]=ee,U.offset=f-U.w,e(4294967286>f-U.w),e(U.offset==U.ha-_));break}return ue==0||ue==7&&le&&U==null?(L!=null&&(L[0]|=ee.na!=null&&0<ee.na.length),w!=null&&(w[0]=D),R!=null&&(R[0]=se),0):ue}function _l(l,f,_){var w=f.width,R=f.height,L=0,D=0,M=w,U=R;if(f.Da=l!=null&&0<l.Da,f.Da&&(M=l.cd,U=l.bd,L=l.v,D=l.j,11>_||(L&=-2,D&=-2),0>L||0>D||0>=M||0>=U||L+M>w||D+U>R))return 0;if(f.v=L,f.j=D,f.va=L+M,f.o=D+U,f.U=M,f.T=U,f.da=l!=null&&0<l.da,f.da){if(!at(M,U,_=[l.ib],L=[l.hb]))return 0;f.ib=_[0],f.hb=L[0]}return f.ob=l!=null&&l.ob,f.Kb=l==null||!l.Sd,f.da&&(f.ob=f.ib<3*w/4&&f.hb<3*R/4,f.Kb=0),1}function vl(l){if(l==null)return 2;if(11>l.S){var f=l.f.RGBA;f.fb+=(l.height-1)*f.A,f.A=-f.A}else f=l.f.kb,l=l.height,f.O+=(l-1)*f.fa,f.fa=-f.fa,f.N+=(l-1>>1)*f.Ab,f.Ab=-f.Ab,f.W+=(l-1>>1)*f.Db,f.Db=-f.Db,f.F!=null&&(f.J+=(l-1)*f.lb,f.lb=-f.lb);return 0}function Vo(l,f,_,w){if(w==null||0>=l||0>=f)return 2;if(_!=null){if(_.Da){var R=_.cd,L=_.bd,D=-2&_.v,M=-2&_.j;if(0>D||0>M||0>=R||0>=L||D+R>l||M+L>f)return 2;l=R,f=L}if(_.da){if(!at(l,f,R=[_.ib],L=[_.hb]))return 2;l=R[0],f=L[0]}}w.width=l,w.height=f;e:{var U=w.width,z=w.height;if(l=w.S,0>=U||0>=z||!(l>=gd&&13>l))l=2;else{if(0>=w.Rd&&w.sd==null){D=L=R=f=0;var Z=(M=U*vy[l])*z;if(11>l||(L=(z+1)/2*(f=(U+1)/2),l==12&&(D=(R=U)*z)),(z=s(Z+2*L+D))==null){l=1;break e}w.sd=z,11>l?((U=w.f.RGBA).eb=z,U.fb=0,U.A=M,U.size=Z):((U=w.f.kb).y=z,U.O=0,U.fa=M,U.Fd=Z,U.f=z,U.N=0+Z,U.Ab=f,U.Cd=L,U.ea=z,U.W=0+Z+L,U.Db=f,U.Ed=L,l==12&&(U.F=z,U.J=0+Z+2*L),U.Tc=D,U.lb=R)}if(f=1,R=w.S,L=w.width,D=w.height,R>=gd&&13>R)if(11>R)l=w.f.RGBA,f&=(M=Math.abs(l.A))*(D-1)+L<=l.size,f&=M>=L*vy[R],f&=l.eb!=null;else{l=w.f.kb,M=(L+1)/2,Z=(D+1)/2,U=Math.abs(l.fa),z=Math.abs(l.Ab);var le=Math.abs(l.Db),$=Math.abs(l.lb),ee=$*(D-1)+L;f&=U*(D-1)+L<=l.Fd,f&=z*(Z-1)+M<=l.Cd,f=(f&=le*(Z-1)+M<=l.Ed)&U>=L&z>=M&le>=M,f&=l.y!=null,f&=l.f!=null,f&=l.ea!=null,R==12&&(f&=$>=L,f&=ee<=l.Tc,f&=l.F!=null)}else f=0;l=f?0:2}}return l!=0||_!=null&&_.fd&&(l=vl(w)),l}var $a=64,gi=[0,1,3,7,15,31,63,127,255,511,1023,2047,4095,8191,16383,32767,65535,131071,262143,524287,1048575,2097151,4194303,8388607,16777215],mi=24,Bo=32,ro=8,Uo=[0,0,1,1,2,2,2,2,3,3,3,3,3,3,3,3,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7];ze("Predictor0","PredictorAdd0"),A.Predictor0=function(){return 4278190080},A.Predictor1=function(l){return l},A.Predictor2=function(l,f,_){return f[_+0]},A.Predictor3=function(l,f,_){return f[_+1]},A.Predictor4=function(l,f,_){return f[_-1]},A.Predictor5=function(l,f,_){return it(it(l,f[_+1]),f[_+0])},A.Predictor6=function(l,f,_){return it(l,f[_-1])},A.Predictor7=function(l,f,_){return it(l,f[_+0])},A.Predictor8=function(l,f,_){return it(f[_-1],f[_+0])},A.Predictor9=function(l,f,_){return it(f[_+0],f[_+1])},A.Predictor10=function(l,f,_){return it(it(l,f[_-1]),it(f[_+0],f[_+1]))},A.Predictor11=function(l,f,_){var w=f[_+0];return 0>=_t(w>>24&255,l>>24&255,(f=f[_-1])>>24&255)+_t(w>>16&255,l>>16&255,f>>16&255)+_t(w>>8&255,l>>8&255,f>>8&255)+_t(255&w,255&l,255&f)?w:l},A.Predictor12=function(l,f,_){var w=f[_+0];return($t((l>>24&255)+(w>>24&255)-((f=f[_-1])>>24&255))<<24|$t((l>>16&255)+(w>>16&255)-(f>>16&255))<<16|$t((l>>8&255)+(w>>8&255)-(f>>8&255))<<8|$t((255&l)+(255&w)-(255&f)))>>>0},A.Predictor13=function(l,f,_){var w=f[_-1];return(Pt((l=it(l,f[_+0]))>>24&255,w>>24&255)<<24|Pt(l>>16&255,w>>16&255)<<16|Pt(l>>8&255,w>>8&255)<<8|Pt(255&l,255&w))>>>0};var wl=A.PredictorAdd0;A.PredictorAdd1=Lt,ze("Predictor2","PredictorAdd2"),ze("Predictor3","PredictorAdd3"),ze("Predictor4","PredictorAdd4"),ze("Predictor5","PredictorAdd5"),ze("Predictor6","PredictorAdd6"),ze("Predictor7","PredictorAdd7"),ze("Predictor8","PredictorAdd8"),ze("Predictor9","PredictorAdd9"),ze("Predictor10","PredictorAdd10"),ze("Predictor11","PredictorAdd11"),ze("Predictor12","PredictorAdd12"),ze("Predictor13","PredictorAdd13");var Kc=A.PredictorAdd2;Ze("ColorIndexInverseTransform","MapARGB","32b",function(l){return l>>8&255},function(l){return l}),Ze("VP8LColorIndexInverseTransformAlpha","MapAlpha","8b",function(l){return l},function(l){return l>>8&255});var Vn,dd=A.ColorIndexInverseTransform,Ts=A.MapARGB,Ss=A.VP8LColorIndexInverseTransformAlpha,bl=A.MapAlpha,Il=A.VP8LPredictorsAdd=[];Il.length=16,(A.VP8LPredictors=[]).length=16,(A.VP8LPredictorsAdd_C=[]).length=16,(A.VP8LPredictors_C=[]).length=16;var Al,El,jo,qo,zo,Wa,$o,Ha,Ui,Ps,Yt,on,Bn,Xn,io,Tl,Yc,fd,K0,Y0,J0,Q0,X0,Z0,Sl,ey,ty,ny,ry=s(511),iy=s(2041),sy=s(225),oy=s(767),ay=0,jp=iy,pd=sy,yi=oy,ji=ry,gd=0,md=1,cy=2,yd=3,_d=4,qp=5,uy=6,zp=7,$p=8,vd=9,Wp=10,WE=[2,3,7],HE=[3,3,11],ly=[280,256,256,256,40],GE=[0,1,1,1,0],KE=[17,18,0,1,2,3,4,5,16,6,7,8,9,10,11,12,13,14,15],YE=[24,7,23,25,40,6,39,41,22,26,38,42,56,5,55,57,21,27,54,58,37,43,72,4,71,73,20,28,53,59,70,74,36,44,88,69,75,52,60,3,87,89,19,29,86,90,35,45,68,76,85,91,51,61,104,2,103,105,18,30,102,106,34,46,84,92,67,77,101,107,50,62,120,1,119,121,83,93,17,31,100,108,66,78,118,122,33,47,117,123,49,63,99,109,82,94,0,116,124,65,79,16,32,98,110,48,115,125,81,95,64,114,126,97,111,80,113,127,96,112],JE=[2954,2956,2958,2962,2970,2986,3018,3082,3212,3468,3980,5004],QE=8,Hp=[4,5,6,7,8,9,10,10,11,12,13,14,15,16,17,17,18,19,20,20,21,21,22,22,23,23,24,25,25,26,27,28,29,30,31,32,33,34,35,36,37,37,38,39,40,41,42,43,44,45,46,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,76,77,78,79,80,81,82,83,84,85,86,87,88,89,91,93,95,96,98,100,101,102,104,106,108,110,112,114,116,118,122,124,126,128,130,132,134,136,138,140,143,145,148,151,154,157],Gp=[4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,60,62,64,66,68,70,72,74,76,78,80,82,84,86,88,90,92,94,96,98,100,102,104,106,108,110,112,114,116,119,122,125,128,131,134,137,140,143,146,149,152,155,158,161,164,167,170,173,177,181,185,189,193,197,201,205,209,213,217,221,225,229,234,239,245,249,254,259,264,269,274,279,284],Pl=null,XE=[[173,148,140,0],[176,155,140,135,0],[180,157,141,134,130,0],[254,254,243,230,196,177,153,140,133,130,129,0]],ZE=[0,1,4,8,5,2,3,6,9,12,13,10,7,11,14,15],hy=[-0,1,-1,2,-2,3,4,6,-3,5,-4,-5,-6,7,-7,8,-8,-9],eT=[[[[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128]],[[253,136,254,255,228,219,128,128,128,128,128],[189,129,242,255,227,213,255,219,128,128,128],[106,126,227,252,214,209,255,255,128,128,128]],[[1,98,248,255,236,226,255,255,128,128,128],[181,133,238,254,221,234,255,154,128,128,128],[78,134,202,247,198,180,255,219,128,128,128]],[[1,185,249,255,243,255,128,128,128,128,128],[184,150,247,255,236,224,128,128,128,128,128],[77,110,216,255,236,230,128,128,128,128,128]],[[1,101,251,255,241,255,128,128,128,128,128],[170,139,241,252,236,209,255,255,128,128,128],[37,116,196,243,228,255,255,255,128,128,128]],[[1,204,254,255,245,255,128,128,128,128,128],[207,160,250,255,238,128,128,128,128,128,128],[102,103,231,255,211,171,128,128,128,128,128]],[[1,152,252,255,240,255,128,128,128,128,128],[177,135,243,255,234,225,128,128,128,128,128],[80,129,211,255,194,224,128,128,128,128,128]],[[1,1,255,128,128,128,128,128,128,128,128],[246,1,255,128,128,128,128,128,128,128,128],[255,128,128,128,128,128,128,128,128,128,128]]],[[[198,35,237,223,193,187,162,160,145,155,62],[131,45,198,221,172,176,220,157,252,221,1],[68,47,146,208,149,167,221,162,255,223,128]],[[1,149,241,255,221,224,255,255,128,128,128],[184,141,234,253,222,220,255,199,128,128,128],[81,99,181,242,176,190,249,202,255,255,128]],[[1,129,232,253,214,197,242,196,255,255,128],[99,121,210,250,201,198,255,202,128,128,128],[23,91,163,242,170,187,247,210,255,255,128]],[[1,200,246,255,234,255,128,128,128,128,128],[109,178,241,255,231,245,255,255,128,128,128],[44,130,201,253,205,192,255,255,128,128,128]],[[1,132,239,251,219,209,255,165,128,128,128],[94,136,225,251,218,190,255,255,128,128,128],[22,100,174,245,186,161,255,199,128,128,128]],[[1,182,249,255,232,235,128,128,128,128,128],[124,143,241,255,227,234,128,128,128,128,128],[35,77,181,251,193,211,255,205,128,128,128]],[[1,157,247,255,236,231,255,255,128,128,128],[121,141,235,255,225,227,255,255,128,128,128],[45,99,188,251,195,217,255,224,128,128,128]],[[1,1,251,255,213,255,128,128,128,128,128],[203,1,248,255,255,128,128,128,128,128,128],[137,1,177,255,224,255,128,128,128,128,128]]],[[[253,9,248,251,207,208,255,192,128,128,128],[175,13,224,243,193,185,249,198,255,255,128],[73,17,171,221,161,179,236,167,255,234,128]],[[1,95,247,253,212,183,255,255,128,128,128],[239,90,244,250,211,209,255,255,128,128,128],[155,77,195,248,188,195,255,255,128,128,128]],[[1,24,239,251,218,219,255,205,128,128,128],[201,51,219,255,196,186,128,128,128,128,128],[69,46,190,239,201,218,255,228,128,128,128]],[[1,191,251,255,255,128,128,128,128,128,128],[223,165,249,255,213,255,128,128,128,128,128],[141,124,248,255,255,128,128,128,128,128,128]],[[1,16,248,255,255,128,128,128,128,128,128],[190,36,230,255,236,255,128,128,128,128,128],[149,1,255,128,128,128,128,128,128,128,128]],[[1,226,255,128,128,128,128,128,128,128,128],[247,192,255,128,128,128,128,128,128,128,128],[240,128,255,128,128,128,128,128,128,128,128]],[[1,134,252,255,255,128,128,128,128,128,128],[213,62,250,255,255,128,128,128,128,128,128],[55,93,255,128,128,128,128,128,128,128,128]],[[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128]]],[[[202,24,213,235,186,191,220,160,240,175,255],[126,38,182,232,169,184,228,174,255,187,128],[61,46,138,219,151,178,240,170,255,216,128]],[[1,112,230,250,199,191,247,159,255,255,128],[166,109,228,252,211,215,255,174,128,128,128],[39,77,162,232,172,180,245,178,255,255,128]],[[1,52,220,246,198,199,249,220,255,255,128],[124,74,191,243,183,193,250,221,255,255,128],[24,71,130,219,154,170,243,182,255,255,128]],[[1,182,225,249,219,240,255,224,128,128,128],[149,150,226,252,216,205,255,171,128,128,128],[28,108,170,242,183,194,254,223,255,255,128]],[[1,81,230,252,204,203,255,192,128,128,128],[123,102,209,247,188,196,255,233,128,128,128],[20,95,153,243,164,173,255,203,128,128,128]],[[1,222,248,255,216,213,128,128,128,128,128],[168,175,246,252,235,205,255,255,128,128,128],[47,116,215,255,211,212,255,255,128,128,128]],[[1,121,236,253,212,214,255,255,128,128,128],[141,84,213,252,201,202,255,219,128,128,128],[42,80,160,240,162,185,255,205,128,128,128]],[[1,1,255,128,128,128,128,128,128,128,128],[244,1,255,128,128,128,128,128,128,128,128],[238,1,255,128,128,128,128,128,128,128,128]]]],tT=[[[231,120,48,89,115,113,120,152,112],[152,179,64,126,170,118,46,70,95],[175,69,143,80,85,82,72,155,103],[56,58,10,171,218,189,17,13,152],[114,26,17,163,44,195,21,10,173],[121,24,80,195,26,62,44,64,85],[144,71,10,38,171,213,144,34,26],[170,46,55,19,136,160,33,206,71],[63,20,8,114,114,208,12,9,226],[81,40,11,96,182,84,29,16,36]],[[134,183,89,137,98,101,106,165,148],[72,187,100,130,157,111,32,75,80],[66,102,167,99,74,62,40,234,128],[41,53,9,178,241,141,26,8,107],[74,43,26,146,73,166,49,23,157],[65,38,105,160,51,52,31,115,128],[104,79,12,27,217,255,87,17,7],[87,68,71,44,114,51,15,186,23],[47,41,14,110,182,183,21,17,194],[66,45,25,102,197,189,23,18,22]],[[88,88,147,150,42,46,45,196,205],[43,97,183,117,85,38,35,179,61],[39,53,200,87,26,21,43,232,171],[56,34,51,104,114,102,29,93,77],[39,28,85,171,58,165,90,98,64],[34,22,116,206,23,34,43,166,73],[107,54,32,26,51,1,81,43,31],[68,25,106,22,64,171,36,225,114],[34,19,21,102,132,188,16,76,124],[62,18,78,95,85,57,50,48,51]],[[193,101,35,159,215,111,89,46,111],[60,148,31,172,219,228,21,18,111],[112,113,77,85,179,255,38,120,114],[40,42,1,196,245,209,10,25,109],[88,43,29,140,166,213,37,43,154],[61,63,30,155,67,45,68,1,209],[100,80,8,43,154,1,51,26,71],[142,78,78,16,255,128,34,197,171],[41,40,5,102,211,183,4,1,221],[51,50,17,168,209,192,23,25,82]],[[138,31,36,171,27,166,38,44,229],[67,87,58,169,82,115,26,59,179],[63,59,90,180,59,166,93,73,154],[40,40,21,116,143,209,34,39,175],[47,15,16,183,34,223,49,45,183],[46,17,33,183,6,98,15,32,183],[57,46,22,24,128,1,54,17,37],[65,32,73,115,28,128,23,128,205],[40,3,9,115,51,192,18,6,223],[87,37,9,115,59,77,64,21,47]],[[104,55,44,218,9,54,53,130,226],[64,90,70,205,40,41,23,26,57],[54,57,112,184,5,41,38,166,213],[30,34,26,133,152,116,10,32,134],[39,19,53,221,26,114,32,73,255],[31,9,65,234,2,15,1,118,73],[75,32,12,51,192,255,160,43,51],[88,31,35,67,102,85,55,186,85],[56,21,23,111,59,205,45,37,192],[55,38,70,124,73,102,1,34,98]],[[125,98,42,88,104,85,117,175,82],[95,84,53,89,128,100,113,101,45],[75,79,123,47,51,128,81,171,1],[57,17,5,71,102,57,53,41,49],[38,33,13,121,57,73,26,1,85],[41,10,67,138,77,110,90,47,114],[115,21,2,10,102,255,166,23,6],[101,29,16,10,85,128,101,196,26],[57,18,10,102,102,213,34,20,43],[117,20,15,36,163,128,68,1,26]],[[102,61,71,37,34,53,31,243,192],[69,60,71,38,73,119,28,222,37],[68,45,128,34,1,47,11,245,171],[62,17,19,70,146,85,55,62,70],[37,43,37,154,100,163,85,160,1],[63,9,92,136,28,64,32,201,85],[75,15,9,9,64,255,184,119,16],[86,6,28,5,64,255,25,248,1],[56,8,17,132,137,255,55,116,128],[58,15,20,82,135,57,26,121,40]],[[164,50,31,137,154,133,25,35,218],[51,103,44,131,131,123,31,6,158],[86,40,64,135,148,224,45,183,128],[22,26,17,131,240,154,14,1,209],[45,16,21,91,64,222,7,1,197],[56,21,39,155,60,138,23,102,213],[83,12,13,54,192,255,68,47,28],[85,26,85,85,128,128,32,146,171],[18,11,7,63,144,171,4,4,246],[35,27,10,146,174,171,12,26,128]],[[190,80,35,99,180,80,126,54,45],[85,126,47,87,176,51,41,20,32],[101,75,128,139,118,146,116,128,85],[56,41,15,176,236,85,37,9,62],[71,30,17,119,118,255,17,18,138],[101,38,60,138,55,70,43,26,142],[146,36,19,30,171,255,97,27,20],[138,45,61,62,219,1,81,188,64],[32,41,20,117,151,142,20,21,163],[112,19,12,61,195,128,48,4,24]]],nT=[[[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[176,246,255,255,255,255,255,255,255,255,255],[223,241,252,255,255,255,255,255,255,255,255],[249,253,253,255,255,255,255,255,255,255,255]],[[255,244,252,255,255,255,255,255,255,255,255],[234,254,254,255,255,255,255,255,255,255,255],[253,255,255,255,255,255,255,255,255,255,255]],[[255,246,254,255,255,255,255,255,255,255,255],[239,253,254,255,255,255,255,255,255,255,255],[254,255,254,255,255,255,255,255,255,255,255]],[[255,248,254,255,255,255,255,255,255,255,255],[251,255,254,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,253,254,255,255,255,255,255,255,255,255],[251,254,254,255,255,255,255,255,255,255,255],[254,255,254,255,255,255,255,255,255,255,255]],[[255,254,253,255,254,255,255,255,255,255,255],[250,255,254,255,254,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]],[[[217,255,255,255,255,255,255,255,255,255,255],[225,252,241,253,255,255,254,255,255,255,255],[234,250,241,250,253,255,253,254,255,255,255]],[[255,254,255,255,255,255,255,255,255,255,255],[223,254,254,255,255,255,255,255,255,255,255],[238,253,254,254,255,255,255,255,255,255,255]],[[255,248,254,255,255,255,255,255,255,255,255],[249,254,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,253,255,255,255,255,255,255,255,255,255],[247,254,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,253,254,255,255,255,255,255,255,255,255],[252,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,254,254,255,255,255,255,255,255,255,255],[253,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,254,253,255,255,255,255,255,255,255,255],[250,255,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]],[[[186,251,250,255,255,255,255,255,255,255,255],[234,251,244,254,255,255,255,255,255,255,255],[251,251,243,253,254,255,254,255,255,255,255]],[[255,253,254,255,255,255,255,255,255,255,255],[236,253,254,255,255,255,255,255,255,255,255],[251,253,253,254,254,255,255,255,255,255,255]],[[255,254,254,255,255,255,255,255,255,255,255],[254,254,254,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,254,255,255,255,255,255,255,255,255,255],[254,254,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]],[[[248,255,255,255,255,255,255,255,255,255,255],[250,254,252,254,255,255,255,255,255,255,255],[248,254,249,253,255,255,255,255,255,255,255]],[[255,253,253,255,255,255,255,255,255,255,255],[246,253,253,255,255,255,255,255,255,255,255],[252,254,251,254,254,255,255,255,255,255,255]],[[255,254,252,255,255,255,255,255,255,255,255],[248,254,253,255,255,255,255,255,255,255,255],[253,255,254,254,255,255,255,255,255,255,255]],[[255,251,254,255,255,255,255,255,255,255,255],[245,251,254,255,255,255,255,255,255,255,255],[253,253,254,255,255,255,255,255,255,255,255]],[[255,251,253,255,255,255,255,255,255,255,255],[252,253,254,255,255,255,255,255,255,255,255],[255,254,255,255,255,255,255,255,255,255,255]],[[255,252,255,255,255,255,255,255,255,255,255],[249,255,254,255,255,255,255,255,255,255,255],[255,255,254,255,255,255,255,255,255,255,255]],[[255,255,253,255,255,255,255,255,255,255,255],[250,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]]],rT=[0,1,2,3,6,4,5,6,6,6,6,6,6,6,6,7,0],Wo=[],es=[],so=[],iT=1,dy=2,Ho=[],qi=[];De("UpsampleRgbLinePair",br,3),De("UpsampleBgrLinePair",gn,3),De("UpsampleRgbaLinePair",jr,4),De("UpsampleBgraLinePair",yl,4),De("UpsampleArgbLinePair",to,4),De("UpsampleRgba4444LinePair",Vi,2),De("UpsampleRgb565LinePair",Ir,2);var sT=A.UpsampleRgbLinePair,oT=A.UpsampleBgrLinePair,fy=A.UpsampleRgbaLinePair,py=A.UpsampleBgraLinePair,gy=A.UpsampleArgbLinePair,my=A.UpsampleRgba4444LinePair,aT=A.UpsampleRgb565LinePair,wd=16,bd=1<<wd-1,xl=-227,Kp=482,cT=6,yy=0,uT=s(256),lT=s(256),hT=s(256),dT=s(256),fT=s(Kp-xl),pT=s(Kp-xl);no("YuvToRgbRow",br,3),no("YuvToBgrRow",gn,3),no("YuvToRgbaRow",jr,4),no("YuvToBgraRow",yl,4),no("YuvToArgbRow",to,4),no("YuvToRgba4444Row",Vi,2),no("YuvToRgb565Row",Ir,2);var _y=[0,4,8,12,128,132,136,140,256,260,264,268,384,388,392,396],Id=[0,2,8],gT=[8,7,6,4,4,2,2,2,1,1,1,1],mT=1;this.WebPDecodeRGBA=function(l,f,_,w,R){var L=md,D=new be,M=new ut;D.ba=M,M.S=L,M.width=[M.width],M.height=[M.height];var U=M.width,z=M.height,Z=new lt;if(Z==null||l==null)var le=2;else e(Z!=null),le=za(l,f,_,Z.width,Z.height,Z.Pd,Z.Qd,Z.format,null);if(le!=0?U=0:(U!=null&&(U[0]=Z.width[0]),z!=null&&(z[0]=Z.height[0]),U=1),U){M.width=M.width[0],M.height=M.height[0],w!=null&&(w[0]=M.width),R!=null&&(R[0]=M.height);e:{if(w=new Mr,(R=new Se).data=l,R.w=f,R.ha=_,R.kd=1,f=[0],e(R!=null),((l=za(R.data,R.w,R.ha,null,null,null,f,null,R))==0||l==7)&&f[0]&&(l=4),(f=l)==0){if(e(D!=null),w.data=R.data,w.w=R.w+R.offset,w.ha=R.ha-R.offset,w.put=dt,w.ac=dr,w.bc=Ki,w.ma=D,R.xa){if((l=gs())==null){D=1;break e}if((function($,ee){var se=[0],we=[0],ue=[0];t:for(;;){if($==null)return 0;if(ee==null)return $.a=2,0;if($.l=ee,$.a=0,ve($.m,ee.data,ee.w,ee.ha),!Jr($.m,se,we,ue)){$.a=3;break t}if($.xb=dy,ee.width=se[0],ee.height=we[0],!Ni(se[0],we[0],1,$,null))break t;return 1}return e($.a!=0),0})(l,w)){if(w=(f=Vo(w.width,w.height,D.Oa,D.ba))==0){t:{w=l;n:for(;;){if(w==null){w=0;break t}if(e(w.s.yc!=null),e(w.s.Ya!=null),e(0<w.s.Wb),e((_=w.l)!=null),e((R=_.ma)!=null),w.xb!=0){if(w.ca=R.ba,w.tb=R.tb,e(w.ca!=null),!_l(R.Oa,_,yd)){w.a=2;break n}if(!ki(w,_.width)||_.da)break n;if((_.da||ht(w.ca.S))&&he(),11>w.ca.S||(alert("todo:WebPInitConvertARGBToYUV"),w.ca.f.kb.F!=null&&he()),w.Pb&&0<w.s.ua&&w.s.vb.X==null&&!j(w.s.vb,w.s.Wa.Xa)){w.a=1;break n}w.xb=0}if(!Zr(w,w.V,w.Ba,w.c,w.i,_.o,Yi))break n;R.Dc=w.Ma,w=1;break t}e(w.a!=0),w=0}w=!w}w&&(f=l.a)}else f=l.a}else{if((l=new ti)==null){D=1;break e}if(l.Fa=R.na,l.P=R.P,l.qc=R.Sa,ni(l,w)){if((f=Vo(w.width,w.height,D.Oa,D.ba))==0){if(l.Aa=0,_=D.Oa,e((R=l)!=null),_!=null){if(0<(U=0>(U=_.Md)?0:100<U?255:255*U/100)){for(z=Z=0;4>z;++z)12>(le=R.pb[z]).lc&&(le.ia=U*gT[0>le.lc?0:le.lc]>>3),Z|=le.ia;Z&&(alert("todo:VP8InitRandom"),R.ia=1)}R.Ga=_.Id,100<R.Ga?R.Ga=100:0>R.Ga&&(R.Ga=0)}(function($,ee){if($==null)return 0;if(ee==null)return ln($,2,"NULL VP8Io parameter in VP8Decode().");if(!$.cb&&!ni($,ee))return 0;if(e($.cb),ee.ac==null||ee.ac(ee)){ee.ob&&($.L=0);var se=Id[$.L];if($.L==2?($.yb=0,$.zb=0):($.yb=ee.v-se>>4,$.zb=ee.j-se>>4,0>$.yb&&($.yb=0),0>$.zb&&($.zb=0)),$.Va=ee.o+15+se>>4,$.Hb=ee.va+15+se>>4,$.Hb>$.za&&($.Hb=$.za),$.Va>$.Ub&&($.Va=$.Ub),0<$.L){var we=$.ed;for(se=0;4>se;++se){var ue;if($.Qa.Cb){var Ie=$.Qa.Lb[se];$.Qa.Fb||(Ie+=we.Tb)}else Ie=we.Tb;for(ue=0;1>=ue;++ue){var Ae=$.gd[se][ue],ke=Ie;if(we.Pc&&(ke+=we.vd[0],ue&&(ke+=we.od[0])),0<(ke=0>ke?0:63<ke?63:ke)){var Re=ke;0<we.wb&&(Re=4<we.wb?Re>>2:Re>>1)>9-we.wb&&(Re=9-we.wb),1>Re&&(Re=1),Ae.dd=Re,Ae.tc=2*ke+Re,Ae.ld=40<=ke?2:15<=ke?1:0}else Ae.tc=0;Ae.La=ue}}}se=0}else ln($,6,"Frame setup failed"),se=$.a;if(se=se==0){if(se){$.$c=0,0<$.Aa||($.Ic=mT);t:{se=$.Ic,we=4*(Re=$.za);var nt=32*Re,He=Re+1,Rt=0<$.L?Re*(0<$.Aa?2:1):0,Qe=($.Aa==2?2:1)*Re;if((Ae=we+832+(ue=3*(16*se+Id[$.L])/2*nt)+(Ie=$.Fa!=null&&0<$.Fa.length?$.Kc.c*$.Kc.i:0))!=Ae)se=0;else{if(Ae>$.Vb){if($.Vb=0,$.Ec=s(Ae),$.Fc=0,$.Ec==null){se=ln($,1,"no memory during frame initialization.");break t}$.Vb=Ae}Ae=$.Ec,ke=$.Fc,$.Ac=Ae,$.Bc=ke,ke+=we,$.Gd=o(nt,Fa),$.Hd=0,$.rb=o(He+1,Ro),$.sb=1,$.wa=Rt?o(Rt,Fr):null,$.Y=0,$.D.Nb=0,$.D.wa=$.wa,$.D.Y=$.Y,0<$.Aa&&($.D.Y+=Re),e(!0),$.oc=Ae,$.pc=ke,ke+=832,$.ya=o(Qe,Qs),$.aa=0,$.D.ya=$.ya,$.D.aa=$.aa,$.Aa==2&&($.D.aa+=Re),$.R=16*Re,$.B=8*Re,Re=(nt=Id[$.L])*$.R,nt=nt/2*$.B,$.sa=Ae,$.ta=ke+Re,$.qa=$.sa,$.ra=$.ta+16*se*$.R+nt,$.Ha=$.qa,$.Ia=$.ra+8*se*$.B+nt,$.$c=0,ke+=ue,$.mb=Ie?Ae:null,$.nb=Ie?ke:null,e(ke+Ie<=$.Fc+$.Vb),Xs($),i($.Ac,$.Bc,0,we),se=1}}if(se){if(ee.ka=0,ee.y=$.sa,ee.O=$.ta,ee.f=$.qa,ee.N=$.ra,ee.ea=$.Ha,ee.Vd=$.Ia,ee.fa=$.R,ee.Rc=$.B,ee.F=null,ee.J=0,!ay){for(se=-255;255>=se;++se)ry[255+se]=0>se?-se:se;for(se=-1020;1020>=se;++se)iy[1020+se]=-128>se?-128:127<se?127:se;for(se=-112;112>=se;++se)sy[112+se]=-16>se?-16:15<se?15:se;for(se=-255;510>=se;++se)oy[255+se]=0>se?0:255<se?255:se;ay=1}$o=ri,Ha=pl,Ps=Di,Yt=Bc,on=_s,Ui=fl,Bn=qa,Xn=Zi,io=P,Tl=q,Yc=Mo,fd=m,K0=Q,Y0=re,J0=As,Q0=Es,X0=Hc,Z0=ja,es[0]=eo,es[1]=Uc,es[2]=Co,es[3]=zc,es[4]=Vr,es[5]=Ba,es[6]=Oi,es[7]=hn,es[8]=Ua,es[9]=Lo,Wo[0]=gl,Wo[1]=qc,Wo[2]=ko,Wo[3]=Xi,Wo[4]=Zs,Wo[5]=ii,Wo[6]=ml,so[0]=Do,so[1]=jc,so[2]=ws,so[3]=$c,so[4]=Oo,so[5]=si,so[6]=Wc,se=1}else se=0}se&&(se=(function(Ut,Zn){for(Ut.M=0;Ut.M<Ut.Va;++Ut.M){var Nt,Xe=Ut.Jc[Ut.M&Ut.Xb],Me=Ut.m,Un=Ut;for(Nt=0;Nt<Un.za;++Nt){var St=Me,jt=Un,wn=jt.Ac,fr=jt.Bc+4*Nt,qr=jt.zc,Cn=jt.ya[jt.aa+Nt];if(jt.Qa.Bb?Cn.$b=Ee(St,jt.Pa.jb[0])?2+Ee(St,jt.Pa.jb[2]):Ee(St,jt.Pa.jb[1]):Cn.$b=0,jt.kc&&(Cn.Ad=Ee(St,jt.Bd)),Cn.Za=!Ee(St,145)+0,Cn.Za){var Ar=Cn.Ob,zr=0;for(jt=0;4>jt;++jt){var er,zt=qr[0+jt];for(er=0;4>er;++er){zt=tT[wn[fr+er]][zt];for(var Qt=hy[Ee(St,zt[0])];0<Qt;)Qt=hy[2*Qt+Ee(St,zt[Qt])];zt=-Qt,wn[fr+er]=zt}r(Ar,zr,wn,fr,4),zr+=4,qr[0+jt]=zt}}else zt=Ee(St,156)?Ee(St,128)?1:3:Ee(St,163)?2:0,Cn.Ob[0]=zt,i(wn,fr,zt,4),i(qr,0,zt,4);Cn.Dd=Ee(St,142)?Ee(St,114)?Ee(St,183)?1:3:2:0}if(Un.m.Ka)return ln(Ut,7,"Premature end-of-partition0 encountered.");for(;Ut.ja<Ut.za;++Ut.ja){if(Un=Xe,St=(Me=Ut).rb[Me.sb-1],wn=Me.rb[Me.sb+Me.ja],Nt=Me.ya[Me.aa+Me.ja],fr=Me.kc?Nt.Ad:0)St.la=wn.la=0,Nt.Za||(St.Na=wn.Na=0),Nt.Hc=0,Nt.Gc=0,Nt.ia=0;else{var Ln,Xt;if(St=wn,wn=Un,fr=Me.Pa.Xc,qr=Me.ya[Me.aa+Me.ja],Cn=Me.pb[qr.$b],jt=qr.ad,Ar=0,zr=Me.rb[Me.sb-1],zt=er=0,i(jt,Ar,0,384),qr.Za)var pr=0,ts=fr[3];else{Qt=s(16);var jn=St.Na+zr.Na;if(jn=Pl(wn,fr[1],jn,Cn.Eb,0,Qt,0),St.Na=zr.Na=(0<jn)+0,1<jn)$o(Qt,0,jt,Ar);else{var oi=Qt[0]+3>>3;for(Qt=0;256>Qt;Qt+=16)jt[Ar+Qt]=oi}pr=1,ts=fr[0]}var an=15&St.la,tr=15&zr.la;for(Qt=0;4>Qt;++Qt){var _i=1&tr;for(oi=Xt=0;4>oi;++oi)an=an>>1|(_i=(jn=Pl(wn,ts,jn=_i+(1&an),Cn.Sc,pr,jt,Ar))>pr)<<7,Xt=Xt<<2|(3<jn?3:1<jn?2:jt[Ar+0]!=0),Ar+=16;an>>=4,tr=tr>>1|_i<<7,er=(er<<8|Xt)>>>0}for(ts=an,pr=tr>>4,Ln=0;4>Ln;Ln+=2){for(Xt=0,an=St.la>>4+Ln,tr=zr.la>>4+Ln,Qt=0;2>Qt;++Qt){for(_i=1&tr,oi=0;2>oi;++oi)jn=_i+(1&an),an=an>>1|(_i=0<(jn=Pl(wn,fr[2],jn,Cn.Qc,0,jt,Ar)))<<3,Xt=Xt<<2|(3<jn?3:1<jn?2:jt[Ar+0]!=0),Ar+=16;an>>=2,tr=tr>>1|_i<<5}zt|=Xt<<4*Ln,ts|=an<<4<<Ln,pr|=(240&tr)<<Ln}St.la=ts,zr.la=pr,qr.Hc=er,qr.Gc=zt,qr.ia=43690&zt?0:Cn.ia,fr=!(er|zt)}if(0<Me.L&&(Me.wa[Me.Y+Me.ja]=Me.gd[Nt.$b][Nt.Za],Me.wa[Me.Y+Me.ja].La|=!fr),Un.Ka)return ln(Ut,7,"Premature end-of-file encountered.")}if(Xs(Ut),Me=Zn,Un=1,Nt=(Xe=Ut).D,St=0<Xe.L&&Xe.M>=Xe.zb&&Xe.M<=Xe.Va,Xe.Aa==0)t:{if(Nt.M=Xe.M,Nt.uc=St,Bi(Xe,Nt),Un=1,Nt=(Xt=Xe.D).Nb,St=(zt=Id[Xe.L])*Xe.R,wn=zt/2*Xe.B,Qt=16*Nt*Xe.R,oi=8*Nt*Xe.B,fr=Xe.sa,qr=Xe.ta-St+Qt,Cn=Xe.qa,jt=Xe.ra-wn+oi,Ar=Xe.Ha,zr=Xe.Ia-wn+oi,tr=(an=Xt.M)==0,er=an>=Xe.Va-1,Xe.Aa==2&&Bi(Xe,Xt),Xt.uc)for(_i=(jn=Xe).D.M,e(jn.D.uc),Xt=jn.yb;Xt<jn.Hb;++Xt){pr=Xt,ts=_i;var $r=(vi=(gr=jn).D).Nb;Ln=gr.R;var vi=vi.wa[vi.Y+pr],wi=gr.sa,ai=gr.ta+16*$r*Ln+16*pr,bi=vi.dd,mn=vi.tc;if(mn!=0)if(e(3<=mn),gr.L==1)0<pr&&Q0(wi,ai,Ln,mn+4),vi.La&&Z0(wi,ai,Ln,mn),0<ts&&J0(wi,ai,Ln,mn+4),vi.La&&X0(wi,ai,Ln,mn);else{var Ii=gr.B,ns=gr.qa,Ga=gr.ra+8*$r*Ii+8*pr,oo=gr.Ha,gr=gr.Ia+8*$r*Ii+8*pr;$r=vi.ld,0<pr&&(Xn(wi,ai,Ln,mn+4,bi,$r),Tl(ns,Ga,oo,gr,Ii,mn+4,bi,$r)),vi.La&&(fd(wi,ai,Ln,mn,bi,$r),Y0(ns,Ga,oo,gr,Ii,mn,bi,$r)),0<ts&&(Bn(wi,ai,Ln,mn+4,bi,$r),io(ns,Ga,oo,gr,Ii,mn+4,bi,$r)),vi.La&&(Yc(wi,ai,Ln,mn,bi,$r),K0(ns,Ga,oo,gr,Ii,mn,bi,$r))}}if(Xe.ia&&alert("todo:DitherRow"),Me.put!=null){if(Xt=16*an,an=16*(an+1),tr?(Me.y=Xe.sa,Me.O=Xe.ta+Qt,Me.f=Xe.qa,Me.N=Xe.ra+oi,Me.ea=Xe.Ha,Me.W=Xe.Ia+oi):(Xt-=zt,Me.y=fr,Me.O=qr,Me.f=Cn,Me.N=jt,Me.ea=Ar,Me.W=zr),er||(an-=zt),an>Me.o&&(an=Me.o),Me.F=null,Me.J=null,Xe.Fa!=null&&0<Xe.Fa.length&&Xt<an&&(Me.J=h(Xe,Me,Xt,an-Xt),Me.F=Xe.mb,Me.F==null&&Me.F.length==0)){Un=ln(Xe,3,"Could not decode alpha data.");break t}Xt<Me.j&&(zt=Me.j-Xt,Xt=Me.j,e(!(1&zt)),Me.O+=Xe.R*zt,Me.N+=Xe.B*(zt>>1),Me.W+=Xe.B*(zt>>1),Me.F!=null&&(Me.J+=Me.width*zt)),Xt<an&&(Me.O+=Me.v,Me.N+=Me.v>>1,Me.W+=Me.v>>1,Me.F!=null&&(Me.J+=Me.v),Me.ka=Xt-Me.j,Me.U=Me.va-Me.v,Me.T=an-Xt,Un=Me.put(Me))}Nt+1!=Xe.Ic||er||(r(Xe.sa,Xe.ta-St,fr,qr+16*Xe.R,St),r(Xe.qa,Xe.ra-wn,Cn,jt+8*Xe.B,wn),r(Xe.Ha,Xe.Ia-wn,Ar,zr+8*Xe.B,wn))}if(!Un)return ln(Ut,6,"Output aborted.")}return 1})($,ee)),ee.bc!=null&&ee.bc(ee),se&=1}return se?($.cb=0,se):0})(l,w)||(f=l.a)}}else f=l.a}f==0&&D.Oa!=null&&D.Oa.fd&&(f=vl(D.ba))}D=f}L=D!=0?null:11>L?M.f.RGBA.eb:M.f.kb.y}else L=null;return L};var vy=[3,4,3,4,4,2,2,4,4,4,2,1,1]};function u(A,F){for(var b="",E=0;E<4;E++)b+=String.fromCharCode(A[F++]);return b}function d(A,F){return A[F+0]|A[F+1]<<8}function g(A,F){return(A[F+0]|A[F+1]<<8|A[F+2]<<16)>>>0}function y(A,F){return(A[F+0]|A[F+1]<<8|A[F+2]<<16|A[F+3]<<24)>>>0}new c;var p=[0],S=[0],N=[],C=new c,k=n,K=(function(A,F){var b={},E=0,T=!1,J=0,fe=0;if(b.frames=[],!(function(O,H){for(var Y=0;Y<4;Y++)if(O[H+Y]!="RIFF".charCodeAt(Y))return!0;return!1})(A,F)){for(y(A,F+=4),F+=8;F<A.length;){var ye=u(A,F),_e=y(A,F+=4);F+=4;var ce=_e+(1&_e);switch(ye){case"VP8 ":case"VP8L":b.frames[E]===void 0&&(b.frames[E]={}),(xe=b.frames[E]).src_off=T?fe:F-8,xe.src_size=J+_e+8,E++,T&&(T=!1,J=0,fe=0);break;case"VP8X":(xe=b.header={}).feature_flags=A[F];var ve=F+4;xe.canvas_width=1+g(A,ve),ve+=3,xe.canvas_height=1+g(A,ve),ve+=3;break;case"ALPH":T=!0,J=ce+8,fe=F-8;break;case"ANIM":(xe=b.header).bgcolor=y(A,F),ve=F+4,xe.loop_count=d(A,ve),ve+=2;break;case"ANMF":var Oe,xe;(xe=b.frames[E]={}).offset_x=2*g(A,F),F+=3,xe.offset_y=2*g(A,F),F+=3,xe.width=1+g(A,F),F+=3,xe.height=1+g(A,F),F+=3,xe.duration=g(A,F),F+=3,Oe=A[F++],xe.dispose=1&Oe,xe.blend=Oe>>1&1}ye!="ANMF"&&(F+=ce)}return b}})(k,0);K.response=k,K.rgbaoutput=!0,K.dataurl=!1;var G=K.header?K.header:null,W=K.frames?K.frames:null;if(G){G.loop_counter=G.loop_count,p=[G.canvas_height],S=[G.canvas_width];for(var ne=0;ne<W.length&&W[ne].blend!=0;ne++);}var de=W[0],B=C.WebPDecodeRGBA(k,de.src_off,de.src_size,S,p);de.rgba=B,de.imgwidth=S[0],de.imgheight=p[0];for(var x=0;x<S[0]*p[0]*4;x++)N[x]=B[x];return this.width=S,this.height=p,this.data=N,this}(function(n){var e,t,r,i,s,o,a,c,u,d=function(O){return O=O||{},this.isStrokeTransparent=O.isStrokeTransparent||!1,this.strokeOpacity=O.strokeOpacity||1,this.strokeStyle=O.strokeStyle||"#000000",this.fillStyle=O.fillStyle||"#000000",this.isFillTransparent=O.isFillTransparent||!1,this.fillOpacity=O.fillOpacity||1,this.font=O.font||"10px sans-serif",this.textBaseline=O.textBaseline||"alphabetic",this.textAlign=O.textAlign||"left",this.lineWidth=O.lineWidth||1,this.lineJoin=O.lineJoin||"miter",this.lineCap=O.lineCap||"butt",this.path=O.path||[],this.transform=O.transform!==void 0?O.transform.clone():new c,this.globalCompositeOperation=O.globalCompositeOperation||"normal",this.globalAlpha=O.globalAlpha||1,this.clip_path=O.clip_path||[],this.currentPoint=O.currentPoint||new o,this.miterLimit=O.miterLimit||10,this.lastPoint=O.lastPoint||new o,this.lineDashOffset=O.lineDashOffset||0,this.lineDash=O.lineDash||[],this.margin=O.margin||[0,0,0,0],this.prevPageLastElemOffset=O.prevPageLastElemOffset||0,this.ignoreClearRect=typeof O.ignoreClearRect!="boolean"||O.ignoreClearRect,this};n.events.push(["initialized",function(){this.context2d=new g(this),e=this.internal.f2,t=this.internal.getCoordinateString,r=this.internal.getVerticalCoordinateString,i=this.internal.getHorizontalCoordinate,s=this.internal.getVerticalCoordinate,o=this.internal.Point,a=this.internal.Rectangle,c=this.internal.Matrix,u=new d}]);var g=function(O){Object.defineProperty(this,"canvas",{get:function(){return{parentNode:!1,style:!1}}});var H=O;Object.defineProperty(this,"pdf",{get:function(){return H}});var Y=!1;Object.defineProperty(this,"pageWrapXEnabled",{get:function(){return Y},set:function(j){Y=!!j}});var X=!1;Object.defineProperty(this,"pageWrapYEnabled",{get:function(){return X},set:function(j){X=!!j}});var te=0;Object.defineProperty(this,"posX",{get:function(){return te},set:function(j){isNaN(j)||(te=j)}});var ae=0;Object.defineProperty(this,"posY",{get:function(){return ae},set:function(j){isNaN(j)||(ae=j)}}),Object.defineProperty(this,"margin",{get:function(){return u.margin},set:function(j){var Ve;typeof j=="number"?Ve=[j,j,j,j]:((Ve=new Array(4))[0]=j[0],Ve[1]=j.length>=2?j[1]:Ve[0],Ve[2]=j.length>=3?j[2]:Ve[0],Ve[3]=j.length>=4?j[3]:Ve[1]),u.margin=Ve}});var ge=!1;Object.defineProperty(this,"autoPaging",{get:function(){return ge},set:function(j){ge=j}});var me=0;Object.defineProperty(this,"lastBreak",{get:function(){return me},set:function(j){me=j}});var Ee=[];Object.defineProperty(this,"pageBreaks",{get:function(){return Ee},set:function(j){Ee=j}}),Object.defineProperty(this,"ctx",{get:function(){return u},set:function(j){j instanceof d&&(u=j)}}),Object.defineProperty(this,"path",{get:function(){return u.path},set:function(j){u.path=j}});var Le=[];Object.defineProperty(this,"ctxStack",{get:function(){return Le},set:function(j){Le=j}}),Object.defineProperty(this,"fillStyle",{get:function(){return this.ctx.fillStyle},set:function(j){var Ve;Ve=y(j),this.ctx.fillStyle=Ve.style,this.ctx.isFillTransparent=Ve.a===0,this.ctx.fillOpacity=Ve.a,this.pdf.setFillColor(Ve.r,Ve.g,Ve.b,{a:Ve.a}),this.pdf.setTextColor(Ve.r,Ve.g,Ve.b,{a:Ve.a})}}),Object.defineProperty(this,"strokeStyle",{get:function(){return this.ctx.strokeStyle},set:function(j){var Ve=y(j);this.ctx.strokeStyle=Ve.style,this.ctx.isStrokeTransparent=Ve.a===0,this.ctx.strokeOpacity=Ve.a,Ve.a===0?this.pdf.setDrawColor(255,255,255):(Ve.a,this.pdf.setDrawColor(Ve.r,Ve.g,Ve.b))}}),Object.defineProperty(this,"lineCap",{get:function(){return this.ctx.lineCap},set:function(j){["butt","round","square"].indexOf(j)!==-1&&(this.ctx.lineCap=j,this.pdf.setLineCap(j))}}),Object.defineProperty(this,"lineWidth",{get:function(){return this.ctx.lineWidth},set:function(j){isNaN(j)||(this.ctx.lineWidth=j,this.pdf.setLineWidth(j))}}),Object.defineProperty(this,"lineJoin",{get:function(){return this.ctx.lineJoin},set:function(j){["bevel","round","miter"].indexOf(j)!==-1&&(this.ctx.lineJoin=j,this.pdf.setLineJoin(j))}}),Object.defineProperty(this,"miterLimit",{get:function(){return this.ctx.miterLimit},set:function(j){isNaN(j)||(this.ctx.miterLimit=j,this.pdf.setMiterLimit(j))}}),Object.defineProperty(this,"textBaseline",{get:function(){return this.ctx.textBaseline},set:function(j){this.ctx.textBaseline=j}}),Object.defineProperty(this,"textAlign",{get:function(){return this.ctx.textAlign},set:function(j){["right","end","center","left","start"].indexOf(j)!==-1&&(this.ctx.textAlign=j)}});var je=null,Ue=null,tt=null;Object.defineProperty(this,"fontFaces",{get:function(){return tt},set:function(j){je=null,Ue=null,tt=j}}),Object.defineProperty(this,"font",{get:function(){return this.ctx.font},set:function(j){var Ve;if(this.ctx.font=j,(Ve=/^\s*(?=(?:(?:[-a-z]+\s*){0,2}(italic|oblique))?)(?=(?:(?:[-a-z]+\s*){0,2}(small-caps))?)(?=(?:(?:[-a-z]+\s*){0,2}(bold(?:er)?|lighter|[1-9]00))?)(?:(?:normal|\1|\2|\3)\s*){0,3}((?:xx?-)?(?:small|large)|medium|smaller|larger|[.\d]+(?:\%|in|[cem]m|ex|p[ctx]))(?:\s*\/\s*(normal|[.\d]+(?:\%|in|[cem]m|ex|p[ctx])))?\s*([-_,\"\'\sa-z0-9]+?)\s*$/i.exec(j))!==null){var bt=Ve[1];Ve[2];var at=Ve[3],Te=Ve[4];Ve[5];var $e=Ve[6],ze=/^([.\d]+)((?:%|in|[cem]m|ex|p[ctx]))$/i.exec(Te)[2];Te=Math.floor(ze==="px"?parseFloat(Te)*this.pdf.internal.scaleFactor:ze==="em"?parseFloat(Te)*this.pdf.getFontSize():parseFloat(Te)*this.pdf.internal.scaleFactor),this.pdf.setFontSize(Te);var ct=(function(Ze){var An,Ct,Et=[],Tt=Ze.trim();if(Tt==="")return qg;if(Tt in Vv)return[Vv[Tt]];for(;Tt!=="";){switch(Ct=null,An=(Tt=Uv(Tt)).charAt(0)){case'"':case"'":Ct=A8(Tt.substring(1),An);break;default:Ct=E8(Tt)}if(Ct===null||(Et.push(Ct[0]),(Tt=Uv(Ct[1]))!==""&&Tt.charAt(0)!==","))return qg;Tt=Tt.replace(/^,/,"")}return Et})($e);if(this.fontFaces){var it=(function(Ze,An){var Ct=Ze.getFontList(),Et=JSON.stringify(Ct);if(je===null||Ue!==Et){var Tt=(function(Wt){var st=[];return Object.keys(Wt).forEach(function(Kt){Wt[Kt].forEach(function(ht){var gt=null;switch(ht){case"bold":gt={family:Kt,weight:"bold"};break;case"italic":gt={family:Kt,style:"italic"};break;case"bolditalic":gt={family:Kt,weight:"bold",style:"italic"};break;case"":case"normal":gt={family:Kt}}gt!==null&&(gt.ref={name:Kt,style:ht},st.push(gt))})}),st})(Ct);je=(function(Wt){for(var st={},Kt=0;Kt<Wt.length;++Kt){var ht=jg(Wt[Kt]),gt=ht.family,rn=ht.stretch,ut=ht.style,lt=ht.weight;st[gt]=st[gt]||{},st[gt][rn]=st[gt][rn]||{},st[gt][rn][ut]=st[gt][rn][ut]||{},st[gt][rn][ut][lt]=ht}return st})(Tt.concat(An)),Ue=Et}return je})(this.pdf,this.fontFaces),$t=ct.map(function(Ze){return{family:Ze,stretch:"normal",weight:at,style:bt}}),Pt=(function(Ze,An,Ct){for(var Et=(Ct=Ct||{}).defaultFontFamily||"times",Tt=Object.assign({},I8,Ct.genericFontFamilies||{}),Wt=null,st=null,Kt=0;Kt<An.length;++Kt)if(Tt[(Wt=jg(An[Kt])).family]&&(Wt.family=Tt[Wt.family]),Ze.hasOwnProperty(Wt.family)){st=Ze[Wt.family];break}if(!(st=st||Ze[Et]))throw new Error("Could not find a font-family for the rule '"+Bv(Wt)+"' and default family '"+Et+"'.");if(st=(function(ht,gt){if(gt[ht])return gt[ht];var rn=Hm[ht],ut=rn<=Hm.normal?-1:1,lt=Mv(gt,gE,rn,ut);if(!lt)throw new Error("Could not find a matching font-stretch value for "+ht);return lt})(Wt.stretch,st),st=(function(ht,gt){if(gt[ht])return gt[ht];for(var rn=pE[ht],ut=0;ut<rn.length;++ut)if(gt[rn[ut]])return gt[rn[ut]];throw new Error("Could not find a matching font-style for "+ht)})(Wt.style,st),!(st=(function(ht,gt){if(gt[ht])return gt[ht];if(ht===400&&gt[500])return gt[500];if(ht===500&&gt[400])return gt[400];var rn=b8[ht],ut=Mv(gt,mE,rn,ht<400?-1:1);if(!ut)throw new Error("Could not find a matching font-weight for value "+ht);return ut})(Wt.weight,st)))throw new Error("Failed to resolve a font for the rule '"+Bv(Wt)+"'.");return st})(it,$t);this.pdf.setFont(Pt.ref.name,Pt.ref.style)}else{var _t="";(at==="bold"||parseInt(at,10)>=700||bt==="bold")&&(_t="bold"),bt==="italic"&&(_t+="italic"),_t.length===0&&(_t="normal");for(var Lt="",kt={arial:"Helvetica",Arial:"Helvetica",verdana:"Helvetica",Verdana:"Helvetica",helvetica:"Helvetica",Helvetica:"Helvetica","sans-serif":"Helvetica",fixed:"Courier",monospace:"Courier",terminal:"Courier",cursive:"Times",fantasy:"Times",serif:"Times"},Je=0;Je<ct.length;Je++){if(this.pdf.internal.getFont(ct[Je],_t,{noFallback:!0,disableWarning:!0})!==void 0){Lt=ct[Je];break}if(_t==="bolditalic"&&this.pdf.internal.getFont(ct[Je],"bold",{noFallback:!0,disableWarning:!0})!==void 0)Lt=ct[Je],_t="bold";else if(this.pdf.internal.getFont(ct[Je],"normal",{noFallback:!0,disableWarning:!0})!==void 0){Lt=ct[Je],_t="normal";break}}if(Lt===""){for(var It=0;It<ct.length;It++)if(kt[ct[It]]){Lt=kt[ct[It]];break}}Lt=Lt===""?"Times":Lt,this.pdf.setFont(Lt,_t)}}}}),Object.defineProperty(this,"globalCompositeOperation",{get:function(){return this.ctx.globalCompositeOperation},set:function(j){this.ctx.globalCompositeOperation=j}}),Object.defineProperty(this,"globalAlpha",{get:function(){return this.ctx.globalAlpha},set:function(j){this.ctx.globalAlpha=j}}),Object.defineProperty(this,"lineDashOffset",{get:function(){return this.ctx.lineDashOffset},set:function(j){this.ctx.lineDashOffset=j,xe.call(this)}}),Object.defineProperty(this,"lineDash",{get:function(){return this.ctx.lineDash},set:function(j){this.ctx.lineDash=j,xe.call(this)}}),Object.defineProperty(this,"ignoreClearRect",{get:function(){return this.ctx.ignoreClearRect},set:function(j){this.ctx.ignoreClearRect=!!j}})};g.prototype.setLineDash=function(O){this.lineDash=O},g.prototype.getLineDash=function(){return this.lineDash.length%2?this.lineDash.concat(this.lineDash):this.lineDash.slice()},g.prototype.fill=function(){W.call(this,"fill",!1)},g.prototype.stroke=function(){W.call(this,"stroke",!1)},g.prototype.beginPath=function(){this.path=[{type:"begin"}]},g.prototype.moveTo=function(O,H){if(isNaN(O)||isNaN(H))throw cn.error("jsPDF.context2d.moveTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.moveTo");var Y=this.ctx.transform.applyToPoint(new o(O,H));this.path.push({type:"mt",x:Y.x,y:Y.y}),this.ctx.lastPoint=new o(O,H)},g.prototype.closePath=function(){var O=new o(0,0),H=0;for(H=this.path.length-1;H!==-1;H--)if(this.path[H].type==="begin"&&Zt(this.path[H+1])==="object"&&typeof this.path[H+1].x=="number"){O=new o(this.path[H+1].x,this.path[H+1].y);break}this.path.push({type:"close"}),this.ctx.lastPoint=new o(O.x,O.y)},g.prototype.lineTo=function(O,H){if(isNaN(O)||isNaN(H))throw cn.error("jsPDF.context2d.lineTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.lineTo");var Y=this.ctx.transform.applyToPoint(new o(O,H));this.path.push({type:"lt",x:Y.x,y:Y.y}),this.ctx.lastPoint=new o(Y.x,Y.y)},g.prototype.clip=function(){this.ctx.clip_path=JSON.parse(JSON.stringify(this.path)),W.call(this,null,!0)},g.prototype.quadraticCurveTo=function(O,H,Y,X){if(isNaN(Y)||isNaN(X)||isNaN(O)||isNaN(H))throw cn.error("jsPDF.context2d.quadraticCurveTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.quadraticCurveTo");var te=this.ctx.transform.applyToPoint(new o(Y,X)),ae=this.ctx.transform.applyToPoint(new o(O,H));this.path.push({type:"qct",x1:ae.x,y1:ae.y,x:te.x,y:te.y}),this.ctx.lastPoint=new o(te.x,te.y)},g.prototype.bezierCurveTo=function(O,H,Y,X,te,ae){if(isNaN(te)||isNaN(ae)||isNaN(O)||isNaN(H)||isNaN(Y)||isNaN(X))throw cn.error("jsPDF.context2d.bezierCurveTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.bezierCurveTo");var ge=this.ctx.transform.applyToPoint(new o(te,ae)),me=this.ctx.transform.applyToPoint(new o(O,H)),Ee=this.ctx.transform.applyToPoint(new o(Y,X));this.path.push({type:"bct",x1:me.x,y1:me.y,x2:Ee.x,y2:Ee.y,x:ge.x,y:ge.y}),this.ctx.lastPoint=new o(ge.x,ge.y)},g.prototype.arc=function(O,H,Y,X,te,ae){if(isNaN(O)||isNaN(H)||isNaN(Y)||isNaN(X)||isNaN(te))throw cn.error("jsPDF.context2d.arc: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.arc");if(ae=!!ae,!this.ctx.transform.isIdentity){var ge=this.ctx.transform.applyToPoint(new o(O,H));O=ge.x,H=ge.y;var me=this.ctx.transform.applyToPoint(new o(0,Y)),Ee=this.ctx.transform.applyToPoint(new o(0,0));Y=Math.sqrt(Math.pow(me.x-Ee.x,2)+Math.pow(me.y-Ee.y,2))}Math.abs(te-X)>=2*Math.PI&&(X=0,te=2*Math.PI),this.path.push({type:"arc",x:O,y:H,radius:Y,startAngle:X,endAngle:te,counterclockwise:ae})},g.prototype.arcTo=function(O,H,Y,X,te){throw new Error("arcTo not implemented.")},g.prototype.rect=function(O,H,Y,X){if(isNaN(O)||isNaN(H)||isNaN(Y)||isNaN(X))throw cn.error("jsPDF.context2d.rect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.rect");this.moveTo(O,H),this.lineTo(O+Y,H),this.lineTo(O+Y,H+X),this.lineTo(O,H+X),this.lineTo(O,H),this.lineTo(O+Y,H),this.lineTo(O,H)},g.prototype.fillRect=function(O,H,Y,X){if(isNaN(O)||isNaN(H)||isNaN(Y)||isNaN(X))throw cn.error("jsPDF.context2d.fillRect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.fillRect");if(!p.call(this)){var te={};this.lineCap!=="butt"&&(te.lineCap=this.lineCap,this.lineCap="butt"),this.lineJoin!=="miter"&&(te.lineJoin=this.lineJoin,this.lineJoin="miter"),this.beginPath(),this.rect(O,H,Y,X),this.fill(),te.hasOwnProperty("lineCap")&&(this.lineCap=te.lineCap),te.hasOwnProperty("lineJoin")&&(this.lineJoin=te.lineJoin)}},g.prototype.strokeRect=function(O,H,Y,X){if(isNaN(O)||isNaN(H)||isNaN(Y)||isNaN(X))throw cn.error("jsPDF.context2d.strokeRect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.strokeRect");S.call(this)||(this.beginPath(),this.rect(O,H,Y,X),this.stroke())},g.prototype.clearRect=function(O,H,Y,X){if(isNaN(O)||isNaN(H)||isNaN(Y)||isNaN(X))throw cn.error("jsPDF.context2d.clearRect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.clearRect");this.ignoreClearRect||(this.fillStyle="#ffffff",this.fillRect(O,H,Y,X))},g.prototype.save=function(O){O=typeof O!="boolean"||O;for(var H=this.pdf.internal.getCurrentPageInfo().pageNumber,Y=0;Y<this.pdf.internal.getNumberOfPages();Y++)this.pdf.setPage(Y+1),this.pdf.internal.out("q");if(this.pdf.setPage(H),O){this.ctx.fontSize=this.pdf.internal.getFontSize();var X=new d(this.ctx);this.ctxStack.push(this.ctx),this.ctx=X}},g.prototype.restore=function(O){O=typeof O!="boolean"||O;for(var H=this.pdf.internal.getCurrentPageInfo().pageNumber,Y=0;Y<this.pdf.internal.getNumberOfPages();Y++)this.pdf.setPage(Y+1),this.pdf.internal.out("Q");this.pdf.setPage(H),O&&this.ctxStack.length!==0&&(this.ctx=this.ctxStack.pop(),this.fillStyle=this.ctx.fillStyle,this.strokeStyle=this.ctx.strokeStyle,this.font=this.ctx.font,this.lineCap=this.ctx.lineCap,this.lineWidth=this.ctx.lineWidth,this.lineJoin=this.ctx.lineJoin,this.lineDash=this.ctx.lineDash,this.lineDashOffset=this.ctx.lineDashOffset)},g.prototype.toDataURL=function(){throw new Error("toDataUrl not implemented.")};var y=function(O){var H,Y,X,te;if(O.isCanvasGradient===!0&&(O=O.getColor()),!O)return{r:0,g:0,b:0,a:0,style:O};if(/transparent|rgba\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*,\s*0+\s*\)/.test(O))H=0,Y=0,X=0,te=0;else{var ae=/rgb\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*\)/.exec(O);if(ae!==null)H=parseInt(ae[1]),Y=parseInt(ae[2]),X=parseInt(ae[3]),te=1;else if((ae=/rgba\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*,\s*([\d.]+)\s*\)/.exec(O))!==null)H=parseInt(ae[1]),Y=parseInt(ae[2]),X=parseInt(ae[3]),te=parseFloat(ae[4]);else{if(te=1,typeof O=="string"&&O.charAt(0)!=="#"){var ge=new aE(O);O=ge.ok?ge.toHex():"#000000"}O.length===4?(H=O.substring(1,2),H+=H,Y=O.substring(2,3),Y+=Y,X=O.substring(3,4),X+=X):(H=O.substring(1,3),Y=O.substring(3,5),X=O.substring(5,7)),H=parseInt(H,16),Y=parseInt(Y,16),X=parseInt(X,16)}}return{r:H,g:Y,b:X,a:te,style:O}},p=function(){return this.ctx.isFillTransparent||this.globalAlpha==0},S=function(){return!!(this.ctx.isStrokeTransparent||this.globalAlpha==0)};g.prototype.fillText=function(O,H,Y,X){if(isNaN(H)||isNaN(Y)||typeof O!="string")throw cn.error("jsPDF.context2d.fillText: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.fillText");if(X=isNaN(X)?void 0:X,!p.call(this)){var te=ce(this.ctx.transform.rotation),ae=this.ctx.transform.scaleX;E.call(this,{text:O,x:H,y:Y,scale:ae,angle:te,align:this.textAlign,maxWidth:X})}},g.prototype.strokeText=function(O,H,Y,X){if(isNaN(H)||isNaN(Y)||typeof O!="string")throw cn.error("jsPDF.context2d.strokeText: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.strokeText");if(!S.call(this)){X=isNaN(X)?void 0:X;var te=ce(this.ctx.transform.rotation),ae=this.ctx.transform.scaleX;E.call(this,{text:O,x:H,y:Y,scale:ae,renderingMode:"stroke",angle:te,align:this.textAlign,maxWidth:X})}},g.prototype.measureText=function(O){if(typeof O!="string")throw cn.error("jsPDF.context2d.measureText: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.measureText");var H=this.pdf,Y=this.pdf.internal.scaleFactor,X=H.internal.getFontSize(),te=H.getStringUnitWidth(O)*X/H.internal.scaleFactor;return new function(ae){var ge=(ae=ae||{}).width||0;return Object.defineProperty(this,"width",{get:function(){return ge}}),this}({width:te*=Math.round(96*Y/72*1e4)/1e4})},g.prototype.scale=function(O,H){if(isNaN(O)||isNaN(H))throw cn.error("jsPDF.context2d.scale: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.scale");var Y=new c(O,0,0,H,0,0);this.ctx.transform=this.ctx.transform.multiply(Y)},g.prototype.rotate=function(O){if(isNaN(O))throw cn.error("jsPDF.context2d.rotate: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.rotate");var H=new c(Math.cos(O),Math.sin(O),-Math.sin(O),Math.cos(O),0,0);this.ctx.transform=this.ctx.transform.multiply(H)},g.prototype.translate=function(O,H){if(isNaN(O)||isNaN(H))throw cn.error("jsPDF.context2d.translate: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.translate");var Y=new c(1,0,0,1,O,H);this.ctx.transform=this.ctx.transform.multiply(Y)},g.prototype.transform=function(O,H,Y,X,te,ae){if(isNaN(O)||isNaN(H)||isNaN(Y)||isNaN(X)||isNaN(te)||isNaN(ae))throw cn.error("jsPDF.context2d.transform: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.transform");var ge=new c(O,H,Y,X,te,ae);this.ctx.transform=this.ctx.transform.multiply(ge)},g.prototype.setTransform=function(O,H,Y,X,te,ae){O=isNaN(O)?1:O,H=isNaN(H)?0:H,Y=isNaN(Y)?0:Y,X=isNaN(X)?1:X,te=isNaN(te)?0:te,ae=isNaN(ae)?0:ae,this.ctx.transform=new c(O,H,Y,X,te,ae)};var N=function(){return this.margin[0]>0||this.margin[1]>0||this.margin[2]>0||this.margin[3]>0};g.prototype.drawImage=function(O,H,Y,X,te,ae,ge,me,Ee){var Le=this.pdf.getImageProperties(O),je=1,Ue=1,tt=1,j=1;X!==void 0&&me!==void 0&&(tt=me/X,j=Ee/te,je=Le.width/X*me/X,Ue=Le.height/te*Ee/te),ae===void 0&&(ae=H,ge=Y,H=0,Y=0),X!==void 0&&me===void 0&&(me=X,Ee=te),X===void 0&&me===void 0&&(me=Le.width,Ee=Le.height);var Ve=this.ctx.transform.decompose(),bt=ce(Ve.rotate.shx),at=new c,Te=(at=(at=(at=at.multiply(Ve.translate)).multiply(Ve.skew)).multiply(Ve.scale)).applyToRectangle(new a(ae-H*tt,ge-Y*j,X*je,te*Ue));if(this.autoPaging){for(var $e,ze=C.call(this,Te),ct=[],it=0;it<ze.length;it+=1)ct.indexOf(ze[it])===-1&&ct.push(ze[it]);G(ct);for(var $t=ct[0],Pt=ct[ct.length-1],_t=$t;_t<Pt+1;_t++){this.pdf.setPage(_t);var Lt=this.pdf.internal.pageSize.width-this.margin[3]-this.margin[1],kt=_t===1?this.posY+this.margin[0]:this.margin[0],Je=this.pdf.internal.pageSize.height-this.posY-this.margin[0]-this.margin[2],It=this.pdf.internal.pageSize.height-this.margin[0]-this.margin[2],Ze=_t===1?0:Je+(_t-2)*It;if(this.ctx.clip_path.length!==0){var An=this.path;$e=JSON.parse(JSON.stringify(this.ctx.clip_path)),this.path=K($e,this.posX+this.margin[3],-Ze+kt+this.ctx.prevPageLastElemOffset),ne.call(this,"fill",!0),this.path=An}var Ct=JSON.parse(JSON.stringify(Te));Ct=K([Ct],this.posX+this.margin[3],-Ze+kt+this.ctx.prevPageLastElemOffset)[0];var Et=(_t>$t||_t<Pt)&&N.call(this);Et&&(this.pdf.saveGraphicsState(),this.pdf.rect(this.margin[3],this.margin[0],Lt,It,null).clip().discardPath()),this.pdf.addImage(O,"JPEG",Ct.x,Ct.y,Ct.w,Ct.h,null,null,bt),Et&&this.pdf.restoreGraphicsState()}}else this.pdf.addImage(O,"JPEG",Te.x,Te.y,Te.w,Te.h,null,null,bt)};var C=function(O,H,Y){var X=[];H=H||this.pdf.internal.pageSize.width,Y=Y||this.pdf.internal.pageSize.height-this.margin[0]-this.margin[2];var te=this.posY+this.ctx.prevPageLastElemOffset;switch(O.type){default:case"mt":case"lt":X.push(Math.floor((O.y+te)/Y)+1);break;case"arc":X.push(Math.floor((O.y+te-O.radius)/Y)+1),X.push(Math.floor((O.y+te+O.radius)/Y)+1);break;case"qct":var ae=ve(this.ctx.lastPoint.x,this.ctx.lastPoint.y,O.x1,O.y1,O.x,O.y);X.push(Math.floor((ae.y+te)/Y)+1),X.push(Math.floor((ae.y+ae.h+te)/Y)+1);break;case"bct":var ge=Oe(this.ctx.lastPoint.x,this.ctx.lastPoint.y,O.x1,O.y1,O.x2,O.y2,O.x,O.y);X.push(Math.floor((ge.y+te)/Y)+1),X.push(Math.floor((ge.y+ge.h+te)/Y)+1);break;case"rect":X.push(Math.floor((O.y+te)/Y)+1),X.push(Math.floor((O.y+O.h+te)/Y)+1)}for(var me=0;me<X.length;me+=1)for(;this.pdf.internal.getNumberOfPages()<X[me];)k.call(this);return X},k=function(){var O=this.fillStyle,H=this.strokeStyle,Y=this.font,X=this.lineCap,te=this.lineWidth,ae=this.lineJoin;this.pdf.addPage(),this.fillStyle=O,this.strokeStyle=H,this.font=Y,this.lineCap=X,this.lineWidth=te,this.lineJoin=ae},K=function(O,H,Y){for(var X=0;X<O.length;X++)switch(O[X].type){case"bct":O[X].x2+=H,O[X].y2+=Y;case"qct":O[X].x1+=H,O[X].y1+=Y;default:O[X].x+=H,O[X].y+=Y}return O},G=function(O){return O.sort(function(H,Y){return H-Y})},W=function(O,H){var Y=this.fillStyle,X=this.strokeStyle,te=this.lineCap,ae=this.lineWidth,ge=Math.abs(ae*this.ctx.transform.scaleX),me=this.lineJoin;if(this.autoPaging){for(var Ee,Le,je=JSON.parse(JSON.stringify(this.path)),Ue=JSON.parse(JSON.stringify(this.path)),tt=[],j=0;j<Ue.length;j++)if(Ue[j].x!==void 0)for(var Ve=C.call(this,Ue[j]),bt=0;bt<Ve.length;bt+=1)tt.indexOf(Ve[bt])===-1&&tt.push(Ve[bt]);for(var at=0;at<tt.length;at++)for(;this.pdf.internal.getNumberOfPages()<tt[at];)k.call(this);G(tt);for(var Te=tt[0],$e=tt[tt.length-1],ze=Te;ze<$e+1;ze++){this.pdf.setPage(ze),this.fillStyle=Y,this.strokeStyle=X,this.lineCap=te,this.lineWidth=ge,this.lineJoin=me;var ct=this.pdf.internal.pageSize.width-this.margin[3]-this.margin[1],it=ze===1?this.posY+this.margin[0]:this.margin[0],$t=this.pdf.internal.pageSize.height-this.posY-this.margin[0]-this.margin[2],Pt=this.pdf.internal.pageSize.height-this.margin[0]-this.margin[2],_t=ze===1?0:$t+(ze-2)*Pt;if(this.ctx.clip_path.length!==0){var Lt=this.path;Ee=JSON.parse(JSON.stringify(this.ctx.clip_path)),this.path=K(Ee,this.posX+this.margin[3],-_t+it+this.ctx.prevPageLastElemOffset),ne.call(this,O,!0),this.path=Lt}if(Le=JSON.parse(JSON.stringify(je)),this.path=K(Le,this.posX+this.margin[3],-_t+it+this.ctx.prevPageLastElemOffset),H===!1||ze===0){var kt=(ze>Te||ze<$e)&&N.call(this);kt&&(this.pdf.saveGraphicsState(),this.pdf.rect(this.margin[3],this.margin[0],ct,Pt,null).clip().discardPath()),ne.call(this,O,H),kt&&this.pdf.restoreGraphicsState()}this.lineWidth=ae}this.path=je}else this.lineWidth=ge,ne.call(this,O,H),this.lineWidth=ae},ne=function(O,H){if((O!=="stroke"||H||!S.call(this))&&(O==="stroke"||H||!p.call(this))){for(var Y,X,te=[],ae=this.path,ge=0;ge<ae.length;ge++){var me=ae[ge];switch(me.type){case"begin":te.push({begin:!0});break;case"close":te.push({close:!0});break;case"mt":te.push({start:me,deltas:[],abs:[]});break;case"lt":var Ee=te.length;if(ae[ge-1]&&!isNaN(ae[ge-1].x)&&(Y=[me.x-ae[ge-1].x,me.y-ae[ge-1].y],Ee>0)){for(;Ee>=0;Ee--)if(te[Ee-1].close!==!0&&te[Ee-1].begin!==!0){te[Ee-1].deltas.push(Y),te[Ee-1].abs.push(me);break}}break;case"bct":Y=[me.x1-ae[ge-1].x,me.y1-ae[ge-1].y,me.x2-ae[ge-1].x,me.y2-ae[ge-1].y,me.x-ae[ge-1].x,me.y-ae[ge-1].y],te[te.length-1].deltas.push(Y);break;case"qct":var Le=ae[ge-1].x+2/3*(me.x1-ae[ge-1].x),je=ae[ge-1].y+2/3*(me.y1-ae[ge-1].y),Ue=me.x+2/3*(me.x1-me.x),tt=me.y+2/3*(me.y1-me.y),j=me.x,Ve=me.y;Y=[Le-ae[ge-1].x,je-ae[ge-1].y,Ue-ae[ge-1].x,tt-ae[ge-1].y,j-ae[ge-1].x,Ve-ae[ge-1].y],te[te.length-1].deltas.push(Y);break;case"arc":te.push({deltas:[],abs:[],arc:!0}),Array.isArray(te[te.length-1].abs)&&te[te.length-1].abs.push(me)}}X=H?null:O==="stroke"?"stroke":"fill";for(var bt=!1,at=0;at<te.length;at++)if(te[at].arc)for(var Te=te[at].abs,$e=0;$e<Te.length;$e++){var ze=Te[$e];ze.type==="arc"?x.call(this,ze.x,ze.y,ze.radius,ze.startAngle,ze.endAngle,ze.counterclockwise,void 0,H,!bt):T.call(this,ze.x,ze.y),bt=!0}else if(te[at].close===!0)this.pdf.internal.out("h"),bt=!1;else if(te[at].begin!==!0){var ct=te[at].start.x,it=te[at].start.y;J.call(this,te[at].deltas,ct,it),bt=!0}X&&A.call(this,X),H&&F.call(this)}},de=function(O){var H=this.pdf.internal.getFontSize()/this.pdf.internal.scaleFactor,Y=H*(this.pdf.internal.getLineHeightFactor()-1);switch(this.ctx.textBaseline){case"bottom":return O-Y;case"top":return O+H-Y;case"hanging":return O+H-2*Y;case"middle":return O+H/2-Y;default:return O}},B=function(O){return O+this.pdf.internal.getFontSize()/this.pdf.internal.scaleFactor*(this.pdf.internal.getLineHeightFactor()-1)};g.prototype.createLinearGradient=function(){var O=function(){};return O.colorStops=[],O.addColorStop=function(H,Y){this.colorStops.push([H,Y])},O.getColor=function(){return this.colorStops.length===0?"#000000":this.colorStops[0][1]},O.isCanvasGradient=!0,O},g.prototype.createPattern=function(){return this.createLinearGradient()},g.prototype.createRadialGradient=function(){return this.createLinearGradient()};var x=function(O,H,Y,X,te,ae,ge,me,Ee){for(var Le=ye.call(this,Y,X,te,ae),je=0;je<Le.length;je++){var Ue=Le[je];je===0&&(Ee?b.call(this,Ue.x1+O,Ue.y1+H):T.call(this,Ue.x1+O,Ue.y1+H)),fe.call(this,O,H,Ue.x2,Ue.y2,Ue.x3,Ue.y3,Ue.x4,Ue.y4)}me?F.call(this):A.call(this,ge)},A=function(O){switch(O){case"stroke":this.pdf.internal.out("S");break;case"fill":this.pdf.internal.out("f")}},F=function(){this.pdf.clip(),this.pdf.discardPath()},b=function(O,H){this.pdf.internal.out(t(O)+" "+r(H)+" m")},E=function(O){var H;switch(O.align){case"right":case"end":H="right";break;case"center":H="center";break;default:H="left"}var Y,X,te,ae=this.pdf.getTextDimensions(O.text),ge=de.call(this,O.y),me=B.call(this,ge)-ae.h,Ee=this.ctx.transform.applyToPoint(new o(O.x,ge));if(this.autoPaging){var Le=this.ctx.transform.decompose(),je=new c;je=(je=(je=je.multiply(Le.translate)).multiply(Le.skew)).multiply(Le.scale);for(var Ue=this.ctx.transform.applyToRectangle(new a(O.x,ge,ae.w,ae.h)),tt=je.applyToRectangle(new a(O.x,me,ae.w,ae.h)),j=C.call(this,tt),Ve=[],bt=0;bt<j.length;bt+=1)Ve.indexOf(j[bt])===-1&&Ve.push(j[bt]);G(Ve);for(var at=Ve[0],Te=Ve[Ve.length-1],$e=at;$e<Te+1;$e++){this.pdf.setPage($e);var ze=$e===1?this.posY+this.margin[0]:this.margin[0],ct=this.pdf.internal.pageSize.height-this.posY-this.margin[0]-this.margin[2],it=this.pdf.internal.pageSize.height-this.margin[2],$t=it-this.margin[0],Pt=this.pdf.internal.pageSize.width-this.margin[1],_t=Pt-this.margin[3],Lt=$e===1?0:ct+($e-2)*$t;if(this.ctx.clip_path.length!==0){var kt=this.path;Y=JSON.parse(JSON.stringify(this.ctx.clip_path)),this.path=K(Y,this.posX+this.margin[3],-1*Lt+ze),ne.call(this,"fill",!0),this.path=kt}var Je=K([JSON.parse(JSON.stringify(tt))],this.posX+this.margin[3],-Lt+ze+this.ctx.prevPageLastElemOffset)[0];O.scale>=.01&&(X=this.pdf.internal.getFontSize(),this.pdf.setFontSize(X*O.scale),te=this.lineWidth,this.lineWidth=te*O.scale);var It=this.autoPaging!=="text";if(It||Je.y+Je.h<=it){if(It||Je.y>=ze&&Je.x<=Pt){var Ze=It?O.text:this.pdf.splitTextToSize(O.text,O.maxWidth||Pt-Je.x)[0],An=K([JSON.parse(JSON.stringify(Ue))],this.posX+this.margin[3],-Lt+ze+this.ctx.prevPageLastElemOffset)[0],Ct=It&&($e>at||$e<Te)&&N.call(this);Ct&&(this.pdf.saveGraphicsState(),this.pdf.rect(this.margin[3],this.margin[0],_t,$t,null).clip().discardPath()),this.pdf.text(Ze,An.x,An.y,{angle:O.angle,align:H,renderingMode:O.renderingMode}),Ct&&this.pdf.restoreGraphicsState()}}else Je.y<it&&(this.ctx.prevPageLastElemOffset+=it-Je.y);O.scale>=.01&&(this.pdf.setFontSize(X),this.lineWidth=te)}}else O.scale>=.01&&(X=this.pdf.internal.getFontSize(),this.pdf.setFontSize(X*O.scale),te=this.lineWidth,this.lineWidth=te*O.scale),this.pdf.text(O.text,Ee.x+this.posX,Ee.y+this.posY,{angle:O.angle,align:H,renderingMode:O.renderingMode,maxWidth:O.maxWidth}),O.scale>=.01&&(this.pdf.setFontSize(X),this.lineWidth=te)},T=function(O,H,Y,X){Y=Y||0,X=X||0,this.pdf.internal.out(t(O+Y)+" "+r(H+X)+" l")},J=function(O,H,Y){return this.pdf.lines(O,H,Y,null,null)},fe=function(O,H,Y,X,te,ae,ge,me){this.pdf.internal.out([e(i(Y+O)),e(s(X+H)),e(i(te+O)),e(s(ae+H)),e(i(ge+O)),e(s(me+H)),"c"].join(" "))},ye=function(O,H,Y,X){for(var te=2*Math.PI,ae=Math.PI/2;H>Y;)H-=te;var ge=Math.abs(Y-H);ge<te&&X&&(ge=te-ge);for(var me=[],Ee=X?-1:1,Le=H;ge>1e-5;){var je=Le+Ee*Math.min(ge,ae);me.push(_e.call(this,O,Le,je)),ge-=Math.abs(je-Le),Le=je}return me},_e=function(O,H,Y){var X=(Y-H)/2,te=O*Math.cos(X),ae=O*Math.sin(X),ge=te,me=-ae,Ee=ge*ge+me*me,Le=Ee+ge*te+me*ae,je=4/3*(Math.sqrt(2*Ee*Le)-Le)/(ge*ae-me*te),Ue=ge-je*me,tt=me+je*ge,j=Ue,Ve=-tt,bt=X+H,at=Math.cos(bt),Te=Math.sin(bt);return{x1:O*Math.cos(H),y1:O*Math.sin(H),x2:Ue*at-tt*Te,y2:Ue*Te+tt*at,x3:j*at-Ve*Te,y3:j*Te+Ve*at,x4:O*Math.cos(Y),y4:O*Math.sin(Y)}},ce=function(O){return 180*O/Math.PI},ve=function(O,H,Y,X,te,ae){var ge=O+.5*(Y-O),me=H+.5*(X-H),Ee=te+.5*(Y-te),Le=ae+.5*(X-ae),je=Math.min(O,te,ge,Ee),Ue=Math.max(O,te,ge,Ee),tt=Math.min(H,ae,me,Le),j=Math.max(H,ae,me,Le);return new a(je,tt,Ue-je,j-tt)},Oe=function(O,H,Y,X,te,ae,ge,me){var Ee,Le,je,Ue,tt,j,Ve,bt,at,Te,$e,ze,ct,it,$t=Y-O,Pt=X-H,_t=te-Y,Lt=ae-X,kt=ge-te,Je=me-ae;for(Le=0;Le<41;Le++)at=(Ve=(je=O+(Ee=Le/40)*$t)+Ee*((tt=Y+Ee*_t)-je))+Ee*(tt+Ee*(te+Ee*kt-tt)-Ve),Te=(bt=(Ue=H+Ee*Pt)+Ee*((j=X+Ee*Lt)-Ue))+Ee*(j+Ee*(ae+Ee*Je-j)-bt),Le==0?($e=at,ze=Te,ct=at,it=Te):($e=Math.min($e,at),ze=Math.min(ze,Te),ct=Math.max(ct,at),it=Math.max(it,Te));return new a(Math.round($e),Math.round(ze),Math.round(ct-$e),Math.round(it-ze))},xe=function(){if(this.prevLineDash||this.ctx.lineDash.length||this.ctx.lineDashOffset){var O,H,Y=(O=this.ctx.lineDash,H=this.ctx.lineDashOffset,JSON.stringify({lineDash:O,lineDashOffset:H}));this.prevLineDash!==Y&&(this.pdf.setLineDash(this.ctx.lineDash,this.ctx.lineDashOffset),this.prevLineDash=Y)}}})(rt.API),(function(n){var e=function(o){var a,c,u,d,g,y,p,S,N,C;for(c=[],u=0,d=(o+=a="\0\0\0\0".slice(o.length%4||4)).length;d>u;u+=4)(g=(o.charCodeAt(u)<<24)+(o.charCodeAt(u+1)<<16)+(o.charCodeAt(u+2)<<8)+o.charCodeAt(u+3))!==0?(y=(g=((g=((g=((g=(g-(C=g%85))/85)-(N=g%85))/85)-(S=g%85))/85)-(p=g%85))/85)%85,c.push(y+33,p+33,S+33,N+33,C+33)):c.push(122);return(function(k,K){for(var G=K;G>0;G--)k.pop()})(c,a.length),String.fromCharCode.apply(String,c)+"~>"},t=function(o){var a,c,u,d,g,y=String,p="length",S=255,N="charCodeAt",C="slice",k="replace";for(o[C](-2),o=o[C](0,-2)[k](/\s/g,"")[k]("z","!!!!!"),u=[],d=0,g=(o+=a="uuuuu"[C](o[p]%5||5))[p];g>d;d+=5)c=52200625*(o[N](d)-33)+614125*(o[N](d+1)-33)+7225*(o[N](d+2)-33)+85*(o[N](d+3)-33)+(o[N](d+4)-33),u.push(S&c>>24,S&c>>16,S&c>>8,S&c);return(function(K,G){for(var W=G;W>0;W--)K.pop()})(u,a[p]),y.fromCharCode.apply(y,u)},r=function(o){return o.split("").map(function(a){return("0"+a.charCodeAt().toString(16)).slice(-2)}).join("")+">"},i=function(o){var a=new RegExp(/^([0-9A-Fa-f]{2})+$/);if((o=o.replace(/\s/g,"")).indexOf(">")!==-1&&(o=o.substr(0,o.indexOf(">"))),o.length%2&&(o+="0"),a.test(o)===!1)return"";for(var c="",u=0;u<o.length;u+=2)c+=String.fromCharCode("0x"+(o[u]+o[u+1]));return c},s=function(o){for(var a=new Uint8Array(o.length),c=o.length;c--;)a[c]=o.charCodeAt(c);return(a=Bm(a)).reduce(function(u,d){return u+String.fromCharCode(d)},"")};n.processDataByFilters=function(o,a){var c=0,u=o||"",d=[];for(typeof(a=a||[])=="string"&&(a=[a]),c=0;c<a.length;c+=1)switch(a[c]){case"ASCII85Decode":case"/ASCII85Decode":u=t(u),d.push("/ASCII85Encode");break;case"ASCII85Encode":case"/ASCII85Encode":u=e(u),d.push("/ASCII85Decode");break;case"ASCIIHexDecode":case"/ASCIIHexDecode":u=i(u),d.push("/ASCIIHexEncode");break;case"ASCIIHexEncode":case"/ASCIIHexEncode":u=r(u),d.push("/ASCIIHexDecode");break;case"FlateEncode":case"/FlateEncode":u=s(u),d.push("/FlateDecode");break;default:throw new Error('The filter: "'+a[c]+'" is not implemented')}return{data:u,reverseChain:d.reverse().join(" ")}}})(rt.API),(function(n){n.loadFile=function(e,t,r){return(function(i,s,o){s=s!==!1,o=typeof o=="function"?o:function(){};var a=void 0;try{a=(function(c,u,d){var g=new XMLHttpRequest,y=0,p=function(S){var N=S.length,C=[],k=String.fromCharCode;for(y=0;y<N;y+=1)C.push(k(255&S.charCodeAt(y)));return C.join("")};if(g.open("GET",c,!u),g.overrideMimeType("text/plain; charset=x-user-defined"),u===!1&&(g.onload=function(){g.status===200?d(p(this.responseText)):d(void 0)}),g.send(null),u&&g.status===200)return p(g.responseText)})(i,s,o)}catch{}return a})(e,t,r)},n.allowFsRead=void 0,n.loadImageFile=n.loadFile})(rt.API),(function(n){function e(){return(yt.html2canvas?Promise.resolve(yt.html2canvas):Ag(()=>import("./html2canvas.esm-DXEQVQnt.js"),[])).catch(function(a){return Promise.reject(new Error("Could not load html2canvas: "+a))}).then(function(a){return a.default?a.default:a})}function t(){return(yt.DOMPurify?Promise.resolve(yt.DOMPurify):Ag(()=>import("./purify.es-Bzr520pe.js"),[])).catch(function(a){return Promise.reject(new Error("Could not load dompurify: "+a))}).then(function(a){return a.default?a.default:a})}var r=function(a){var c=Zt(a);return c==="undefined"?"undefined":c==="string"||a instanceof String?"string":c==="number"||a instanceof Number?"number":c==="function"||a instanceof Function?"function":a&&a.constructor===Array?"array":a&&a.nodeType===1?"element":c==="object"?"object":"unknown"},i=function(a,c){var u=document.createElement(a);for(var d in c.className&&(u.className=c.className),c.innerHTML&&c.dompurify&&(u.innerHTML=c.dompurify.sanitize(c.innerHTML)),c.style)u.style[d]=c.style[d];return u},s=function a(c,u){for(var d=c.nodeType===3?document.createTextNode(c.nodeValue):c.cloneNode(!1),g=c.firstChild;g;g=g.nextSibling)u!==!0&&g.nodeType===1&&g.nodeName==="SCRIPT"||d.appendChild(a(g,u));return c.nodeType===1&&(c.nodeName==="CANVAS"?(d.width=c.width,d.height=c.height,d.getContext("2d").drawImage(c,0,0)):c.nodeName!=="TEXTAREA"&&c.nodeName!=="SELECT"||(d.value=c.value),d.addEventListener("load",function(){d.scrollTop=c.scrollTop,d.scrollLeft=c.scrollLeft},!0)),d},o=function a(c){var u=Object.assign(a.convert(Promise.resolve()),JSON.parse(JSON.stringify(a.template))),d=a.convert(Promise.resolve(),u);return(d=d.setProgress(1,a,1,[a])).set(c)};(o.prototype=Object.create(Promise.prototype)).constructor=o,o.convert=function(a,c){return a.__proto__=c||o.prototype,a},o.template={prop:{src:null,container:null,overlay:null,canvas:null,img:null,pdf:null,pageSize:null,callback:function(){}},progress:{val:0,state:null,n:0,stack:[]},opt:{filename:"file.pdf",margin:[0,0,0,0],enableLinks:!0,x:0,y:0,html2canvas:{},jsPDF:{},backgroundColor:"transparent"}},o.prototype.from=function(a,c){return this.then(function(){switch(c=c||(function(u){switch(r(u)){case"string":return"string";case"element":return u.nodeName.toLowerCase()==="canvas"?"canvas":"element";default:return"unknown"}})(a),c){case"string":return this.then(t).then(function(u){return this.set({src:i("div",{innerHTML:a,dompurify:u})})});case"element":return this.set({src:a});case"canvas":return this.set({canvas:a});case"img":return this.set({img:a});default:return this.error("Unknown source type.")}})},o.prototype.to=function(a){switch(a){case"container":return this.toContainer();case"canvas":return this.toCanvas();case"img":return this.toImg();case"pdf":return this.toPdf();default:return this.error("Invalid target.")}},o.prototype.toContainer=function(){return this.thenList([function(){return this.prop.src||this.error("Cannot duplicate - no source HTML.")},function(){return this.prop.pageSize||this.setPageSize()}]).then(function(){var a={position:"relative",display:"inline-block",width:(typeof this.opt.width!="number"||isNaN(this.opt.width)||typeof this.opt.windowWidth!="number"||isNaN(this.opt.windowWidth)?Math.max(this.prop.src.clientWidth,this.prop.src.scrollWidth,this.prop.src.offsetWidth):this.opt.windowWidth)+"px",left:0,right:0,top:0,margin:"auto",backgroundColor:this.opt.backgroundColor},c=s(this.prop.src,this.opt.html2canvas.javascriptEnabled);c.tagName==="BODY"&&(a.height=Math.max(document.body.scrollHeight,document.body.offsetHeight,document.documentElement.clientHeight,document.documentElement.scrollHeight,document.documentElement.offsetHeight)+"px"),this.prop.overlay=i("div",{className:"html2pdf__overlay",style:{position:"fixed",overflow:"hidden",zIndex:1e3,left:"-100000px",right:0,bottom:0,top:0}}),this.prop.container=i("div",{className:"html2pdf__container",style:a}),this.prop.container.appendChild(c),this.prop.container.firstChild.appendChild(i("div",{style:{clear:"both",border:"0 none transparent",margin:0,padding:0,height:0}})),this.prop.container.style.float="none",this.prop.overlay.appendChild(this.prop.container),document.body.appendChild(this.prop.overlay),this.prop.container.firstChild.style.position="relative",this.prop.container.height=Math.max(this.prop.container.firstChild.clientHeight,this.prop.container.firstChild.scrollHeight,this.prop.container.firstChild.offsetHeight)+"px"})},o.prototype.toCanvas=function(){var a=[function(){return document.body.contains(this.prop.container)||this.toContainer()}];return this.thenList(a).then(e).then(function(c){var u=Object.assign({},this.opt.html2canvas);return delete u.onrendered,c(this.prop.container,u)}).then(function(c){(this.opt.html2canvas.onrendered||function(){})(c),this.prop.canvas=c,document.body.removeChild(this.prop.overlay)})},o.prototype.toContext2d=function(){var a=[function(){return document.body.contains(this.prop.container)||this.toContainer()}];return this.thenList(a).then(e).then(function(c){var u=this.opt.jsPDF,d=this.opt.fontFaces,g=typeof this.opt.width!="number"||isNaN(this.opt.width)||typeof this.opt.windowWidth!="number"||isNaN(this.opt.windowWidth)?1:this.opt.width/this.opt.windowWidth,y=Object.assign({async:!0,allowTaint:!0,scale:g,scrollX:this.opt.scrollX||0,scrollY:this.opt.scrollY||0,backgroundColor:"#ffffff",imageTimeout:15e3,logging:!0,proxy:null,removeContainer:!0,foreignObjectRendering:!1,useCORS:!1},this.opt.html2canvas);if(delete y.onrendered,u.context2d.autoPaging=this.opt.autoPaging===void 0||this.opt.autoPaging,u.context2d.posX=this.opt.x,u.context2d.posY=this.opt.y,u.context2d.margin=this.opt.margin,u.context2d.fontFaces=d,d)for(var p=0;p<d.length;++p){var S=d[p],N=S.src.find(function(C){return C.format==="truetype"});N&&u.addFont(N.url,S.ref.name,S.ref.style)}return y.windowHeight=y.windowHeight||0,y.windowHeight=y.windowHeight==0?Math.max(this.prop.container.clientHeight,this.prop.container.scrollHeight,this.prop.container.offsetHeight):y.windowHeight,u.context2d.save(!0),c(this.prop.container,y)}).then(function(c){this.opt.jsPDF.context2d.restore(!0),(this.opt.html2canvas.onrendered||function(){})(c),this.prop.canvas=c,document.body.removeChild(this.prop.overlay)})},o.prototype.toImg=function(){return this.thenList([function(){return this.prop.canvas||this.toCanvas()}]).then(function(){var a=this.prop.canvas.toDataURL("image/"+this.opt.image.type,this.opt.image.quality);this.prop.img=document.createElement("img"),this.prop.img.src=a})},o.prototype.toPdf=function(){return this.thenList([function(){return this.toContext2d()}]).then(function(){this.prop.pdf=this.prop.pdf||this.opt.jsPDF})},o.prototype.output=function(a,c,u){return(u=u||"pdf").toLowerCase()==="img"||u.toLowerCase()==="image"?this.outputImg(a,c):this.outputPdf(a,c)},o.prototype.outputPdf=function(a,c){return this.thenList([function(){return this.prop.pdf||this.toPdf()}]).then(function(){return this.prop.pdf.output(a,c)})},o.prototype.outputImg=function(a){return this.thenList([function(){return this.prop.img||this.toImg()}]).then(function(){switch(a){case void 0:case"img":return this.prop.img;case"datauristring":case"dataurlstring":return this.prop.img.src;case"datauri":case"dataurl":return document.location.href=this.prop.img.src;default:throw'Image output type "'+a+'" is not supported.'}})},o.prototype.save=function(a){return this.thenList([function(){return this.prop.pdf||this.toPdf()}]).set(a?{filename:a}:null).then(function(){this.prop.pdf.save(this.opt.filename)})},o.prototype.doCallback=function(){return this.thenList([function(){return this.prop.pdf||this.toPdf()}]).then(function(){this.prop.callback(this.prop.pdf)})},o.prototype.set=function(a){if(r(a)!=="object")return this;var c=Object.keys(a||{}).map(function(u){if(u in o.template.prop)return function(){this.prop[u]=a[u]};switch(u){case"margin":return this.setMargin.bind(this,a.margin);case"jsPDF":return function(){return this.opt.jsPDF=a.jsPDF,this.setPageSize()};case"pageSize":return this.setPageSize.bind(this,a.pageSize);default:return function(){this.opt[u]=a[u]}}},this);return this.then(function(){return this.thenList(c)})},o.prototype.get=function(a,c){return this.then(function(){var u=a in o.template.prop?this.prop[a]:this.opt[a];return c?c(u):u})},o.prototype.setMargin=function(a){return this.then(function(){switch(r(a)){case"number":a=[a,a,a,a];case"array":if(a.length===2&&(a=[a[0],a[1],a[0],a[1]]),a.length===4)break;default:return this.error("Invalid margin array.")}this.opt.margin=a}).then(this.setPageSize)},o.prototype.setPageSize=function(a){function c(u,d){return Math.floor(u*d/72*96)}return this.then(function(){(a=a||rt.getPageSize(this.opt.jsPDF)).hasOwnProperty("inner")||(a.inner={width:a.width-this.opt.margin[1]-this.opt.margin[3],height:a.height-this.opt.margin[0]-this.opt.margin[2]},a.inner.px={width:c(a.inner.width,a.k),height:c(a.inner.height,a.k)},a.inner.ratio=a.inner.height/a.inner.width),this.prop.pageSize=a})},o.prototype.setProgress=function(a,c,u,d){return a!=null&&(this.progress.val=a),c!=null&&(this.progress.state=c),u!=null&&(this.progress.n=u),d!=null&&(this.progress.stack=d),this.progress.ratio=this.progress.val/this.progress.state,this},o.prototype.updateProgress=function(a,c,u,d){return this.setProgress(a?this.progress.val+a:null,c||null,u?this.progress.n+u:null,d?this.progress.stack.concat(d):null)},o.prototype.then=function(a,c){var u=this;return this.thenCore(a,c,function(d,g){return u.updateProgress(null,null,1,[d]),Promise.prototype.then.call(this,function(y){return u.updateProgress(null,d),y}).then(d,g).then(function(y){return u.updateProgress(1),y})})},o.prototype.thenCore=function(a,c,u){u=u||Promise.prototype.then;var d=this;a&&(a=a.bind(d)),c&&(c=c.bind(d));var g=Promise.toString().indexOf("[native code]")!==-1&&Promise.name==="Promise"?d:o.convert(Object.assign({},d),Promise.prototype),y=u.call(g,a,c);return o.convert(y,d.__proto__)},o.prototype.thenExternal=function(a,c){return Promise.prototype.then.call(this,a,c)},o.prototype.thenList=function(a){var c=this;return a.forEach(function(u){c=c.thenCore(u)}),c},o.prototype.catch=function(a){a&&(a=a.bind(this));var c=Promise.prototype.catch.call(this,a);return o.convert(c,this)},o.prototype.catchExternal=function(a){return Promise.prototype.catch.call(this,a)},o.prototype.error=function(a){return this.then(function(){throw new Error(a)})},o.prototype.using=o.prototype.set,o.prototype.saveAs=o.prototype.save,o.prototype.export=o.prototype.output,o.prototype.run=o.prototype.then,rt.getPageSize=function(a,c,u){if(Zt(a)==="object"){var d=a;a=d.orientation,c=d.unit||c,u=d.format||u}c=c||"mm",u=u||"a4",a=(""+(a||"P")).toLowerCase();var g,y=(""+u).toLowerCase(),p={a0:[2383.94,3370.39],a1:[1683.78,2383.94],a2:[1190.55,1683.78],a3:[841.89,1190.55],a4:[595.28,841.89],a5:[419.53,595.28],a6:[297.64,419.53],a7:[209.76,297.64],a8:[147.4,209.76],a9:[104.88,147.4],a10:[73.7,104.88],b0:[2834.65,4008.19],b1:[2004.09,2834.65],b2:[1417.32,2004.09],b3:[1000.63,1417.32],b4:[708.66,1000.63],b5:[498.9,708.66],b6:[354.33,498.9],b7:[249.45,354.33],b8:[175.75,249.45],b9:[124.72,175.75],b10:[87.87,124.72],c0:[2599.37,3676.54],c1:[1836.85,2599.37],c2:[1298.27,1836.85],c3:[918.43,1298.27],c4:[649.13,918.43],c5:[459.21,649.13],c6:[323.15,459.21],c7:[229.61,323.15],c8:[161.57,229.61],c9:[113.39,161.57],c10:[79.37,113.39],dl:[311.81,623.62],letter:[612,792],"government-letter":[576,756],legal:[612,1008],"junior-legal":[576,360],ledger:[1224,792],tabloid:[792,1224],"credit-card":[153,243]};switch(c){case"pt":g=1;break;case"mm":g=72/25.4;break;case"cm":g=72/2.54;break;case"in":g=72;break;case"px":g=.75;break;case"pc":case"em":g=12;break;case"ex":g=6;break;default:throw"Invalid unit: "+c}var S,N=0,C=0;if(p.hasOwnProperty(y))N=p[y][1]/g,C=p[y][0]/g;else try{N=u[1],C=u[0]}catch{throw new Error("Invalid format: "+u)}if(a==="p"||a==="portrait")a="p",C>N&&(S=C,C=N,N=S);else{if(a!=="l"&&a!=="landscape")throw"Invalid orientation: "+a;a="l",N>C&&(S=C,C=N,N=S)}return{width:C,height:N,unit:c,k:g,orientation:a}},n.html=function(a,c){(c=c||{}).callback=c.callback||function(){},c.html2canvas=c.html2canvas||{},c.html2canvas.canvas=c.html2canvas.canvas||this.canvas,c.jsPDF=c.jsPDF||this,c.fontFaces=c.fontFaces?c.fontFaces.map(jg):null;var u=new o(c);return c.worker?u:u.from(a).doCallback()}})(rt.API),rt.API.addJS=function(n){return qv=n,this.internal.events.subscribe("postPutResources",function(){Wd=this.internal.newObject(),this.internal.out("<<"),this.internal.out("/Names [(EmbeddedJS) "+(Wd+1)+" 0 R]"),this.internal.out(">>"),this.internal.out("endobj"),jv=this.internal.newObject(),this.internal.out("<<"),this.internal.out("/S /JavaScript"),this.internal.out("/JS ("+qv+")"),this.internal.out(">>"),this.internal.out("endobj")}),this.internal.events.subscribe("putCatalog",function(){Wd!==void 0&&jv!==void 0&&this.internal.out("/Names <</JavaScript "+Wd+" 0 R>>")}),this},(function(n){var e;n.events.push(["postPutResources",function(){var t=this,r=/^(\d+) 0 obj$/;if(this.outline.root.children.length>0)for(var i=t.outline.render().split(/\r\n/),s=0;s<i.length;s++){var o=i[s],a=r.exec(o);if(a!=null){var c=a[1];t.internal.newObjectDeferredBegin(c,!1)}t.internal.write(o)}if(this.outline.createNamedDestinations){var u=this.internal.pages.length,d=[];for(s=0;s<u;s++){var g=t.internal.newObject();d.push(g);var y=t.internal.getPageInfo(s+1);t.internal.write("<< /D["+y.objId+" 0 R /XYZ null null null]>> endobj")}var p=t.internal.newObject();for(t.internal.write("<< /Names [ "),s=0;s<d.length;s++)t.internal.write("(page_"+(s+1)+")"+d[s]+" 0 R");t.internal.write(" ] >>","endobj"),e=t.internal.newObject(),t.internal.write("<< /Dests "+p+" 0 R"),t.internal.write(">>","endobj")}}]),n.events.push(["putCatalog",function(){var t=this;t.outline.root.children.length>0&&(t.internal.write("/Outlines",this.outline.makeRef(this.outline.root)),this.outline.createNamedDestinations&&t.internal.write("/Names "+e+" 0 R"))}]),n.events.push(["initialized",function(){var t=this;t.outline={createNamedDestinations:!1,root:{children:[]}},t.outline.add=function(r,i,s){var o={title:i,options:s,children:[]};return r==null&&(r=this.root),r.children.push(o),o},t.outline.render=function(){return this.ctx={},this.ctx.val="",this.ctx.pdf=t,this.genIds_r(this.root),this.renderRoot(this.root),this.renderItems(this.root),this.ctx.val},t.outline.genIds_r=function(r){r.id=t.internal.newObjectDeferred();for(var i=0;i<r.children.length;i++)this.genIds_r(r.children[i])},t.outline.renderRoot=function(r){this.objStart(r),this.line("/Type /Outlines"),r.children.length>0&&(this.line("/First "+this.makeRef(r.children[0])),this.line("/Last "+this.makeRef(r.children[r.children.length-1]))),this.line("/Count "+this.count_r({count:0},r)),this.objEnd()},t.outline.renderItems=function(r){for(var i=this.ctx.pdf.internal.getVerticalCoordinateString,s=0;s<r.children.length;s++){var o=r.children[s];this.objStart(o),this.line("/Title "+this.makeString(o.title)),this.line("/Parent "+this.makeRef(r)),s>0&&this.line("/Prev "+this.makeRef(r.children[s-1])),s<r.children.length-1&&this.line("/Next "+this.makeRef(r.children[s+1])),o.children.length>0&&(this.line("/First "+this.makeRef(o.children[0])),this.line("/Last "+this.makeRef(o.children[o.children.length-1])));var a=this.count=this.count_r({count:0},o);if(a>0&&this.line("/Count "+a),o.options&&o.options.pageNumber){var c=t.internal.getPageInfo(o.options.pageNumber);this.line("/Dest ["+c.objId+" 0 R /XYZ 0 "+i(0)+" 0]")}this.objEnd()}for(var u=0;u<r.children.length;u++)this.renderItems(r.children[u])},t.outline.line=function(r){this.ctx.val+=r+`\r
`},t.outline.makeRef=function(r){return r.id+" 0 R"},t.outline.makeString=function(r){return"("+t.internal.pdfEscape(r)+")"},t.outline.objStart=function(r){this.ctx.val+=`\r
`+r.id+` 0 obj\r
<<\r
`},t.outline.objEnd=function(){this.ctx.val+=`>> \r
endobj\r
`},t.outline.count_r=function(r,i){for(var s=0;s<i.children.length;s++)r.count++,this.count_r(r,i.children[s]);return r.count}}])})(rt.API),(function(n){var e=[192,193,194,195,196,197,198,199];n.processJPEG=function(t,r,i,s,o,a){var c,u=this.decode.DCT_DECODE,d=null;if(typeof t=="string"||this.__addimage__.isArrayBuffer(t)||this.__addimage__.isArrayBufferView(t)){switch(t=o||t,t=this.__addimage__.isArrayBuffer(t)?new Uint8Array(t):t,c=(function(g){for(var y,p=256*g.charCodeAt(4)+g.charCodeAt(5),S=g.length,N={width:0,height:0,numcomponents:1},C=4;C<S;C+=2){if(C+=p,e.indexOf(g.charCodeAt(C+1))!==-1){y=256*g.charCodeAt(C+5)+g.charCodeAt(C+6),N={width:256*g.charCodeAt(C+7)+g.charCodeAt(C+8),height:y,numcomponents:g.charCodeAt(C+9)};break}p=256*g.charCodeAt(C+2)+g.charCodeAt(C+3)}return N})(t=this.__addimage__.isArrayBufferView(t)?this.__addimage__.arrayBufferToBinaryString(t):t),c.numcomponents){case 1:a=this.color_spaces.DEVICE_GRAY;break;case 4:a=this.color_spaces.DEVICE_CMYK;break;case 3:a=this.color_spaces.DEVICE_RGB}d={data:t,width:c.width,height:c.height,colorSpace:a,bitsPerComponent:8,filter:u,index:r,alias:i}}return d}})(rt.API),rt.API.processPNG=function(n,e,t,r){if(this.__addimage__.isArrayBuffer(n)&&(n=new Uint8Array(n)),this.__addimage__.isArrayBufferView(n)){var i,s=a8(n,{checkCrc:!0}),o=s.width,a=s.height,c=s.channels,u=s.palette,d=s.depth;i=u&&c===1?(function(x){for(var A=x.width,F=x.height,b=x.data,E=x.palette,T=x.depth,J=!1,fe=[],ye=[],_e=void 0,ce=!1,ve=0,Oe=0;Oe<E.length;Oe++){var xe=H_(E[Oe],4),O=xe[0],H=xe[1],Y=xe[2],X=xe[3];fe.push(O,H,Y),X!=null&&(X===0?(ve++,ye.length<1&&ye.push(Oe)):X<255&&(ce=!0))}if(ce||ve>1){J=!0,ye=void 0;var te=A*F;_e=new Uint8Array(te);for(var ae=new DataView(b.buffer),ge=0;ge<te;ge++){var me=zg(ae,ge,T),Ee=H_(E[me],4)[3];_e[ge]=Ee}}else ve===0&&(ye=void 0);return{colorSpace:"Indexed",colorsPerPixel:1,sMaskBitsPerComponent:J?8:void 0,colorBytes:b,alphaBytes:_e,needSMask:J,palette:fe,mask:ye}})(s):c===2||c===4?(function(x){for(var A=x.data,F=x.width,b=x.height,E=x.channels,T=x.depth,J=E===2?"DeviceGray":"DeviceRGB",fe=E-1,ye=F*b,_e=fe,ce=ye*_e,ve=1*ye,Oe=Math.ceil(ce*T/8),xe=Math.ceil(ve*T/8),O=new Uint8Array(Oe),H=new Uint8Array(xe),Y=new DataView(A.buffer),X=new DataView(O.buffer),te=new DataView(H.buffer),ae=!1,ge=0;ge<ye;ge++){for(var me=ge*E,Ee=0;Ee<_e;Ee++)Qv(X,zg(Y,me+Ee,T),ge*_e+Ee,T);var Le=zg(Y,me+_e,T);Le<(1<<T)-1&&(ae=!0),Qv(te,Le,1*ge,T)}return{colorSpace:J,colorsPerPixel:fe,sMaskBitsPerComponent:ae?T:void 0,colorBytes:O,alphaBytes:H,needSMask:ae}})(s):(function(x){var A=x.data,F=x.channels===1?"DeviceGray":"DeviceRGB";return{colorSpace:F,colorsPerPixel:F==="DeviceGray"?1:3,colorBytes:A instanceof Uint16Array?(function(b){for(var E=b.length,T=new Uint8Array(2*E),J=new DataView(T.buffer,T.byteOffset,T.byteLength),fe=0;fe<E;fe++)J.setUint16(2*fe,b[fe],!1);return T})(A):A,needSMask:!1}})(s);var g,y,p,S=i,N=S.colorSpace,C=S.colorsPerPixel,k=S.sMaskBitsPerComponent,K=S.colorBytes,G=S.alphaBytes,W=S.needSMask,ne=S.palette,de=S.mask,B=null;return r!==rt.API.image_compression.NONE&&typeof Bm=="function"?(B=(function(x){var A;switch(x){case rt.API.image_compression.FAST:A=11;break;case rt.API.image_compression.MEDIUM:A=13;break;case rt.API.image_compression.SLOW:A=14;break;default:A=12}return A})(r),g=this.decode.FLATE_DECODE,y="/Predictor ".concat(B," /Colors ").concat(C," /BitsPerComponent ").concat(d," /Columns ").concat(o),n=Hv(K,Math.ceil(o*C*d/8),C,d,r),W&&(p=Hv(G,Math.ceil(o*k/8),1,k,r))):(g=void 0,y=void 0,n=K,W&&(p=G)),(this.__addimage__.isArrayBuffer(n)||this.__addimage__.isArrayBufferView(n))&&(n=this.__addimage__.arrayBufferToBinaryString(n)),(p&&this.__addimage__.isArrayBuffer(p)||this.__addimage__.isArrayBufferView(p))&&(p=this.__addimage__.arrayBufferToBinaryString(p)),{alias:t,data:n,index:e,filter:g,decodeParameters:y,transparency:de,palette:ne,sMask:p,predictor:B,width:o,height:a,bitsPerComponent:d,sMaskBitsPerComponent:k,colorSpace:N}}},(function(n){n.processGIF89A=function(e,t,r,i){var s=new x8(e),o=s.width,a=s.height,c=[];s.decodeAndBlitFrameRGBA(0,c);var u={data:c,width:o,height:a},d=new $g(100).encode(u,100);return n.processJPEG.call(this,d,t,r,i)},n.processGIF87A=n.processGIF89A})(rt.API),rs.prototype.parseHeader=function(){if(this.fileSize=this.datav.getUint32(this.pos,!0),this.pos+=4,this.reserved=this.datav.getUint32(this.pos,!0),this.pos+=4,this.offset=this.datav.getUint32(this.pos,!0),this.pos+=4,this.headerSize=this.datav.getUint32(this.pos,!0),this.pos+=4,this.width=this.datav.getUint32(this.pos,!0),this.pos+=4,this.height=this.datav.getInt32(this.pos,!0),this.pos+=4,this.planes=this.datav.getUint16(this.pos,!0),this.pos+=2,this.bitPP=this.datav.getUint16(this.pos,!0),this.pos+=2,this.compress=this.datav.getUint32(this.pos,!0),this.pos+=4,this.rawSize=this.datav.getUint32(this.pos,!0),this.pos+=4,this.hr=this.datav.getUint32(this.pos,!0),this.pos+=4,this.vr=this.datav.getUint32(this.pos,!0),this.pos+=4,this.colors=this.datav.getUint32(this.pos,!0),this.pos+=4,this.importantColors=this.datav.getUint32(this.pos,!0),this.pos+=4,this.bitPP===16&&this.is_with_alpha&&(this.bitPP=15),this.bitPP<15){var n=this.colors===0?1<<this.bitPP:this.colors;this.palette=new Array(n);for(var e=0;e<n;e++){var t=this.datav.getUint8(this.pos++,!0),r=this.datav.getUint8(this.pos++,!0),i=this.datav.getUint8(this.pos++,!0),s=this.datav.getUint8(this.pos++,!0);this.palette[e]={red:i,green:r,blue:t,quad:s}}}this.height<0&&(this.height*=-1,this.bottom_up=!1)},rs.prototype.parseBGR=function(){this.pos=this.offset;try{var n="bit"+this.bitPP,e=this.width*this.height*4;this.data=new Uint8Array(e),this[n]()}catch(t){cn.log("bit decode error:"+t)}},rs.prototype.bit1=function(){var n,e=Math.ceil(this.width/8),t=e%4;for(n=this.height-1;n>=0;n--){for(var r=this.bottom_up?n:this.height-1-n,i=0;i<e;i++)for(var s=this.datav.getUint8(this.pos++,!0),o=r*this.width*4+8*i*4,a=0;a<8&&8*i+a<this.width;a++){var c=this.palette[s>>7-a&1];this.data[o+4*a]=c.blue,this.data[o+4*a+1]=c.green,this.data[o+4*a+2]=c.red,this.data[o+4*a+3]=255}t!==0&&(this.pos+=4-t)}},rs.prototype.bit4=function(){for(var n=Math.ceil(this.width/2),e=n%4,t=this.height-1;t>=0;t--){for(var r=this.bottom_up?t:this.height-1-t,i=0;i<n;i++){var s=this.datav.getUint8(this.pos++,!0),o=r*this.width*4+2*i*4,a=s>>4,c=15&s,u=this.palette[a];if(this.data[o]=u.blue,this.data[o+1]=u.green,this.data[o+2]=u.red,this.data[o+3]=255,2*i+1>=this.width)break;u=this.palette[c],this.data[o+4]=u.blue,this.data[o+4+1]=u.green,this.data[o+4+2]=u.red,this.data[o+4+3]=255}e!==0&&(this.pos+=4-e)}},rs.prototype.bit8=function(){for(var n=this.width%4,e=this.height-1;e>=0;e--){for(var t=this.bottom_up?e:this.height-1-e,r=0;r<this.width;r++){var i=this.datav.getUint8(this.pos++,!0),s=t*this.width*4+4*r;if(i<this.palette.length){var o=this.palette[i];this.data[s]=o.red,this.data[s+1]=o.green,this.data[s+2]=o.blue,this.data[s+3]=255}else this.data[s]=255,this.data[s+1]=255,this.data[s+2]=255,this.data[s+3]=255}n!==0&&(this.pos+=4-n)}},rs.prototype.bit15=function(){for(var n=this.width%3,e=parseInt("11111",2),t=this.height-1;t>=0;t--){for(var r=this.bottom_up?t:this.height-1-t,i=0;i<this.width;i++){var s=this.datav.getUint16(this.pos,!0);this.pos+=2;var o=(s&e)/e*255|0,a=(s>>5&e)/e*255|0,c=(s>>10&e)/e*255|0,u=s>>15?255:0,d=r*this.width*4+4*i;this.data[d]=c,this.data[d+1]=a,this.data[d+2]=o,this.data[d+3]=u}this.pos+=n}},rs.prototype.bit16=function(){for(var n=this.width%3,e=parseInt("11111",2),t=parseInt("111111",2),r=this.height-1;r>=0;r--){for(var i=this.bottom_up?r:this.height-1-r,s=0;s<this.width;s++){var o=this.datav.getUint16(this.pos,!0);this.pos+=2;var a=(o&e)/e*255|0,c=(o>>5&t)/t*255|0,u=(o>>11)/e*255|0,d=i*this.width*4+4*s;this.data[d]=u,this.data[d+1]=c,this.data[d+2]=a,this.data[d+3]=255}this.pos+=n}},rs.prototype.bit24=function(){for(var n=this.height-1;n>=0;n--){for(var e=this.bottom_up?n:this.height-1-n,t=0;t<this.width;t++){var r=this.datav.getUint8(this.pos++,!0),i=this.datav.getUint8(this.pos++,!0),s=this.datav.getUint8(this.pos++,!0),o=e*this.width*4+4*t;this.data[o]=s,this.data[o+1]=i,this.data[o+2]=r,this.data[o+3]=255}this.pos+=this.width%4}},rs.prototype.bit32=function(){for(var n=this.height-1;n>=0;n--)for(var e=this.bottom_up?n:this.height-1-n,t=0;t<this.width;t++){var r=this.datav.getUint8(this.pos++,!0),i=this.datav.getUint8(this.pos++,!0),s=this.datav.getUint8(this.pos++,!0),o=this.datav.getUint8(this.pos++,!0),a=e*this.width*4+4*t;this.data[a]=s,this.data[a+1]=i,this.data[a+2]=r,this.data[a+3]=o}},rs.prototype.getData=function(){return this.data},(function(n){n.processBMP=function(e,t,r,i){var s=new rs(e,!1),o=s.width,a=s.height,c={data:s.getData(),width:o,height:a},u=new $g(100).encode(c,100);return n.processJPEG.call(this,u,t,r,i)}})(rt.API),Zv.prototype.getData=function(){return this.data},(function(n){n.processWEBP=function(e,t,r,i){var s=new Zv(e),o=s.width,a=s.height,c={data:s.getData(),width:o,height:a},u=new $g(100).encode(c,100);return n.processJPEG.call(this,u,t,r,i)}})(rt.API),rt.API.processRGBA=function(n,e,t){for(var r=n.data,i=r.length,s=new Uint8Array(i/4*3),o=new Uint8Array(i/4),a=0,c=0,u=0;u<i;u+=4){var d=r[u],g=r[u+1],y=r[u+2],p=r[u+3];s[a++]=d,s[a++]=g,s[a++]=y,o[c++]=p}var S=this.__addimage__.arrayBufferToBinaryString(s);return{alpha:this.__addimage__.arrayBufferToBinaryString(o),data:S,index:e,alias:t,colorSpace:"DeviceRGB",bitsPerComponent:8,width:n.width,height:n.height}},rt.API.setLanguage=function(n){return this.internal.languageSettings===void 0&&(this.internal.languageSettings={},this.internal.languageSettings.isSubscribed=!1),{af:"Afrikaans",sq:"Albanian",ar:"Arabic (Standard)","ar-DZ":"Arabic (Algeria)","ar-BH":"Arabic (Bahrain)","ar-EG":"Arabic (Egypt)","ar-IQ":"Arabic (Iraq)","ar-JO":"Arabic (Jordan)","ar-KW":"Arabic (Kuwait)","ar-LB":"Arabic (Lebanon)","ar-LY":"Arabic (Libya)","ar-MA":"Arabic (Morocco)","ar-OM":"Arabic (Oman)","ar-QA":"Arabic (Qatar)","ar-SA":"Arabic (Saudi Arabia)","ar-SY":"Arabic (Syria)","ar-TN":"Arabic (Tunisia)","ar-AE":"Arabic (U.A.E.)","ar-YE":"Arabic (Yemen)",an:"Aragonese",hy:"Armenian",as:"Assamese",ast:"Asturian",az:"Azerbaijani",eu:"Basque",be:"Belarusian",bn:"Bengali",bs:"Bosnian",br:"Breton",bg:"Bulgarian",my:"Burmese",ca:"Catalan",ch:"Chamorro",ce:"Chechen",zh:"Chinese","zh-HK":"Chinese (Hong Kong)","zh-CN":"Chinese (PRC)","zh-SG":"Chinese (Singapore)","zh-TW":"Chinese (Taiwan)",cv:"Chuvash",co:"Corsican",cr:"Cree",hr:"Croatian",cs:"Czech",da:"Danish",nl:"Dutch (Standard)","nl-BE":"Dutch (Belgian)",en:"English","en-AU":"English (Australia)","en-BZ":"English (Belize)","en-CA":"English (Canada)","en-IE":"English (Ireland)","en-JM":"English (Jamaica)","en-NZ":"English (New Zealand)","en-PH":"English (Philippines)","en-ZA":"English (South Africa)","en-TT":"English (Trinidad & Tobago)","en-GB":"English (United Kingdom)","en-US":"English (United States)","en-ZW":"English (Zimbabwe)",eo:"Esperanto",et:"Estonian",fo:"Faeroese",fj:"Fijian",fi:"Finnish",fr:"French (Standard)","fr-BE":"French (Belgium)","fr-CA":"French (Canada)","fr-FR":"French (France)","fr-LU":"French (Luxembourg)","fr-MC":"French (Monaco)","fr-CH":"French (Switzerland)",fy:"Frisian",fur:"Friulian",gd:"Gaelic (Scots)","gd-IE":"Gaelic (Irish)",gl:"Galacian",ka:"Georgian",de:"German (Standard)","de-AT":"German (Austria)","de-DE":"German (Germany)","de-LI":"German (Liechtenstein)","de-LU":"German (Luxembourg)","de-CH":"German (Switzerland)",el:"Greek",gu:"Gujurati",ht:"Haitian",he:"Hebrew",hi:"Hindi",hu:"Hungarian",is:"Icelandic",id:"Indonesian",iu:"Inuktitut",ga:"Irish",it:"Italian (Standard)","it-CH":"Italian (Switzerland)",ja:"Japanese",kn:"Kannada",ks:"Kashmiri",kk:"Kazakh",km:"Khmer",ky:"Kirghiz",tlh:"Klingon",ko:"Korean","ko-KP":"Korean (North Korea)","ko-KR":"Korean (South Korea)",la:"Latin",lv:"Latvian",lt:"Lithuanian",lb:"Luxembourgish",mk:"North Macedonia",ms:"Malay",ml:"Malayalam",mt:"Maltese",mi:"Maori",mr:"Marathi",mo:"Moldavian",nv:"Navajo",ng:"Ndonga",ne:"Nepali",no:"Norwegian",nb:"Norwegian (Bokmal)",nn:"Norwegian (Nynorsk)",oc:"Occitan",or:"Oriya",om:"Oromo",fa:"Persian","fa-IR":"Persian/Iran",pl:"Polish",pt:"Portuguese","pt-BR":"Portuguese (Brazil)",pa:"Punjabi","pa-IN":"Punjabi (India)","pa-PK":"Punjabi (Pakistan)",qu:"Quechua",rm:"Rhaeto-Romanic",ro:"Romanian","ro-MO":"Romanian (Moldavia)",ru:"Russian","ru-MO":"Russian (Moldavia)",sz:"Sami (Lappish)",sg:"Sango",sa:"Sanskrit",sc:"Sardinian",sd:"Sindhi",si:"Singhalese",sr:"Serbian",sk:"Slovak",sl:"Slovenian",so:"Somani",sb:"Sorbian",es:"Spanish","es-AR":"Spanish (Argentina)","es-BO":"Spanish (Bolivia)","es-CL":"Spanish (Chile)","es-CO":"Spanish (Colombia)","es-CR":"Spanish (Costa Rica)","es-DO":"Spanish (Dominican Republic)","es-EC":"Spanish (Ecuador)","es-SV":"Spanish (El Salvador)","es-GT":"Spanish (Guatemala)","es-HN":"Spanish (Honduras)","es-MX":"Spanish (Mexico)","es-NI":"Spanish (Nicaragua)","es-PA":"Spanish (Panama)","es-PY":"Spanish (Paraguay)","es-PE":"Spanish (Peru)","es-PR":"Spanish (Puerto Rico)","es-ES":"Spanish (Spain)","es-UY":"Spanish (Uruguay)","es-VE":"Spanish (Venezuela)",sx:"Sutu",sw:"Swahili",sv:"Swedish","sv-FI":"Swedish (Finland)","sv-SV":"Swedish (Sweden)",ta:"Tamil",tt:"Tatar",te:"Teluga",th:"Thai",tig:"Tigre",ts:"Tsonga",tn:"Tswana",tr:"Turkish",tk:"Turkmen",uk:"Ukrainian",hsb:"Upper Sorbian",ur:"Urdu",ve:"Venda",vi:"Vietnamese",vo:"Volapuk",wa:"Walloon",cy:"Welsh",xh:"Xhosa",ji:"Yiddish",zu:"Zulu"}[n]!==void 0&&(this.internal.languageSettings.languageCode=n,this.internal.languageSettings.isSubscribed===!1&&(this.internal.events.subscribe("putCatalog",function(){this.internal.write("/Lang ("+this.internal.languageSettings.languageCode+")")}),this.internal.languageSettings.isSubscribed=!0)),this},ou=rt.API,Hd=ou.getCharWidthsArray=function(n,e){var t,r,i=(e=e||{}).font||this.internal.getFont(),s=e.fontSize||this.internal.getFontSize(),o=e.charSpace||this.internal.getCharSpace(),a=e.widths?e.widths:i.metadata.Unicode.widths,c=a.fof?a.fof:1,u=e.kerning?e.kerning:i.metadata.Unicode.kerning,d=u.fof?u.fof:1,g=e.doKerning!==!1,y=0,p=n.length,S=0,N=a[0]||c,C=[];for(t=0;t<p;t++)r=n.charCodeAt(t),typeof i.metadata.widthOfString=="function"?C.push((i.metadata.widthOfGlyph(i.metadata.characterToGlyph(r))+o*(1e3/s)||0)/1e3):(y=g&&Zt(u[r])==="object"&&!isNaN(parseInt(u[r][S],10))?u[r][S]/d:0,C.push((a[r]||N)/c+y)),S=r;return C},zv=ou.getStringUnitWidth=function(n,e){var t=(e=e||{}).fontSize||this.internal.getFontSize(),r=e.font||this.internal.getFont(),i=e.charSpace||this.internal.getCharSpace();return ou.processArabic&&(n=ou.processArabic(n)),typeof r.metadata.widthOfString=="function"?r.metadata.widthOfString(n,t,i)/t:Hd.apply(this,arguments).reduce(function(s,o){return s+o},0)},$v=function(n,e,t,r){for(var i=[],s=0,o=n.length,a=0;s!==o&&a+e[s]<t;)a+=e[s],s++;i.push(n.slice(0,s));var c=s;for(a=0;s!==o;)a+e[s]>r&&(i.push(n.slice(c,s)),a=0,c=s),a+=e[s],s++;return c!==s&&i.push(n.slice(c,s)),i},Wv=function(n,e,t){t||(t={});var r,i,s,o,a,c,u,d=[],g=[d],y=t.textIndent||0,p=0,S=0,N=n.split(" "),C=Hd.apply(this,[" ",t])[0];if(c=t.lineIndent===-1?N[0].length+2:t.lineIndent||0){var k=Array(c).join(" "),K=[];N.map(function(W){(W=W.split(/\s*\n/)).length>1?K=K.concat(W.map(function(ne,de){return(de&&ne.length?`
`:"")+ne})):K.push(W[0])}),N=K,c=zv.apply(this,[k,t])}for(s=0,o=N.length;s<o;s++){var G=0;if(r=N[s],c&&r[0]==`
`&&(r=r.substr(1),G=1),y+p+(S=(i=Hd.apply(this,[r,t])).reduce(function(W,ne){return W+ne},0))>e||G){if(S>e){for(a=$v.apply(this,[r,i,e-(y+p),e]),d.push(a.shift()),d=[a.pop()];a.length;)g.push([a.shift()]);S=i.slice(r.length-(d[0]?d[0].length:0)).reduce(function(W,ne){return W+ne},0)}else d=[r];g.push(d),y=S+c,p=C}else d.push(r),y+=p+S,p=C}return u=c?function(W,ne){return(ne?k:"")+W.join(" ")}:function(W){return W.join(" ")},g.map(u)},ou.splitTextToSize=function(n,e,t){var r,i=(t=t||{}).fontSize||this.internal.getFontSize(),s=(function(d){if(d.widths&&d.kerning)return{widths:d.widths,kerning:d.kerning};var g=this.internal.getFont(d.fontName,d.fontStyle),y="Unicode";return g.metadata[y]?{widths:g.metadata[y].widths||{0:1},kerning:g.metadata[y].kerning||{}}:{font:g.metadata,fontSize:this.internal.getFontSize(),charSpace:this.internal.getCharSpace()}}).call(this,t);r=Array.isArray(n)?n:String(n).split(/\r?\n/);var o=1*this.internal.scaleFactor*e/i;s.textIndent=t.textIndent?1*t.textIndent*this.internal.scaleFactor/i:0,s.lineIndent=t.lineIndent;var a,c,u=[];for(a=0,c=r.length;a<c;a++)u=u.concat(Wv.apply(this,[r[a],o,s]));return u},(function(n){n.__fontmetrics__=n.__fontmetrics__||{};for(var e="0123456789abcdef",t="klmnopqrstuvwxyz",r={},i={},s=0;s<16;s++)r[t[s]]=e[s],i[e[s]]=t[s];var o=function(y){return"0x"+parseInt(y,10).toString(16)},a=n.__fontmetrics__.compress=function(y){var p,S,N,C,k=["{"];for(var K in y){if(p=y[K],isNaN(parseInt(K,10))?S="'"+K+"'":(K=parseInt(K,10),S=(S=o(K).slice(2)).slice(0,-1)+i[S.slice(-1)]),typeof p=="number")p<0?(N=o(p).slice(3),C="-"):(N=o(p).slice(2),C=""),N=C+N.slice(0,-1)+i[N.slice(-1)];else{if(Zt(p)!=="object")throw new Error("Don't know what to do with value type "+Zt(p)+".");N=a(p)}k.push(S+N)}return k.push("}"),k.join("")},c=n.__fontmetrics__.uncompress=function(y){if(typeof y!="string")throw new Error("Invalid argument passed to uncompress.");for(var p,S,N,C,k={},K=1,G=k,W=[],ne="",de="",B=y.length-1,x=1;x<B;x+=1)(C=y[x])=="'"?p?(N=p.join(""),p=void 0):p=[]:p?p.push(C):C=="{"?(W.push([G,N]),G={},N=void 0):C=="}"?((S=W.pop())[0][S[1]]=G,N=void 0,G=S[0]):C=="-"?K=-1:N===void 0?r.hasOwnProperty(C)?(ne+=r[C],N=parseInt(ne,16)*K,K=1,ne=""):ne+=C:r.hasOwnProperty(C)?(de+=r[C],G[N]=parseInt(de,16)*K,K=1,N=void 0,de=""):de+=C;return k},u={codePages:["WinAnsiEncoding"],WinAnsiEncoding:c("{19m8n201n9q201o9r201s9l201t9m201u8m201w9n201x9o201y8o202k8q202l8r202m9p202q8p20aw8k203k8t203t8v203u9v2cq8s212m9t15m8w15n9w2dw9s16k8u16l9u17s9z17x8y17y9y}")},d={Unicode:{Courier:u,"Courier-Bold":u,"Courier-BoldOblique":u,"Courier-Oblique":u,Helvetica:u,"Helvetica-Bold":u,"Helvetica-BoldOblique":u,"Helvetica-Oblique":u,"Times-Roman":u,"Times-Bold":u,"Times-BoldItalic":u,"Times-Italic":u}},g={Unicode:{"Courier-Oblique":c("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Times-BoldItalic":c("{'widths'{k3o2q4ycx2r201n3m201o6o201s2l201t2l201u2l201w3m201x3m201y3m2k1t2l2r202m2n2n3m2o3m2p5n202q6o2r1w2s2l2t2l2u3m2v3t2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v2l3w3t3x3t3y3t3z3m4k5n4l4m4m4m4n4m4o4s4p4m4q4m4r4s4s4y4t2r4u3m4v4m4w3x4x5t4y4s4z4s5k3x5l4s5m4m5n3r5o3x5p4s5q4m5r5t5s4m5t3x5u3x5v2l5w1w5x2l5y3t5z3m6k2l6l3m6m3m6n2w6o3m6p2w6q2l6r3m6s3r6t1w6u1w6v3m6w1w6x4y6y3r6z3m7k3m7l3m7m2r7n2r7o1w7p3r7q2w7r4m7s3m7t2w7u2r7v2n7w1q7x2n7y3t202l3mcl4mal2ram3man3mao3map3mar3mas2lat4uau1uav3maw3way4uaz2lbk2sbl3t'fof'6obo2lbp3tbq3mbr1tbs2lbu1ybv3mbz3mck4m202k3mcm4mcn4mco4mcp4mcq5ycr4mcs4mct4mcu4mcv4mcw2r2m3rcy2rcz2rdl4sdm4sdn4sdo4sdp4sdq4sds4sdt4sdu4sdv4sdw4sdz3mek3mel3mem3men3meo3mep3meq4ser2wes2wet2weu2wev2wew1wex1wey1wez1wfl3rfm3mfn3mfo3mfp3mfq3mfr3tfs3mft3rfu3rfv3rfw3rfz2w203k6o212m6o2dw2l2cq2l3t3m3u2l17s3x19m3m}'kerning'{cl{4qu5kt5qt5rs17ss5ts}201s{201ss}201t{cks4lscmscnscoscpscls2wu2yu201ts}201x{2wu2yu}2k{201ts}2w{4qx5kx5ou5qx5rs17su5tu}2x{17su5tu5ou}2y{4qx5kx5ou5qx5rs17ss5ts}'fof'-6ofn{17sw5tw5ou5qw5rs}7t{cksclscmscnscoscps4ls}3u{17su5tu5os5qs}3v{17su5tu5os5qs}7p{17su5tu}ck{4qu5kt5qt5rs17ss5ts}4l{4qu5kt5qt5rs17ss5ts}cm{4qu5kt5qt5rs17ss5ts}cn{4qu5kt5qt5rs17ss5ts}co{4qu5kt5qt5rs17ss5ts}cp{4qu5kt5qt5rs17ss5ts}6l{4qu5ou5qw5rt17su5tu}5q{ckuclucmucnucoucpu4lu}5r{ckuclucmucnucoucpu4lu}7q{cksclscmscnscoscps4ls}6p{4qu5ou5qw5rt17sw5tw}ek{4qu5ou5qw5rt17su5tu}el{4qu5ou5qw5rt17su5tu}em{4qu5ou5qw5rt17su5tu}en{4qu5ou5qw5rt17su5tu}eo{4qu5ou5qw5rt17su5tu}ep{4qu5ou5qw5rt17su5tu}es{17ss5ts5qs4qu}et{4qu5ou5qw5rt17sw5tw}eu{4qu5ou5qw5rt17ss5ts}ev{17ss5ts5qs4qu}6z{17sw5tw5ou5qw5rs}fm{17sw5tw5ou5qw5rs}7n{201ts}fo{17sw5tw5ou5qw5rs}fp{17sw5tw5ou5qw5rs}fq{17sw5tw5ou5qw5rs}7r{cksclscmscnscoscps4ls}fs{17sw5tw5ou5qw5rs}ft{17su5tu}fu{17su5tu}fv{17su5tu}fw{17su5tu}fz{cksclscmscnscoscps4ls}}}"),"Helvetica-Bold":c("{'widths'{k3s2q4scx1w201n3r201o6o201s1w201t1w201u1w201w3m201x3m201y3m2k1w2l2l202m2n2n3r2o3r2p5t202q6o2r1s2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v2l3w3u3x3u3y3u3z3x4k6l4l4s4m4s4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3r4v4s4w3x4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v2l5w1w5x2l5y3u5z3r6k2l6l3r6m3x6n3r6o3x6p3r6q2l6r3x6s3x6t1w6u1w6v3r6w1w6x5t6y3x6z3x7k3x7l3x7m2r7n3r7o2l7p3x7q3r7r4y7s3r7t3r7u3m7v2r7w1w7x2r7y3u202l3rcl4sal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3xbq3rbr1wbs2lbu2obv3rbz3xck4s202k3rcm4scn4sco4scp4scq6ocr4scs4mct4mcu4mcv4mcw1w2m2zcy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3res3ret3reu3rev3rew1wex1wey1wez1wfl3xfm3xfn3xfo3xfp3xfq3xfr3ufs3xft3xfu3xfv3xfw3xfz3r203k6o212m6o2dw2l2cq2l3t3r3u2l17s4m19m3r}'kerning'{cl{4qs5ku5ot5qs17sv5tv}201t{2ww4wy2yw}201w{2ks}201x{2ww4wy2yw}2k{201ts201xs}2w{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}2x{5ow5qs}2y{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}'fof'-6o7p{17su5tu5ot}ck{4qs5ku5ot5qs17sv5tv}4l{4qs5ku5ot5qs17sv5tv}cm{4qs5ku5ot5qs17sv5tv}cn{4qs5ku5ot5qs17sv5tv}co{4qs5ku5ot5qs17sv5tv}cp{4qs5ku5ot5qs17sv5tv}6l{17st5tt5os}17s{2kwclvcmvcnvcovcpv4lv4wwckv}5o{2kucltcmtcntcotcpt4lt4wtckt}5q{2ksclscmscnscoscps4ls4wvcks}5r{2ks4ws}5t{2kwclvcmvcnvcovcpv4lv4wwckv}eo{17st5tt5os}fu{17su5tu5ot}6p{17ss5ts}ek{17st5tt5os}el{17st5tt5os}em{17st5tt5os}en{17st5tt5os}6o{201ts}ep{17st5tt5os}es{17ss5ts}et{17ss5ts}eu{17ss5ts}ev{17ss5ts}6z{17su5tu5os5qt}fm{17su5tu5os5qt}fn{17su5tu5os5qt}fo{17su5tu5os5qt}fp{17su5tu5os5qt}fq{17su5tu5os5qt}fs{17su5tu5os5qt}ft{17su5tu5ot}7m{5os}fv{17su5tu5ot}fw{17su5tu5ot}}}"),Courier:c("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Courier-BoldOblique":c("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Times-Bold":c("{'widths'{k3q2q5ncx2r201n3m201o6o201s2l201t2l201u2l201w3m201x3m201y3m2k1t2l2l202m2n2n3m2o3m2p6o202q6o2r1w2s2l2t2l2u3m2v3t2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v2l3w3t3x3t3y3t3z3m4k5x4l4s4m4m4n4s4o4s4p4m4q3x4r4y4s4y4t2r4u3m4v4y4w4m4x5y4y4s4z4y5k3x5l4y5m4s5n3r5o4m5p4s5q4s5r6o5s4s5t4s5u4m5v2l5w1w5x2l5y3u5z3m6k2l6l3m6m3r6n2w6o3r6p2w6q2l6r3m6s3r6t1w6u2l6v3r6w1w6x5n6y3r6z3m7k3r7l3r7m2w7n2r7o2l7p3r7q3m7r4s7s3m7t3m7u2w7v2r7w1q7x2r7y3o202l3mcl4sal2lam3man3mao3map3mar3mas2lat4uau1yav3maw3tay4uaz2lbk2sbl3t'fof'6obo2lbp3rbr1tbs2lbu2lbv3mbz3mck4s202k3mcm4scn4sco4scp4scq6ocr4scs4mct4mcu4mcv4mcw2r2m3rcy2rcz2rdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3rek3mel3mem3men3meo3mep3meq4ser2wes2wet2weu2wev2wew1wex1wey1wez1wfl3rfm3mfn3mfo3mfp3mfq3mfr3tfs3mft3rfu3rfv3rfw3rfz3m203k6o212m6o2dw2l2cq2l3t3m3u2l17s4s19m3m}'kerning'{cl{4qt5ks5ot5qy5rw17sv5tv}201t{cks4lscmscnscoscpscls4wv}2k{201ts}2w{4qu5ku7mu5os5qx5ru17su5tu}2x{17su5tu5ou5qs}2y{4qv5kv7mu5ot5qz5ru17su5tu}'fof'-6o7t{cksclscmscnscoscps4ls}3u{17su5tu5os5qu}3v{17su5tu5os5qu}fu{17su5tu5ou5qu}7p{17su5tu5ou5qu}ck{4qt5ks5ot5qy5rw17sv5tv}4l{4qt5ks5ot5qy5rw17sv5tv}cm{4qt5ks5ot5qy5rw17sv5tv}cn{4qt5ks5ot5qy5rw17sv5tv}co{4qt5ks5ot5qy5rw17sv5tv}cp{4qt5ks5ot5qy5rw17sv5tv}6l{17st5tt5ou5qu}17s{ckuclucmucnucoucpu4lu4wu}5o{ckuclucmucnucoucpu4lu4wu}5q{ckzclzcmzcnzcozcpz4lz4wu}5r{ckxclxcmxcnxcoxcpx4lx4wu}5t{ckuclucmucnucoucpu4lu4wu}7q{ckuclucmucnucoucpu4lu}6p{17sw5tw5ou5qu}ek{17st5tt5qu}el{17st5tt5ou5qu}em{17st5tt5qu}en{17st5tt5qu}eo{17st5tt5qu}ep{17st5tt5ou5qu}es{17ss5ts5qu}et{17sw5tw5ou5qu}eu{17sw5tw5ou5qu}ev{17ss5ts5qu}6z{17sw5tw5ou5qu5rs}fm{17sw5tw5ou5qu5rs}fn{17sw5tw5ou5qu5rs}fo{17sw5tw5ou5qu5rs}fp{17sw5tw5ou5qu5rs}fq{17sw5tw5ou5qu5rs}7r{cktcltcmtcntcotcpt4lt5os}fs{17sw5tw5ou5qu5rs}ft{17su5tu5ou5qu}7m{5os}fv{17su5tu5ou5qu}fw{17su5tu5ou5qu}fz{cksclscmscnscoscps4ls}}}"),Symbol:c("{'widths'{k3uaw4r19m3m2k1t2l2l202m2y2n3m2p5n202q6o3k3m2s2l2t2l2v3r2w1t3m3m2y1t2z1wbk2sbl3r'fof'6o3n3m3o3m3p3m3q3m3r3m3s3m3t3m3u1w3v1w3w3r3x3r3y3r3z2wbp3t3l3m5v2l5x2l5z3m2q4yfr3r7v3k7w1o7x3k}'kerning'{'fof'-6o}}"),Helvetica:c("{'widths'{k3p2q4mcx1w201n3r201o6o201s1q201t1q201u1q201w2l201x2l201y2l2k1w2l1w202m2n2n3r2o3r2p5t202q6o2r1n2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v1w3w3u3x3u3y3u3z3r4k6p4l4m4m4m4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3m4v4m4w3r4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v1w5w1w5x1w5y2z5z3r6k2l6l3r6m3r6n3m6o3r6p3r6q1w6r3r6s3r6t1q6u1q6v3m6w1q6x5n6y3r6z3r7k3r7l3r7m2l7n3m7o1w7p3r7q3m7r4s7s3m7t3m7u3m7v2l7w1u7x2l7y3u202l3rcl4mal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3rbr1wbs2lbu2obv3rbz3xck4m202k3rcm4mcn4mco4mcp4mcq6ocr4scs4mct4mcu4mcv4mcw1w2m2ncy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3mes3ret3reu3rev3rew1wex1wey1wez1wfl3rfm3rfn3rfo3rfp3rfq3rfr3ufs3xft3rfu3rfv3rfw3rfz3m203k6o212m6o2dw2l2cq2l3t3r3u1w17s4m19m3r}'kerning'{5q{4wv}cl{4qs5kw5ow5qs17sv5tv}201t{2wu4w1k2yu}201x{2wu4wy2yu}17s{2ktclucmucnu4otcpu4lu4wycoucku}2w{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}2x{17sy5ty5oy5qs}2y{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}'fof'-6o7p{17sv5tv5ow}ck{4qs5kw5ow5qs17sv5tv}4l{4qs5kw5ow5qs17sv5tv}cm{4qs5kw5ow5qs17sv5tv}cn{4qs5kw5ow5qs17sv5tv}co{4qs5kw5ow5qs17sv5tv}cp{4qs5kw5ow5qs17sv5tv}6l{17sy5ty5ow}do{17st5tt}4z{17st5tt}7s{fst}dm{17st5tt}dn{17st5tt}5o{ckwclwcmwcnwcowcpw4lw4wv}dp{17st5tt}dq{17st5tt}7t{5ow}ds{17st5tt}5t{2ktclucmucnu4otcpu4lu4wycoucku}fu{17sv5tv5ow}6p{17sy5ty5ow5qs}ek{17sy5ty5ow}el{17sy5ty5ow}em{17sy5ty5ow}en{5ty}eo{17sy5ty5ow}ep{17sy5ty5ow}es{17sy5ty5qs}et{17sy5ty5ow5qs}eu{17sy5ty5ow5qs}ev{17sy5ty5ow5qs}6z{17sy5ty5ow5qs}fm{17sy5ty5ow5qs}fn{17sy5ty5ow5qs}fo{17sy5ty5ow5qs}fp{17sy5ty5qs}fq{17sy5ty5ow5qs}7r{5ow}fs{17sy5ty5ow5qs}ft{17sv5tv5ow}7m{5ow}fv{17sv5tv5ow}fw{17sv5tv5ow}}}"),"Helvetica-BoldOblique":c("{'widths'{k3s2q4scx1w201n3r201o6o201s1w201t1w201u1w201w3m201x3m201y3m2k1w2l2l202m2n2n3r2o3r2p5t202q6o2r1s2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v2l3w3u3x3u3y3u3z3x4k6l4l4s4m4s4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3r4v4s4w3x4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v2l5w1w5x2l5y3u5z3r6k2l6l3r6m3x6n3r6o3x6p3r6q2l6r3x6s3x6t1w6u1w6v3r6w1w6x5t6y3x6z3x7k3x7l3x7m2r7n3r7o2l7p3x7q3r7r4y7s3r7t3r7u3m7v2r7w1w7x2r7y3u202l3rcl4sal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3xbq3rbr1wbs2lbu2obv3rbz3xck4s202k3rcm4scn4sco4scp4scq6ocr4scs4mct4mcu4mcv4mcw1w2m2zcy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3res3ret3reu3rev3rew1wex1wey1wez1wfl3xfm3xfn3xfo3xfp3xfq3xfr3ufs3xft3xfu3xfv3xfw3xfz3r203k6o212m6o2dw2l2cq2l3t3r3u2l17s4m19m3r}'kerning'{cl{4qs5ku5ot5qs17sv5tv}201t{2ww4wy2yw}201w{2ks}201x{2ww4wy2yw}2k{201ts201xs}2w{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}2x{5ow5qs}2y{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}'fof'-6o7p{17su5tu5ot}ck{4qs5ku5ot5qs17sv5tv}4l{4qs5ku5ot5qs17sv5tv}cm{4qs5ku5ot5qs17sv5tv}cn{4qs5ku5ot5qs17sv5tv}co{4qs5ku5ot5qs17sv5tv}cp{4qs5ku5ot5qs17sv5tv}6l{17st5tt5os}17s{2kwclvcmvcnvcovcpv4lv4wwckv}5o{2kucltcmtcntcotcpt4lt4wtckt}5q{2ksclscmscnscoscps4ls4wvcks}5r{2ks4ws}5t{2kwclvcmvcnvcovcpv4lv4wwckv}eo{17st5tt5os}fu{17su5tu5ot}6p{17ss5ts}ek{17st5tt5os}el{17st5tt5os}em{17st5tt5os}en{17st5tt5os}6o{201ts}ep{17st5tt5os}es{17ss5ts}et{17ss5ts}eu{17ss5ts}ev{17ss5ts}6z{17su5tu5os5qt}fm{17su5tu5os5qt}fn{17su5tu5os5qt}fo{17su5tu5os5qt}fp{17su5tu5os5qt}fq{17su5tu5os5qt}fs{17su5tu5os5qt}ft{17su5tu5ot}7m{5os}fv{17su5tu5ot}fw{17su5tu5ot}}}"),ZapfDingbats:c("{'widths'{k4u2k1w'fof'6o}'kerning'{'fof'-6o}}"),"Courier-Bold":c("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Times-Italic":c("{'widths'{k3n2q4ycx2l201n3m201o5t201s2l201t2l201u2l201w3r201x3r201y3r2k1t2l2l202m2n2n3m2o3m2p5n202q5t2r1p2s2l2t2l2u3m2v4n2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v2l3w4n3x4n3y4n3z3m4k5w4l3x4m3x4n4m4o4s4p3x4q3x4r4s4s4s4t2l4u2w4v4m4w3r4x5n4y4m4z4s5k3x5l4s5m3x5n3m5o3r5p4s5q3x5r5n5s3x5t3r5u3r5v2r5w1w5x2r5y2u5z3m6k2l6l3m6m3m6n2w6o3m6p2w6q1w6r3m6s3m6t1w6u1w6v2w6w1w6x4s6y3m6z3m7k3m7l3m7m2r7n2r7o1w7p3m7q2w7r4m7s2w7t2w7u2r7v2s7w1v7x2s7y3q202l3mcl3xal2ram3man3mao3map3mar3mas2lat4wau1vav3maw4nay4waz2lbk2sbl4n'fof'6obo2lbp3mbq3obr1tbs2lbu1zbv3mbz3mck3x202k3mcm3xcn3xco3xcp3xcq5tcr4mcs3xct3xcu3xcv3xcw2l2m2ucy2lcz2ldl4mdm4sdn4sdo4sdp4sdq4sds4sdt4sdu4sdv4sdw4sdz3mek3mel3mem3men3meo3mep3meq4mer2wes2wet2weu2wev2wew1wex1wey1wez1wfl3mfm3mfn3mfo3mfp3mfq3mfr4nfs3mft3mfu3mfv3mfw3mfz2w203k6o212m6m2dw2l2cq2l3t3m3u2l17s3r19m3m}'kerning'{cl{5kt4qw}201s{201sw}201t{201tw2wy2yy6q-t}201x{2wy2yy}2k{201tw}2w{7qs4qy7rs5ky7mw5os5qx5ru17su5tu}2x{17ss5ts5os}2y{7qs4qy7rs5ky7mw5os5qx5ru17su5tu}'fof'-6o6t{17ss5ts5qs}7t{5os}3v{5qs}7p{17su5tu5qs}ck{5kt4qw}4l{5kt4qw}cm{5kt4qw}cn{5kt4qw}co{5kt4qw}cp{5kt4qw}6l{4qs5ks5ou5qw5ru17su5tu}17s{2ks}5q{ckvclvcmvcnvcovcpv4lv}5r{ckuclucmucnucoucpu4lu}5t{2ks}6p{4qs5ks5ou5qw5ru17su5tu}ek{4qs5ks5ou5qw5ru17su5tu}el{4qs5ks5ou5qw5ru17su5tu}em{4qs5ks5ou5qw5ru17su5tu}en{4qs5ks5ou5qw5ru17su5tu}eo{4qs5ks5ou5qw5ru17su5tu}ep{4qs5ks5ou5qw5ru17su5tu}es{5ks5qs4qs}et{4qs5ks5ou5qw5ru17su5tu}eu{4qs5ks5qw5ru17su5tu}ev{5ks5qs4qs}ex{17ss5ts5qs}6z{4qv5ks5ou5qw5ru17su5tu}fm{4qv5ks5ou5qw5ru17su5tu}fn{4qv5ks5ou5qw5ru17su5tu}fo{4qv5ks5ou5qw5ru17su5tu}fp{4qv5ks5ou5qw5ru17su5tu}fq{4qv5ks5ou5qw5ru17su5tu}7r{5os}fs{4qv5ks5ou5qw5ru17su5tu}ft{17su5tu5qs}fu{17su5tu5qs}fv{17su5tu5qs}fw{17su5tu5qs}}}"),"Times-Roman":c("{'widths'{k3n2q4ycx2l201n3m201o6o201s2l201t2l201u2l201w2w201x2w201y2w2k1t2l2l202m2n2n3m2o3m2p5n202q6o2r1m2s2l2t2l2u3m2v3s2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v1w3w3s3x3s3y3s3z2w4k5w4l4s4m4m4n4m4o4s4p3x4q3r4r4s4s4s4t2l4u2r4v4s4w3x4x5t4y4s4z4s5k3r5l4s5m4m5n3r5o3x5p4s5q4s5r5y5s4s5t4s5u3x5v2l5w1w5x2l5y2z5z3m6k2l6l2w6m3m6n2w6o3m6p2w6q2l6r3m6s3m6t1w6u1w6v3m6w1w6x4y6y3m6z3m7k3m7l3m7m2l7n2r7o1w7p3m7q3m7r4s7s3m7t3m7u2w7v3k7w1o7x3k7y3q202l3mcl4sal2lam3man3mao3map3mar3mas2lat4wau1vav3maw3say4waz2lbk2sbl3s'fof'6obo2lbp3mbq2xbr1tbs2lbu1zbv3mbz2wck4s202k3mcm4scn4sco4scp4scq5tcr4mcs3xct3xcu3xcv3xcw2l2m2tcy2lcz2ldl4sdm4sdn4sdo4sdp4sdq4sds4sdt4sdu4sdv4sdw4sdz3mek2wel2wem2wen2weo2wep2weq4mer2wes2wet2weu2wev2wew1wex1wey1wez1wfl3mfm3mfn3mfo3mfp3mfq3mfr3sfs3mft3mfu3mfv3mfw3mfz3m203k6o212m6m2dw2l2cq2l3t3m3u1w17s4s19m3m}'kerning'{cl{4qs5ku17sw5ou5qy5rw201ss5tw201ws}201s{201ss}201t{ckw4lwcmwcnwcowcpwclw4wu201ts}2k{201ts}2w{4qs5kw5os5qx5ru17sx5tx}2x{17sw5tw5ou5qu}2y{4qs5kw5os5qx5ru17sx5tx}'fof'-6o7t{ckuclucmucnucoucpu4lu5os5rs}3u{17su5tu5qs}3v{17su5tu5qs}7p{17sw5tw5qs}ck{4qs5ku17sw5ou5qy5rw201ss5tw201ws}4l{4qs5ku17sw5ou5qy5rw201ss5tw201ws}cm{4qs5ku17sw5ou5qy5rw201ss5tw201ws}cn{4qs5ku17sw5ou5qy5rw201ss5tw201ws}co{4qs5ku17sw5ou5qy5rw201ss5tw201ws}cp{4qs5ku17sw5ou5qy5rw201ss5tw201ws}6l{17su5tu5os5qw5rs}17s{2ktclvcmvcnvcovcpv4lv4wuckv}5o{ckwclwcmwcnwcowcpw4lw4wu}5q{ckyclycmycnycoycpy4ly4wu5ms}5r{cktcltcmtcntcotcpt4lt4ws}5t{2ktclvcmvcnvcovcpv4lv4wuckv}7q{cksclscmscnscoscps4ls}6p{17su5tu5qw5rs}ek{5qs5rs}el{17su5tu5os5qw5rs}em{17su5tu5os5qs5rs}en{17su5qs5rs}eo{5qs5rs}ep{17su5tu5os5qw5rs}es{5qs}et{17su5tu5qw5rs}eu{17su5tu5qs5rs}ev{5qs}6z{17sv5tv5os5qx5rs}fm{5os5qt5rs}fn{17sv5tv5os5qx5rs}fo{17sv5tv5os5qx5rs}fp{5os5qt5rs}fq{5os5qt5rs}7r{ckuclucmucnucoucpu4lu5os}fs{17sv5tv5os5qx5rs}ft{17ss5ts5qs}fu{17sw5tw5qs}fv{17sw5tw5qs}fw{17ss5ts5qs}fz{ckuclucmucnucoucpu4lu5os5rs}}}"),"Helvetica-Oblique":c("{'widths'{k3p2q4mcx1w201n3r201o6o201s1q201t1q201u1q201w2l201x2l201y2l2k1w2l1w202m2n2n3r2o3r2p5t202q6o2r1n2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v1w3w3u3x3u3y3u3z3r4k6p4l4m4m4m4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3m4v4m4w3r4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v1w5w1w5x1w5y2z5z3r6k2l6l3r6m3r6n3m6o3r6p3r6q1w6r3r6s3r6t1q6u1q6v3m6w1q6x5n6y3r6z3r7k3r7l3r7m2l7n3m7o1w7p3r7q3m7r4s7s3m7t3m7u3m7v2l7w1u7x2l7y3u202l3rcl4mal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3rbr1wbs2lbu2obv3rbz3xck4m202k3rcm4mcn4mco4mcp4mcq6ocr4scs4mct4mcu4mcv4mcw1w2m2ncy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3mes3ret3reu3rev3rew1wex1wey1wez1wfl3rfm3rfn3rfo3rfp3rfq3rfr3ufs3xft3rfu3rfv3rfw3rfz3m203k6o212m6o2dw2l2cq2l3t3r3u1w17s4m19m3r}'kerning'{5q{4wv}cl{4qs5kw5ow5qs17sv5tv}201t{2wu4w1k2yu}201x{2wu4wy2yu}17s{2ktclucmucnu4otcpu4lu4wycoucku}2w{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}2x{17sy5ty5oy5qs}2y{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}'fof'-6o7p{17sv5tv5ow}ck{4qs5kw5ow5qs17sv5tv}4l{4qs5kw5ow5qs17sv5tv}cm{4qs5kw5ow5qs17sv5tv}cn{4qs5kw5ow5qs17sv5tv}co{4qs5kw5ow5qs17sv5tv}cp{4qs5kw5ow5qs17sv5tv}6l{17sy5ty5ow}do{17st5tt}4z{17st5tt}7s{fst}dm{17st5tt}dn{17st5tt}5o{ckwclwcmwcnwcowcpw4lw4wv}dp{17st5tt}dq{17st5tt}7t{5ow}ds{17st5tt}5t{2ktclucmucnu4otcpu4lu4wycoucku}fu{17sv5tv5ow}6p{17sy5ty5ow5qs}ek{17sy5ty5ow}el{17sy5ty5ow}em{17sy5ty5ow}en{5ty}eo{17sy5ty5ow}ep{17sy5ty5ow}es{17sy5ty5qs}et{17sy5ty5ow5qs}eu{17sy5ty5ow5qs}ev{17sy5ty5ow5qs}6z{17sy5ty5ow5qs}fm{17sy5ty5ow5qs}fn{17sy5ty5ow5qs}fo{17sy5ty5ow5qs}fp{17sy5ty5qs}fq{17sy5ty5ow5qs}7r{5ow}fs{17sy5ty5ow5qs}ft{17sv5tv5ow}7m{5ow}fv{17sv5tv5ow}fw{17sv5tv5ow}}}")}};n.events.push(["addFont",function(y){var p=y.font,S=g.Unicode[p.postScriptName];S&&(p.metadata.Unicode={},p.metadata.Unicode.widths=S.widths,p.metadata.Unicode.kerning=S.kerning);var N=d.Unicode[p.postScriptName];N&&(p.metadata.Unicode.encoding=N,p.encoding=N.codePages[0])}])})(rt.API),(function(n){var e=function(t){for(var r=t.length,i=new Uint8Array(r),s=0;s<r;s++)i[s]=t.charCodeAt(s);return i};n.API.events.push(["addFont",function(t){var r=void 0,i=t.font,s=t.instance;if(!i.isStandardFont){if(s===void 0)throw new Error("Font does not exist in vFS, import fonts or remove declaration doc.addFont('"+i.postScriptName+"').");if(typeof(r=s.existsFileInVFS(i.postScriptName)===!1?s.loadFile(i.postScriptName):s.getFileFromVFS(i.postScriptName))!="string")throw new Error("Font is not stored as string-data in vFS, import fonts or remove declaration doc.addFont('"+i.postScriptName+"').");(function(o,a){a=/^\x00\x01\x00\x00/.test(a)?e(a):e(lf(a)),o.metadata=n.API.TTFFont.open(a),o.metadata.Unicode=o.metadata.Unicode||{encoding:{},kerning:{},widths:[]},o.metadata.glyIdsUsed=[0]})(i,r)}}])})(rt),rt.API.addSvgAsImage=function(n,e,t,r,i,s,o,a){if(isNaN(e)||isNaN(t))throw cn.error("jsPDF.addSvgAsImage: Invalid coordinates",arguments),new Error("Invalid coordinates passed to jsPDF.addSvgAsImage");if(isNaN(r)||isNaN(i))throw cn.error("jsPDF.addSvgAsImage: Invalid measurements",arguments),new Error("Invalid measurements (width and/or height) passed to jsPDF.addSvgAsImage");var c=document.createElement("canvas");c.width=r,c.height=i;var u=c.getContext("2d");u.fillStyle="#fff",u.fillRect(0,0,c.width,c.height);var d={ignoreMouse:!0,ignoreAnimation:!0,ignoreDimensions:!0},g=this;return(yt.canvg?Promise.resolve(yt.canvg):Ag(()=>import("./index.es-C3R405zp.js"),[])).catch(function(y){return Promise.reject(new Error("Could not load canvg: "+y))}).then(function(y){return y.default?y.default:y}).then(function(y){return y.fromString(u,n,d)},function(){return Promise.reject(new Error("Could not load canvg."))}).then(function(y){return y.render(d)}).then(function(){g.addImage(c.toDataURL("image/jpeg",1),e,t,r,i,o,a)})},rt.API.putTotalPages=function(n){var e,t=0;parseInt(this.internal.getFont().id.substr(1),10)<15?(e=new RegExp(n,"g"),t=this.internal.getNumberOfPages()):(e=new RegExp(this.pdfEscape16(n,this.internal.getFont()),"g"),t=this.pdfEscape16(this.internal.getNumberOfPages()+"",this.internal.getFont()));for(var r=1;r<=this.internal.getNumberOfPages();r++)for(var i=0;i<this.internal.pages[r].length;i++)this.internal.pages[r][i]=this.internal.pages[r][i].replace(e,t);return this},rt.API.viewerPreferences=function(n,e){var t;n=n||{},e=e||!1;var r,i,s,o={HideToolbar:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},HideMenubar:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},HideWindowUI:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},FitWindow:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},CenterWindow:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},DisplayDocTitle:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.4},NonFullScreenPageMode:{defaultValue:"UseNone",value:"UseNone",type:"name",explicitSet:!1,valueSet:["UseNone","UseOutlines","UseThumbs","UseOC"],pdfVersion:1.3},Direction:{defaultValue:"L2R",value:"L2R",type:"name",explicitSet:!1,valueSet:["L2R","R2L"],pdfVersion:1.3},ViewArea:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},ViewClip:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},PrintArea:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},PrintClip:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},PrintScaling:{defaultValue:"AppDefault",value:"AppDefault",type:"name",explicitSet:!1,valueSet:["AppDefault","None"],pdfVersion:1.6},Duplex:{defaultValue:"",value:"none",type:"name",explicitSet:!1,valueSet:["Simplex","DuplexFlipShortEdge","DuplexFlipLongEdge","none"],pdfVersion:1.7},PickTrayByPDFSize:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.7},PrintPageRange:{defaultValue:"",value:"",type:"array",explicitSet:!1,valueSet:null,pdfVersion:1.7},NumCopies:{defaultValue:1,value:1,type:"integer",explicitSet:!1,valueSet:null,pdfVersion:1.7}},a=Object.keys(o),c=[],u=0,d=0,g=0;function y(S,N){var C,k=!1;for(C=0;C<S.length;C+=1)S[C]===N&&(k=!0);return k}if(this.internal.viewerpreferences===void 0&&(this.internal.viewerpreferences={},this.internal.viewerpreferences.configuration=JSON.parse(JSON.stringify(o)),this.internal.viewerpreferences.isSubscribed=!1),t=this.internal.viewerpreferences.configuration,n==="reset"||e===!0){var p=a.length;for(g=0;g<p;g+=1)t[a[g]].value=t[a[g]].defaultValue,t[a[g]].explicitSet=!1}if(Zt(n)==="object"){for(i in n)if(s=n[i],y(a,i)&&s!==void 0){if(t[i].type==="boolean"&&typeof s=="boolean")t[i].value=s;else if(t[i].type==="name"&&y(t[i].valueSet,s))t[i].value=s;else if(t[i].type==="integer"&&Number.isInteger(s))t[i].value=s;else if(t[i].type==="array"){for(u=0;u<s.length;u+=1)if(r=!0,s[u].length===1&&typeof s[u][0]=="number")c.push(String(s[u]-1));else if(s[u].length>1){for(d=0;d<s[u].length;d+=1)typeof s[u][d]!="number"&&(r=!1);r===!0&&c.push([s[u][0]-1,s[u][1]-1].join(" "))}t[i].value="["+c.join(" ")+"]"}else t[i].value=t[i].defaultValue;t[i].explicitSet=!0}}return this.internal.viewerpreferences.isSubscribed===!1&&(this.internal.events.subscribe("putCatalog",function(){var S,N=[];for(S in t)t[S].explicitSet===!0&&(t[S].type==="name"?N.push("/"+S+" /"+t[S].value):N.push("/"+S+" "+t[S].value));N.length!==0&&this.internal.write(`/ViewerPreferences
<<
`+N.join(`
`)+`
>>`)}),this.internal.viewerpreferences.isSubscribed=!0),this.internal.viewerpreferences.configuration=t,this},(function(n){var e=function(){var r='<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#"><rdf:Description rdf:about="" xmlns:jspdf="'+this.internal.__metadata__.namespaceuri+'"><jspdf:metadata>',i=unescape(encodeURIComponent('<x:xmpmeta xmlns:x="adobe:ns:meta/">')),s=unescape(encodeURIComponent(r)),o=unescape(encodeURIComponent(this.internal.__metadata__.metadata)),a=unescape(encodeURIComponent("</jspdf:metadata></rdf:Description></rdf:RDF>")),c=unescape(encodeURIComponent("</x:xmpmeta>")),u=s.length+o.length+a.length+i.length+c.length;this.internal.__metadata__.metadata_object_number=this.internal.newObject(),this.internal.write("<< /Type /Metadata /Subtype /XML /Length "+u+" >>"),this.internal.write("stream"),this.internal.write(i+s+o+a+c),this.internal.write("endstream"),this.internal.write("endobj")},t=function(){this.internal.__metadata__.metadata_object_number&&this.internal.write("/Metadata "+this.internal.__metadata__.metadata_object_number+" 0 R")};n.addMetadata=function(r,i){return this.internal.__metadata__===void 0&&(this.internal.__metadata__={metadata:r,namespaceuri:i||"http://jspdf.default.namespaceuri/"},this.internal.events.subscribe("putCatalog",t),this.internal.events.subscribe("postPutResources",e)),this}})(rt.API),(function(n){var e=n.API,t=e.pdfEscape16=function(s,o){for(var a,c=o.metadata.Unicode.widths,u=["","0","00","000","0000"],d=[""],g=0,y=s.length;g<y;++g){if(a=o.metadata.characterToGlyph(s.charCodeAt(g)),o.metadata.glyIdsUsed.push(a),o.metadata.toUnicode[a]=s.charCodeAt(g),c.indexOf(a)==-1&&(c.push(a),c.push([parseInt(o.metadata.widthOfGlyph(a),10)])),a=="0")return d.join("");a=a.toString(16),d.push(u[4-a.length],a)}return d.join("")},r=function(s){var o,a,c,u,d,g,y;for(d=`/CIDInit /ProcSet findresource begin
12 dict begin
begincmap
/CIDSystemInfo <<
  /Registry (Adobe)
  /Ordering (UCS)
  /Supplement 0
>> def
/CMapName /Adobe-Identity-UCS def
/CMapType 2 def
1 begincodespacerange
<0000><ffff>
endcodespacerange`,c=[],g=0,y=(a=Object.keys(s).sort(function(p,S){return p-S})).length;g<y;g++)o=a[g],c.length>=100&&(d+=`
`+c.length+` beginbfchar
`+c.join(`
`)+`
endbfchar`,c=[]),s[o]!==void 0&&s[o]!==null&&typeof s[o].toString=="function"&&(u=("0000"+s[o].toString(16)).slice(-4),o=("0000"+(+o).toString(16)).slice(-4),c.push("<"+o+"><"+u+">"));return c.length&&(d+=`
`+c.length+` beginbfchar
`+c.join(`
`)+`
endbfchar
`),d+`endcmap
CMapName currentdict /CMap defineresource pop
end
end`};e.events.push(["putFont",function(s){(function(o){var a=o.font,c=o.out,u=o.newObject,d=o.putStream;if(a.metadata instanceof n.API.TTFFont&&a.encoding==="Identity-H"){for(var g=a.metadata.Unicode.widths,y=a.metadata.subset.encode(a.metadata.glyIdsUsed,1),p="",S=0;S<y.length;S++)p+=String.fromCharCode(y[S]);var N=u();d({data:p,addLength1:!0,objectId:N}),c("endobj");var C=u();d({data:r(a.metadata.toUnicode),addLength1:!0,objectId:C}),c("endobj");var k=u();c("<<"),c("/Type /FontDescriptor"),c("/FontName /"+fu(a.fontName)),c("/FontFile2 "+N+" 0 R"),c("/FontBBox "+n.API.PDFObject.convert(a.metadata.bbox)),c("/Flags "+a.metadata.flags),c("/StemV "+a.metadata.stemV),c("/ItalicAngle "+a.metadata.italicAngle),c("/Ascent "+a.metadata.ascender),c("/Descent "+a.metadata.decender),c("/CapHeight "+a.metadata.capHeight),c(">>"),c("endobj");var K=u();c("<<"),c("/Type /Font"),c("/BaseFont /"+fu(a.fontName)),c("/FontDescriptor "+k+" 0 R"),c("/W "+n.API.PDFObject.convert(g)),c("/CIDToGIDMap /Identity"),c("/DW 1000"),c("/Subtype /CIDFontType2"),c("/CIDSystemInfo"),c("<<"),c("/Supplement 0"),c("/Registry (Adobe)"),c("/Ordering ("+a.encoding+")"),c(">>"),c(">>"),c("endobj"),a.objectNumber=u(),c("<<"),c("/Type /Font"),c("/Subtype /Type0"),c("/ToUnicode "+C+" 0 R"),c("/BaseFont /"+fu(a.fontName)),c("/Encoding /"+a.encoding),c("/DescendantFonts ["+K+" 0 R]"),c(">>"),c("endobj"),a.isAlreadyPutted=!0}})(s)}]),e.events.push(["putFont",function(s){(function(o){var a=o.font,c=o.out,u=o.newObject,d=o.putStream;if(a.metadata instanceof n.API.TTFFont&&a.encoding==="WinAnsiEncoding"){for(var g=a.metadata.rawData,y="",p=0;p<g.length;p++)y+=String.fromCharCode(g[p]);var S=u();d({data:y,addLength1:!0,objectId:S}),c("endobj");var N=u();d({data:r(a.metadata.toUnicode),addLength1:!0,objectId:N}),c("endobj");var C=u();c("<<"),c("/Descent "+a.metadata.decender),c("/CapHeight "+a.metadata.capHeight),c("/StemV "+a.metadata.stemV),c("/Type /FontDescriptor"),c("/FontFile2 "+S+" 0 R"),c("/Flags 96"),c("/FontBBox "+n.API.PDFObject.convert(a.metadata.bbox)),c("/FontName /"+fu(a.fontName)),c("/ItalicAngle "+a.metadata.italicAngle),c("/Ascent "+a.metadata.ascender),c(">>"),c("endobj"),a.objectNumber=u();for(var k=0;k<a.metadata.hmtx.widths.length;k++)a.metadata.hmtx.widths[k]=parseInt(a.metadata.hmtx.widths[k]*(1e3/a.metadata.head.unitsPerEm));c("<</Subtype/TrueType/Type/Font/ToUnicode "+N+" 0 R/BaseFont/"+fu(a.fontName)+"/FontDescriptor "+C+" 0 R/Encoding/"+a.encoding+" /FirstChar 29 /LastChar 255 /Widths "+n.API.PDFObject.convert(a.metadata.hmtx.widths)+">>"),c("endobj"),a.isAlreadyPutted=!0}})(s)}]);var i=function(s){var o,a=s.text||"",c=s.x,u=s.y,d=s.options||{},g=s.mutex||{},y=g.pdfEscape,p=g.activeFontKey,S=g.fonts,N=p,C="",k=0,K="",G=S[N].encoding;if(S[N].encoding!=="Identity-H")return{text:a,x:c,y:u,options:d,mutex:g};for(K=a,N=p,Array.isArray(a)&&(K=a[0]),k=0;k<K.length;k+=1)S[N].metadata.hasOwnProperty("cmap")&&(o=S[N].metadata.cmap.unicode.codeMap[K[k].charCodeAt(0)]),o||K[k].charCodeAt(0)<256&&S[N].metadata.hasOwnProperty("Unicode")?C+=K[k]:C+="";var W="";return parseInt(N.slice(1))<14||G==="WinAnsiEncoding"?W=y(C,N).split("").map(function(ne){return ne.charCodeAt(0).toString(16)}).join(""):G==="Identity-H"&&(W=t(C,S[N])),g.isHex=!0,{text:W,x:c,y:u,options:d,mutex:g}};e.events.push(["postProcessText",function(s){var o=s.text||"",a=[],c={text:o,x:s.x,y:s.y,options:s.options,mutex:s.mutex};if(Array.isArray(o)){var u=0;for(u=0;u<o.length;u+=1)Array.isArray(o[u])&&o[u].length===3?a.push([i(Object.assign({},c,{text:o[u][0]})).text,o[u][1],o[u][2]]):a.push(i(Object.assign({},c,{text:o[u]})).text);s.text=a}else s.text=i(Object.assign({},c,{text:o})).text}])})(rt),(function(n){var e=function(){return this.internal.vFS===void 0&&(this.internal.vFS={}),!0};n.existsFileInVFS=function(t){return e.call(this),this.internal.vFS[t]!==void 0},n.addFileToVFS=function(t,r){return e.call(this),this.internal.vFS[t]=r,this},n.getFileFromVFS=function(t){return e.call(this),this.internal.vFS[t]!==void 0?this.internal.vFS[t]:null}})(rt.API),(function(n){n.__bidiEngine__=n.prototype.__bidiEngine__=function(r){var i,s,o,a,c,u,d,g=e,y=[[0,3,0,1,0,0,0],[0,3,0,1,2,2,0],[0,3,0,17,2,0,1],[0,3,5,5,4,1,0],[0,3,21,21,4,0,1],[0,3,5,5,4,2,0]],p=[[2,0,1,1,0,1,0],[2,0,1,1,0,2,0],[2,0,2,1,3,2,0],[2,0,2,33,3,1,1]],S={L:0,R:1,EN:2,AN:3,N:4,B:5,S:6},N={0:0,5:1,6:2,7:3,32:4,251:5,254:6,255:7},C=["(",")","(","<",">","<","[","]","[","{","}","{","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","",""],k=new RegExp(/^([1-4|9]|1[0-9]|2[0-9]|3[0168]|4[04589]|5[012]|7[78]|159|16[0-9]|17[0-2]|21[569]|22[03489]|250)$/),K=!1,G=0;this.__bidiEngine__={};var W=function(b){var E=b.charCodeAt(),T=E>>8,J=N[T];return J!==void 0?g[256*J+(255&E)]:T===252||T===253?"AL":k.test(T)?"L":T===8?"R":"N"},ne=function(b){for(var E,T=0;T<b.length;T++){if((E=W(b.charAt(T)))==="L")return!1;if(E==="R")return!0}return!1},de=function(b,E,T,J){var fe,ye,_e,ce,ve=E[J];switch(ve){case"L":case"R":case"LRE":case"RLE":case"LRO":case"RLO":case"PDF":K=!1;break;case"N":case"AN":break;case"EN":K&&(ve="AN");break;case"AL":K=!0,ve="R";break;case"WS":case"BN":ve="N";break;case"CS":J<1||J+1>=E.length||(fe=T[J-1])!=="EN"&&fe!=="AN"||(ye=E[J+1])!=="EN"&&ye!=="AN"?ve="N":K&&(ye="AN"),ve=ye===fe?ye:"N";break;case"ES":ve=(fe=J>0?T[J-1]:"B")==="EN"&&J+1<E.length&&E[J+1]==="EN"?"EN":"N";break;case"ET":if(J>0&&T[J-1]==="EN"){ve="EN";break}if(K){ve="N";break}for(_e=J+1,ce=E.length;_e<ce&&E[_e]==="ET";)_e++;ve=_e<ce&&E[_e]==="EN"?"EN":"N";break;case"NSM":if(o&&!a){for(ce=E.length,_e=J+1;_e<ce&&E[_e]==="NSM";)_e++;if(_e<ce){var Oe=b[J],xe=Oe>=1425&&Oe<=2303||Oe===64286;if(fe=E[_e],xe&&(fe==="R"||fe==="AL")){ve="R";break}}}ve=J<1||(fe=E[J-1])==="B"?"N":T[J-1];break;case"B":K=!1,i=!0,ve=G;break;case"S":s=!0,ve="N"}return ve},B=function(b,E,T){var J=b.split("");return T&&x(J,T,{hiLevel:G}),J.reverse(),E&&E.reverse(),J.join("")},x=function(b,E,T){var J,fe,ye,_e,ce,ve=-1,Oe=b.length,xe=0,O=[],H=G?p:y,Y=[];for(K=!1,i=!1,s=!1,fe=0;fe<Oe;fe++)Y[fe]=W(b[fe]);for(ye=0;ye<Oe;ye++){if(ce=xe,O[ye]=de(b,Y,O,ye),J=240&(xe=H[ce][S[O[ye]]]),xe&=15,E[ye]=_e=H[xe][5],J>0)if(J===16){for(fe=ve;fe<ye;fe++)E[fe]=1;ve=-1}else ve=-1;if(H[xe][6])ve===-1&&(ve=ye);else if(ve>-1){for(fe=ve;fe<ye;fe++)E[fe]=_e;ve=-1}Y[ye]==="B"&&(E[ye]=0),T.hiLevel|=_e}s&&(function(X,te,ae){for(var ge=0;ge<ae;ge++)if(X[ge]==="S"){te[ge]=G;for(var me=ge-1;me>=0&&X[me]==="WS";me--)te[me]=G}})(Y,E,Oe)},A=function(b,E,T,J,fe){if(!(fe.hiLevel<b)){if(b===1&&G===1&&!i)return E.reverse(),void(T&&T.reverse());for(var ye,_e,ce,ve,Oe=E.length,xe=0;xe<Oe;){if(J[xe]>=b){for(ce=xe+1;ce<Oe&&J[ce]>=b;)ce++;for(ve=xe,_e=ce-1;ve<_e;ve++,_e--)ye=E[ve],E[ve]=E[_e],E[_e]=ye,T&&(ye=T[ve],T[ve]=T[_e],T[_e]=ye);xe=ce}xe++}}},F=function(b,E,T){var J=b.split(""),fe={hiLevel:G};return T||(T=[]),x(J,T,fe),(function(ye,_e,ce){if(ce.hiLevel!==0&&d)for(var ve,Oe=0;Oe<ye.length;Oe++)_e[Oe]===1&&(ve=C.indexOf(ye[Oe]))>=0&&(ye[Oe]=C[ve+1])})(J,T,fe),A(2,J,E,T,fe),A(1,J,E,T,fe),J.join("")};return this.__bidiEngine__.doBidiReorder=function(b,E,T){if((function(fe,ye){if(ye)for(var _e=0;_e<fe.length;_e++)ye[_e]=_e;a===void 0&&(a=ne(fe)),u===void 0&&(u=ne(fe))})(b,E),o||!c||u)if(o&&c&&a^u)G=a?1:0,b=B(b,E,T);else if(!o&&c&&u)G=a?1:0,b=F(b,E,T),b=B(b,E);else if(!o||a||c||u){if(o&&!c&&a^u)b=B(b,E),a?(G=0,b=F(b,E,T)):(G=1,b=F(b,E,T),b=B(b,E));else if(o&&a&&!c&&u)G=1,b=F(b,E,T),b=B(b,E);else if(!o&&!c&&a^u){var J=d;a?(G=1,b=F(b,E,T),G=0,d=!1,b=F(b,E,T),d=J):(G=0,b=F(b,E,T),b=B(b,E),G=1,d=!1,b=F(b,E,T),d=J,b=B(b,E))}}else G=0,b=F(b,E,T);else G=a?1:0,b=F(b,E,T);return b},this.__bidiEngine__.setOptions=function(b){b&&(o=b.isInputVisual,c=b.isOutputVisual,a=b.isInputRtl,u=b.isOutputRtl,d=b.isSymmetricSwapping)},this.__bidiEngine__.setOptions(r),this.__bidiEngine__};var e=["BN","BN","BN","BN","BN","BN","BN","BN","BN","S","B","S","WS","B","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","B","B","B","S","WS","N","N","ET","ET","ET","N","N","N","N","N","ES","CS","ES","CS","CS","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","CS","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","BN","BN","BN","BN","BN","BN","B","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","CS","N","ET","ET","ET","ET","N","N","N","N","L","N","N","BN","N","N","ET","ET","EN","EN","N","L","N","N","N","EN","L","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","N","N","N","N","N","ET","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","R","NSM","R","NSM","NSM","R","NSM","NSM","R","NSM","N","N","N","N","N","N","N","N","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","N","N","N","N","N","R","R","R","R","R","N","N","N","N","N","N","N","N","N","N","N","AN","AN","AN","AN","AN","AN","N","N","AL","ET","ET","AL","CS","AL","N","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AL","AL","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AN","AN","AN","AN","AN","AN","AN","AN","AN","AN","ET","AN","AN","AL","AL","AL","NSM","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AN","N","NSM","NSM","NSM","NSM","NSM","NSM","AL","AL","NSM","NSM","N","NSM","NSM","NSM","NSM","AL","AL","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","N","AL","AL","NSM","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AL","N","N","N","N","N","N","N","N","N","N","N","N","N","N","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","R","R","N","N","N","N","R","N","N","N","N","N","WS","WS","WS","WS","WS","WS","WS","WS","WS","WS","WS","BN","BN","BN","L","R","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","WS","B","LRE","RLE","PDF","LRO","RLO","CS","ET","ET","ET","ET","ET","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","CS","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","WS","BN","BN","BN","BN","BN","N","LRI","RLI","FSI","PDI","BN","BN","BN","BN","BN","BN","EN","L","N","N","EN","EN","EN","EN","EN","EN","ES","ES","N","N","N","L","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","ES","ES","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","L","L","L","L","L","L","L","N","N","N","N","N","N","N","N","N","N","N","N","L","L","L","L","L","N","N","N","N","N","R","NSM","R","R","R","R","R","R","R","R","R","R","ES","R","R","R","R","R","R","R","R","R","R","R","R","R","N","R","R","R","R","R","N","R","N","R","R","N","R","R","N","R","R","R","R","R","R","R","R","R","R","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","CS","N","CS","N","N","CS","N","N","N","N","N","N","N","N","N","ET","N","N","ES","ES","N","N","N","N","N","ET","ET","N","N","N","N","N","AL","AL","AL","AL","AL","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","N","N","BN","N","N","N","ET","ET","ET","N","N","N","N","N","ES","CS","ES","CS","CS","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","CS","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","N","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","L","L","L","L","L","L","N","N","L","L","L","L","L","L","N","N","L","L","L","L","L","L","N","N","L","L","L","N","N","N","ET","ET","N","N","N","ET","ET","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N"],t=new n.__bidiEngine__({isInputVisual:!0});n.API.events.push(["postProcessText",function(r){var i=r.text;r.x,r.y;var s=r.options||{};r.mutex,s.lang;var o=[];if(s.isInputVisual=typeof s.isInputVisual!="boolean"||s.isInputVisual,t.setOptions(s),Object.prototype.toString.call(i)==="[object Array]"){var a=0;for(o=[],a=0;a<i.length;a+=1)Object.prototype.toString.call(i[a])==="[object Array]"?o.push([t.doBidiReorder(i[a][0]),i[a][1],i[a][2]]):o.push([t.doBidiReorder(i[a])]);r.text=o}else r.text=t.doBidiReorder(i);t.setOptions({isInputVisual:!0})}])})(rt),rt.API.TTFFont=(function(){function n(e){var t;if(this.rawData=e,t=this.contents=new Sa(e),this.contents.pos=4,t.readString(4)==="ttcf")throw new Error("TTCF not supported.");t.pos=0,this.parse(),this.subset=new z8(this),this.registerTTF()}return n.open=function(e){return new n(e)},n.prototype.parse=function(){return this.directory=new R8(this.contents),this.head=new k8(this),this.name=new F8(this),this.cmap=new _E(this),this.toUnicode={},this.hhea=new C8(this),this.maxp=new M8(this),this.hmtx=new V8(this),this.post=new D8(this),this.os2=new L8(this),this.loca=new q8(this),this.glyf=new B8(this),this.ascender=this.os2.exists&&this.os2.ascender||this.hhea.ascender,this.decender=this.os2.exists&&this.os2.decender||this.hhea.decender,this.lineGap=this.os2.exists&&this.os2.lineGap||this.hhea.lineGap,this.bbox=[this.head.xMin,this.head.yMin,this.head.xMax,this.head.yMax]},n.prototype.registerTTF=function(){var e,t,r,i,s;if(this.scaleFactor=1e3/this.head.unitsPerEm,this.bbox=(function(){var o,a,c,u;for(u=[],o=0,a=(c=this.bbox).length;o<a;o++)e=c[o],u.push(Math.round(e*this.scaleFactor));return u}).call(this),this.stemV=0,this.post.exists?(r=255&(i=this.post.italic_angle),32768&(t=i>>16)&&(t=-(1+(65535^t))),this.italicAngle=+(t+"."+r)):this.italicAngle=0,this.ascender=Math.round(this.ascender*this.scaleFactor),this.decender=Math.round(this.decender*this.scaleFactor),this.lineGap=Math.round(this.lineGap*this.scaleFactor),this.capHeight=this.os2.exists&&this.os2.capHeight||this.ascender,this.xHeight=this.os2.exists&&this.os2.xHeight||0,this.familyClass=(this.os2.exists&&this.os2.familyClass||0)>>8,this.isSerif=(s=this.familyClass)===1||s===2||s===3||s===4||s===5||s===7,this.isScript=this.familyClass===10,this.flags=0,this.post.isFixedPitch&&(this.flags|=1),this.isSerif&&(this.flags|=2),this.isScript&&(this.flags|=8),this.italicAngle!==0&&(this.flags|=64),this.flags|=32,!this.cmap.unicode)throw new Error("No unicode cmap for font")},n.prototype.characterToGlyph=function(e){var t;return((t=this.cmap.unicode)!=null?t.codeMap[e]:void 0)||0},n.prototype.widthOfGlyph=function(e){var t;return t=1e3/this.head.unitsPerEm,this.hmtx.forGlyph(e).advance*t},n.prototype.widthOfString=function(e,t,r){var i,s,o,a;for(o=0,s=0,a=(e=""+e).length;0<=a?s<a:s>a;s=0<=a?++s:--s)i=e.charCodeAt(s),o+=this.widthOfGlyph(this.characterToGlyph(i))+r*(1e3/t)||0;return o*(t/1e3)},n.prototype.lineHeight=function(e,t){var r;return t==null&&(t=!1),r=t?this.lineGap:0,(this.ascender+r-this.decender)/1e3*e},n})();var ps,Sa=(function(){function n(e){this.data=e??[],this.pos=0,this.length=this.data.length}return n.prototype.readByte=function(){return this.data[this.pos++]},n.prototype.writeByte=function(e){return this.data[this.pos++]=e},n.prototype.readUInt32=function(){return 16777216*this.readByte()+(this.readByte()<<16)+(this.readByte()<<8)+this.readByte()},n.prototype.writeUInt32=function(e){return this.writeByte(e>>>24&255),this.writeByte(e>>16&255),this.writeByte(e>>8&255),this.writeByte(255&e)},n.prototype.readInt32=function(){var e;return(e=this.readUInt32())>=2147483648?e-4294967296:e},n.prototype.writeInt32=function(e){return e<0&&(e+=4294967296),this.writeUInt32(e)},n.prototype.readUInt16=function(){return this.readByte()<<8|this.readByte()},n.prototype.writeUInt16=function(e){return this.writeByte(e>>8&255),this.writeByte(255&e)},n.prototype.readInt16=function(){var e;return(e=this.readUInt16())>=32768?e-65536:e},n.prototype.writeInt16=function(e){return e<0&&(e+=65536),this.writeUInt16(e)},n.prototype.readString=function(e){var t,r;for(r=[],t=0;0<=e?t<e:t>e;t=0<=e?++t:--t)r[t]=String.fromCharCode(this.readByte());return r.join("")},n.prototype.writeString=function(e){var t,r,i;for(i=[],t=0,r=e.length;0<=r?t<r:t>r;t=0<=r?++t:--t)i.push(this.writeByte(e.charCodeAt(t)));return i},n.prototype.readShort=function(){return this.readInt16()},n.prototype.writeShort=function(e){return this.writeInt16(e)},n.prototype.readLongLong=function(){var e,t,r,i,s,o,a,c;return e=this.readByte(),t=this.readByte(),r=this.readByte(),i=this.readByte(),s=this.readByte(),o=this.readByte(),a=this.readByte(),c=this.readByte(),128&e?-1*(72057594037927940*(255^e)+281474976710656*(255^t)+1099511627776*(255^r)+4294967296*(255^i)+16777216*(255^s)+65536*(255^o)+256*(255^a)+(255^c)+1):72057594037927940*e+281474976710656*t+1099511627776*r+4294967296*i+16777216*s+65536*o+256*a+c},n.prototype.writeLongLong=function(e){var t,r;return t=Math.floor(e/4294967296),r=4294967295&e,this.writeByte(t>>24&255),this.writeByte(t>>16&255),this.writeByte(t>>8&255),this.writeByte(255&t),this.writeByte(r>>24&255),this.writeByte(r>>16&255),this.writeByte(r>>8&255),this.writeByte(255&r)},n.prototype.readInt=function(){return this.readInt32()},n.prototype.writeInt=function(e){return this.writeInt32(e)},n.prototype.read=function(e){var t,r;for(t=[],r=0;0<=e?r<e:r>e;r=0<=e?++r:--r)t.push(this.readByte());return t},n.prototype.write=function(e){var t,r,i,s;for(s=[],r=0,i=e.length;r<i;r++)t=e[r],s.push(this.writeByte(t));return s},n})(),R8=(function(){var n;function e(t){var r,i,s;for(this.scalarType=t.readInt(),this.tableCount=t.readShort(),this.searchRange=t.readShort(),this.entrySelector=t.readShort(),this.rangeShift=t.readShort(),this.tables={},i=0,s=this.tableCount;0<=s?i<s:i>s;i=0<=s?++i:--i)r={tag:t.readString(4),checksum:t.readInt(),offset:t.readInt(),length:t.readInt()},this.tables[r.tag]=r}return e.prototype.encode=function(t){var r,i,s,o,a,c,u,d,g,y,p,S,N;for(N in p=Object.keys(t).length,c=Math.log(2),g=16*Math.floor(Math.log(p)/c),o=Math.floor(g/c),d=16*p-g,(i=new Sa).writeInt(this.scalarType),i.writeShort(p),i.writeShort(g),i.writeShort(o),i.writeShort(d),s=16*p,u=i.pos+s,a=null,S=[],t)for(y=t[N],i.writeString(N),i.writeInt(n(y)),i.writeInt(u),i.writeInt(y.length),S=S.concat(y),N==="head"&&(a=u),u+=y.length;u%4;)S.push(0),u++;return i.write(S),r=2981146554-n(i.data),i.pos=a+8,i.writeUInt32(r),i.data},n=function(t){var r,i,s,o;for(t=vE.call(t);t.length%4;)t.push(0);for(s=new Sa(t),i=0,r=0,o=t.length;r<o;r=r+=4)i+=s.readUInt32();return 4294967295&i},e})(),N8={}.hasOwnProperty,Ks=function(n,e){for(var t in e)N8.call(e,t)&&(n[t]=e[t]);function r(){this.constructor=n}return r.prototype=e.prototype,n.prototype=new r,n.__super__=e.prototype,n};ps=(function(){function n(e){var t;this.file=e,t=this.file.directory.tables[this.tag],this.exists=!!t,t&&(this.offset=t.offset,this.length=t.length,this.parse(this.file.contents))}return n.prototype.parse=function(){},n.prototype.encode=function(){},n.prototype.raw=function(){return this.exists?(this.file.contents.pos=this.offset,this.file.contents.read(this.length)):null},n})();var k8=(function(){function n(){return n.__super__.constructor.apply(this,arguments)}return Ks(n,ps),n.prototype.tag="head",n.prototype.parse=function(e){return e.pos=this.offset,this.version=e.readInt(),this.revision=e.readInt(),this.checkSumAdjustment=e.readInt(),this.magicNumber=e.readInt(),this.flags=e.readShort(),this.unitsPerEm=e.readShort(),this.created=e.readLongLong(),this.modified=e.readLongLong(),this.xMin=e.readShort(),this.yMin=e.readShort(),this.xMax=e.readShort(),this.yMax=e.readShort(),this.macStyle=e.readShort(),this.lowestRecPPEM=e.readShort(),this.fontDirectionHint=e.readShort(),this.indexToLocFormat=e.readShort(),this.glyphDataFormat=e.readShort()},n.prototype.encode=function(e){var t;return(t=new Sa).writeInt(this.version),t.writeInt(this.revision),t.writeInt(this.checkSumAdjustment),t.writeInt(this.magicNumber),t.writeShort(this.flags),t.writeShort(this.unitsPerEm),t.writeLongLong(this.created),t.writeLongLong(this.modified),t.writeShort(this.xMin),t.writeShort(this.yMin),t.writeShort(this.xMax),t.writeShort(this.yMax),t.writeShort(this.macStyle),t.writeShort(this.lowestRecPPEM),t.writeShort(this.fontDirectionHint),t.writeShort(e),t.writeShort(this.glyphDataFormat),t.data},n})(),e5=(function(){function n(e,t){var r,i,s,o,a,c,u,d,g,y,p,S,N,C,k,K,G;switch(this.platformID=e.readUInt16(),this.encodingID=e.readShort(),this.offset=t+e.readInt(),g=e.pos,e.pos=this.offset,this.format=e.readUInt16(),this.length=e.readUInt16(),this.language=e.readUInt16(),this.isUnicode=this.platformID===3&&this.encodingID===1&&this.format===4||this.platformID===0&&this.format===4,this.codeMap={},this.format){case 0:for(c=0;c<256;++c)this.codeMap[c]=e.readByte();break;case 4:for(p=e.readUInt16(),y=p/2,e.pos+=6,s=(function(){var W,ne;for(ne=[],c=W=0;0<=y?W<y:W>y;c=0<=y?++W:--W)ne.push(e.readUInt16());return ne})(),e.pos+=2,N=(function(){var W,ne;for(ne=[],c=W=0;0<=y?W<y:W>y;c=0<=y?++W:--W)ne.push(e.readUInt16());return ne})(),u=(function(){var W,ne;for(ne=[],c=W=0;0<=y?W<y:W>y;c=0<=y?++W:--W)ne.push(e.readUInt16());return ne})(),d=(function(){var W,ne;for(ne=[],c=W=0;0<=y?W<y:W>y;c=0<=y?++W:--W)ne.push(e.readUInt16());return ne})(),i=(this.length-e.pos+this.offset)/2,a=(function(){var W,ne;for(ne=[],c=W=0;0<=i?W<i:W>i;c=0<=i?++W:--W)ne.push(e.readUInt16());return ne})(),c=k=0,G=s.length;k<G;c=++k)for(C=s[c],r=K=S=N[c];S<=C?K<=C:K>=C;r=S<=C?++K:--K)d[c]===0?o=r+u[c]:(o=a[d[c]/2+(r-S)-(y-c)]||0)!==0&&(o+=u[c]),this.codeMap[r]=65535&o}e.pos=g}return n.encode=function(e,t){var r,i,s,o,a,c,u,d,g,y,p,S,N,C,k,K,G,W,ne,de,B,x,A,F,b,E,T,J,fe,ye,_e,ce,ve,Oe,xe,O,H,Y,X,te,ae,ge,me,Ee,Le,je;switch(J=new Sa,o=Object.keys(e).sort(function(Ue,tt){return Ue-tt}),t){case"macroman":for(N=0,C=(function(){var Ue=[];for(S=0;S<256;++S)Ue.push(0);return Ue})(),K={0:0},s={},fe=0,ve=o.length;fe<ve;fe++)K[me=e[i=o[fe]]]==null&&(K[me]=++N),s[i]={old:e[i],new:K[e[i]]},C[i]=K[e[i]];return J.writeUInt16(1),J.writeUInt16(0),J.writeUInt32(12),J.writeUInt16(0),J.writeUInt16(262),J.writeUInt16(0),J.write(C),{charMap:s,subtable:J.data,maxGlyphID:N+1};case"unicode":for(E=[],g=[],G=0,K={},r={},k=u=null,ye=0,Oe=o.length;ye<Oe;ye++)K[ne=e[i=o[ye]]]==null&&(K[ne]=++G),r[i]={old:ne,new:K[ne]},a=K[ne]-i,k!=null&&a===u||(k&&g.push(k),E.push(i),u=a),k=i;for(k&&g.push(k),g.push(65535),E.push(65535),F=2*(A=E.length),x=2*Math.pow(Math.log(A)/Math.LN2,2),y=Math.log(x/2)/Math.LN2,B=2*A-x,c=[],de=[],p=[],S=_e=0,xe=E.length;_e<xe;S=++_e){if(b=E[S],d=g[S],b===65535){c.push(0),de.push(0);break}if(b-(T=r[b].new)>=32768)for(c.push(0),de.push(2*(p.length+A-S)),i=ce=b;b<=d?ce<=d:ce>=d;i=b<=d?++ce:--ce)p.push(r[i].new);else c.push(T-b),de.push(0)}for(J.writeUInt16(3),J.writeUInt16(1),J.writeUInt32(12),J.writeUInt16(4),J.writeUInt16(16+8*A+2*p.length),J.writeUInt16(0),J.writeUInt16(F),J.writeUInt16(x),J.writeUInt16(y),J.writeUInt16(B),ae=0,O=g.length;ae<O;ae++)i=g[ae],J.writeUInt16(i);for(J.writeUInt16(0),ge=0,H=E.length;ge<H;ge++)i=E[ge],J.writeUInt16(i);for(Ee=0,Y=c.length;Ee<Y;Ee++)a=c[Ee],J.writeUInt16(a);for(Le=0,X=de.length;Le<X;Le++)W=de[Le],J.writeUInt16(W);for(je=0,te=p.length;je<te;je++)N=p[je],J.writeUInt16(N);return{charMap:r,subtable:J.data,maxGlyphID:G+1}}},n})(),_E=(function(){function n(){return n.__super__.constructor.apply(this,arguments)}return Ks(n,ps),n.prototype.tag="cmap",n.prototype.parse=function(e){var t,r,i;for(e.pos=this.offset,this.version=e.readUInt16(),i=e.readUInt16(),this.tables=[],this.unicode=null,r=0;0<=i?r<i:r>i;r=0<=i?++r:--r)t=new e5(e,this.offset),this.tables.push(t),t.isUnicode&&this.unicode==null&&(this.unicode=t);return!0},n.encode=function(e,t){var r,i;return t==null&&(t="macroman"),r=e5.encode(e,t),(i=new Sa).writeUInt16(0),i.writeUInt16(1),r.table=i.data.concat(r.subtable),r},n})(),C8=(function(){function n(){return n.__super__.constructor.apply(this,arguments)}return Ks(n,ps),n.prototype.tag="hhea",n.prototype.parse=function(e){return e.pos=this.offset,this.version=e.readInt(),this.ascender=e.readShort(),this.decender=e.readShort(),this.lineGap=e.readShort(),this.advanceWidthMax=e.readShort(),this.minLeftSideBearing=e.readShort(),this.minRightSideBearing=e.readShort(),this.xMaxExtent=e.readShort(),this.caretSlopeRise=e.readShort(),this.caretSlopeRun=e.readShort(),this.caretOffset=e.readShort(),e.pos+=8,this.metricDataFormat=e.readShort(),this.numberOfMetrics=e.readUInt16()},n})(),L8=(function(){function n(){return n.__super__.constructor.apply(this,arguments)}return Ks(n,ps),n.prototype.tag="OS/2",n.prototype.parse=function(e){if(e.pos=this.offset,this.version=e.readUInt16(),this.averageCharWidth=e.readShort(),this.weightClass=e.readUInt16(),this.widthClass=e.readUInt16(),this.type=e.readShort(),this.ySubscriptXSize=e.readShort(),this.ySubscriptYSize=e.readShort(),this.ySubscriptXOffset=e.readShort(),this.ySubscriptYOffset=e.readShort(),this.ySuperscriptXSize=e.readShort(),this.ySuperscriptYSize=e.readShort(),this.ySuperscriptXOffset=e.readShort(),this.ySuperscriptYOffset=e.readShort(),this.yStrikeoutSize=e.readShort(),this.yStrikeoutPosition=e.readShort(),this.familyClass=e.readShort(),this.panose=(function(){var t,r;for(r=[],t=0;t<10;++t)r.push(e.readByte());return r})(),this.charRange=(function(){var t,r;for(r=[],t=0;t<4;++t)r.push(e.readInt());return r})(),this.vendorID=e.readString(4),this.selection=e.readShort(),this.firstCharIndex=e.readShort(),this.lastCharIndex=e.readShort(),this.version>0&&(this.ascent=e.readShort(),this.descent=e.readShort(),this.lineGap=e.readShort(),this.winAscent=e.readShort(),this.winDescent=e.readShort(),this.codePageRange=(function(){var t,r;for(r=[],t=0;t<2;t=++t)r.push(e.readInt());return r})(),this.version>1))return this.xHeight=e.readShort(),this.capHeight=e.readShort(),this.defaultChar=e.readShort(),this.breakChar=e.readShort(),this.maxContext=e.readShort()},n})(),D8=(function(){function n(){return n.__super__.constructor.apply(this,arguments)}return Ks(n,ps),n.prototype.tag="post",n.prototype.parse=function(e){var t,r,i;switch(e.pos=this.offset,this.format=e.readInt(),this.italicAngle=e.readInt(),this.underlinePosition=e.readShort(),this.underlineThickness=e.readShort(),this.isFixedPitch=e.readInt(),this.minMemType42=e.readInt(),this.maxMemType42=e.readInt(),this.minMemType1=e.readInt(),this.maxMemType1=e.readInt(),this.format){case 65536:case 196608:break;case 131072:var s;for(r=e.readUInt16(),this.glyphNameIndex=[],s=0;0<=r?s<r:s>r;s=0<=r?++s:--s)this.glyphNameIndex.push(e.readUInt16());for(this.names=[],i=[];e.pos<this.offset+this.length;)t=e.readByte(),i.push(this.names.push(e.readString(t)));return i;case 151552:return r=e.readUInt16(),this.offsets=e.read(r);case 262144:return this.map=(function(){var o,a,c;for(c=[],s=o=0,a=this.file.maxp.numGlyphs;0<=a?o<a:o>a;s=0<=a?++o:--o)c.push(e.readUInt32());return c}).call(this)}},n})(),O8=function(n,e){this.raw=n,this.length=n.length,this.platformID=e.platformID,this.encodingID=e.encodingID,this.languageID=e.languageID},F8=(function(){function n(){return n.__super__.constructor.apply(this,arguments)}return Ks(n,ps),n.prototype.tag="name",n.prototype.parse=function(e){var t,r,i,s,o,a,c,u,d,g,y;for(e.pos=this.offset,e.readShort(),t=e.readShort(),a=e.readShort(),r=[],s=0;0<=t?s<t:s>t;s=0<=t?++s:--s)r.push({platformID:e.readShort(),encodingID:e.readShort(),languageID:e.readShort(),nameID:e.readShort(),length:e.readShort(),offset:this.offset+a+e.readShort()});for(c={},s=d=0,g=r.length;d<g;s=++d)i=r[s],e.pos=i.offset,u=e.readString(i.length),o=new O8(u,i),c[y=i.nameID]==null&&(c[y]=[]),c[i.nameID].push(o);this.strings=c,this.copyright=c[0],this.fontFamily=c[1],this.fontSubfamily=c[2],this.uniqueSubfamily=c[3],this.fontName=c[4],this.version=c[5];try{this.postscriptName=c[6][0].raw.replace(/[\x00-\x19\x80-\xff]/g,"")}catch{this.postscriptName=c[4][0].raw.replace(/[\x00-\x19\x80-\xff]/g,"")}return this.trademark=c[7],this.manufacturer=c[8],this.designer=c[9],this.description=c[10],this.vendorUrl=c[11],this.designerUrl=c[12],this.license=c[13],this.licenseUrl=c[14],this.preferredFamily=c[15],this.preferredSubfamily=c[17],this.compatibleFull=c[18],this.sampleText=c[19]},n})(),M8=(function(){function n(){return n.__super__.constructor.apply(this,arguments)}return Ks(n,ps),n.prototype.tag="maxp",n.prototype.parse=function(e){return e.pos=this.offset,this.version=e.readInt(),this.numGlyphs=e.readUInt16(),this.maxPoints=e.readUInt16(),this.maxContours=e.readUInt16(),this.maxCompositePoints=e.readUInt16(),this.maxComponentContours=e.readUInt16(),this.maxZones=e.readUInt16(),this.maxTwilightPoints=e.readUInt16(),this.maxStorage=e.readUInt16(),this.maxFunctionDefs=e.readUInt16(),this.maxInstructionDefs=e.readUInt16(),this.maxStackElements=e.readUInt16(),this.maxSizeOfInstructions=e.readUInt16(),this.maxComponentElements=e.readUInt16(),this.maxComponentDepth=e.readUInt16()},n})(),V8=(function(){function n(){return n.__super__.constructor.apply(this,arguments)}return Ks(n,ps),n.prototype.tag="hmtx",n.prototype.parse=function(e){var t,r,i,s,o,a,c;for(e.pos=this.offset,this.metrics=[],t=0,a=this.file.hhea.numberOfMetrics;0<=a?t<a:t>a;t=0<=a?++t:--t)this.metrics.push({advance:e.readUInt16(),lsb:e.readInt16()});for(i=this.file.maxp.numGlyphs-this.file.hhea.numberOfMetrics,this.leftSideBearings=(function(){var u,d;for(d=[],t=u=0;0<=i?u<i:u>i;t=0<=i?++u:--u)d.push(e.readInt16());return d})(),this.widths=(function(){var u,d,g,y;for(y=[],u=0,d=(g=this.metrics).length;u<d;u++)s=g[u],y.push(s.advance);return y}).call(this),r=this.widths[this.widths.length-1],c=[],t=o=0;0<=i?o<i:o>i;t=0<=i?++o:--o)c.push(this.widths.push(r));return c},n.prototype.forGlyph=function(e){return e in this.metrics?this.metrics[e]:{advance:this.metrics[this.metrics.length-1].advance,lsb:this.leftSideBearings[e-this.metrics.length]}},n})(),vE=[].slice,B8=(function(){function n(){return n.__super__.constructor.apply(this,arguments)}return Ks(n,ps),n.prototype.tag="glyf",n.prototype.parse=function(){return this.cache={}},n.prototype.glyphFor=function(e){var t,r,i,s,o,a,c,u,d,g;return e in this.cache?this.cache[e]:(s=this.file.loca,t=this.file.contents,r=s.indexOf(e),(i=s.lengthOf(e))===0?this.cache[e]=null:(t.pos=this.offset+r,o=(a=new Sa(t.read(i))).readShort(),u=a.readShort(),g=a.readShort(),c=a.readShort(),d=a.readShort(),this.cache[e]=o===-1?new j8(a,u,g,c,d):new U8(a,o,u,g,c,d),this.cache[e]))},n.prototype.encode=function(e,t,r){var i,s,o,a,c;for(o=[],s=[],a=0,c=t.length;a<c;a++)i=e[t[a]],s.push(o.length),i&&(o=o.concat(i.encode(r)));return s.push(o.length),{table:o,offsets:s}},n})(),U8=(function(){function n(e,t,r,i,s,o){this.raw=e,this.numberOfContours=t,this.xMin=r,this.yMin=i,this.xMax=s,this.yMax=o,this.compound=!1}return n.prototype.encode=function(){return this.raw.data},n})(),j8=(function(){function n(e,t,r,i,s){var o,a;for(this.raw=e,this.xMin=t,this.yMin=r,this.xMax=i,this.yMax=s,this.compound=!0,this.glyphIDs=[],this.glyphOffsets=[],o=this.raw;a=o.readShort(),this.glyphOffsets.push(o.pos),this.glyphIDs.push(o.readUInt16()),32&a;)o.pos+=1&a?4:2,128&a?o.pos+=8:64&a?o.pos+=4:8&a&&(o.pos+=2)}return n.prototype.encode=function(){var e,t,r;for(t=new Sa(vE.call(this.raw.data)),e=0,r=this.glyphIDs.length;e<r;++e)t.pos=this.glyphOffsets[e];return t.data},n})(),q8=(function(){function n(){return n.__super__.constructor.apply(this,arguments)}return Ks(n,ps),n.prototype.tag="loca",n.prototype.parse=function(e){var t,r;return e.pos=this.offset,t=this.file.head.indexToLocFormat,this.offsets=t===0?(function(){var i,s;for(s=[],r=0,i=this.length;r<i;r+=2)s.push(2*e.readUInt16());return s}).call(this):(function(){var i,s;for(s=[],r=0,i=this.length;r<i;r+=4)s.push(e.readUInt32());return s}).call(this)},n.prototype.indexOf=function(e){return this.offsets[e]},n.prototype.lengthOf=function(e){return this.offsets[e+1]-this.offsets[e]},n.prototype.encode=function(e,t){for(var r=new Uint32Array(this.offsets.length),i=0,s=0,o=0;o<r.length;++o)if(r[o]=i,s<t.length&&t[s]==o){++s,r[o]=i;var a=this.offsets[o],c=this.offsets[o+1]-a;c>0&&(i+=c)}for(var u=new Array(4*r.length),d=0;d<r.length;++d)u[4*d+3]=255&r[d],u[4*d+2]=(65280&r[d])>>8,u[4*d+1]=(16711680&r[d])>>16,u[4*d]=(4278190080&r[d])>>24;return u},n})(),z8=(function(){function n(e){this.font=e,this.subset={},this.unicodes={},this.next=33}return n.prototype.generateCmap=function(){var e,t,r,i,s;for(t in i=this.font.cmap.tables[0].codeMap,e={},s=this.subset)r=s[t],e[t]=i[r];return e},n.prototype.glyphsFor=function(e){var t,r,i,s,o,a,c;for(i={},o=0,a=e.length;o<a;o++)i[s=e[o]]=this.font.glyf.glyphFor(s);for(s in t=[],i)(r=i[s])!=null&&r.compound&&t.push.apply(t,r.glyphIDs);if(t.length>0)for(s in c=this.glyphsFor(t))r=c[s],i[s]=r;return i},n.prototype.encode=function(e,t){var r,i,s,o,a,c,u,d,g,y,p,S,N,C,k;for(i in r=_E.encode(this.generateCmap(),"unicode"),o=this.glyphsFor(e),p={0:0},k=r.charMap)p[(c=k[i]).old]=c.new;for(S in y=r.maxGlyphID,o)S in p||(p[S]=y++);return d=(function(K){var G,W;for(G in W={},K)W[K[G]]=G;return W})(p),g=Object.keys(d).sort(function(K,G){return K-G}),N=(function(){var K,G,W;for(W=[],K=0,G=g.length;K<G;K++)a=g[K],W.push(d[a]);return W})(),s=this.font.glyf.encode(o,N,p),u=this.font.loca.encode(s.offsets,N),C={cmap:this.font.cmap.raw(),glyf:s.table,loca:u,hmtx:this.font.hmtx.raw(),hhea:this.font.hhea.raw(),maxp:this.font.maxp.raw(),post:this.font.post.raw(),name:this.font.name.raw(),head:this.font.head.encode(t)},this.font.os2.exists&&(C["OS/2"]=this.font.os2.raw()),this.font.directory.encode(C)},n})();rt.API.PDFObject=(function(){var n;function e(){}return n=function(t,r){return(Array(r+1).join("0")+t).slice(-r)},e.convert=function(t){var r,i,s,o;if(Array.isArray(t))return"["+(function(){var a,c,u;for(u=[],a=0,c=t.length;a<c;a++)r=t[a],u.push(e.convert(r));return u})().join(" ")+"]";if(typeof t=="string")return"/"+t;if(t?.isString)return"("+t+")";if(t instanceof Date)return"(D:"+n(t.getUTCFullYear(),4)+n(t.getUTCMonth(),2)+n(t.getUTCDate(),2)+n(t.getUTCHours(),2)+n(t.getUTCMinutes(),2)+n(t.getUTCSeconds(),2)+"Z)";if({}.toString.call(t)==="[object Object]"){for(i in s=["<<"],t)o=t[i],s.push("/"+i+" "+e.convert(o));return s.push(">>"),s.join(`
`)}return""+t},e})();function wE(n,e,t,r,i){r=r||{};var s=1.15,o=i.internal.scaleFactor,a=i.internal.getFontSize()/o,c=i.getLineHeightFactor?i.getLineHeightFactor():s,u=a*c,d=/\r\n|\r|\n/g,g="",y=1;if((r.valign==="middle"||r.valign==="bottom"||r.halign==="center"||r.halign==="right")&&(g=typeof n=="string"?n.split(d):n,y=g.length||1),t+=a*(2-s),r.valign==="middle"?t-=y/2*u:r.valign==="bottom"&&(t-=y*u),r.halign==="center"||r.halign==="right"){var p=a;if(r.halign==="center"&&(p*=.5),g&&y>=1){for(var S=0;S<g.length;S++)i.text(g[S],e-i.getStringUnitWidth(g[S])*p,t),t+=u;return i}e-=i.getStringUnitWidth(n)*p}return r.halign==="justify"?i.text(n,e,t,{maxWidth:r.maxWidth||100,align:"justify"}):i.text(n,e,t),i}var t5={},xu=(function(){function n(e){this.jsPDFDocument=e,this.userStyles={textColor:e.getTextColor?this.jsPDFDocument.getTextColor():0,fontSize:e.internal.getFontSize(),fontStyle:e.internal.getFont().fontStyle,font:e.internal.getFont().fontName,lineWidth:e.getLineWidth?this.jsPDFDocument.getLineWidth():0,lineColor:e.getDrawColor?this.jsPDFDocument.getDrawColor():0}}return n.setDefaults=function(e,t){t===void 0&&(t=null),t?t.__autoTableDocumentDefaults=e:t5=e},n.unifyColor=function(e){return Array.isArray(e)?e:typeof e=="number"?[e,e,e]:typeof e=="string"?[e]:null},n.prototype.applyStyles=function(e,t){var r,i,s;t===void 0&&(t=!1),e.fontStyle&&this.jsPDFDocument.setFontStyle&&this.jsPDFDocument.setFontStyle(e.fontStyle);var o=this.jsPDFDocument.internal.getFont(),a=o.fontStyle,c=o.fontName;if(e.font&&(c=e.font),e.fontStyle){a=e.fontStyle;var u=this.getFontList()[c];u&&u.indexOf(a)===-1&&this.jsPDFDocument.setFontStyle&&(this.jsPDFDocument.setFontStyle(u[0]),a=u[0])}if(this.jsPDFDocument.setFont(c,a),e.fontSize&&this.jsPDFDocument.setFontSize(e.fontSize),!t){var d=n.unifyColor(e.fillColor);d&&(r=this.jsPDFDocument).setFillColor.apply(r,d),d=n.unifyColor(e.textColor),d&&(i=this.jsPDFDocument).setTextColor.apply(i,d),d=n.unifyColor(e.lineColor),d&&(s=this.jsPDFDocument).setDrawColor.apply(s,d),typeof e.lineWidth=="number"&&this.jsPDFDocument.setLineWidth(e.lineWidth)}},n.prototype.splitTextToSize=function(e,t,r){return this.jsPDFDocument.splitTextToSize(e,t,r)},n.prototype.rect=function(e,t,r,i,s){return this.jsPDFDocument.rect(e,t,r,i,s)},n.prototype.getLastAutoTable=function(){return this.jsPDFDocument.lastAutoTable||null},n.prototype.getTextWidth=function(e){return this.jsPDFDocument.getTextWidth(e)},n.prototype.getDocument=function(){return this.jsPDFDocument},n.prototype.setPage=function(e){this.jsPDFDocument.setPage(e)},n.prototype.addPage=function(){return this.jsPDFDocument.addPage()},n.prototype.getFontList=function(){return this.jsPDFDocument.getFontList()},n.prototype.getGlobalOptions=function(){return t5||{}},n.prototype.getDocumentOptions=function(){return this.jsPDFDocument.__autoTableDocumentDefaults||{}},n.prototype.pageSize=function(){var e=this.jsPDFDocument.internal.pageSize;return e.width==null&&(e={width:e.getWidth(),height:e.getHeight()}),e},n.prototype.scaleFactor=function(){return this.jsPDFDocument.internal.scaleFactor},n.prototype.getLineHeightFactor=function(){var e=this.jsPDFDocument;return e.getLineHeightFactor?e.getLineHeightFactor():1.15},n.prototype.getLineHeight=function(e){return e/this.scaleFactor()*this.getLineHeightFactor()},n.prototype.pageNumber=function(){var e=this.jsPDFDocument.internal.getCurrentPageInfo();return e?e.pageNumber:this.jsPDFDocument.internal.getNumberOfPages()},n})(),Gm=function(n,e){return Gm=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,r){t.__proto__=r}||function(t,r){for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(t[i]=r[i])},Gm(n,e)};function bE(n,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");Gm(n,e);function t(){this.constructor=n}n.prototype=e===null?Object.create(e):(t.prototype=e.prototype,new t)}var IE=(function(n){bE(e,n);function e(t){var r=n.call(this)||this;return r._element=t,r}return e})(Array);function $8(n){return{font:"helvetica",fontStyle:"normal",overflow:"linebreak",fillColor:!1,textColor:20,halign:"left",valign:"top",fontSize:10,cellPadding:5/n,lineColor:200,lineWidth:0,cellWidth:"auto",minCellHeight:0,minCellWidth:0}}function W8(n){var e={striped:{table:{fillColor:255,textColor:80,fontStyle:"normal"},head:{textColor:255,fillColor:[41,128,185],fontStyle:"bold"},body:{},foot:{textColor:255,fillColor:[41,128,185],fontStyle:"bold"},alternateRow:{fillColor:245}},grid:{table:{fillColor:255,textColor:80,fontStyle:"normal",lineWidth:.1},head:{textColor:255,fillColor:[26,188,156],fontStyle:"bold",lineWidth:0},body:{},foot:{textColor:255,fillColor:[26,188,156],fontStyle:"bold",lineWidth:0},alternateRow:{}},plain:{head:{fontStyle:"bold"},foot:{fontStyle:"bold"}}};return e[n]}function Gf(n,e,t){t.applyStyles(e,!0);var r=Array.isArray(n)?n:[n],i=r.map(function(s){return t.getTextWidth(s)}).reduce(function(s,o){return Math.max(s,o)},0);return i}function AE(n,e,t,r){var i=e.settings.tableLineWidth,s=e.settings.tableLineColor;n.applyStyles({lineWidth:i,lineColor:s});var o=EE(i,!1);o&&n.rect(t.x,t.y,e.getWidth(n.pageSize().width),r.y-t.y,o)}function EE(n,e){var t=n>0,r=e||e===0;return t&&r?"DF":t?"S":r?"F":null}function Fp(n,e){var t,r,i,s;if(n=n||e,Array.isArray(n)){if(n.length>=4)return{top:n[0],right:n[1],bottom:n[2],left:n[3]};if(n.length===3)return{top:n[0],right:n[1],bottom:n[2],left:n[1]};if(n.length===2)return{top:n[0],right:n[1],bottom:n[0],left:n[1]};n.length===1?n=n[0]:n=e}return typeof n=="object"?(typeof n.vertical=="number"&&(n.top=n.vertical,n.bottom=n.vertical),typeof n.horizontal=="number"&&(n.right=n.horizontal,n.left=n.horizontal),{left:(t=n.left)!==null&&t!==void 0?t:e,top:(r=n.top)!==null&&r!==void 0?r:e,right:(i=n.right)!==null&&i!==void 0?i:e,bottom:(s=n.bottom)!==null&&s!==void 0?s:e}):(typeof n!="number"&&(n=e),{top:n,right:n,bottom:n,left:n})}function TE(n,e){var t=Fp(e.settings.margin,0);return n.pageSize().width-(t.left+t.right)}function H8(n,e,t,r,i){var s={},o=1.3333333333333333,a=Wg(e,function(G){return i.getComputedStyle(G).backgroundColor});a!=null&&(s.fillColor=a);var c=Wg(e,function(G){return i.getComputedStyle(G).color});c!=null&&(s.textColor=c);var u=K8(r,t);u&&(s.cellPadding=u);var d="borderTopColor",g=o*t,y=r.borderTopWidth;if(r.borderBottomWidth===y&&r.borderRightWidth===y&&r.borderLeftWidth===y){var p=(parseFloat(y)||0)/g;p&&(s.lineWidth=p)}else s.lineWidth={top:(parseFloat(r.borderTopWidth)||0)/g,right:(parseFloat(r.borderRightWidth)||0)/g,bottom:(parseFloat(r.borderBottomWidth)||0)/g,left:(parseFloat(r.borderLeftWidth)||0)/g},s.lineWidth.top||(s.lineWidth.right?d="borderRightColor":s.lineWidth.bottom?d="borderBottomColor":s.lineWidth.left&&(d="borderLeftColor"));var S=Wg(e,function(G){return i.getComputedStyle(G)[d]});S!=null&&(s.lineColor=S);var N=["left","right","center","justify"];N.indexOf(r.textAlign)!==-1&&(s.halign=r.textAlign),N=["middle","bottom","top"],N.indexOf(r.verticalAlign)!==-1&&(s.valign=r.verticalAlign);var C=parseInt(r.fontSize||"");isNaN(C)||(s.fontSize=C/o);var k=G8(r);k&&(s.fontStyle=k);var K=(r.fontFamily||"").toLowerCase();return n.indexOf(K)!==-1&&(s.font=K),s}function G8(n){var e="";return(n.fontWeight==="bold"||n.fontWeight==="bolder"||parseInt(n.fontWeight)>=700)&&(e="bold"),(n.fontStyle==="italic"||n.fontStyle==="oblique")&&(e+="italic"),e}function Wg(n,e){var t=SE(n,e);if(!t)return null;var r=t.match(/^rgba?\((\d+),\s*(\d+),\s*(\d+)(?:,\s*(\d*\.?\d*))?\)$/);if(!r||!Array.isArray(r))return null;var i=[parseInt(r[1]),parseInt(r[2]),parseInt(r[3])],s=parseInt(r[4]);return s===0||isNaN(i[0])||isNaN(i[1])||isNaN(i[2])?null:i}function SE(n,e){var t=e(n);return t==="rgba(0, 0, 0, 0)"||t==="transparent"||t==="initial"||t==="inherit"?n.parentElement==null?null:SE(n.parentElement,e):t}function K8(n,e){var t=[n.paddingTop,n.paddingRight,n.paddingBottom,n.paddingLeft],r=96/(72/e),i=(parseInt(n.lineHeight)-parseInt(n.fontSize))/e/2,s=t.map(function(a){return parseInt(a||"0")/r}),o=Fp(s,0);return i>o.top&&(o.top=i),i>o.bottom&&(o.bottom=i),o}function PE(n,e,t,r,i){var s,o;r===void 0&&(r=!1),i===void 0&&(i=!1);var a;typeof e=="string"?a=t.document.querySelector(e):a=e;var c=Object.keys(n.getFontList()),u=n.scaleFactor(),d=[],g=[],y=[];if(!a)return console.error("Html table could not be found with input: ",e),{head:d,body:g,foot:y};for(var p=0;p<a.rows.length;p++){var S=a.rows[p],N=(o=(s=S?.parentElement)===null||s===void 0?void 0:s.tagName)===null||o===void 0?void 0:o.toLowerCase(),C=Y8(c,u,t,S,r,i);C&&(N==="thead"?d.push(C):N==="tfoot"?y.push(C):g.push(C))}return{head:d,body:g,foot:y}}function Y8(n,e,t,r,i,s){for(var o=new IE(r),a=0;a<r.cells.length;a++){var c=r.cells[a],u=t.getComputedStyle(c);if(i||u.display!=="none"){var d=void 0;s&&(d=H8(n,c,e,u,t)),o.push({rowSpan:c.rowSpan,colSpan:c.colSpan,styles:d,_element:c,content:J8(c)})}}var g=t.getComputedStyle(r);if(o.length>0&&(i||g.display!=="none"))return o}function J8(n){var e=n.cloneNode(!0);return e.innerHTML=e.innerHTML.replace(/\n/g,"").replace(/ +/g," "),e.innerHTML=e.innerHTML.split(/<br.*?>/).map(function(t){return t.trim()}).join(`
`),e.innerText||e.textContent||""}function Q8(n,e,t){for(var r=0,i=[n,e,t];r<i.length;r++){var s=i[r];s&&typeof s!="object"&&console.error("The options parameter should be of type object, is: "+typeof s),s.startY&&typeof s.startY!="number"&&(console.error("Invalid value for startY option",s.startY),delete s.startY)}}function po(n,e,t,r,i){if(n==null)throw new TypeError("Cannot convert undefined or null to object");for(var s=Object(n),o=1;o<arguments.length;o++){var a=arguments[o];if(a!=null)for(var c in a)Object.prototype.hasOwnProperty.call(a,c)&&(s[c]=a[c])}return s}function xE(n,e){var t=new xu(n),r=t.getDocumentOptions(),i=t.getGlobalOptions();Q8(i,r,e);var s=po({},i,r,e),o;typeof window<"u"&&(o=window);var a=X8(i,r,e),c=Z8(i,r,e),u=eO(t,s),d=nO(t,s,o);return{id:e.tableId,content:d,hooks:c,styles:a,settings:u}}function X8(n,e,t){for(var r={styles:{},headStyles:{},bodyStyles:{},footStyles:{},alternateRowStyles:{},columnStyles:{}},i=function(c){if(c==="columnStyles"){var u=n[c],d=e[c],g=t[c];r.columnStyles=po({},u,d,g)}else{var y=[n,e,t],p=y.map(function(S){return S[c]||{}});r[c]=po({},p[0],p[1],p[2])}},s=0,o=Object.keys(r);s<o.length;s++){var a=o[s];i(a)}return r}function Z8(n,e,t){for(var r=[n,e,t],i={didParseCell:[],willDrawCell:[],didDrawCell:[],willDrawPage:[],didDrawPage:[]},s=0,o=r;s<o.length;s++){var a=o[s];a.didParseCell&&i.didParseCell.push(a.didParseCell),a.willDrawCell&&i.willDrawCell.push(a.willDrawCell),a.didDrawCell&&i.didDrawCell.push(a.didDrawCell),a.willDrawPage&&i.willDrawPage.push(a.willDrawPage),a.didDrawPage&&i.didDrawPage.push(a.didDrawPage)}return i}function eO(n,e){var t,r,i,s,o,a,c,u,d,g,y,p,S=Fp(e.margin,40/n.scaleFactor()),N=(t=tO(n,e.startY))!==null&&t!==void 0?t:S.top,C;e.showFoot===!0?C="everyPage":e.showFoot===!1?C="never":C=(r=e.showFoot)!==null&&r!==void 0?r:"everyPage";var k;e.showHead===!0?k="everyPage":e.showHead===!1?k="never":k=(i=e.showHead)!==null&&i!==void 0?i:"everyPage";var K=(s=e.useCss)!==null&&s!==void 0?s:!1,G=e.theme||(K?"plain":"striped"),W=!!e.horizontalPageBreak,ne=(o=e.horizontalPageBreakRepeat)!==null&&o!==void 0?o:null;return{includeHiddenHtml:(a=e.includeHiddenHtml)!==null&&a!==void 0?a:!1,useCss:K,theme:G,startY:N,margin:S,pageBreak:(c=e.pageBreak)!==null&&c!==void 0?c:"auto",rowPageBreak:(u=e.rowPageBreak)!==null&&u!==void 0?u:"auto",tableWidth:(d=e.tableWidth)!==null&&d!==void 0?d:"auto",showHead:k,showFoot:C,tableLineWidth:(g=e.tableLineWidth)!==null&&g!==void 0?g:0,tableLineColor:(y=e.tableLineColor)!==null&&y!==void 0?y:200,horizontalPageBreak:W,horizontalPageBreakRepeat:ne,horizontalPageBreakBehaviour:(p=e.horizontalPageBreakBehaviour)!==null&&p!==void 0?p:"afterAllRows"}}function tO(n,e){var t=n.getLastAutoTable(),r=n.scaleFactor(),i=n.pageNumber(),s=!1;if(t&&t.startPageNumber){var o=t.startPageNumber+t.pageNumber-1;s=o===i}return typeof e=="number"?e:(e==null||e===!1)&&s&&t?.finalY!=null?t.finalY+20/r:null}function nO(n,e,t){var r=e.head||[],i=e.body||[],s=e.foot||[];if(e.html){var o=e.includeHiddenHtml;if(t){var a=PE(n,e.html,t,o,e.useCss)||{};r=a.head||r,i=a.body||r,s=a.foot||r}else console.error("Cannot parse html in non browser environment")}var c=e.columns||rO(r,i,s);return{columns:c,head:r,body:i,foot:s}}function rO(n,e,t){var r=n[0]||e[0]||t[0]||[],i=[];return Object.keys(r).filter(function(s){return s!=="_element"}).forEach(function(s){var o=1,a;Array.isArray(r)?a=r[parseInt(s)]:a=r[s],typeof a=="object"&&!Array.isArray(a)&&(o=a?.colSpan||1);for(var c=0;c<o;c++){var u=void 0;Array.isArray(r)?u=i.length:u=s+(c>0?"_".concat(c):"");var d={dataKey:u};i.push(d)}}),i}var Km=(function(){function n(e,t,r){this.table=t,this.pageNumber=t.pageNumber,this.settings=t.settings,this.cursor=r,this.doc=e.getDocument()}return n})(),iO=(function(n){bE(e,n);function e(t,r,i,s,o,a){var c=n.call(this,t,r,a)||this;return c.cell=i,c.row=s,c.column=o,c.section=s.section,c}return e})(Km),sO=(function(){function n(e,t){this.pageNumber=1,this.id=e.id,this.settings=e.settings,this.styles=e.styles,this.hooks=e.hooks,this.columns=t.columns,this.head=t.head,this.body=t.body,this.foot=t.foot}return n.prototype.getHeadHeight=function(e){return this.head.reduce(function(t,r){return t+r.getMaxCellHeight(e)},0)},n.prototype.getFootHeight=function(e){return this.foot.reduce(function(t,r){return t+r.getMaxCellHeight(e)},0)},n.prototype.allRows=function(){return this.head.concat(this.body).concat(this.foot)},n.prototype.callCellHooks=function(e,t,r,i,s,o){for(var a=0,c=t;a<c.length;a++){var u=c[a],d=new iO(e,this,r,i,s,o),g=u(d)===!1;if(r.text=Array.isArray(r.text)?r.text:[r.text],g)return!1}return!0},n.prototype.callEndPageHooks=function(e,t){e.applyStyles(e.userStyles);for(var r=0,i=this.hooks.didDrawPage;r<i.length;r++){var s=i[r];s(new Km(e,this,t))}},n.prototype.callWillDrawPageHooks=function(e,t){for(var r=0,i=this.hooks.willDrawPage;r<i.length;r++){var s=i[r];s(new Km(e,this,t))}},n.prototype.getWidth=function(e){if(typeof this.settings.tableWidth=="number")return this.settings.tableWidth;if(this.settings.tableWidth==="wrap"){var t=this.columns.reduce(function(i,s){return i+s.wrappedWidth},0);return t}else{var r=this.settings.margin;return e-r.left-r.right}},n})(),RE=(function(){function n(e,t,r,i,s){s===void 0&&(s=!1),this.height=0,this.raw=e,e instanceof IE&&(this.raw=e._element,this.element=e._element),this.index=t,this.section=r,this.cells=i,this.spansMultiplePages=s}return n.prototype.getMaxCellHeight=function(e){var t=this;return e.reduce(function(r,i){var s;return Math.max(r,((s=t.cells[i.index])===null||s===void 0?void 0:s.height)||0)},0)},n.prototype.hasRowSpan=function(e){var t=this;return e.filter(function(r){var i=t.cells[r.index];return i?i.rowSpan>1:!1}).length>0},n.prototype.canEntireRowFit=function(e,t){return this.getMaxCellHeight(t)<=e},n.prototype.getMinimumRowHeight=function(e,t){var r=this;return e.reduce(function(i,s){var o=r.cells[s.index];if(!o)return 0;var a=t.getLineHeight(o.styles.fontSize),c=o.padding("vertical"),u=c+a;return u>i?u:i},0)},n})(),NE=(function(){function n(e,t,r){var i;this.contentHeight=0,this.contentWidth=0,this.wrappedWidth=0,this.minReadableWidth=0,this.minWidth=0,this.width=0,this.height=0,this.x=0,this.y=0,this.styles=t,this.section=r,this.raw=e;var s=e;e!=null&&typeof e=="object"&&!Array.isArray(e)?(this.rowSpan=e.rowSpan||1,this.colSpan=e.colSpan||1,s=(i=e.content)!==null&&i!==void 0?i:e,e._element&&(this.raw=e._element)):(this.rowSpan=1,this.colSpan=1);var o=s!=null?""+s:"",a=/\r\n|\r|\n/g;this.text=o.split(a)}return n.prototype.getTextPos=function(){var e;if(this.styles.valign==="top")e=this.y+this.padding("top");else if(this.styles.valign==="bottom")e=this.y+this.height-this.padding("bottom");else{var t=this.height-this.padding("vertical");e=this.y+t/2+this.padding("top")}var r;if(this.styles.halign==="right")r=this.x+this.width-this.padding("right");else if(this.styles.halign==="center"){var i=this.width-this.padding("horizontal");r=this.x+i/2+this.padding("left")}else r=this.x+this.padding("left");return{x:r,y:e}},n.prototype.getContentHeight=function(e,t){t===void 0&&(t=1.15);var r=Array.isArray(this.text)?this.text.length:1,i=this.styles.fontSize/e*t,s=r*i+this.padding("vertical");return Math.max(s,this.styles.minCellHeight)},n.prototype.padding=function(e){var t=Fp(this.styles.cellPadding,0);return e==="vertical"?t.top+t.bottom:e==="horizontal"?t.left+t.right:t[e]},n})(),oO=(function(){function n(e,t,r){this.wrappedWidth=0,this.minReadableWidth=0,this.minWidth=0,this.width=0,this.dataKey=e,this.raw=t,this.index=r}return n.prototype.getMaxCustomCellWidth=function(e){for(var t=0,r=0,i=e.allRows();r<i.length;r++){var s=i[r],o=s.cells[this.index];o&&typeof o.styles.cellWidth=="number"&&(t=Math.max(t,o.styles.cellWidth))}return t},n})();function aO(n,e){cO(n,e);var t=[],r=0;e.columns.forEach(function(s){var o=s.getMaxCustomCellWidth(e);o?s.width=o:(s.width=s.wrappedWidth,t.push(s)),r+=s.width});var i=e.getWidth(n.pageSize().width)-r;i&&(i=Ym(t,i,function(s){return Math.max(s.minReadableWidth,s.minWidth)})),i&&(i=Ym(t,i,function(s){return s.minWidth})),i=Math.abs(i),!e.settings.horizontalPageBreak&&i>.1/n.scaleFactor()&&(i=i<1?i:Math.round(i),console.log("Of the table content, ".concat(i," units width could not fit page"))),lO(e),hO(e,n),uO(e)}function cO(n,e){var t=n.scaleFactor(),r=e.settings.horizontalPageBreak,i=TE(n,e);e.allRows().forEach(function(s){for(var o=0,a=e.columns;o<a.length;o++){var c=a[o],u=s.cells[c.index];if(u){var d=e.hooks.didParseCell;e.callCellHooks(n,d,u,s,c,null);var g=u.padding("horizontal");u.contentWidth=Gf(u.text,u.styles,n)+g;var y=Gf(u.text.join(" ").split(/[^\S\u00A0]+/),u.styles,n);if(u.minReadableWidth=y+u.padding("horizontal"),typeof u.styles.cellWidth=="number")u.minWidth=u.styles.cellWidth,u.wrappedWidth=u.styles.cellWidth;else if(u.styles.cellWidth==="wrap"||r===!0)u.contentWidth>i?(u.minWidth=i,u.wrappedWidth=i):(u.minWidth=u.contentWidth,u.wrappedWidth=u.contentWidth);else{var p=10/t;u.minWidth=u.styles.minCellWidth||p,u.wrappedWidth=u.contentWidth,u.minWidth>u.wrappedWidth&&(u.wrappedWidth=u.minWidth)}}}}),e.allRows().forEach(function(s){for(var o=0,a=e.columns;o<a.length;o++){var c=a[o],u=s.cells[c.index];if(u&&u.colSpan===1)c.wrappedWidth=Math.max(c.wrappedWidth,u.wrappedWidth),c.minWidth=Math.max(c.minWidth,u.minWidth),c.minReadableWidth=Math.max(c.minReadableWidth,u.minReadableWidth);else{var d=e.styles.columnStyles[c.dataKey]||e.styles.columnStyles[c.index]||{},g=d.cellWidth||d.minCellWidth;g&&typeof g=="number"&&(c.minWidth=g,c.wrappedWidth=g)}u&&(u.colSpan>1&&!c.minWidth&&(c.minWidth=u.minWidth),u.colSpan>1&&!c.wrappedWidth&&(c.wrappedWidth=u.minWidth))}})}function Ym(n,e,t){for(var r=e,i=n.reduce(function(p,S){return p+S.wrappedWidth},0),s=0;s<n.length;s++){var o=n[s],a=o.wrappedWidth/i,c=r*a,u=o.width+c,d=t(o),g=u<d?d:u;e-=g-o.width,o.width=g}if(e=Math.round(e*1e10)/1e10,e){var y=n.filter(function(p){return e<0?p.width>t(p):!0});y.length&&(e=Ym(y,e,t))}return e}function uO(n){for(var e={},t=1,r=n.allRows(),i=0;i<r.length;i++)for(var s=r[i],o=0,a=n.columns;o<a.length;o++){var c=a[o],u=e[c.index];if(t>1)t--,delete s.cells[c.index];else if(u)u.cell.height+=s.height,t=u.cell.colSpan,delete s.cells[c.index],u.left--,u.left<=1&&delete e[c.index];else{var d=s.cells[c.index];if(!d)continue;if(d.height=s.height,d.rowSpan>1){var g=r.length-i,y=d.rowSpan>g?g:d.rowSpan;e[c.index]={cell:d,left:y,row:s}}}}}function lO(n){for(var e=n.allRows(),t=0;t<e.length;t++)for(var r=e[t],i=null,s=0,o=0,a=0;a<n.columns.length;a++){var c=n.columns[a];if(o-=1,o>1&&n.columns[a+1])s+=c.width,delete r.cells[c.index];else if(i){var u=i;delete r.cells[c.index],i=null,u.width=c.width+s}else{var u=r.cells[c.index];if(!u)continue;if(o=u.colSpan,s=0,u.colSpan>1){i=u,s+=c.width;continue}u.width=c.width+s}}}function hO(n,e){for(var t={count:0,height:0},r=0,i=n.allRows();r<i.length;r++){for(var s=i[r],o=0,a=n.columns;o<a.length;o++){var c=a[o],u=s.cells[c.index];if(u){e.applyStyles(u.styles,!0);var d=u.width-u.padding("horizontal");if(u.styles.overflow==="linebreak")u.text=e.splitTextToSize(u.text,d+1/e.scaleFactor(),{fontSize:u.styles.fontSize});else if(u.styles.overflow==="ellipsize")u.text=n5(u.text,d,u.styles,e,"...");else if(u.styles.overflow==="hidden")u.text=n5(u.text,d,u.styles,e,"");else if(typeof u.styles.overflow=="function"){var g=u.styles.overflow(u.text,d);typeof g=="string"?u.text=[g]:u.text=g}u.contentHeight=u.getContentHeight(e.scaleFactor(),e.getLineHeightFactor());var y=u.contentHeight/u.rowSpan;u.rowSpan>1&&t.count*t.height<y*u.rowSpan?t={height:y,count:u.rowSpan}:t&&t.count>0&&t.height>y&&(y=t.height),y>s.height&&(s.height=y)}}t.count--}}function n5(n,e,t,r,i){return n.map(function(s){return dO(s,e,t,r,i)})}function dO(n,e,t,r,i){var s=1e4*r.scaleFactor();if(e=Math.ceil(e*s)/s,e>=Gf(n,t,r))return n;for(;e<Gf(n+i,t,r)&&!(n.length<=1);)n=n.substring(0,n.length-1);return n.trim()+i}function kE(n,e){var t=new xu(n),r=fO(e,t.scaleFactor()),i=new sO(e,r);return aO(t,i),t.applyStyles(t.userStyles),i}function fO(n,e){var t=n.content,r=gO(t.columns);if(t.head.length===0){var i=r5(r,"head");i&&t.head.push(i)}if(t.foot.length===0){var i=r5(r,"foot");i&&t.foot.push(i)}var s=n.settings.theme,o=n.styles;return{columns:r,head:Hg("head",t.head,r,o,s,e),body:Hg("body",t.body,r,o,s,e),foot:Hg("foot",t.foot,r,o,s,e)}}function Hg(n,e,t,r,i,s){var o={},a=e.map(function(c,u){for(var d=0,g={},y=0,p=0,S=0,N=t;S<N.length;S++){var C=N[S];if(o[C.index]==null||o[C.index].left===0)if(p===0){var k=void 0;Array.isArray(c)?k=c[C.index-y-d]:k=c[C.dataKey];var K={};typeof k=="object"&&!Array.isArray(k)&&(K=k?.styles||{});var G=mO(n,C,u,i,r,s,K),W=new NE(k,G,n);g[C.dataKey]=W,g[C.index]=W,p=W.colSpan-1,o[C.index]={left:W.rowSpan-1,times:p}}else p--,y++;else o[C.index].left--,p=o[C.index].times,d++}return new RE(c,u,n,g)});return a}function r5(n,e){var t={};return n.forEach(function(r){if(r.raw!=null){var i=pO(e,r.raw);i!=null&&(t[r.dataKey]=i)}}),Object.keys(t).length>0?t:null}function pO(n,e){if(n==="head"){if(typeof e=="object")return e.header||null;if(typeof e=="string"||typeof e=="number")return e}else if(n==="foot"&&typeof e=="object")return e.footer;return null}function gO(n){return n.map(function(e,t){var r,i;return typeof e=="object"?i=(r=e.dataKey)!==null&&r!==void 0?r:t:i=t,new oO(i,e,t)})}function mO(n,e,t,r,i,s,o){var a=W8(r),c;n==="head"?c=i.headStyles:n==="body"?c=i.bodyStyles:n==="foot"&&(c=i.footStyles);var u=po({},a.table,a[n],i.styles,c),d=i.columnStyles[e.dataKey]||i.columnStyles[e.index]||{},g=n==="body"?d:{},y=n==="body"&&t%2===0?po({},a.alternateRow,i.alternateRowStyles):{},p=$8(s),S=po({},p,u,y,g);return po(S,o)}function yO(n,e,t){var r;t===void 0&&(t={});var i=TE(n,e),s=new Map,o=[],a=[],c=[];Array.isArray(e.settings.horizontalPageBreakRepeat)?c=e.settings.horizontalPageBreakRepeat:(typeof e.settings.horizontalPageBreakRepeat=="string"||typeof e.settings.horizontalPageBreakRepeat=="number")&&(c=[e.settings.horizontalPageBreakRepeat]),c.forEach(function(y){var p=e.columns.find(function(S){return S.dataKey===y||S.index===y});p&&!s.has(p.index)&&(s.set(p.index,!0),o.push(p.index),a.push(e.columns[p.index]),i-=p.wrappedWidth)});for(var u=!0,d=(r=t?.start)!==null&&r!==void 0?r:0;d<e.columns.length;){if(s.has(d)){d++;continue}var g=e.columns[d].wrappedWidth;if(u||i>=g)u=!1,o.push(d),a.push(e.columns[d]),i-=g;else break;d++}return{colIndexes:o,columns:a,lastIndex:d-1}}function _O(n,e){for(var t=[],r=0;r<e.columns.length;r++){var i=yO(n,e,{start:r});i.columns.length&&(t.push(i),r=i.lastIndex)}return t}function CE(n,e){var t=e.settings,r=t.startY,i=t.margin,s={x:i.left,y:r},o=e.getHeadHeight(e.columns)+e.getFootHeight(e.columns),a=r+i.bottom+o;if(t.pageBreak==="avoid"){var c=e.body,u=c.reduce(function(y,p){return y+p.height},0);a+=u}var d=new xu(n);(t.pageBreak==="always"||t.startY!=null&&a>d.pageSize().height)&&(DE(d),s.y=i.top),e.callWillDrawPageHooks(d,s);var g=po({},s);e.startPageNumber=d.pageNumber(),t.horizontalPageBreak?vO(d,e,g,s):(d.applyStyles(d.userStyles),(t.showHead==="firstPage"||t.showHead==="everyPage")&&e.head.forEach(function(y){return Io(d,e,y,s,e.columns)}),d.applyStyles(d.userStyles),e.body.forEach(function(y,p){var S=p===e.body.length-1;Kf(d,e,y,S,g,s,e.columns)}),d.applyStyles(d.userStyles),(t.showFoot==="lastPage"||t.showFoot==="everyPage")&&e.foot.forEach(function(y){return Io(d,e,y,s,e.columns)})),AE(d,e,g,s),e.callEndPageHooks(d,s),e.finalY=s.y,n.lastAutoTable=e,d.applyStyles(d.userStyles)}function vO(n,e,t,r){var i=_O(n,e),s=e.settings;if(s.horizontalPageBreakBehaviour==="afterAllRows")i.forEach(function(u,d){n.applyStyles(n.userStyles),d>0?mh(n,e,t,r,u.columns,!0):i5(n,e,r,u.columns),wO(n,e,t,r,u.columns),Gg(n,e,r,u.columns)});else for(var o=-1,a=i[0],c=function(){var u=o;if(a){n.applyStyles(n.userStyles);var d=a.columns;o>=0?mh(n,e,t,r,d,!0):i5(n,e,r,d),u=s5(n,e,o+1,r,d),Gg(n,e,r,d)}var g=u-o;i.slice(1).forEach(function(y){n.applyStyles(n.userStyles),mh(n,e,t,r,y.columns,!0),s5(n,e,o+1,r,y.columns,g),Gg(n,e,r,y.columns)}),o=u};o<e.body.length-1;)c()}function i5(n,e,t,r){var i=e.settings;n.applyStyles(n.userStyles),(i.showHead==="firstPage"||i.showHead==="everyPage")&&e.head.forEach(function(s){return Io(n,e,s,t,r)})}function wO(n,e,t,r,i){n.applyStyles(n.userStyles),e.body.forEach(function(s,o){var a=o===e.body.length-1;Kf(n,e,s,a,t,r,i)})}function s5(n,e,t,r,i,s){n.applyStyles(n.userStyles),s=s??e.body.length;var o=Math.min(t+s,e.body.length),a=-1;return e.body.slice(t,o).forEach(function(c,u){var d=t+u===e.body.length-1,g=LE(n,e,d,r);c.canEntireRowFit(g,i)&&(Io(n,e,c,r,i),a=t+u)}),a}function Gg(n,e,t,r){var i=e.settings;n.applyStyles(n.userStyles),(i.showFoot==="lastPage"||i.showFoot==="everyPage")&&e.foot.forEach(function(s){return Io(n,e,s,t,r)})}function bO(n,e,t){var r=t.getLineHeight(n.styles.fontSize),i=n.padding("vertical"),s=Math.floor((e-i)/r);return Math.max(0,s)}function IO(n,e,t,r){var i={};n.spansMultiplePages=!0,n.height=0;for(var s=0,o=0,a=t.columns;o<a.length;o++){var c=a[o],u=n.cells[c.index];if(u){Array.isArray(u.text)||(u.text=[u.text]);var d=new NE(u.raw,u.styles,u.section);d=po(d,u),d.text=[];var g=bO(u,e,r);u.text.length>g&&(d.text=u.text.splice(g,u.text.length));var y=r.scaleFactor(),p=r.getLineHeightFactor();u.contentHeight=u.getContentHeight(y,p),u.contentHeight>=e&&(u.contentHeight=e,d.styles.minCellHeight-=e),u.contentHeight>n.height&&(n.height=u.contentHeight),d.contentHeight=d.getContentHeight(y,p),d.contentHeight>s&&(s=d.contentHeight),i[c.index]=d}}var S=new RE(n.raw,-1,n.section,i,!0);S.height=s;for(var N=0,C=t.columns;N<C.length;N++){var c=C[N],d=S.cells[c.index];d&&(d.height=S.height);var u=n.cells[c.index];u&&(u.height=n.height)}return S}function AO(n,e,t,r){var i=n.pageSize().height,s=r.settings.margin,o=s.top+s.bottom,a=i-o;e.section==="body"&&(a-=r.getHeadHeight(r.columns)+r.getFootHeight(r.columns));var c=e.getMinimumRowHeight(r.columns,n),u=c<t;if(c>a)return console.log("Will not be able to print row ".concat(e.index," correctly since it's minimum height is larger than page height")),!0;if(!u)return!1;var d=e.hasRowSpan(r.columns),g=e.getMaxCellHeight(r.columns)>a;return g?(d&&console.log("The content of row ".concat(e.index," will not be drawn correctly since drawing rows with a height larger than the page height and has cells with rowspans is not supported.")),!0):!(d||r.settings.rowPageBreak==="avoid")}function Kf(n,e,t,r,i,s,o){var a=LE(n,e,r,s);if(t.canEntireRowFit(a,o))Io(n,e,t,s,o);else if(AO(n,t,a,e)){var c=IO(t,a,e,n);Io(n,e,t,s,o),mh(n,e,i,s,o),Kf(n,e,c,r,i,s,o)}else mh(n,e,i,s,o),Kf(n,e,t,r,i,s,o)}function Io(n,e,t,r,i){r.x=e.settings.margin.left;for(var s=0,o=i;s<o.length;s++){var a=o[s],c=t.cells[a.index];if(!c){r.x+=a.width;continue}n.applyStyles(c.styles),c.x=r.x,c.y=r.y;var u=e.callCellHooks(n,e.hooks.willDrawCell,c,t,a,r);if(u===!1){r.x+=a.width;continue}EO(n,c,r);var d=c.getTextPos();wE(c.text,d.x,d.y,{halign:c.styles.halign,valign:c.styles.valign,maxWidth:Math.ceil(c.width-c.padding("left")-c.padding("right"))},n.getDocument()),e.callCellHooks(n,e.hooks.didDrawCell,c,t,a,r),r.x+=a.width}r.y+=t.height}function EO(n,e,t){var r=e.styles;if(n.getDocument().setFillColor(n.getDocument().getFillColor()),typeof r.lineWidth=="number"){var i=EE(r.lineWidth,r.fillColor);i&&n.rect(e.x,t.y,e.width,e.height,i)}else typeof r.lineWidth=="object"&&(r.fillColor&&n.rect(e.x,t.y,e.width,e.height,"F"),TO(n,e,t,r.lineWidth))}function TO(n,e,t,r){var i,s,o,a;r.top&&(i=t.x,s=t.y,o=t.x+e.width,a=t.y,r.right&&(o+=.5*r.right),r.left&&(i-=.5*r.left),c(r.top,i,s,o,a)),r.bottom&&(i=t.x,s=t.y+e.height,o=t.x+e.width,a=t.y+e.height,r.right&&(o+=.5*r.right),r.left&&(i-=.5*r.left),c(r.bottom,i,s,o,a)),r.left&&(i=t.x,s=t.y,o=t.x,a=t.y+e.height,r.top&&(s-=.5*r.top),r.bottom&&(a+=.5*r.bottom),c(r.left,i,s,o,a)),r.right&&(i=t.x+e.width,s=t.y,o=t.x+e.width,a=t.y+e.height,r.top&&(s-=.5*r.top),r.bottom&&(a+=.5*r.bottom),c(r.right,i,s,o,a));function c(u,d,g,y,p){n.getDocument().setLineWidth(u),n.getDocument().line(d,g,y,p,"S")}}function LE(n,e,t,r){var i=e.settings.margin.bottom,s=e.settings.showFoot;return(s==="everyPage"||s==="lastPage"&&t)&&(i+=e.getFootHeight(e.columns)),n.pageSize().height-r.y-i}function mh(n,e,t,r,i,s){i===void 0&&(i=[]),s===void 0&&(s=!1),n.applyStyles(n.userStyles),e.settings.showFoot==="everyPage"&&!s&&e.foot.forEach(function(a){return Io(n,e,a,r,i)}),e.callEndPageHooks(n,r);var o=e.settings.margin;AE(n,e,t,r),DE(n),e.pageNumber++,r.x=o.left,r.y=o.top,t.y=o.top,e.callWillDrawPageHooks(n,r),e.settings.showHead==="everyPage"&&(e.head.forEach(function(a){return Io(n,e,a,r,i)}),n.applyStyles(n.userStyles))}function DE(n){var e=n.pageNumber();n.setPage(e+1);var t=n.pageNumber();return t===e?(n.addPage(),!0):!1}function SO(n){n.API.autoTable=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var r=e[0],i=xE(this,r),s=kE(this,i);return CE(this,s),this},n.API.lastAutoTable=!1,n.API.autoTableText=function(e,t,r,i){wE(e,t,r,i,this)},n.API.autoTableSetDefaults=function(e){return xu.setDefaults(e,this),this},n.autoTableSetDefaults=function(e,t){xu.setDefaults(e,t)},n.API.autoTableHtmlToJson=function(e,t){var r;if(t===void 0&&(t=!1),typeof window>"u")return console.error("Cannot run autoTableHtmlToJson in non browser environment"),null;var i=new xu(this),s=PE(i,e,window,t,!1),o=s.head,a=s.body,c=((r=o[0])===null||r===void 0?void 0:r.map(function(u){return u.content}))||[];return{columns:c,rows:a,data:a}}}var Kg;function PO(n,e){var t=xE(n,e),r=kE(n,t);CE(n,r)}try{if(typeof window<"u"&&window){var o5=window,a5=o5.jsPDF||((Kg=o5.jspdf)===null||Kg===void 0?void 0:Kg.jsPDF);a5&&SO(a5)}}catch(n){console.error("Could not apply autoTable plugin",n)}const c5="v1.6.3";function xO(){console.log("AppDate Version:",c5),document.querySelectorAll(".app-version-label").forEach(e=>e.textContent=c5),window.addAppointment=ME,window.editAppointment=BE,window.saveAppointmentEdit=UE,window.deleteAppointment=jE,window.closeEditAppointmentModal=Mp,window.openAddAppointmentModal=VE;const n=document.getElementById("icsInput");n&&(n.onclick=function(){this.value=null}),FE(),VO()}window.addAppointment=ME;window.editAppointment=BE;window.saveAppointmentEdit=UE;window.deleteAppointment=jE;window.closeEditAppointmentModal=Mp;window.openAddAppointmentModal=VE;window.handleIcsUpload=NO;window.setCalendarFilter=RO;window.jumpToToday=OE;window.jumpToDate=$0;window.exportManualAppointments=CO;window.handleBackupUpload=LO;window.exportOverviewPdf=kO;let gf=null,mf=null,fc="all",Jm="",u5=!1,q0="calendar",go="week",pa=!1,os=new Set;window.switchView=n=>{q0=n;const e=document.getElementById("calendarList"),t=document.getElementById("overviewView"),r=document.getElementById("nav-btn-calendar"),i=document.getElementById("nav-btn-overview");n==="calendar"?(e.classList.remove("hidden"),t.classList.add("hidden"),r.classList.add("text-blue-400","bg-blue-500/10"),r.classList.remove("text-br-400","hover:text-br-200"),i.classList.remove("text-blue-400","bg-blue-500/10"),i.classList.add("text-br-400","hover:text-br-200"),dl()):(e.classList.add("hidden"),t.classList.remove("hidden"),i.classList.add("text-blue-400","bg-blue-500/10"),i.classList.remove("text-br-400","hover:text-br-200"),r.classList.remove("text-blue-400","bg-blue-500/10"),r.classList.add("text-br-400","hover:text-br-200"),renderOverview())};window.setOverviewRange=n=>{go=n,["week","month","year","custom"].forEach(t=>{const r=document.getElementById(`ov-btn-${t}`);t===n?(r.classList.add("bg-blue-600","text-white","shadow"),r.classList.remove("text-br-300","hover:text-white")):(r.classList.remove("bg-blue-600","text-white","shadow"),r.classList.add("text-br-300","hover:text-white"))});const e=document.getElementById("overviewCustomInputs");n==="custom"?e.classList.remove("hidden"):e.classList.add("hidden"),renderOverview()};window.renderOverview=()=>{const n=document.getElementById("overviewList");if(!n)return;let e=nn.allEvents||[];e=e.filter(c=>fc==="all"?!0:fc==="exchange"?c.source==="exchange"||c.source==="imported":fc==="manual"?c.source==="app"||(c.source==="exchange"||c.source==="imported")&&c.isAppRelevant:!0);const t=new Date;let r,i;if(go==="week"){const c=new Date(t),u=c.getDay()||7;u!==1&&c.setHours(-24*(u-1)),r=c.toISOString().split("T")[0];const d=new Date(c);d.setDate(d.getDate()+6),i=d.toISOString().split("T")[0]}else go==="month"?(r=new Date(t.getFullYear(),t.getMonth(),1).toISOString().split("T")[0],i=new Date(t.getFullYear(),t.getMonth()+1,0).toISOString().split("T")[0]):go==="year"?(r=`${t.getFullYear()}-01-01`,i=`${t.getFullYear()}-12-31`):go==="custom"&&(r=document.getElementById("ovStart").value,i=document.getElementById("ovEnd").value);const s=e.filter(c=>{const u=(c.start||"").split("T")[0];return!(r&&u<r||i&&u>i)});if(s.sort((c,u)=>(c.start||"").localeCompare(u.start||"")),s.length===0){n.innerHTML='<div class="p-8 text-center text-br-300">Keine Termine im Zeitraum</div>';return}let o='<div class="bg-br-800 rounded-xl overflow-hidden border border-br-600/50">',a="";s.forEach(c=>{const u=c.start.split("T")[0],d=new Date(c.start),g=d.toLocaleDateString("de-DE",{day:"2-digit",month:"2-digit",year:"2-digit"}),y=d.toLocaleDateString("de-DE",{weekday:"short"}),p=c.isAllDay?"All Day":d.toLocaleTimeString("de-DE",{hour:"2-digit",minute:"2-digit"}),S=u!==a;a=u;const N=S?"border-t border-br-700/50":"";c.source,o+=`
        <div class="flex items-center p-3 hover:bg-white/5 transition-colors gap-3 ${N}">
            <div class="w-14 flex flex-col items-center leading-tight opacity-70">
                <span class="text-[10px] uppercase font-bold text-br-400">${y}</span>
                <span class="text-xs font-mono text-br-200">${g}</span>
            </div>
            
            <div class="w-12 text-xs font-mono text-br-300 text-right">
                ${p}
            </div>
            
            <div class="flex-grow min-w-0">
                <div class="text-sm font-medium text-white truncate">${c.title}</div>
                ${c.location?`<div class="text-[10px] text-br-400 truncate"> ${c.location}</div>`:""}
                ${c.description&&c.description.trim()!=="{"?`<div class="text-[10px] text-br-500 truncate mt-0.5">${c.description}</div>`:""}
            </div>

            <div class="w-2 h-2 rounded-full ${c.source==="exchange"?"bg-purple-500":"bg-blue-500"}"></div>
        </div>
        `}),o+="</div>",o+=`<div class="text-center text-xs text-br-400 mt-2">${s.length} Termine gefunden</div>`,n.innerHTML=o};window.filterBySearch=n=>{Jm=n,dl()};window.toggleSelectionMode=()=>{pa=!pa,os.clear(),z0(),dl()};window.toggleEventSelection=n=>{pa&&(os.has(n)?os.delete(n):os.add(n),z0(),dl())};window.deleteSelectedAppointments=async()=>{if(os.size!==0&&confirm(`${os.size} Termine wirklich lschen?`))try{const n=lr.batch();let e=0;const t=[...nn.events.app,...nn.events.exchange];os.forEach(r=>{const i=t.find(a=>a.id===r);if(!i)return;const s=i.source==="exchange"?"exchange_events":"app_events",o=lr.collection(s).doc(r);n.delete(o),e++}),await n.commit(),alert(` ${e} Termine gelscht.`),pa=!1,os.clear(),z0()}catch(n){console.error("Batch Delete Error:",n),alert("Fehler beim Lschen: "+n.message)}};function z0(){const n=document.getElementById("btnSelectionMode"),e=n.querySelector("span:not(#selectionCountBadge)"),t=document.getElementById("selectionCountBadge"),r=document.getElementById("btnDeleteSelected"),i=document.querySelector('button[onclick="openAddAppointmentModal()"]');pa?(n.classList.add("bg-blue-600","text-white","border-blue-500"),n.classList.remove("text-br-300"),e&&(e.textContent="Nicht Lschen"),i&&i.classList.add("hidden"),os.size>0?(r.classList.remove("hidden"),r.classList.add("flex"),t.textContent=os.size,t.classList.remove("hidden"),t.classList.add("flex")):(r.classList.add("hidden"),r.classList.remove("flex"),t.classList.add("hidden"),t.classList.remove("flex"))):(n.classList.remove("bg-blue-600","text-white","border-blue-500"),n.classList.add("text-br-300"),e&&(e.textContent="Lschauswahl"),i&&i.classList.remove("hidden"),r.classList.add("hidden"),r.classList.remove("flex"),t.classList.add("hidden"),t.classList.remove("flex"))}function RO(n){fc=n;const e=["all","exchange","manual"];e.forEach(t=>{const r=document.getElementById(`filter-btn-${t}`);r&&(t===n?(r.classList.add("bg-blue-600","text-white","shadow"),r.classList.remove("text-br-300","hover:text-white","bg-transparent")):r.className="px-3 py-1.5 text-xs font-medium rounded-lg text-br-300 hover:text-white transition-all")}),e.forEach(t=>{const r=document.getElementById(`ov-filter-btn-${t}`);r&&(t===n?(r.classList.add("bg-blue-600","text-white","shadow"),r.classList.remove("text-br-300","hover:text-white","bg-transparent")):r.className="px-3 py-1.5 text-xs font-medium rounded-lg text-br-300 hover:text-white transition-all")}),q0==="overview"?renderOverview():dl()}function OE(){const n=new Date().toISOString().split("T")[0];$0(n)}function $0(n){if(!n)return;const e=document.getElementById(`date-${n}`);if(e){const r=document.querySelector("header"),o=(r?r.offsetHeight:120)+80,c=e.getBoundingClientRect().top+window.pageYOffset-o;window.scrollTo({top:c,behavior:"smooth"}),e.classList.add("bg-br-700"),setTimeout(()=>e.classList.remove("bg-br-700"),1500)}else{const i=Object.keys(nn.groupedEvents||{}).sort().find(s=>s>=n);i?$0(i):alert("Keine Termine an oder nach diesem Datum gefunden.")}const t=document.getElementById("dateNav");t&&t.value!==n&&(t.value=n)}async function NO(n){if(console.log("DEBUG: handleIcsUpload called with",n),!n.files||!n.files[0]){console.log("No file selected.");return}if(!confirm(` ACHTUNG: Dies lscht ALLE bestehenden Termine (App & Exchange) und importiert die Datei neu.

Wirklich fortfahren?`)){n.value="";return}const e=n.files[0];console.log("Reading file:",e.name);try{const t=await e.text();console.log("File content length:",t.length);const r=DO(t),i=new Date;i.setDate(i.getDate()-1);const s=i.toISOString().split("T")[0],o=r.filter(a=>a.start?a.start.split("T")[0]>=s:!1);console.log(`Found ${r.length} total events. filtered to ${o.length} future events.`),setTimeout(async()=>{try{if(console.log("Starting import process inside timeout..."),o.length===0){alert("Keine zuknftigen Termine gefunden.");return}console.log("User confirmed Reset & Import (Pre-Check passed).");const a=lr.collection("app_events");console.log("Cleaning up ALL old data (Full Reset)...");const c=await a.get();console.log(`Found ${c.size} app events to delete.`),await l5(lr,c.docs),console.log("Deleted all app events.");const u=await lr.collection("exchange_events").get();console.log(`Found ${u.size} exchange events to delete.`),await l5(lr,u.docs),console.log("Deleted all exchange events."),console.log("Starting upload of new events...");const d=400,g=[];for(let p=0;p<o.length;p+=d)g.push(o.slice(p,p+d));let y=0;for(const p of g){const S=lr.batch();p.forEach(N=>{const C=a.doc();S.set(C,{...N,source:"imported",createdAt:new Date})}),await S.commit(),y+=p.length,console.log(`Uploaded batch. Total: ${y}`)}console.log("All done."),alert(` ${y} Termine erfolgreich importiert!`),n.value=""}catch(a){console.error("Critical Error inside Import Timeout:",a),alert("Kritischer Import-Fehler: "+a.message)}},100)}catch(t){console.error("Import Error:",t),alert("Fehler: "+t.message)}}async function kO(){try{const n=new rt,e=new Date;let t,r,i;if(go==="week"){const u=new Date(e),d=u.getDay()||7;d!==1&&u.setHours(-24*(d-1)),t=u.toISOString().split("T")[0];const g=new Date(u);g.setDate(g.getDate()+6),r=g.toISOString().split("T")[0],i=`Woche: ${t} bis ${r}`}else if(go==="month")t=new Date(e.getFullYear(),e.getMonth(),1).toISOString().split("T")[0],r=new Date(e.getFullYear(),e.getMonth()+1,0).toISOString().split("T")[0],i=`Monat: ${e.toLocaleDateString("de-DE",{month:"long",year:"numeric"})}`;else if(go==="year")t=`${e.getFullYear()}-01-01`,r=`${e.getFullYear()}-12-31`,i=`Jahr: ${e.getFullYear()}`;else if(go==="custom"){if(t=document.getElementById("ovStart").value,r=document.getElementById("ovEnd").value,!t||!r){alert("Bitte erst einen Zeitraum auswhlen.");return}i=`Zeitraum: ${t} bis ${r}`}const o=(nn.allEvents||[]).filter(u=>{const d=u.source==="app"||!u.source&&!u.type,g=(u.source==="exchange"||u.source==="imported")&&u.isAppRelevant;if(!d&&!g)return!1;const y=(u.start||"").split("T")[0];return!(t&&y<t||r&&y>r)});if(o.sort((u,d)=>(u.start||"").localeCompare(d.start||"")),o.length===0){alert("Keine Termine fr diesen Zeitraum gefunden (nur App-Relevante werden gedruckt).");return}n.setFontSize(18),n.setTextColor(40,40,40),n.text("AppDate Terminbersicht",14,20),n.setFontSize(10),n.setTextColor(100,100,100),n.text(`Erstellt am: ${e.toLocaleDateString("de-DE")} ${e.toLocaleTimeString("de-DE")}`,14,26),n.text(i,14,32);const a=o.map(u=>{const d=new Date(u.start),g=d.toLocaleDateString("de-DE",{weekday:"short",day:"2-digit",month:"2-digit",year:"2-digit"}),y=u.isAllDay?"Ganztgig":d.toLocaleTimeString("de-DE",{hour:"2-digit",minute:"2-digit"});return[g,y,u.title||"",u.location||""]});PO(n,{head:[["Datum","Zeit","Titel","Ort"]],body:a,startY:40,theme:"grid",styles:{fontSize:8,cellPadding:1.5,lineColor:[200,200,200],lineWidth:.1,overflow:"linebreak"},headStyles:{fillColor:[60,100,160],textColor:255,fontSize:8,fontStyle:"bold",halign:"left"},columnStyles:{0:{cellWidth:25},1:{cellWidth:15},2:{cellWidth:"auto"},3:{cellWidth:35}},alternateRowStyles:{fillColor:[250,250,250]},margin:{top:40,left:14,right:14}});const c=n.internal.getNumberOfPages();for(let u=1;u<=c;u++)n.setPage(u),n.setFontSize(8),n.setTextColor(150),n.text(`Seite ${u} von ${c}`,n.internal.pageSize.width-20,n.internal.pageSize.height-10,{align:"right"});n.save(`AppDate_Termine_${t}_${r}.pdf`)}catch(n){console.error("PDF Export Error:",n),alert("Fehler beim PDF Export: "+n.message)}}async function CO(){try{const n=nn.events.app.filter(s=>s.source==="app"||!s.source&&!s.type);if(n.length===0){alert("Keine manuellen Termine zum Exportieren gefunden.");return}const e=JSON.stringify(n,null,2),t="data:application/json;charset=utf-8,"+encodeURIComponent(e),r=`app-termine-backup-${new Date().toISOString().split("T")[0]}.json`,i=document.createElement("a");i.setAttribute("href",t),i.setAttribute("download",r),i.click(),console.log(`Exported ${n.length} manual events.`)}catch(n){console.error("Export Error:",n),alert("Fehler beim Export: "+n.message)}}async function LO(n){if(!n.files||!n.files[0])return;const e=n.files[0];if(!confirm(`Mchtest du das Backup "${e.name}" wiederherstellen?
Dies fgt die Termine zu den bestehenden hinzu.`)){n.value="";return}try{const t=await e.text(),r=JSON.parse(t);if(!Array.isArray(r))throw new Error("Ungltiges Format (Kein Array)");console.log(`Restoring ${r.length} events...`);let i=0;const s=lr.batch();let o=0;for(const a of r){const{id:c,...u}=a;if(u.source="app",u.createdAt=new Date,!u.title||!u.start)continue;const d=lr.collection("app_events").doc();s.set(d,u),i++,o++,o>=450&&(await s.commit(),o=0)}o>0&&await s.commit(),alert(` ${i} Termine erfolgreich wiederhergestellt.`),n.value=""}catch(t){console.error("Restore Error:",t),alert("Fehler beim Wiederherstellen: "+t.message),n.value=""}}async function l5(n,e){if(e.length===0)return;const t=400;for(let r=0;r<e.length;r+=t){const i=n.batch();e.slice(r,r+t).forEach(o=>i.delete(o.ref)),await i.commit()}}function DO(n){const e=[],t=n.split(/\r\n|\n|\r/);let r=null;const i=s=>{if(!s)return null;try{const o=s.split(":"),a=o[o.length-1],c=a.substring(0,4),u=a.substring(4,6),d=a.substring(6,8);let g="00",y="00",p="00";if(a.includes("T")){const S=a.split("T")[1];g=S.substring(0,2),y=S.substring(2,4),p=S.substring(4,6)}return`${c}-${u}-${d}T${g}:${y}:${p}`}catch{return null}};return t.forEach(s=>{if(s=s.trim(),s==="BEGIN:VEVENT")r={};else if(s==="END:VEVENT")r&&(r.title||r.summary)&&r.start&&(!r.title&&r.summary&&(r.title=r.summary),e.push(r)),r=null;else if(r){if(s.startsWith("SUMMARY:")&&(r.title=s.substring(8)),s.startsWith("SUMMARY;")){const o=s.split(":");o.length>1&&(r.title=o.slice(1).join(":"))}s.startsWith("DTSTART")&&(r.start=i(s)),s.startsWith("DTEND")&&(r.end=i(s)),s.startsWith("LOCATION:")&&(r.location=s.substring(9)),s.startsWith("DESCRIPTION:")&&(r.description=s.substring(12))}}),e}function FE(){Qm(),nn.events={exchange:[],app:[]},gf=lr.collection("exchange_events").onSnapshot(n=>{const e=n.docs.map(t=>({...t.data(),id:t.id,source:"exchange"}));nn.events.exchange=e,h5()},n=>console.log("Exchange sync error",n)),mf=lr.collection("app_events").onSnapshot(n=>{const e=n.docs.map(t=>{const r=t.data();return{id:t.id,...r,source:r.source||"app"}});nn.events.app=e,h5()},n=>console.log("App sync error",n))}function Qm(){gf&&gf(),mf&&mf(),gf=null,mf=null}function W0(){const n=document.getElementById("apptRecurrence").value,e=document.getElementById("apptRecurrenceEnd"),t=document.getElementById("recurrenceIntervalGroup"),r=document.getElementById("recurrenceUnitLabel");if(n==="none")e.disabled=!0,e.value="",t.classList.add("hidden");else{e.disabled=!1,t.classList.remove("hidden");let i="Tage";if(n==="weekly"&&(i="Wochen"),n==="monthly"&&(i="Monate"),n==="yearly"&&(i="Jahre"),r.textContent=i,!e.value){const s=new Date;s.setFullYear(s.getFullYear()+1),e.value=s.toISOString().split("T")[0]}}}document.addEventListener("DOMContentLoaded",()=>{const n=document.getElementById("apptRecurrence");n&&n.addEventListener("change",W0)});function h5(){OO()}function OO(){const n=new Map,e=r=>{if(!r.start)return;if(r.id,!r.recurrence||r.recurrence==="none"){const d=`${r.start.split("T")[0]}|${r.title}`;n.set(d,r);return}let i=new Date(r.start);const s=r.recurrenceEnd?new Date(r.recurrenceEnd):new Date(new Date().getFullYear()+2,0,1);let o=0;const a=365*2,c=r.recurrence,u=parseInt(r.recurrenceInterval||1);for(;i<=s&&o<a;){const d=i.getFullYear(),g=String(i.getMonth()+1).padStart(2,"0"),y=String(i.getDate()).padStart(2,"0"),p=`${d}-${g}-${y}`;if(r.excludedDates&&r.excludedDates.includes(p)){d5(i,c,u),o++;continue}const S=new Date(r.start),N=String(S.getHours()).padStart(2,"0"),C=String(S.getMinutes()).padStart(2,"0"),K=new Date(r.end).getTime()-S.getTime(),G=`${d}-${g}-${y}T${N}:${C}:00`,W=new Date(G),ne=new Date(W.getTime()+K),de=ne.getFullYear(),B=String(ne.getMonth()+1).padStart(2,"0"),x=String(ne.getDate()).padStart(2,"0"),A=String(ne.getHours()).padStart(2,"0"),F=String(ne.getMinutes()).padStart(2,"0"),b=`${de}-${B}-${x}T${A}:${F}:00`,E={...r,start:G,end:b,_isInstance:o>0},T=`${G.split("T")[0]}|${r.title}`;n.set(T,E),d5(i,c,u),o++}};[...nn.events.app,...nn.events.exchange].forEach(e),nn.allEvents=Array.from(n.values()),q0==="overview"?renderOverview():dl()}function d5(n,e,t){e==="daily"&&n.setDate(n.getDate()+t),e==="weekly"&&n.setDate(n.getDate()+7*t),e==="monthly"&&n.setMonth(n.getMonth()+t),e==="yearly"&&n.setFullYear(n.getFullYear()+t)}function dl(){const n=document.getElementById("calendarList");if(!n)return;const e=nn.allEvents||[];if(e.length===0){n.innerHTML='<div class="p-8 text-center text-br-300"><div class="text-4xl mb-2"></div><p>Keine Termine gefunden</p></div>';return}const t=e.filter(u=>{if(Jm){const d=Jm.toLowerCase(),g=(u.title||"").toLowerCase(),y=(u.description||"").toLowerCase(),p=(u.location||"").toLowerCase();if(!g.includes(d)&&!y.includes(d)&&!p.includes(d))return!1}return fc==="all"?!0:fc==="exchange"?u.source==="exchange"||u.source==="imported":fc==="manual"?u.source==="app"||(u.source==="exchange"||u.source==="imported")&&u.isAppRelevant:!0});if(t.length===0){n.innerHTML='<div class="p-8 text-center text-br-300"><div class="text-4xl mb-2"></div><p>Keine Termine fr diesen Filter</p></div>';return}t.sort((u,d)=>(u.start||"").localeCompare(d.start||""));const r=new Date;r.setDate(r.getDate()-1);const i=r.toISOString().split("T")[0],s=t.filter(u=>(u.start||"").split("T")[0]>=i),o={};s.forEach(u=>{const d=(u.start||"").split("T")[0],g=(u.end||"").split("T")[0];if(d!==g){const y=new Date(d),p=new Date(g);let S=new Date(y);for(;S<=p;){const N=S.toISOString().split("T")[0];o[N]||(o[N]=[]),o[N].push(u),S.setDate(S.getDate()+1)}}else o[d]||(o[d]=[]),o[d].push(u)}),nn.groupedEvents=o;const a=Object.keys(o).sort();let c="";a.forEach(u=>{const d=o[u],g=new Date(u).toLocaleDateString("de-DE",{weekday:"long",year:"numeric",month:"long",day:"numeric"}),y=u===new Date().toISOString().split("T")[0];c+=`<div id="date-${u}" class="mb-6 scroll-mt-48 transition-colors duration-500 rounded-lg">
            <div class="sticky top-[7.5rem] bg-br-900/95 backdrop-blur py-2 border-b border-br-700 mb-2 z-10 flex items-center gap-2 shadow-md">
                <h3 class="font-bold ${y?"text-blue-400":"text-br-200"} text-lg">${y?"Heute, ":""}${g}</h3>
            </div>
            <div class="space-y-3">`,d.forEach(p=>{const S=p.source==="exchange",N=p.recurrence&&p.recurrence!=="none",C=FO(p),k=p.start?`'${p.start}'`:"null",K=p.id.replace(/'/g,"\\'"),G=os.has(p.id);let W,ne,de="";pa?(W=`window.toggleEventSelection('${K}')`,G?(ne="bg-blue-600/20 border-blue-500 ring-1 ring-blue-500 shadow-lg shadow-blue-500/10 cursor-pointer",de='<div class="absolute right-4 top-4 text-blue-400 animate-in zoom-in spin-in-90 duration-200"><i class="ph-check-circle-fill text-2xl"></i></div>'):(ne="bg-br-800 border-br-600 hover:bg-br-750 cursor-pointer opacity-80 hover:opacity-100",de='<div class="absolute right-4 top-4 text-br-500"><i class="ph-circle text-2xl"></i></div>')):(W=`window.editAppointment('${K}', ${k})`,ne=S?"bg-br-800/50 border-br-700 cursor-pointer hover:border-purple-500":"bg-br-800 border-br-600 hover:border-blue-500 cursor-pointer"),c+=`<div class="p-4 rounded-xl border ${ne} transition-all relative overflow-hidden group select-none"
                onclick="${W}">
                
                ${pa?de:S?'<div class="absolute right-0 top-0 bottom-0 w-1 bg-purple-500"></div>':'<div class="absolute right-0 top-0 bottom-0 w-1 bg-blue-500"></div>'}
                
                <div class="flex justify-between items-start ${pa?"pr-8":""}">
                    <div>
                        <div class="font-medium text-white mb-1 flex items-center gap-2">
                             ${p.title||"Termin"}
                             ${N?'<span class="text-[10px] text-blue-300 bg-blue-900/40 px-1 rounded"></span>':""}
                        </div>
                        <div class="flex items-center gap-3 text-xs text-br-300">
                            <span class="flex items-center gap-1"> ${C}</span>
                            ${p.location?`<span class="flex items-center gap-1"> ${p.location}</span>`:""}
                        </div>
                    </div>
                </div>
                ${p.description&&p.description.length>3&&!p.description.includes("{")?`<div class="mt-2 text-xs text-br-400 line-clamp-2">${p.description}</div>`:""}
            </div>`}),c+="</div></div>"}),s.length===0&&(c='<div class="p-8 text-center text-br-300"><p>Keine zuknftigen Termine</p></div>'),n.innerHTML=c,u5||setTimeout(()=>{OE(),u5=!0},300)}function FO(n){if(n.isAllDay)return"Ganztgig";if(n.start&&n.end)try{const e=new Date(n.start),t=new Date(n.end);return`${e.toLocaleTimeString("de-DE",{hour:"2-digit",minute:"2-digit"})} - ${t.toLocaleTimeString("de-DE",{hour:"2-digit",minute:"2-digit"})}`}catch{}return""}function ME(){}function VE(){const n=document.getElementById("editAppointmentModal");n.classList.remove("hidden"),n.classList.add("flex"),nn.editingAppointmentId=null,nn.editingInstanceDate=null,document.getElementById("apptId").value="",document.getElementById("apptTitle").value="",document.getElementById("apptDate").value=new Date().toISOString().split("T")[0],document.getElementById("apptStart").value="09:00",document.getElementById("apptEnd").value="10:00",document.getElementById("apptLocation").value="",document.getElementById("apptDescription").value="",document.getElementById("apptAllDay").checked=!1,document.getElementById("apptRecurrence").value="none",document.getElementById("apptRecurrenceInterval").value="1",document.getElementById("apptRecurrenceEnd").value="",W0(),document.getElementById("exchangeOptions").classList.add("hidden"),document.getElementById("apptIsAppRelevant").checked=!1,document.getElementById("btnDeleteAppt").classList.add("hidden"),document.getElementById("btnGroupRecurringDelete").classList.add("hidden"),document.getElementById("modalTitleAppt").textContent=" Neuer Termin",document.getElementById("apptReminderActive").checked=!1,document.getElementById("apptReminderValue").value="15",document.getElementById("apptReminderUnit").value="minutes",H0()}function BE(n,e){let t=nn.events.app.find(y=>y.id===n);if(t||(t=nn.events.exchange.find(y=>y.id===n)),!t){console.error("Event not found for editing:",n);return}nn.editingAppointmentId=n;const r=e||t.start,i=r.split("T")[0];nn.editingInstanceDate=i;const s=r.includes("T")?r.split("T")[1].substring(0,5):"09:00",o=t.end&&t.end.includes("T")?t.end.split("T")[1].substring(0,5):"17:00";document.getElementById("editAppointmentModal").classList.remove("hidden"),document.getElementById("editAppointmentModal").classList.add("flex"),document.getElementById("apptId").value=n,document.getElementById("apptTitle").value=t.title,document.getElementById("apptDate").value=i,document.getElementById("apptStart").value=s,document.getElementById("apptEnd").value=o,document.getElementById("apptLocation").value=t.location||"";const a=(t.description||"").trim();document.getElementById("apptDescription").value=a==="{"?"":a,document.getElementById("apptAllDay").checked=t.isAllDay||!1,document.getElementById("apptRecurrence").value=t.recurrence||"none",document.getElementById("apptRecurrenceInterval").value=t.recurrenceInterval||"1",document.getElementById("apptRecurrenceEnd").value=t.recurrenceEnd||"",W0(),t.recurrence&&t.recurrence!=="none"?(document.getElementById("btnDeleteAppt").classList.add("hidden"),document.getElementById("btnGroupRecurringDelete").classList.remove("hidden"),document.getElementById("btnGroupRecurringDelete").classList.add("flex")):(document.getElementById("btnDeleteAppt").classList.remove("hidden"),document.getElementById("btnGroupRecurringDelete").classList.add("hidden"),document.getElementById("btnGroupRecurringDelete").classList.remove("flex"));const u=document.getElementById("exchangeOptions"),d=document.getElementById("apptIsAppRelevant");u.classList.remove("hidden"),t.source==="exchange"||t.source==="imported"?(d.disabled=!1,d.checked=t.isAppRelevant||!1,document.querySelector('label[for="apptIsAppRelevant"]').textContent="Auch in App Filter anzeigen",document.querySelector("#exchangeOptions p").textContent='Dieser Outlook-Termin erscheint dann auch im lokalen "App"-Filter.'):(d.checked=!0,d.disabled=!0,document.querySelector('label[for="apptIsAppRelevant"]').textContent="In App Filter aktiv",document.querySelector("#exchangeOptions p").textContent="Standard-Termine sind immer im App-Filter sichtbar."),document.getElementById("modalTitleAppt").textContent=" Termin bearbeiten";const g=t.reminderActive||!1;document.getElementById("apptReminderActive").checked=g,document.getElementById("apptReminderValue").value=t.reminderValue||"15",document.getElementById("apptReminderUnit").value=t.reminderUnit||"minutes",H0()}async function UE(){const n=document.getElementById("apptId").value,e=document.getElementById("apptTitle").value,t=document.getElementById("apptDate").value,r=document.getElementById("apptStart").value,i=document.getElementById("apptEnd").value,s=document.getElementById("apptLocation").value,o=document.getElementById("apptDescription").value,a=document.getElementById("apptAllDay").checked,c=document.getElementById("apptRecurrence").value,u=document.getElementById("apptRecurrenceEnd").value,d=document.getElementById("apptRecurrenceInterval").value;if(!e||!t){alert("Bitte Titel und Datum ausfllen.");return}const g=`${t}T${r}:00`;let y=t;if(i<r){const[C,k,K]=t.split("-").map(Number),G=new Date(C,k,0).getDate();let W=K+1,ne=k,de=C;W>G&&(W=1,ne++,ne>12&&(ne=1,de++)),y=`${de}-${String(ne).padStart(2,"0")}-${String(W).padStart(2,"0")}`}const p=`${y}T${i}:00`,S={title:e,start:g,end:p,location:s,description:o,isAllDay:a,recurrence:c,recurrenceEnd:u,recurrenceInterval:d,recurrenceInterval:d,reminderActive:document.getElementById("apptReminderActive").checked,reminderValue:parseInt(document.getElementById("apptReminderValue").value)||15,reminderUnit:document.getElementById("apptReminderUnit").value,updatedAt:new Date};let N=null;if(n&&(N=nn.events.app.find(C=>C.id===n)||nn.events.exchange.find(C=>C.id===n)),N&&(N.source==="exchange"||N.source==="imported")){S.source=N.source;const C=document.getElementById("apptIsAppRelevant").checked;S.isAppRelevant=C}else S.source="app";try{n?nn.events.exchange.some(k=>k.id===n)?await lr.collection("exchange_events").doc(n).update(S):(await lr.collection("app_events").doc(n).get()).exists?await lr.collection("app_events").doc(n).update(S):await lr.collection("app_events").add(S):(S.createdAt=new Date,await lr.collection("app_events").add(S)),Mp()}catch(C){console.error("Save Error:",C),alert("Fehler beim Speichern: "+C.message)}}async function jE(){const n=nn.editingAppointmentId;if(n&&confirm("Termin wirklich lschen?"))try{await lr.collection("app_events").doc(n).delete(),await lr.collection("exchange_events").doc(n).delete(),Mp()}catch(e){console.error("Delete Error:",e)}}function Mp(){document.getElementById("editAppointmentModal").classList.remove("flex"),document.getElementById("editAppointmentModal").classList.add("hidden")}const f5=new Set,MO=new Audio("https://assets.mixkit.co/active_storage/sfx/2869/2869-preview.mp3");function VO(){setInterval(BO,3e4);const n=document.getElementById("apptReminderActive");n&&n.addEventListener("change",H0)}function H0(){const n=document.getElementById("apptReminderActive"),e=document.getElementById("reminderOptions");n&&n.checked?(e.classList.remove("hidden"),"Notification"in window&&Notification.permission!=="granted"&&Notification.requestPermission()):e&&e.classList.add("hidden")}function BO(){if(!nn.allEvents)return;const n=new Date;nn.allEvents.forEach(e=>{if(!e.reminderActive||!e.start)return;const t=new Date(e.start),r=e.reminderValue||15,i=e.reminderUnit||"minutes";let s=new Date(t);i==="minutes"&&s.setMinutes(t.getMinutes()-r),i==="hours"&&s.setHours(t.getHours()-r),i==="days"&&s.setDate(t.getDate()-r);const a=(n.getTime()-s.getTime())/6e4;if(a>=0&&a<2){const c=`${e.id}_${e.start}`;f5.has(c)||(UO(e),f5.add(c))}})}function UO(n){console.log(" REMINDER:",n.title);try{MO.play().catch(e=>console.log("Audio play blocked (user didn't interact yet):",e))}catch{}"Notification"in window&&Notification.permission==="granted"&&document.visibilityState==="hidden"&&new Notification("Erinnerung: "+n.title,{body:`Startet um ${new Date(n.start).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})}`,icon:"/icon.png"}),jO(` ${n.title}`,`In ${n.reminderValue} ${n.reminderUnit==="minutes"?"Minuten":n.reminderUnit==="hours"?"Stunden":"Tagen"}`)}function jO(n,e){const t=document.createElement("div");t.className="fixed top-4 right-4 z-[9999] bg-br-800 border border-blue-500 text-white px-4 py-3 rounded-xl shadow-2xl flex items-center gap-3 animate-fade-in",t.innerHTML=`
        <div class="bg-blue-500/20 p-2 rounded-full text-blue-400"><i class="ph-bell-ringing-bold text-xl"></i></div>
        <div>
            <div class="font-bold text-sm">${n}</div>
            <div class="text-xs text-br-300">${e}</div>
        </div>
    `,document.body.appendChild(t),setTimeout(()=>{t.style.opacity="0",t.style.transform="translateY(-10px)",t.style.transition="all 0.5s ease",setTimeout(()=>t.remove(),500)},5e3)}let qs=[],Yf="none";function qO(){window.openSecuritySettings=g5,window.closeSecurityModal=qE,window.startPinChange=KO,window.lockApp=$O,window.confirmPinAction=JO,window.cancelPinAction=YO,window.clearPinDigit=HO,window.triggerBiometricUnlock=G0,window.setupBiometricFromSettings=t7;const n=document.getElementById("btnSecurity");n&&n.addEventListener("click",g5),document.querySelectorAll(".pin-key").forEach(e=>{e.addEventListener("click",t=>{const r=t.target.getAttribute("data-num");r&&WO(r)})})}const Vp="appdate_bio_cred_id";function p5(n){const e=document.getElementById("lockScreen");e&&(e.classList.remove("hidden"),e.classList.add("flex")),qs=[],Bp(),ZO(n).then(t=>{t&&G0()})}function zO(){const n=document.getElementById("lockScreen");n&&(n.classList.add("hidden"),n.classList.remove("flex")),qs=[]}function $O(){sessionStorage.removeItem("APP_UNLOCKED"),window.location.reload()}async function WO(n){const e=document.getElementById("lockScreen");document.getElementById("securityPinView"),!e.classList.contains("hidden")&&qs.length<4&&(qs.push(n),Bp(),qs.length===4&&await GO())}function HO(){qs.length>0&&(qs.pop(),Bp()),document.getElementById("lockMessage").textContent=""}function Bp(){const n=document.getElementById("pinDisplayDots");if(!n)return;const e=n.children;for(let t=0;t<4;t++)t<qs.length?(e[t].classList.remove("bg-br-700","border-br-600"),e[t].classList.add("bg-blue-500","border-blue-400","shadow-[0_0_10px_rgba(59,130,246,0.5)]")):(e[t].classList.remove("bg-blue-500","border-blue-400","shadow-[0_0_10px_rgba(59,130,246,0.5)]"),e[t].classList.add("bg-br-700","border-br-600"))}async function GO(){const n=qs.join(""),e=`user-${n}@appdate.local`,t=n+F0,r=document.getElementById("lockMessage");r.textContent="Prfe...";try{await yo.signInWithEmailAndPassword(e,t),r.textContent="Erfolg",window.finalizeUnlock&&window.finalizeUnlock()}catch(i){if(console.error("Login Error:",i),i.code==="auth/user-not-found"||i.code==="auth/invalid-credential")if(await yo.signOut(),confirm(`PIN ${n} ist noch nicht eingerichtet. Mchtest du ihn jetzt aktivieren?`))try{await yo.createUserWithEmailAndPassword(e,t),window.finalizeUnlock&&window.finalizeUnlock(),window.finalizeUnlock()}catch(s){$l("Fehler: "+s.message),pu()}else $l("PIN nicht gefunden."),pu();else i.code==="auth/wrong-password"?($l("Falscher Code."),pu()):i.code==="auth/too-many-requests"?($l("Zu viele Versuche. Warte kurz."),pu()):($l("Fehler: "+i.message),pu())}}function $l(n){const e=document.getElementById("lockMessage");e&&(e.textContent=n)}function pu(){const n=document.getElementById("pinDisplayDots");n&&(n.classList.add("animate-shake"),setTimeout(()=>{qs=[],Bp(),n.classList.remove("animate-shake")},500))}function g5(){const n=document.getElementById("securityModal");n.classList.remove("hidden"),n.classList.add("flex"),Up()}function qE(){const n=document.getElementById("securityModal");n.classList.add("hidden"),n.classList.remove("flex"),Up()}function Up(){document.getElementById("securityMainView").classList.remove("hidden"),document.getElementById("securityPinView").classList.add("hidden"),document.getElementById("modalPinInput").value="";const n=document.getElementById("modalPinError");n&&(n.textContent=""),Yf="none",document.getElementById("pinManageSection").classList.remove("hidden"),document.getElementById("pinSetupSection").classList.add("hidden");const e=document.getElementById("btnSetupBioManual");e&&(window.PublicKeyCredential?(e.classList.remove("hidden"),localStorage.getItem(Vp)?e.innerHTML='<i class="ph-check-circle-bold text-xl"></i> Face ID aktiv (Neu koppeln)':e.innerHTML='<i class="ph-fingerprint-simple-bold text-xl"></i> Face ID / Touch ID koppeln'):e.classList.add("hidden"))}function zE(n,e,t){document.getElementById("securityMainView").classList.add("hidden"),document.getElementById("securityPinView").classList.remove("hidden"),document.getElementById("securityPinView").classList.add("flex"),document.getElementById("pinViewTitle").textContent=n,document.getElementById("pinViewDesc").textContent=e;const r=document.getElementById("modalPinInput");r.value="",r.focus(),Yf=t}function KO(){zE("Authentifizierung","Alten PIN eingeben","change-verify-old")}function YO(){Up()}async function JO(){const n=document.getElementById("modalPinInput").value,e=document.getElementById("modalPinError");if(!/^\d{4}$/.test(n)){e.textContent="Muss genau 4 Zahlen enthalten.";return}Yf==="change-verify-old"?await QO(n)?zE("Neuer PIN","Bitte neuen Code eingeben","change-new"):e.textContent="Falscher PIN.":Yf==="change-new"&&(await XO(n),qE(),alert("PIN erfolgreich gendert!"))}async function QO(n){try{const e=n+F0,t=$s.auth.EmailAuthProvider.credential(ZC,e);return await yo.currentUser.reauthenticateWithCredential(t),!0}catch(e){return console.error("Reauth failed",e),!1}}async function XO(n){try{const e=n+F0;await yo.currentUser.updatePassword(e)}catch(e){console.error("Update password failed",e),alert("Fehler beim ndern: "+e.message)}}async function ZO(n){if(!window.PublicKeyCredential)return;const e=localStorage.getItem(Vp),t=document.getElementById("btnBiometricUnlock");return n||yo.currentUser,e?(t&&(t.classList.remove("hidden"),t.classList.add("flex")),!0):(t&&(t.classList.add("hidden"),t.classList.remove("flex")),!1)}async function e7(){try{const n=new Uint8Array(32);window.crypto.getRandomValues(n);const e={challenge:n,rp:{name:"AppDate Secured",id:window.location.hostname},user:{id:Uint8Array.from(yo.currentUser.uid,r=>r.charCodeAt(0)),name:yo.currentUser.email||"User",displayName:"AppDate User"},pubKeyCredParams:[{alg:-7,type:"public-key"}],authenticatorSelection:{authenticatorAttachment:"platform",userVerification:"required"},timeout:6e4},t=await navigator.credentials.create({publicKey:e});localStorage.setItem(Vp,t.id),alert("Face ID / Touch ID erfolgreich eingerichtet!")}catch(n){console.error("Bio Setup Error:",n),alert("Einrichtung fehlgeschlagen: "+n.message)}}async function G0(){try{const n=new Uint8Array(32);window.crypto.getRandomValues(n);const e={challenge:n,rpId:window.location.hostname,userVerification:"required",timeout:6e4},t=localStorage.getItem(Vp);if(t&&t!=="active")try{const r=t.replace(/-/g,"+").replace(/_/g,"/"),i=r.length%4,s=i?r+"=".repeat(4-i):r,o=Uint8Array.from(atob(s),a=>a.charCodeAt(0));e.allowCredentials=[{type:"public-key",id:o,transports:["internal"]}]}catch(r){console.warn("Could not decode stored BioID, falling back to discovery.",r)}await navigator.credentials.get({publicKey:e}),window.finalizeUnlock&&window.finalizeUnlock()}catch(n){console.error("Bio Unlock Error:",n),pu()}}window.triggerBiometricUnlock=G0;async function t7(){confirm("Mchtest du dieses Gert mit deinem Account verknpfen (via FaceID/TouchID)?")&&(await e7(),Up())}function $E(){const n=document.getElementById("app");sessionStorage.setItem("APP_UNLOCKED","true"),zO(),n&&n.classList.remove("hidden"),FE()}window.finalizeUnlock=$E;function n7(){yo.onAuthStateChanged(async n=>{const e=document.getElementById("app");n?(console.log("Auth State: User is authenticated.",n.uid),nn.currentUser=n,sessionStorage.getItem("APP_UNLOCKED")==="true"?(console.log("Session verified. Unlocking."),$E()):(console.log("New Session / Locked. Showing Lock Screen."),p5(n),Qm())):(console.log("Auth State: User not logged in."),nn.currentUser=null,sessionStorage.removeItem("APP_UNLOCKED"),Qm(),p5(),e&&e.classList.add("hidden"))})}document.addEventListener("DOMContentLoaded",()=>{"serviceWorker"in navigator&&navigator.serviceWorker.getRegistrations().then(function(n){for(let e of n)e.unregister(),console.log("Legacy Service Worker unregistered.")}),qO(),n7(),xO()});export{Zt as _};
